(self["webpackChunkintrigue_web"]=self["webpackChunkintrigue_web"]||[]).push([[857],{5787:function(t,e,n){var r=n(7854),i=n(7976),o=r.TypeError;t.exports=function(t,e){if(i(e,t))return t;throw o("Incorrect invocation")}},3678:function(t){t.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},2801:function(t,e,n){"use strict";var r=n(2109),i=n(5005),o=n(9114),s=n(3070).f,a=n(2597),c=n(5787),u=n(9587),l=n(6277),d=n(3678),h=n(7741),f=n(1913),p="DOMException",g=i("Error"),m=i(p),v=function(){c(this,y);var t=arguments.length,e=l(t<1?void 0:arguments[0]),n=l(t<2?void 0:arguments[1],"Error"),r=new m(e,n),i=g(e);return i.name=p,s(r,"stack",o(1,h(i.stack,1))),u(r,this,v),r},y=v.prototype=m.prototype,b="stack"in g(p),w="stack"in new m(1,2),E=b&&!w;r({global:!0,constructor:!0,forced:f||E},{DOMException:E?v:m});var S=i(p),D=S.prototype;if(D.constructor!==S)for(var k in f||s(D,"constructor",o(1,S)),d)if(a(d,k)){var x=d[k],C=x.s;a(S,C)||s(S,C,o(6,x.c))}},9841:function(t,e){"use strict";var n="\\b10\\.(?:97[89]\\.\\d{2,8}\\/\\d{1,7}|\\d{4,9}\\/\\S+)",r=new RegExp(n,"g"),i=new RegExp(n),o=/(?:\w|\(.+\)|2-#)$/;function s(t){var e=String(t).toLowerCase().match(r);return e?e.map(c).filter(Boolean):[]}function a(t){var e=String(t).toLowerCase().match(i);if(e)return c(e[0])}function c(t){return o.test(t)?t:a(t.replace(/\W$/,""))}e.extract=s},6294:function(t){"use strict";const e="[a-fA-F\\d:]",n=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${e})|(?<=${e})(?=\\s|$))`:"",r="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",i="[a-fA-F\\d]{1,4}",o=`\n(?:\n(?:${i}:){7}(?:${i}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${i}:){6}(?:${r}|:${i}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${i}:){5}(?::${r}|(?::${i}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${i}:){4}(?:(?::${i}){0,1}:${r}|(?::${i}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${i}:){3}(?:(?::${i}){0,2}:${r}|(?::${i}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${i}:){2}(?:(?::${i}){0,3}:${r}|(?::${i}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${i}:){1}(?:(?::${i}){0,4}:${r}|(?::${i}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::${i}){0,5}:${r}|(?::${i}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),s=new RegExp(`(?:^${r}$)|(?:^${o}$)`),a=new RegExp(`^${r}$`),c=new RegExp(`^${o}$`),u=t=>t&&t.exact?s:new RegExp(`(?:${n(t)}${r}${n(t)})|(?:${n(t)}${o}${n(t)})`,"g");u.v4=t=>t&&t.exact?a:new RegExp(`${n(t)}${r}${n(t)}`,"g"),u.v6=t=>t&&t.exact?c:new RegExp(`${n(t)}${o}${n(t)}`,"g"),t.exports=u},4892:function(t,e,n){n(1703),n(6699);const r=n(6035),i=n(8447),o=n(3213),s=n(2470),a=n(4667),c=n(34),u=n(4324),l=n(5708),d=t=>Math.floor(Math.random()*Math.floor(t)),h=(t,e)=>{if(!Number.isInteger(e))throw new Error("The value of maxWords is incorrect.");const n=e-1,r=t.filter((t=>t.split(" ").length-1<=n));return r},f=(t="en",e={})=>{if(!["en","es","ja","pt","nl","fr","de","cs"].includes(t))throw new Error("Selected language is invalid.");const n=Object.keys(e);if(n.length&&!n.includes("maxWords"))throw new Error("Specified option is invalid.");let f=r.fruits;return"es"===t&&(f=i.fruits),"ja"===t&&(f=o.fruits),"pt"===t&&(f=s.fruits),"nl"===t&&(f=a.fruits),"fr"===t&&(f=c.fruits),"de"===t&&(f=u.fruits),"cs"===t&&(f=l.fruits),"maxWords"in e&&(f=h(f,e.maxWords)),f[d(f.length)]};t.exports=f},4743:function(t,e,n){n(1703),n(8675),n(3462),n(6699),function(e){t.exports=e()}((function(){var t=Math.floor,e=Math.abs,r=Math.pow;return function(){function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var c=void 0;if(!a&&c)return require(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};e[s][0].call(l.exports,(function(t){var n=e[s][1][t];return i(n||t)}),l,l.exports,t,e,n,r)}return n[s].exports}for(var o=void 0,s=0;s<r.length;s++)i(r[s]);return i}return t}()({1:[function(t,e,n){"use strict";function r(t){var e=t.length;if(0<e%4)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");-1===n&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function i(t,e,n){return 3*(e+n)/4-n}function o(t){var e,n,o=r(t),s=o[0],a=o[1],c=new d(i(t,s,a)),u=0,h=0<a?s-4:s;for(n=0;n<h;n+=4)e=l[t.charCodeAt(n)]<<18|l[t.charCodeAt(n+1)]<<12|l[t.charCodeAt(n+2)]<<6|l[t.charCodeAt(n+3)],c[u++]=255&e>>16,c[u++]=255&e>>8,c[u++]=255&e;return 2===a&&(e=l[t.charCodeAt(n)]<<2|l[t.charCodeAt(n+1)]>>4,c[u++]=255&e),1===a&&(e=l[t.charCodeAt(n)]<<10|l[t.charCodeAt(n+1)]<<4|l[t.charCodeAt(n+2)]>>2,c[u++]=255&e>>8,c[u++]=255&e),c}function s(t){return u[63&t>>18]+u[63&t>>12]+u[63&t>>6]+u[63&t]}function a(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(16711680&t[o]<<16)+(65280&t[o+1]<<8)+(255&t[o+2]),i.push(s(r));return i.join("")}function c(t){for(var e,n=t.length,r=n%3,i=[],o=16383,s=0,c=n-r;s<c;s+=o)i.push(a(t,s,s+o>c?c:s+o));return 1===r?(e=t[n-1],i.push(u[e>>2]+u[63&e<<4]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],i.push(u[e>>10]+u[63&e>>4]+u[63&e<<2]+"=")),i.join("")}n.byteLength=function(t){var e=r(t),n=e[0],i=e[1];return 3*(n+i)/4-i},n.toByteArray=o,n.fromByteArray=c;for(var u=[],l=[],d="undefined"==typeof Uint8Array?Array:Uint8Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,p=h.length;f<p;++f)u[f]=h[f],l[h.charCodeAt(f)]=f;l[45]=62,l[95]=63},{}],2:[function(){},{}],3:[function(t,e,n){(function(){(function(){
/*!
          * The buffer module from node.js, for the browser.
          *
          * @author   Feross Aboukhadijeh <https://feross.org>
          * @license  MIT
          */
"use strict";var e=String.fromCharCode,i=Math.min;function o(t){if(2147483647<t)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return e.__proto__=s.prototype,e}function s(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return l(t)}return a(t,e,n)}function a(t,e,n){if("string"==typeof t)return d(t,e);if(ArrayBuffer.isView(t))return h(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(q(t,ArrayBuffer)||t&&q(t.buffer,ArrayBuffer))return f(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return s.from(r,e,n);var i=p(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return s.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(0>t)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t,e,n){return c(t),0>=t||void 0===e?o(t):"string"==typeof n?o(t).fill(e,n):o(t).fill(e)}function l(t){return c(t),o(0>t?0:0|g(t))}function d(t,e){if(("string"!=typeof e||""===e)&&(e="utf8"),!s.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|m(t,e),r=o(n),i=r.write(t,e);return i!==n&&(r=r.slice(0,i)),r}function h(t){for(var e=0>t.length?0:0|g(t.length),n=o(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function f(t,e,n){if(0>e||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),r.__proto__=s.prototype,r}function p(t){if(s.isBuffer(t)){var e=0|g(t.length),n=o(e);return 0===n.length||t.copy(n,0,0,e),n}return void 0===t.length?"Buffer"===t.type&&Array.isArray(t.data)?h(t.data):void 0:"number"!=typeof t.length||G(t.length)?o(0):h(t)}function g(t){if(t>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|t}function m(t,e){if(s.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||q(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,r=2<arguments.length&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return $(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return W(t).length;default:if(i)return r?-1:$(t).length;e=(""+e).toLowerCase(),i=!0}}function v(t,e,n){var r=!1;if((void 0===e||0>e)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),0>=n)return"";if(n>>>=0,e>>>=0,n<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,n);case"utf8":case"utf-8":return O(this,e,n);case"ascii":return M(this,e,n);case"latin1":case"binary":return T(this,e,n);case"base64":return _(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function y(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function b(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:-2147483648>n&&(n=-2147483648),n=+n,G(n)&&(n=i?0:t.length-1),0>n&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(0>n){if(!i)return-1;n=0}if("string"==typeof e&&(e=s.from(e,r)),s.isBuffer(e))return 0===e.length?-1:w(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):w(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function w(t,e,n,r,i){function o(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}var s,a=1,c=t.length,u=e.length;if(void 0!==r&&(r=(r+"").toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(2>t.length||2>e.length)return-1;a=2,c/=2,u/=2,n/=2}if(i){var l=-1;for(s=n;s<c;s++)if(o(t,s)!==o(e,-1===l?0:s-l))-1!==l&&(s-=s-l),l=-1;else if(-1===l&&(l=s),s-l+1===u)return l*a}else for(n+u>c&&(n=c-u),s=n;0<=s;s--){for(var d=!0,h=0;h<u;h++)if(o(t,s+h)!==o(e,h)){d=!1;break}if(d)return s}return-1}function E(t,e,n,r){n=+n||0;var i=t.length-n;r?(r=+r,r>i&&(r=i)):r=i;var o=e.length;r>o/2&&(r=o/2);for(var s,a=0;a<r;++a){if(s=parseInt(e.substr(2*a,2),16),G(s))return a;t[n+a]=s}return a}function S(t,e,n,r){return U($(e,t.length-n),t,n,r)}function D(t,e,n,r){return U(H(e),t,n,r)}function k(t,e,n,r){return D(t,e,n,r)}function x(t,e,n,r){return U(W(e),t,n,r)}function C(t,e,n,r){return U(V(e,t.length-n),t,n,r)}function _(t,e,n){return 0===e&&n===t.length?K.fromByteArray(t):K.fromByteArray(t.slice(e,n))}function O(t,e,n){n=i(t.length,n);for(var r=[],o=e;o<n;){var s,a,c,u,l=t[o],d=null,h=239<l?4:223<l?3:191<l?2:1;if(o+h<=n)1===h?128>l&&(d=l):2===h?(s=t[o+1],128==(192&s)&&(u=(31&l)<<6|63&s,127<u&&(d=u))):3===h?(s=t[o+1],a=t[o+2],128==(192&s)&&128==(192&a)&&(u=(15&l)<<12|(63&s)<<6|63&a,2047<u&&(55296>u||57343<u)&&(d=u))):4===h&&(s=t[o+1],a=t[o+2],c=t[o+3],128==(192&s)&&128==(192&a)&&128==(192&c)&&(u=(15&l)<<18|(63&s)<<12|(63&a)<<6|63&c,65535<u&&1114112>u&&(d=u)));null===d?(d=65533,h=1):65535<d&&(d-=65536,r.push(55296|1023&d>>>10),d=56320|1023&d),r.push(d),o+=h}return A(r)}function A(t){var n=t.length;if(n<=4096)return e.apply(String,t);for(var r="",i=0;i<n;)r+=e.apply(String,t.slice(i,i+=4096));return r}function M(t,n,r){var o="";r=i(t.length,r);for(var s=n;s<r;++s)o+=e(127&t[s]);return o}function T(t,n,r){var o="";r=i(t.length,r);for(var s=n;s<r;++s)o+=e(t[s]);return o}function R(t,e,n){var r=t.length;(!e||0>e)&&(e=0),(!n||0>n||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=L(t[o]);return i}function N(t,n,r){for(var i=t.slice(n,r),o="",s=0;s<i.length;s+=2)o+=e(i[s]+256*i[s+1]);return o}function P(t,e,n){if(0!=t%1||0>t)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function B(t,e,n,r,i,o){if(!s.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function F(t,e,n,r){if(n+r>t.length)throw new RangeError("Index out of range");if(0>n)throw new RangeError("Index out of range")}function I(t,e,n,r,i){return e=+e,n>>>=0,i||F(t,e,n,4,34028234663852886e22,-34028234663852886e22),Y.write(t,e,n,r,23,4),n+4}function z(t,e,n,r,i){return e=+e,n>>>=0,i||F(t,e,n,8,17976931348623157e292,-17976931348623157e292),Y.write(t,e,n,r,52,8),n+8}function j(t){if(t=t.split("=")[0],t=t.trim().replace(X,""),2>t.length)return"";for(;0!=t.length%4;)t+="=";return t}function L(t){return 16>t?"0"+t.toString(16):t.toString(16)}function $(t,e){e=e||1/0;for(var n,r=t.length,i=null,o=[],s=0;s<r;++s){if(n=t.charCodeAt(s),55295<n&&57344>n){if(!i){if(56319<n){-1<(e-=3)&&o.push(239,191,189);continue}if(s+1===r){-1<(e-=3)&&o.push(239,191,189);continue}i=n;continue}if(56320>n){-1<(e-=3)&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(e-=3)&&o.push(239,191,189);if(i=null,128>n){if(0>(e-=1))break;o.push(n)}else if(2048>n){if(0>(e-=2))break;o.push(192|n>>6,128|63&n)}else if(65536>n){if(0>(e-=3))break;o.push(224|n>>12,128|63&n>>6,128|63&n)}else{if(!(1114112>n))throw new Error("Invalid code point");if(0>(e-=4))break;o.push(240|n>>18,128|63&n>>12,128|63&n>>6,128|63&n)}}return o}function H(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function V(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!(0>(e-=2));++s)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}function W(t){return K.toByteArray(j(t))}function U(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function q(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function G(t){return t!==t}var K=t("base64-js"),Y=t("ieee754");n.Buffer=s,n.SlowBuffer=function(t){return+t!=t&&(t=0),s.alloc(+t)},n.INSPECT_MAX_BYTES=50,n.kMaxLength=2147483647,s.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(e){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){return s.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){return s.isBuffer(this)?this.byteOffset:void 0}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192,s.from=function(t,e,n){return a(t,e,n)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,s.alloc=function(t,e,n){return u(t,e,n)},s.allocUnsafe=function(t){return l(t)},s.allocUnsafeSlow=function(t){return l(t)},s.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function(t,e){if(q(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),q(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,r=e.length,o=0,a=i(n,r);o<a;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},s.isEncoding=function(t){switch((t+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=s.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(q(o,Uint8Array)&&(o=s.from(o)),!s.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},s.byteLength=m,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var t=this.length;if(0!=t%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},s.prototype.swap32=function(){var t=this.length;if(0!=t%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},s.prototype.swap64=function(){var t=this.length;if(0!=t%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},s.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?O(this,0,t):v.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},s.prototype.compare=function(t,e,n,r,o){if(q(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),0>e||n>t.length||0>r||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,o>>>=0,this===t)return 0;for(var a=o-r,c=n-e,u=i(a,c),l=this.slice(r,o),d=t.slice(e,n),h=0;h<u;++h)if(l[h]!==d[h]){a=l[h],c=d[h];break}return a<c?-1:c<a?1:0},s.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},s.prototype.indexOf=function(t,e,n){return b(this,t,e,n,!0)},s.prototype.lastIndexOf=function(t,e,n){return b(this,t,e,n,!1)},s.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),0<t.length&&(0>n||0>e)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return E(this,t,e,n);case"utf8":case"utf-8":return S(this,t,e,n);case"ascii":return D(this,t,e,n);case"latin1":case"binary":return k(this,t,e,n);case"base64":return x(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,0>t?(t+=n,0>t&&(t=0)):t>n&&(t=n),0>e?(e+=n,0>e&&(e=0)):e>n&&(e=n),e<t&&(e=t);var r=this.subarray(t,e);return r.__proto__=s.prototype,r},s.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||P(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},s.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||P(t,e,this.length);for(var r=this[t+--e],i=1;0<e&&(i*=256);)r+=this[t+--e]*i;return r},s.prototype.readUInt8=function(t,e){return t>>>=0,e||P(t,1,this.length),this[t]},s.prototype.readUInt16LE=function(t,e){return t>>>=0,e||P(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUInt16BE=function(t,e){return t>>>=0,e||P(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUInt32LE=function(t,e){return t>>>=0,e||P(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUInt32BE=function(t,e){return t>>>=0,e||P(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||P(t,e,this.length);for(var i=this[t],o=1,s=0;++s<e&&(o*=256);)i+=this[t+s]*o;return o*=128,i>=o&&(i-=r(2,8*e)),i},s.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||P(t,e,this.length);for(var i=e,o=1,s=this[t+--i];0<i&&(o*=256);)s+=this[t+--i]*o;return o*=128,s>=o&&(s-=r(2,8*e)),s},s.prototype.readInt8=function(t,e){return t>>>=0,e||P(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},s.prototype.readInt16LE=function(t,e){t>>>=0,e||P(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(t,e){t>>>=0,e||P(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(t,e){return t>>>=0,e||P(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t>>>=0,e||P(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readFloatLE=function(t,e){return t>>>=0,e||P(t,4,this.length),Y.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t>>>=0,e||P(t,4,this.length),Y.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t>>>=0,e||P(t,8,this.length),Y.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t>>>=0,e||P(t,8,this.length),Y.read(this,t,!1,52,8)},s.prototype.writeUIntLE=function(t,e,n,i){if(t=+t,e>>>=0,n>>>=0,!i){var o=r(2,8*n)-1;B(this,t,e,n,o,0)}var s=1,a=0;for(this[e]=255&t;++a<n&&(s*=256);)this[e+a]=255&t/s;return e+n},s.prototype.writeUIntBE=function(t,e,n,i){if(t=+t,e>>>=0,n>>>=0,!i){var o=r(2,8*n)-1;B(this,t,e,n,o,0)}var s=n-1,a=1;for(this[e+s]=255&t;0<=--s&&(a*=256);)this[e+s]=255&t/a;return e+n},s.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,1,255,0),this[e]=255&t,e+1},s.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},s.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e>>>=0,!i){var o=r(2,8*n-1);B(this,t,e,n,o-1,-o)}var s=0,a=1,c=0;for(this[e]=255&t;++s<n&&(a*=256);)0>t&&0===c&&0!==this[e+s-1]&&(c=1),this[e+s]=255&(t/a>>0)-c;return e+n},s.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e>>>=0,!i){var o=r(2,8*n-1);B(this,t,e,n,o-1,-o)}var s=n-1,a=1,c=0;for(this[e+s]=255&t;0<=--s&&(a*=256);)0>t&&0===c&&0!==this[e+s+1]&&(c=1),this[e+s]=255&(t/a>>0)-c;return e+n},s.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,1,127,-128),0>t&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||B(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeFloatLE=function(t,e,n){return I(this,t,e,!0,n)},s.prototype.writeFloatBE=function(t,e,n){return I(this,t,e,!1,n)},s.prototype.writeDoubleLE=function(t,e,n){return z(this,t,e,!0,n)},s.prototype.writeDoubleBE=function(t,e,n){return z(this,t,e,!1,n)},s.prototype.copy=function(t,e,n,r){if(!s.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),0<r&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(0>e)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("Index out of range");if(0>r)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i=r-n;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,n,r);else if(this===t&&n<e&&e<r)for(var o=i-1;0<=o;--o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,r),e);return i},s.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){var i=t.charCodeAt(0);("utf8"===r&&128>i||"latin1"===r)&&(t=i)}}else"number"==typeof t&&(t&=255);if(0>e||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=s.isBuffer(t)?t:s.from(t,r),c=a.length;if(0===c)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=a[o%c]}return this};var X=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,t("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(t,e,n){(function(r){(function(){function i(){let t;try{t=n.storage.getItem("debug")}catch(t){}return!t&&"undefined"!=typeof r&&"env"in r&&(t=r.env.DEBUG),t}n.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(t=>{"%%"===t||(r++,"%c"===t&&(i=r))})),t.splice(i,0,n)},n.save=function(t){try{t?n.storage.setItem("debug",t):n.storage.removeItem("debug")}catch(t){}},n.load=i,n.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},n.storage=function(){try{return localStorage}catch(t){}}(),n.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.log=console.debug||console.log||(()=>{}),e.exports=t("./common")(n);const{formatters:o}=e.exports;o.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this)}).call(this,t("_process"))},{"./common":5,_process:12}],5:[function(t,n){n.exports=function(n){function r(t){function e(...t){if(!e.enabled)return;const i=e,o=+new Date,s=o-(n||o);i.diff=s,i.prev=n,i.curr=o,n=o,t[0]=r.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let a=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,((e,n)=>{if("%%"===e)return"%";a++;const o=r.formatters[n];if("function"==typeof o){const n=t[a];e=o.call(i,n),t.splice(a,1),a--}return e})),r.formatArgs.call(i,t);const c=i.log||r.log;c.apply(i,t)}let n,o=null;return e.namespace=t,e.useColors=r.useColors(),e.color=r.selectColor(t),e.extend=i,e.destroy=r.destroy,Object.defineProperty(e,"enabled",{enumerable:!0,configurable:!1,get:()=>null===o?r.enabled(t):o,set:t=>{o=t}}),"function"==typeof r.init&&r.init(e),e}function i(t,e){const n=r(this.namespace+("undefined"==typeof e?":":e)+t);return n.log=this.log,n}function o(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(t){return t instanceof Error?t.stack||t.message:t},r.disable=function(){const t=[...r.names.map(o),...r.skips.map(o).map((t=>"-"+t))].join(",");return r.enable(""),t},r.enable=function(t){let e;r.save(t),r.names=[],r.skips=[];const n=("string"==typeof t?t:"").split(/[\s,]+/),i=n.length;for(e=0;e<i;e++)n[e]&&(t=n[e].replace(/\*/g,".*?"),"-"===t[0]?r.skips.push(new RegExp("^"+t.substr(1)+"$")):r.names.push(new RegExp("^"+t+"$")))},r.enabled=function(t){if("*"===t[t.length-1])return!0;let e,n;for(e=0,n=r.skips.length;e<n;e++)if(r.skips[e].test(t))return!1;for(e=0,n=r.names.length;e<n;e++)if(r.names[e].test(t))return!0;return!1},r.humanize=t("ms"),r.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(n).forEach((t=>{r[t]=n[t]})),r.names=[],r.skips=[],r.formatters={},r.selectColor=function(t){let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return r.colors[e(n)%r.colors.length]},r.enable(r.load()),r}},{ms:11}],6:[function(t,e){"use strict";function n(t,e){for(const n in e)Object.defineProperty(t,n,{value:e[n],enumerable:!0,configurable:!0});return t}e.exports=function(t,e,r){if(!t||"string"==typeof t)throw new TypeError("Please pass an Error to err-code");r||(r={}),"object"==typeof e&&(r=e,e=""),e&&(r.code=e);try{return n(t,r)}catch(e){r.message=t.message,r.stack=t.stack;const i=function(){};i.prototype=Object.create(Object.getPrototypeOf(t));const o=n(new i,r);return o}}},{}],7:[function(t,e){"use strict";function n(t){console&&console.warn&&console.warn(t)}function r(){r.init.call(this)}function i(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function o(t){return void 0===t._maxListeners?r.defaultMaxListeners:t._maxListeners}function s(t,e,r,s){var a,c,u;if(i(r),c=t._events,void 0===c?(c=t._events=Object.create(null),t._eventsCount=0):(void 0!==c.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),c=t._events),u=c[e]),void 0===u)u=c[e]=r,++t._eventsCount;else if("function"==typeof u?u=c[e]=s?[r,u]:[u,r]:s?u.unshift(r):u.push(r),a=o(t),0<a&&u.length>a&&!u.warned){u.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=u.length,n(l)}return t}function a(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=a.bind(r);return i.listener=n,r.wrapFn=i,i}function u(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?f(i):d(i,i.length)}function l(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function d(t,e){for(var n=Array(e),r=0;r<e;++r)n[r]=t[r];return n}function h(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function f(t){for(var e=Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function p(t,e,n){"function"==typeof t.on&&g(t,"error",e,n)}function g(t,e,n,r){if("function"==typeof t.on)r.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function i(o){r.once&&t.removeEventListener(e,i),n(o)}))}}var m,v="object"==typeof Reflect?Reflect:null,y=v&&"function"==typeof v.apply?v.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};m=v&&"function"==typeof v.ownKeys?v.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var b=Number.isNaN||function(t){return t!==t};e.exports=r,e.exports.once=function(t,e){return new Promise((function(n,r){function i(n){t.removeListener(e,o),r(n)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",i),n([].slice.call(arguments))}g(t,e,o,{once:!0}),"error"!==e&&p(t,i,{once:!0})}))},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var w=10;Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return w},set:function(t){if("number"!=typeof t||0>t||b(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");w=t}}),r.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(t){if("number"!=typeof t||0>t||b(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},r.prototype.getMaxListeners=function(){return o(this)},r.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(0<e.length&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[t];if(void 0===a)return!1;if("function"==typeof a)y(a,this,e);else{var c=a.length,u=d(a,c);for(n=0;n<c;++n)y(u[n],this,e)}return!0},r.prototype.addListener=function(t,e){return s(this,t,e,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(t,e){return s(this,t,e,!0)},r.prototype.once=function(t,e){return i(e),this.on(t,c(this,t,e)),this},r.prototype.prependOnceListener=function(t,e){return i(e),this.prependListener(t,c(this,t,e)),this},r.prototype.removeListener=function(t,e){var n,r,o,s,a;if(i(e),r=this._events,void 0===r)return this;if(n=r[t],void 0===n)return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,s=n.length-1;0<=s;s--)if(n[s]===e||n[s].listener===e){a=n[s].listener,o=s;break}if(0>o)return this;0===o?n.shift():h(n,o),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,a||e)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(t){var e,n,r;if(n=this._events,void 0===n)return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)i=o[r],"removeListener"!==i&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=n[t],"function"==typeof e)this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;0<=r;r--)this.removeListener(t,e[r]);return this},r.prototype.listeners=function(t){return u(this,t,!0)},r.prototype.rawListeners=function(t){return u(this,t,!1)},r.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):l.call(t,e)},r.prototype.listenerCount=l,r.prototype.eventNames=function(){return 0<this._eventsCount?m(this._events):[]}},{}],8:[function(t,e){e.exports=function(){if("undefined"==typeof globalThis)return null;var t={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return t.RTCPeerConnection?t:null}},{}],9:[function(n,i,o){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
o.read=function(t,e,n,i,o){var s,a,c=8*o-i-1,u=(1<<c)-1,l=u>>1,d=-7,h=n?o-1:0,f=n?-1:1,p=t[e+h];for(h+=f,s=p&(1<<-d)-1,p>>=-d,d+=c;0<d;s=256*s+t[e+h],h+=f,d-=8);for(a=s&(1<<-d)-1,s>>=-d,d+=i;0<d;a=256*a+t[e+h],h+=f,d-=8);if(0===s)s=1-l;else{if(s===u)return a?NaN:1/0*(p?-1:1);a+=r(2,i),s-=l}return(p?-1:1)*a*r(2,s-i)},o.write=function(n,i,o,s,a,c){var u,l,d,h=Math.LN2,f=Math.log,p=8*c-a-1,g=(1<<p)-1,m=g>>1,v=23===a?r(2,-24)-r(2,-77):0,y=s?0:c-1,b=s?1:-1,w=0>i||0===i&&0>1/i?1:0;for(i=e(i),isNaN(i)||i===1/0?(l=isNaN(i)?1:0,u=g):(u=t(f(i)/h),1>i*(d=r(2,-u))&&(u--,d*=2),i+=1<=u+m?v/d:v*r(2,1-m),2<=i*d&&(u++,d/=2),u+m>=g?(l=0,u=g):1<=u+m?(l=(i*d-1)*r(2,a),u+=m):(l=i*r(2,m-1)*r(2,a),u=0));8<=a;n[o+y]=255&l,y+=b,l/=256,a-=8);for(u=u<<a|l,p+=a;0<p;n[o+y]=255&u,y+=b,u/=256,p-=8);n[o+y-b]|=128*w}},{}],10:[function(t,e){e.exports="function"==typeof Object.create?function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},{}],11:[function(t,n){var r=Math.round;function i(t){if(t+="",!(100<t.length)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();return"years"===r||"year"===r||"yrs"===r||"yr"===r||"y"===r?315576e5*n:"weeks"===r||"week"===r||"w"===r?6048e5*n:"days"===r||"day"===r||"d"===r?864e5*n:"hours"===r||"hour"===r||"hrs"===r||"hr"===r||"h"===r?36e5*n:"minutes"===r||"minute"===r||"mins"===r||"min"===r||"m"===r?6e4*n:"seconds"===r||"second"===r||"secs"===r||"sec"===r||"s"===r?1e3*n:"milliseconds"===r||"millisecond"===r||"msecs"===r||"msec"===r||"ms"===r?n:void 0}}}function o(t){var n=e(t);return 864e5<=n?r(t/864e5)+"d":36e5<=n?r(t/36e5)+"h":6e4<=n?r(t/6e4)+"m":1e3<=n?r(t/1e3)+"s":t+"ms"}function s(t){var n=e(t);return 864e5<=n?a(t,n,864e5,"day"):36e5<=n?a(t,n,36e5,"hour"):6e4<=n?a(t,n,6e4,"minute"):1e3<=n?a(t,n,1e3,"second"):t+" ms"}function a(t,e,n,i){return r(t/n)+" "+i+(e>=1.5*n?"s":"")}n.exports=function(t,e){e=e||{};var n=typeof t;if("string"==n&&0<t.length)return i(t);if("number"===n&&isFinite(t))return e.long?s(t):o(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},{}],12:[function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(t){if(l===setTimeout)return setTimeout(t,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(n){try{return l.call(null,t,0)}catch(n){return l.call(this,t,0)}}}function o(t){if(d===clearTimeout)return clearTimeout(t);if((d===r||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(t);try{return d(t)}catch(n){try{return d.call(null,t)}catch(n){return d.call(this,t)}}}function s(){g&&f&&(g=!1,f.length?p=f.concat(p):m=-1,p.length&&a())}function a(){if(!g){var t=i(s);g=!0;for(var e=p.length;e;){for(f=p,p=[];++m<e;)f&&f[m].run();m=-1,e=p.length}f=null,g=!1,o(t)}}function c(t,e){this.fun=t,this.array=e}function u(){}var l,d,h=e.exports={};(function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{d="function"==typeof clearTimeout?clearTimeout:r}catch(e){d=r}})();var f,p=[],g=!1,m=-1;h.nextTick=function(t){var e=Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new c(t,e)),1!==p.length||g||i(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.prependListener=u,h.prependOnceListener=u,h.listeners=function(){return[]},h.binding=function(){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],13:[function(t,e){(function(t){(function(){
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
let n;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"==typeof window?t:window):t=>(n||(n=Promise.resolve())).then(t).catch((t=>setTimeout((()=>{throw t}),0)))}).call(this)}).call(this,"undefined"==typeof n.g?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:n.g)},{}],14:[function(t,e){(function(n,r){(function(){"use strict";var i=t("safe-buffer").Buffer,o=r.crypto||r.msCrypto;e.exports=o&&o.getRandomValues?function(t,e){if(t>4294967295)throw new RangeError("requested too many random bytes");var r=i.allocUnsafe(t);if(0<t)if(65536<t)for(var s=0;s<t;s+=65536)o.getRandomValues(r.slice(s,s+65536));else o.getRandomValues(r);return"function"==typeof e?n.nextTick((function(){e(null,r)})):r}:function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this)}).call(this,t("_process"),"undefined"==typeof n.g?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:n.g)},{_process:12,"safe-buffer":30}],15:[function(t,e){"use strict";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function r(t,e,r){function i(t,n,r){return"string"==typeof e?e:e(t,n,r)}r||(r=Error);var o=function(t){function e(e,n,r){return t.call(this,i(e,n,r))||this}return n(e,t),e}(r);o.prototype.name=r.name,o.prototype.code=t,c[t]=o}function i(t,e){if(Array.isArray(t)){var n=t.length;return t=t.map((function(t){return t+""})),2<n?"one of ".concat(e," ").concat(t.slice(0,n-1).join(", "),", or ")+t[n-1]:2===n?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}return"of ".concat(e," ").concat(t+"")}function o(t,e,n){return t.substr(!n||0>n?0:+n,e.length)===e}function s(t,e,n){return(void 0===n||n>t.length)&&(n=t.length),t.substring(n-e.length,n)===e}function a(t,e,n){return"number"!=typeof n&&(n=0),!(n+e.length>t.length)&&-1!==t.indexOf(e,n)}var c={};r("ERR_INVALID_OPT_VALUE",(function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'}),TypeError),r("ERR_INVALID_ARG_TYPE",(function(t,e,n){var r,c;if("string"==typeof e&&o(e,"not ")?(r="must not be",e=e.replace(/^not /,"")):r="must be",s(t," argument"))c="The ".concat(t," ").concat(r," ").concat(i(e,"type"));else{var u=a(t,".")?"property":"argument";c='The "'.concat(t,'" ').concat(u," ").concat(r," ").concat(i(e,"type"))}return c+=". Received type ".concat(typeof n),c}),TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",(function(t){return"The "+t+" method is not implemented"})),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",(function(t){return"Cannot call "+t+" after a stream was destroyed"})),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",(function(t){return"Unknown encoding: "+t}),TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=c},{}],16:[function(t,e){(function(n){(function(){"use strict";function r(t){return this instanceof r?(a.call(this,t),c.call(this,t),this.allowHalfOpen=!0,void(t&&(!1===t.readable&&(this.readable=!1),!1===t.writable&&(this.writable=!1),!1===t.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",i))))):new r(t)}function i(){this._writableState.ended||n.nextTick(o,this)}function o(t){t.end()}var s=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};e.exports=r;var a=t("./_stream_readable"),c=t("./_stream_writable");t("inherits")(r,a);for(var u,l=s(c.prototype),d=0;d<l.length;d++)u=l[d],r.prototype[u]||(r.prototype[u]=c.prototype[u]);Object.defineProperty(r.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(r.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(r.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(r.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=t,this._writableState.destroyed=t)}})}).call(this)}).call(this,t("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(t,e){"use strict";function n(t){return this instanceof n?void r.call(this,t):new n(t)}e.exports=n;var r=t("./_stream_transform");t("inherits")(n,r),n.prototype._transform=function(t,e,n){n(null,t)}},{"./_stream_transform":19,inherits:10}],18:[function(t,e){(function(n,r){(function(){"use strict";function i(t){return N.from(t)}function o(t){return N.isBuffer(t)||t instanceof P}function s(t,e,n){return"function"==typeof t.prependListener?t.prependListener(e,n):void(t._events&&t._events[e]?Array.isArray(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n))}function a(e,n,r){A=A||t("./_stream_duplex"),e=e||{},"boolean"!=typeof r&&(r=n instanceof A),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=H(this,e,"readableHighWaterMark",r),this.buffer=new j,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(!F&&(F=t("string_decoder/").StringDecoder),this.decoder=new F(e.encoding),this.encoding=e.encoding)}function c(e){if(A=A||t("./_stream_duplex"),!(this instanceof c))return new c(e);var n=this instanceof A;this._readableState=new a(e,this,n),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),R.call(this)}function u(t,e,n,r,o){M("readableAddChunk",e);var s,a=t._readableState;if(null===e)a.reading=!1,p(t,a);else if(o||(s=d(a,e)),s)K(t,s);else if(a.objectMode||e&&0<e.length)if("string"==typeof e||a.objectMode||Object.getPrototypeOf(e)===N.prototype||(e=i(e)),r)a.endEmitted?K(t,new G):l(t,a,e,!0);else if(a.ended)K(t,new U);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!n?(e=a.decoder.write(e),a.objectMode||0!==e.length?l(t,a,e,!1):v(t,a)):l(t,a,e,!1)}else r||(a.reading=!1,v(t,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function l(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(e.awaitDrain=0,t.emit("data",n)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&g(t)),v(t,e)}function d(t,e){var n;return o(e)||"string"==typeof e||void 0===e||t.objectMode||(n=new W("chunk",["string","Buffer","Uint8Array"],e)),n}function h(t){return 1073741824<=t?t=1073741824:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function f(t,e){return 0>=t||0===e.length&&e.ended?0:e.objectMode?1:t===t?(t>e.highWaterMark&&(e.highWaterMark=h(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0)):e.flowing&&e.length?e.buffer.head.data.length:e.length}function p(t,e){if(M("onEofChunk"),!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,e.sync?g(t):(e.needReadable=!1,!e.emittedReadable&&(e.emittedReadable=!0,m(t)))}}function g(t){var e=t._readableState;M("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(M("emitReadable",e.flowing),e.emittedReadable=!0,n.nextTick(m,t))}function m(t){var e=t._readableState;M("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,k(t)}function v(t,e){e.readingMore||(e.readingMore=!0,n.nextTick(y,t,e))}function y(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length);){var n=e.length;if(M("maybeReadMore read 0"),t.read(0),n===e.length)break}e.readingMore=!1}function b(t){return function(){var e=t._readableState;M("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&T(t,"data")&&(e.flowing=!0,k(t))}}function w(t){var e=t._readableState;e.readableListening=0<t.listenerCount("readable"),e.resumeScheduled&&!e.paused?e.flowing=!0:0<t.listenerCount("data")&&t.resume()}function E(t){M("readable nexttick read 0"),t.read(0)}function S(t,e){e.resumeScheduled||(e.resumeScheduled=!0,n.nextTick(D,t,e))}function D(t,e){M("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),k(t),e.flowing&&!e.reading&&t.read(0)}function k(t){var e=t._readableState;for(M("flow",e.flowing);e.flowing&&null!==t.read(););}function x(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):n=e.buffer.consume(t,e.decoder),n);var n}function C(t){var e=t._readableState;M("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,n.nextTick(_,e,t))}function _(t,e){if(M("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&0===t.length&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var n=e._writableState;(!n||n.autoDestroy&&n.finished)&&e.destroy()}}function O(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}var A;e.exports=c,c.ReadableState=a;t("events").EventEmitter;var M,T=function(t,e){return t.listeners(e).length},R=t("./internal/streams/stream"),N=t("buffer").Buffer,P=r.Uint8Array||function(){},B=t("util");M=B&&B.debuglog?B.debuglog("stream"):function(){};var F,I,z,j=t("./internal/streams/buffer_list"),L=t("./internal/streams/destroy"),$=t("./internal/streams/state"),H=$.getHighWaterMark,V=t("../errors").codes,W=V.ERR_INVALID_ARG_TYPE,U=V.ERR_STREAM_PUSH_AFTER_EOF,q=V.ERR_METHOD_NOT_IMPLEMENTED,G=V.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;t("inherits")(c,R);var K=L.errorOrDestroy,Y=["error","close","destroy","pause","resume"];Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),c.prototype.destroy=L.destroy,c.prototype._undestroy=L.undestroy,c.prototype._destroy=function(t,e){e(t)},c.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=N.from(t,e),e=""),n=!0),u(this,t,e,!1,n)},c.prototype.unshift=function(t){return u(this,t,null,!0,!1)},c.prototype.isPaused=function(){return!1===this._readableState.flowing},c.prototype.setEncoding=function(e){F||(F=t("string_decoder/").StringDecoder);var n=new F(e);this._readableState.decoder=n,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=n.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this},c.prototype.read=function(t){M("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&((0===e.highWaterMark?0<e.length:e.length>=e.highWaterMark)||e.ended))return M("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?C(this):g(this),null;if(t=f(t,e),0===t&&e.ended)return 0===e.length&&C(this),null;var r,i=e.needReadable;return M("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&(i=!0,M("length less than watermark",i)),e.ended||e.reading?(i=!1,M("reading or ended",i)):i&&(M("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,!e.reading&&(t=f(n,e))),r=0<t?x(t,e):null,null===r?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),0===e.length&&(!e.ended&&(e.needReadable=!0),n!==t&&e.ended&&C(this)),null!==r&&this.emit("data",r),r},c.prototype._read=function(){K(this,new q("_read()"))},c.prototype.pipe=function(t,e){function r(t,e){M("onunpipe"),t===h&&e&&!1===e.hasUnpiped&&(e.hasUnpiped=!0,o())}function i(){M("onend"),t.end()}function o(){M("cleanup"),t.removeListener("close",u),t.removeListener("finish",l),t.removeListener("drain",m),t.removeListener("error",c),t.removeListener("unpipe",r),h.removeListener("end",i),h.removeListener("end",d),h.removeListener("data",a),v=!0,f.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&m()}function a(e){M("ondata");var n=t.write(e);M("dest.write",n),!1===n&&((1===f.pipesCount&&f.pipes===t||1<f.pipesCount&&-1!==O(f.pipes,t))&&!v&&(M("false write response, pause",f.awaitDrain),f.awaitDrain++),h.pause())}function c(e){M("onerror",e),d(),t.removeListener("error",c),0===T(t,"error")&&K(t,e)}function u(){t.removeListener("finish",l),d()}function l(){M("onfinish"),t.removeListener("close",u),d()}function d(){M("unpipe"),h.unpipe(t)}var h=this,f=this._readableState;switch(f.pipesCount){case 0:f.pipes=t;break;case 1:f.pipes=[f.pipes,t];break;default:f.pipes.push(t)}f.pipesCount+=1,M("pipe count=%d opts=%j",f.pipesCount,e);var p=(!e||!1!==e.end)&&t!==n.stdout&&t!==n.stderr,g=p?i:d;f.endEmitted?n.nextTick(g):h.once("end",g),t.on("unpipe",r);var m=b(h);t.on("drain",m);var v=!1;return h.on("data",a),s(t,"error",c),t.once("close",u),t.once("finish",l),t.emit("pipe",h),f.flowing||(M("pipe resume"),h.resume()),t},c.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=O(e.pipes,t);return-1===s||(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},c.prototype.on=function(t,e){var r=R.prototype.on.call(this,t,e),i=this._readableState;return"data"===t?(i.readableListening=0<this.listenerCount("readable"),!1!==i.flowing&&this.resume()):"readable"==t&&!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,M("on readable",i.length,i.reading),i.length?g(this):!i.reading&&n.nextTick(E,this)),r},c.prototype.addListener=c.prototype.on,c.prototype.removeListener=function(t,e){var r=R.prototype.removeListener.call(this,t,e);return"readable"===t&&n.nextTick(w,this),r},c.prototype.removeAllListeners=function(t){var e=R.prototype.removeAllListeners.apply(this,arguments);return("readable"===t||void 0===t)&&n.nextTick(w,this),e},c.prototype.resume=function(){var t=this._readableState;return t.flowing||(M("resume"),t.flowing=!t.readableListening,S(this,t)),t.paused=!1,this},c.prototype.pause=function(){return M("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(M("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},c.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",(function(){if(M("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(i){if(M("wrapped data"),n.decoder&&(i=n.decoder.write(i)),(!n.objectMode||null!==i&&void 0!==i)&&(n.objectMode||i&&i.length)){var o=e.push(i);o||(r=!0,t.pause())}})),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<Y.length;o++)t.on(Y[o],this.emit.bind(this,Y[o]));return this._read=function(e){M("wrapped _read",e),r&&(r=!1,t.resume())},this},"function"==typeof Symbol&&(c.prototype[Symbol.asyncIterator]=function(){return void 0===I&&(I=t("./internal/streams/async_iterator")),I(this)}),Object.defineProperty(c.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(c.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(c.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),c._fromList=x,Object.defineProperty(c.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(c.from=function(e,n){return void 0===z&&(z=t("./internal/streams/from")),z(c,e,n)})}).call(this)}).call(this,t("_process"),"undefined"==typeof n.g?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:n.g)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(t,e){"use strict";function n(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new c);n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function r(t){return this instanceof r?(d.call(this,t),this._transformState={afterTransform:n.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),void this.on("prefinish",i)):new r(t)}function i(){var t=this;"function"!=typeof this._flush||this._readableState.destroyed?o(this,null,null):this._flush((function(e,n){o(t,e,n)}))}function o(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new l;if(t._transformState.transforming)throw new u;return t.push(null)}e.exports=r;var s=t("../errors").codes,a=s.ERR_METHOD_NOT_IMPLEMENTED,c=s.ERR_MULTIPLE_CALLBACK,u=s.ERR_TRANSFORM_ALREADY_TRANSFORMING,l=s.ERR_TRANSFORM_WITH_LENGTH_0,d=t("./_stream_duplex");t("inherits")(r,d),r.prototype.push=function(t,e){return this._transformState.needTransform=!1,d.prototype.push.call(this,t,e)},r.prototype._transform=function(t,e,n){n(new a("_transform()"))},r.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},r.prototype._read=function(){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},r.prototype._destroy=function(t,e){d.prototype._destroy.call(this,t,(function(t){e(t)}))}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(t,e){(function(n,r){(function(){"use strict";function i(t){var e=this;this.next=null,this.entry=null,this.finish=function(){C(e,t)}}function o(t){return T.from(t)}function s(t){return T.isBuffer(t)||t instanceof R}function a(){}function c(e,n,r){_=_||t("./_stream_duplex"),e=e||{},"boolean"!=typeof r&&(r=n instanceof _),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=B(this,e,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){v(n,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function u(e){_=_||t("./_stream_duplex");var n=this instanceof _;return n||O.call(u,this)?(this._writableState=new c(e,this,n),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),void M.call(this)):new u(e)}function l(t,e){var r=new V;U(t,r),n.nextTick(e,r)}function d(t,e,r,i){var o;return null===r?o=new H:"string"!=typeof r&&!e.objectMode&&(o=new I("chunk",["string","Buffer"],r)),!o||(U(t,o),n.nextTick(i,o),!1)}function h(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=T.from(e,n)),e}function f(t,e,n,r,i,o){if(!n){var s=h(e,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else p(t,e,!1,a,r,i,o);return c}function p(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new $("write")):n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function g(t,e,r,i,o){--e.pendingcb,r?(n.nextTick(o,i),n.nextTick(k,t,e),t._writableState.errorEmitted=!0,U(t,i)):(o(i),t._writableState.errorEmitted=!0,U(t,i),k(t,e))}function m(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function v(t,e){var r=t._writableState,i=r.sync,o=r.writecb;if("function"!=typeof o)throw new j;if(m(r),e)g(t,r,i,e,o);else{var s=E(r)||t.destroyed;s||r.corked||r.bufferProcessing||!r.bufferedRequest||w(t,r),i?n.nextTick(y,t,r,s,o):y(t,r,s,o)}}function y(t,e,n,r){n||b(t,e),e.pendingcb--,r(),k(t,e)}function b(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function w(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,o=Array(r),s=e.corkedRequestsFree;s.entry=n;for(var a=0,c=!0;n;)o[a]=n,n.isBuf||(c=!1),n=n.next,a+=1;o.allBuffers=c,p(t,e,!0,e.length,o,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new i(e),e.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,l=n.encoding,d=n.callback,h=e.objectMode?1:u.length;if(p(t,e,!1,h,u,l,d),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function E(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function S(t,e){t._final((function(n){e.pendingcb--,n&&U(t,n),e.prefinished=!0,t.emit("prefinish"),k(t,e)}))}function D(t,e){e.prefinished||e.finalCalled||("function"!=typeof t._final||e.destroyed?(e.prefinished=!0,t.emit("prefinish")):(e.pendingcb++,e.finalCalled=!0,n.nextTick(S,t,e)))}function k(t,e){var n=E(e);if(n&&(D(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var r=t._readableState;(!r||r.autoDestroy&&r.endEmitted)&&t.destroy()}return n}function x(t,e,r){e.ending=!0,k(t,e),r&&(e.finished?n.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function C(t,e,n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree.next=t}var _;e.exports=u,u.WritableState=c;var O,A={deprecate:t("util-deprecate")},M=t("./internal/streams/stream"),T=t("buffer").Buffer,R=r.Uint8Array||function(){},N=t("./internal/streams/destroy"),P=t("./internal/streams/state"),B=P.getHighWaterMark,F=t("../errors").codes,I=F.ERR_INVALID_ARG_TYPE,z=F.ERR_METHOD_NOT_IMPLEMENTED,j=F.ERR_MULTIPLE_CALLBACK,L=F.ERR_STREAM_CANNOT_PIPE,$=F.ERR_STREAM_DESTROYED,H=F.ERR_STREAM_NULL_VALUES,V=F.ERR_STREAM_WRITE_AFTER_END,W=F.ERR_UNKNOWN_ENCODING,U=N.errorOrDestroy;t("inherits")(u,M),c.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(c.prototype,"buffer",{get:A.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(O=Function.prototype[Symbol.hasInstance],Object.defineProperty(u,Symbol.hasInstance,{value:function(t){return!!O.call(this,t)||!(this!==u)&&t&&t._writableState instanceof c}})):O=function(t){return t instanceof this},u.prototype.pipe=function(){U(this,new L)},u.prototype.write=function(t,e,n){var r=this._writableState,i=!1,c=!r.objectMode&&s(t);return c&&!T.isBuffer(t)&&(t=o(t)),"function"==typeof e&&(n=e,e=null),c?e="buffer":!e&&(e=r.defaultEncoding),"function"!=typeof n&&(n=a),r.ending?l(this,n):(c||d(this,r,t,n))&&(r.pendingcb++,i=f(this,r,c,t,e,n)),i},u.prototype.cork=function(){this._writableState.corked++},u.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&w(this,t))},u.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())))throw new W(t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),u.prototype._write=function(t,e,n){n(new z("_write()"))},u.prototype._writev=null,u.prototype.end=function(t,e,n){var r=this._writableState;return"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!==t&&void 0!==t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||x(this,r,n),this},Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),u.prototype.destroy=N.destroy,u.prototype._undestroy=N.undestroy,u.prototype._destroy=function(t,e){e(t)}}).call(this)}).call(this,t("_process"),"undefined"==typeof n.g?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:n.g)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(t,e){(function(n){(function(){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){return{value:t,done:e}}function o(t){var e=t[l];if(null!==e){var n=t[m].read();null!==n&&(t[p]=null,t[l]=null,t[d]=null,e(i(n,!1)))}}function s(t){n.nextTick(o,t)}function a(t,e){return function(n,r){t.then((function(){return e[f]?void n(i(void 0,!0)):void e[g](n,r)}),r)}}var c,u=t("./end-of-stream"),l=Symbol("lastResolve"),d=Symbol("lastReject"),h=Symbol("error"),f=Symbol("ended"),p=Symbol("lastPromise"),g=Symbol("handlePromise"),m=Symbol("stream"),v=Object.getPrototypeOf((function(){})),y=Object.setPrototypeOf((c={get stream(){return this[m]},next:function(){var t=this,e=this[h];if(null!==e)return Promise.reject(e);if(this[f])return Promise.resolve(i(void 0,!0));if(this[m].destroyed)return new Promise((function(e,r){n.nextTick((function(){t[h]?r(t[h]):e(i(void 0,!0))}))}));var r,o=this[p];if(o)r=new Promise(a(o,this));else{var s=this[m].read();if(null!==s)return Promise.resolve(i(s,!1));r=new Promise(this[g])}return this[p]=r,r}},r(c,Symbol.asyncIterator,(function(){return this})),r(c,"return",(function(){var t=this;return new Promise((function(e,n){t[m].destroy(null,(function(t){return t?void n(t):void e(i(void 0,!0))}))}))})),c),v);e.exports=function(t){var e,n=Object.create(y,(e={},r(e,m,{value:t,writable:!0}),r(e,l,{value:null,writable:!0}),r(e,d,{value:null,writable:!0}),r(e,h,{value:null,writable:!0}),r(e,f,{value:t._readableState.endEmitted,writable:!0}),r(e,g,{value:function(t,e){var r=n[m].read();r?(n[p]=null,n[l]=null,n[d]=null,t(i(r,!1))):(n[l]=t,n[d]=e)},writable:!0}),e));return n[p]=null,u(t,(function(t){if(t&&"ERR_STREAM_PREMATURE_CLOSE"!==t.code){var e=n[d];return null!==e&&(n[p]=null,n[l]=null,n[d]=null,e(t)),void(n[h]=t)}var r=n[l];null!==r&&(n[p]=null,n[l]=null,n[d]=null,r(i(void 0,!0))),n[f]=!0})),t.on("readable",s.bind(null,n)),n}}).call(this)}).call(this,t("_process"))},{"./end-of-stream":24,_process:12}],22:[function(t,e){"use strict";function n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function r(t){for(var e,r=1;r<arguments.length;r++)e=null==arguments[r]?{}:arguments[r],r%2?n(Object(e),!0).forEach((function(n){i(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):n(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}));return t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n,r=0;r<e.length;r++)n=e[r],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}function a(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}function c(t,e,n){l.prototype.copy.call(t,e,n)}var u=t("buffer"),l=u.Buffer,d=t("util"),h=d.inspect,f=h&&h.custom||"inspect";e.exports=function(){function t(){o(this,t),this.head=null,this.tail=null,this.length=0}return a(t,[{key:"push",value:function(t){var e={data:t,next:null};0<this.length?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){if(0!==this.length){var t=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n}},{key:"concat",value:function(t){if(0===this.length)return l.alloc(0);for(var e=l.allocUnsafe(t>>>0),n=this.head,r=0;n;)c(n.data,e,r),r+=n.data.length,n=n.next;return e}},{key:"consume",value:function(t,e){var n;return t<this.head.data.length?(n=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):n=t===this.head.data.length?this.shift():e?this._getString(t):this._getBuffer(t),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var e=this.head,n=1,r=e.data;for(t-=r.length;e=e.next;){var i=e.data,o=t>i.length?i.length:t;if(r+=o===i.length?i:i.slice(0,t),t-=o,0===t){o===i.length?(++n,this.head=e.next?e.next:this.tail=null):(this.head=e,e.data=i.slice(o));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(t){var e=l.allocUnsafe(t),n=this.head,r=1;for(n.data.copy(e),t-=n.data.length;n=n.next;){var i=n.data,o=t>i.length?i.length:t;if(i.copy(e,e.length-t,0,o),t-=o,0===t){o===i.length?(++r,this.head=n.next?n.next:this.tail=null):(this.head=n,n.data=i.slice(o));break}++r}return this.length-=r,e}},{key:f,value:function(t,e){return h(this,r({},e,{depth:0,customInspect:!1}))}}]),t}()},{buffer:3,util:2}],23:[function(t,e){(function(t){(function(){"use strict";function n(t,e){i(t,e),r(t)}function r(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function i(t,e){t.emit("error",e)}e.exports={destroy:function(e,o){var s=this,a=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return a||c?(o?o(e):e&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,t.nextTick(i,this,e)):t.nextTick(i,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!o&&e?s._writableState?s._writableState.errorEmitted?t.nextTick(r,s):(s._writableState.errorEmitted=!0,t.nextTick(n,s,e)):t.nextTick(n,s,e):o?(t.nextTick(r,s),o(e)):t.nextTick(r,s)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(t,e){var n=t._readableState,r=t._writableState;n&&n.autoDestroy||r&&r.autoDestroy?t.destroy(e):t.emit("error",e)}}}).call(this)}).call(this,t("_process"))},{_process:12}],24:[function(t,e){"use strict";function n(t){var e=!1;return function(){if(!e){e=!0;for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];t.apply(this,r)}}}function r(){}function i(t){return t.setHeader&&"function"==typeof t.abort}function o(t,e,a){if("function"==typeof e)return o(t,null,e);e||(e={}),a=n(a||r);var c=e.readable||!1!==e.readable&&t.readable,u=e.writable||!1!==e.writable&&t.writable,l=function(){t.writable||h()},d=t._writableState&&t._writableState.finished,h=function(){u=!1,d=!0,c||a.call(t)},f=t._readableState&&t._readableState.endEmitted,p=function(){c=!1,f=!0,u||a.call(t)},g=function(e){a.call(t,e)},m=function(){var e;return c&&!f?(t._readableState&&t._readableState.ended||(e=new s),a.call(t,e)):u&&!d?(t._writableState&&t._writableState.ended||(e=new s),a.call(t,e)):void 0},v=function(){t.req.on("finish",h)};return i(t)?(t.on("complete",h),t.on("abort",m),t.req?v():t.on("request",v)):u&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",p),t.on("finish",h),!1!==e.error&&t.on("error",g),t.on("close",m),function(){t.removeListener("complete",h),t.removeListener("abort",m),t.removeListener("request",v),t.req&&t.req.removeListener("finish",h),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",h),t.removeListener("end",p),t.removeListener("error",g),t.removeListener("close",m)}}var s=t("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;e.exports=o},{"../../../errors":15}],25:[function(t,e){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(t,e){"use strict";function n(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}function r(t){if(t)throw t}function i(t){return t.setHeader&&"function"==typeof t.abort}function o(e,r,o,s){s=n(s);var a=!1;e.on("close",(function(){a=!0})),void 0===u&&(u=t("./end-of-stream")),u(e,{readable:r,writable:o},(function(t){return t?s(t):(a=!0,void s())}));var c=!1;return function(t){if(!a)return c?void 0:(c=!0,i(e)?e.abort():"function"==typeof e.destroy?e.destroy():void s(t||new h("pipe")))}}function s(t){t()}function a(t,e){return t.pipe(e)}function c(t){return t.length&&"function"==typeof t[t.length-1]?t.pop():r}var u,l=t("../../../errors").codes,d=l.ERR_MISSING_ARGS,h=l.ERR_STREAM_DESTROYED;e.exports=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=c(e);if(Array.isArray(e[0])&&(e=e[0]),2>e.length)throw new d("streams");var i,u=e.map((function(t,n){var a=n<e.length-1;return o(t,a,0<n,(function(t){i||(i=t),t&&u.forEach(s),a||(u.forEach(s),r(i))}))}));return e.reduce(a)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(e,n){"use strict";function r(t,e,n){return null==t.highWaterMark?e?t[n]:null:t.highWaterMark}var i=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;n.exports={getHighWaterMark:function(e,n,o,s){var a=r(n,s,o);if(null!=a){if(!isFinite(a)||t(a)!==a||0>a){var c=s?o:"highWaterMark";throw new i(c,a)}return t(a)}return e.objectMode?16:16384}}},{"../../../errors":15}],28:[function(t,e){e.exports=t("events").EventEmitter},{events:7}],29:[function(t,e,n){n=e.exports=t("./lib/_stream_readable.js"),n.Stream=n,n.Readable=n,n.Writable=t("./lib/_stream_writable.js"),n.Duplex=t("./lib/_stream_duplex.js"),n.Transform=t("./lib/_stream_transform.js"),n.PassThrough=t("./lib/_stream_passthrough.js"),n.finished=t("./lib/internal/streams/end-of-stream.js"),n.pipeline=t("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(t,e,n){function r(t,e){for(var n in t)e[n]=t[n]}function i(t,e,n){return s(t,e,n)}
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var o=t("buffer"),s=o.Buffer;s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=o:(r(o,n),n.Buffer=i),i.prototype=Object.create(s.prototype),r(s,i),i.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return s(t,e,n)},i.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=s(t);return void 0===e?r.fill(0):"string"==typeof n?r.fill(e,n):r.fill(e),r},i.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return s(t)},i.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return o.SlowBuffer(t)}},{buffer:3}],31:[function(t,e,n){"use strict";function r(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function i(t){var e=r(t);if("string"!=typeof e&&(m.isEncoding===v||!v(t)))throw new Error("Unknown encoding: "+t);return e||t}function o(t){var e;switch(this.encoding=i(t),this.encoding){case"utf16le":this.text=l,this.end=d,e=4;break;case"utf8":this.fillLast=u,e=4;break;case"base64":this.text=h,this.end=f,e=3;break;default:return this.write=p,void(this.end=g)}this.lastNeed=0,this.lastTotal=0,this.lastChar=m.allocUnsafe(e)}function s(t){return 127>=t?0:6==t>>5?2:14==t>>4?3:30==t>>3?4:2==t>>6?-1:-2}function a(t,e,n){var r=e.length-1;if(r<n)return 0;var i=s(e[r]);return 0<=i?(0<i&&(t.lastNeed=i-1),i):--r<n||-2===i?0:(i=s(e[r]),0<=i?(0<i&&(t.lastNeed=i-2),i):--r<n||-2===i?0:(i=s(e[r]),0<=i?(0<i&&(2===i?i=0:t.lastNeed=i-3),i):0))}function c(t,e){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(1<t.lastNeed&&1<e.length){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(2<t.lastNeed&&2<e.length&&128!=(192&e[2]))return t.lastNeed=2,"�"}}function u(t){var e=this.lastTotal-this.lastNeed,n=c(this,t,e);return void 0===n?this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length)):n}function l(t,e){if(0==(t.length-e)%2){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(55296<=r&&56319>=r)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function d(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function h(t,e){var n=(t.length-e)%3;return 0==n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1==n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function f(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function p(t){return t.toString(this.encoding)}function g(t){return t&&t.length?this.write(t):""}var m=t("safe-buffer").Buffer,v=m.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};n.StringDecoder=o,o.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(e=this.fillLast(t),void 0===e)return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},o.prototype.text=function(t,e){var n=a(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},o.prototype.fillLast=function(t){return this.lastNeed<=t.length?(t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),void(this.lastNeed-=t.length))}},{"safe-buffer":30}],32:[function(t,e){(function(t){(function(){function n(e){try{if(!t.localStorage)return!1}catch(t){return!1}var n=t.localStorage[e];return null!=n&&"true"===(n+"").toLowerCase()}e.exports=function(t,e){function r(){if(!i){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),i=!0}return t.apply(this,arguments)}if(n("noDeprecation"))return t;var i=!1;return r}}).call(this)}).call(this,"undefined"==typeof n.g?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:n.g)},{}],"/":[function(t,e){function n(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}function r(t){console.warn(t)}
/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const i=t("debug")("simple-peer"),o=t("get-browser-rtc"),s=t("randombytes"),a=t("readable-stream"),c=t("queue-microtask"),u=t("err-code"),{Buffer:l}=t("buffer"),d=65536;class h extends a.Duplex{constructor(t){if(t=Object.assign({allowHalfOpen:!1},t),super(t),this._id=s(4).toString("hex").slice(0,7),this._debug("new peer %o",t),this.channelName=t.initiator?t.channelName||s(20).toString("hex"):null,this.initiator=t.initiator||!1,this.channelConfig=t.channelConfig||h.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},h.config,t.config),this.offerOptions=t.offerOptions||{},this.answerOptions=t.answerOptions||{},this.sdpTransform=t.sdpTransform||(t=>t),this.streams=t.streams||(t.stream?[t.stream]:[]),this.trickle=void 0===t.trickle||t.trickle,this.allowHalfTrickle=void 0!==t.allowHalfTrickle&&t.allowHalfTrickle,this.iceCompleteTimeout=t.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=t.wrtc&&"object"==typeof t.wrtc?t.wrtc:o(),!this._wrtc)throw"undefined"==typeof window?u(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):u(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(t){return void this.destroy(u(t,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc="number"==typeof this._pc._peerConnectionId,this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=t=>{this._onIceCandidate(t)},"object"==typeof this._pc.peerIdentity&&this._pc.peerIdentity.catch((t=>{this.destroy(u(t,"ERR_PC_PEER_IDENTITY"))})),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=t=>{this._setupData(t)},this.streams&&this.streams.forEach((t=>{this.addStream(t)})),this._pc.ontrack=t=>{this._onTrack(t)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&"open"===this._channel.readyState}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(t){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if("string"==typeof t)try{t=JSON.parse(t)}catch(e){t={}}this._debug("signal()"),t.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),t.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(t.transceiverRequest.kind,t.transceiverRequest.init)),t.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(t.candidate):this._pendingCandidates.push(t.candidate)),t.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(t)).then((()=>{this.destroyed||(this._pendingCandidates.forEach((t=>{this._addIceCandidate(t)})),this._pendingCandidates=[],"offer"===this._pc.remoteDescription.type&&this._createAnswer())})).catch((t=>{this.destroy(u(t,"ERR_SET_REMOTE_DESCRIPTION"))})),t.sdp||t.candidate||t.renegotiate||t.transceiverRequest||this.destroy(u(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(t){const e=new this._wrtc.RTCIceCandidate(t);this._pc.addIceCandidate(e).catch((t=>{!e.address||e.address.endsWith(".local")?r("Ignoring unsupported ICE candidate."):this.destroy(u(t,"ERR_ADD_ICE_CANDIDATE"))}))}send(t){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(t)}}addTransceiver(t,e){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(t,e),this._needsNegotiation()}catch(t){this.destroy(u(t,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:t,init:e}})}}addStream(t){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),t.getTracks().forEach((e=>{this.addTrack(e,t)}))}}addTrack(t,e){if(this.destroying)return;if(this.destroyed)throw u(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const n=this._senderMap.get(t)||new Map;let r=n.get(e);if(r)throw r.removed?u(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):u(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED");r=this._pc.addTrack(t,e),n.set(e,r),this._senderMap.set(t,n),this._needsNegotiation()}replaceTrack(t,e,n){if(this.destroying)return;if(this.destroyed)throw u(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const r=this._senderMap.get(t),i=r?r.get(n):null;if(!i)throw u(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");e&&this._senderMap.set(e,r),null==i.replaceTrack?this.destroy(u(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):i.replaceTrack(e)}removeTrack(t,e){if(this.destroying)return;if(this.destroyed)throw u(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const n=this._senderMap.get(t),r=n?n.get(e):null;if(!r)throw u(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{r.removed=!0,this._pc.removeTrack(r)}catch(t){"NS_ERROR_UNEXPECTED"===t.name?this._sendersAwaitingStable.push(r):this.destroy(u(t,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(t){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),t.getTracks().forEach((e=>{this.removeTrack(e,t)}))}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,c((()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1})))}negotiate(){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout((()=>{this._createOffer()}),0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(t){this._destroy(t,(()=>{}))}_destroy(t,e){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",t&&(t.message||t)),c((()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",t&&(t.message||t)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(t){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(t){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,t&&this.emit("error",t),this.emit("close"),e()})))}_setupData(t){if(!t.channel)return this.destroy(u(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=t.channel,this._channel.binaryType="arraybuffer","number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=d),this.channelName=this._channel.label,this._channel.onmessage=t=>{this._onChannelMessage(t)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=t=>{const e=t.error instanceof Error?t.error:new Error(`Datachannel error: ${t.message} ${t.filename}:${t.lineno}:${t.colno}`);this.destroy(u(e,"ERR_DATA_CHANNEL"))};let e=!1;this._closingInterval=setInterval((()=>{this._channel&&"closing"===this._channel.readyState?(e&&this._onChannelClose(),e=!0):e=!1}),5e3)}_read(){}_write(t,e,n){if(this.destroyed)return n(u(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(t)}catch(t){return this.destroy(u(t,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>d?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=n):n(null)}else this._debug("write before connect"),this._chunk=t,this._cb=n}_onFinish(){if(!this.destroyed){const t=()=>{setTimeout((()=>this.destroy()),1e3)};this._connected?t():this.once("connect",t)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout((()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))}),this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then((t=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(t.sdp=n(t.sdp)),t.sdp=this.sdpTransform(t.sdp);const e=()=>{if(!this.destroyed){const e=this._pc.localDescription||t;this._debug("signal"),this.emit("signal",{type:e.type,sdp:e.sdp})}};this._pc.setLocalDescription(t).then((()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?e():this.once("_iceComplete",e))})).catch((t=>{this.destroy(u(t,"ERR_SET_LOCAL_DESCRIPTION"))}))})).catch((t=>{this.destroy(u(t,"ERR_CREATE_OFFER"))}))}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach((t=>{t.mid||!t.sender.track||t.requested||(t.requested=!0,this.addTransceiver(t.sender.track.kind))}))}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then((t=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(t.sdp=n(t.sdp)),t.sdp=this.sdpTransform(t.sdp);const e=()=>{if(!this.destroyed){const e=this._pc.localDescription||t;this._debug("signal"),this.emit("signal",{type:e.type,sdp:e.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(t).then((()=>{this.destroyed||(this.trickle||this._iceComplete?e():this.once("_iceComplete",e))})).catch((t=>{this.destroy(u(t,"ERR_SET_LOCAL_DESCRIPTION"))}))})).catch((t=>{this.destroy(u(t,"ERR_CREATE_ANSWER"))}))}_onConnectionStateChange(){this.destroyed||"failed"===this._pc.connectionState&&this.destroy(u(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const t=this._pc.iceConnectionState,e=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",t,e),this.emit("iceStateChange",t,e),("connected"===t||"completed"===t)&&(this._pcReady=!0,this._maybeReady()),"failed"===t&&this.destroy(u(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),"closed"===t&&this.destroy(u(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(t){const e=t=>("[object Array]"===Object.prototype.toString.call(t.values)&&t.values.forEach((e=>{Object.assign(t,e)})),t);0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then((n=>{const r=[];n.forEach((t=>{r.push(e(t))})),t(null,r)}),(e=>t(e))):0<this._pc.getStats.length?this._pc.getStats((n=>{if(this.destroyed)return;const r=[];n.result().forEach((t=>{const n={};t.names().forEach((e=>{n[e]=t.stat(e)})),n.id=t.id,n.type=t.type,n.timestamp=t.timestamp,r.push(e(n))})),t(null,r)}),(e=>t(e))):t(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const t=()=>{this.destroyed||this.getStats(((e,n)=>{if(this.destroyed)return;e&&(n=[]);const r={},i={},o={};let s=!1;n.forEach((t=>{("remotecandidate"===t.type||"remote-candidate"===t.type)&&(r[t.id]=t),("localcandidate"===t.type||"local-candidate"===t.type)&&(i[t.id]=t),("candidatepair"===t.type||"candidate-pair"===t.type)&&(o[t.id]=t)}));const a=t=>{s=!0;let e=i[t.localCandidateId];e&&(e.ip||e.address)?(this.localAddress=e.ip||e.address,this.localPort=+e.port):e&&e.ipAddress?(this.localAddress=e.ipAddress,this.localPort=+e.portNumber):"string"==typeof t.googLocalAddress&&(e=t.googLocalAddress.split(":"),this.localAddress=e[0],this.localPort=+e[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let n=r[t.remoteCandidateId];n&&(n.ip||n.address)?(this.remoteAddress=n.ip||n.address,this.remotePort=+n.port):n&&n.ipAddress?(this.remoteAddress=n.ipAddress,this.remotePort=+n.portNumber):"string"==typeof t.googRemoteAddress&&(n=t.googRemoteAddress.split(":"),this.remoteAddress=n[0],this.remotePort=+n[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(n.forEach((t=>{"transport"===t.type&&t.selectedCandidatePairId&&a(o[t.selectedCandidatePairId]),("googCandidatePair"===t.type&&"true"===t.googActiveConnection||("candidatepair"===t.type||"candidate-pair"===t.type)&&t.selected)&&a(t)})),s||Object.keys(o).length&&!Object.keys(i).length){if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(t){return this.destroy(u(t,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const e=this._cb;this._cb=null,e(null)}"number"!=typeof this._channel.bufferedAmountLowThreshold&&(this._interval=setInterval((()=>this._onInterval()),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}else setTimeout(t,100)}))};t()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>d)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||("stable"===this._pc.signalingState&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach((t=>{this._pc.removeTrack(t),this._queuedNegotiation=!0})),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(t){this.destroyed||(t.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:t.candidate.candidate,sdpMLineIndex:t.candidate.sdpMLineIndex,sdpMid:t.candidate.sdpMid}}):!t.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),t.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(t){if(this.destroyed)return;let e=t.data;e instanceof ArrayBuffer&&(e=l.from(e)),this.push(e)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const t=this._cb;this._cb=null,t(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(t){this.destroyed||t.streams.forEach((e=>{this._debug("on track"),this.emit("track",t.track,e),this._remoteTracks.push({track:t.track,stream:e}),this._remoteStreams.some((t=>t.id===e.id))||(this._remoteStreams.push(e),c((()=>{this._debug("on stream"),this.emit("stream",e)})))}))}_debug(){const t=[].slice.call(arguments);t[0]="["+this._id+"] "+t[0],i.apply(null,t)}}h.WEBRTC_SUPPORT=!!o(),h.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},h.channelConfig={},e.exports=h},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")}))},7994:function(t,e,n){"use strict";function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=n(6294),a=n(248),c=function(){try{var t=n(1538);return"function"===typeof t?t:RegExp}catch(e){return RegExp}}(),u=s.v4().source,l=s.v6().source;t.exports=function(t){t=i({exact:!1,strict:!1,auth:!1,localhost:!0,parens:!1,apostrophes:!1,trailingPeriod:!1,ipv4:!0,ipv6:!0,tlds:a,returnString:!1},t);var e="(?:(?:[a-z]+:)?//)".concat(t.strict?"":"?"),n=t.auth?"(?:\\S+(?::\\S*)?@)?":"",r="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",o="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",s="(?:\\.".concat(t.strict?"(?:[a-z\\u00a1-\\uffff]{2,})":"(?:".concat(t.tlds.sort((function(t,e){return e.length-t.length})).join("|"),")"),")").concat(t.trailingPeriod?"\\.?":""),d="(?::\\d{2,5})?",h=t.parens?t.apostrophes?'(?:[/?#][^\\s"]*)?':"(?:[/?#][^\\s\"']*)?":t.apostrophes?'(?:[/?#][^\\s"\\)]*)?':"(?:[/?#][^\\s\"\\)']*)?",f="(?:".concat(e,"|www\\.)").concat(n,"(?:");return t.localhost&&(f+="localhost|"),t.ipv4&&(f+="".concat(u,"|")),t.ipv6&&(f+="".concat(l,"|")),f+="".concat(r).concat(o).concat(s,")").concat(d).concat(h),t.returnString?f:t.exact?new c("(?:^".concat(f,"$)"),"i"):new c(f,"ig")}},8169:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return Qj}});var r={};n.r(r),n.d(r,{BaseTransition:function(){return w.P$},Comment:function(){return w.sv},EffectScope:function(){return w.Bj},Fragment:function(){return w.HY},KeepAlive:function(){return w.Ob},ReactiveEffect:function(){return w.qq},Static:function(){return w.qG},Suspense:function(){return w.n4},Teleport:function(){return w.lR},Text:function(){return w.xv},Transition:function(){return w.uT},TransitionGroup:function(){return w.W3},VueElement:function(){return w.a2},callWithAsyncErrorHandling:function(){return w.$d},callWithErrorHandling:function(){return w.KU},camelize:function(){return w._A},capitalize:function(){return w.kC},cloneVNode:function(){return w.Ho},compatUtils:function(){return w.ry},compile:function(){return Cd},computed:function(){return w.Fl},createApp:function(){return w.ri},createBlock:function(){return w.j4},createCommentVNode:function(){return w.kq},createElementBlock:function(){return w.iD},createElementVNode:function(){return w._},createHydrationRenderer:function(){return w.Eo},createPropsRestProxy:function(){return w.p1},createRenderer:function(){return w.Us},createSSRApp:function(){return w.vr},createSlots:function(){return w.Nv},createStaticVNode:function(){return w.uE},createTextVNode:function(){return w.Uk},createVNode:function(){return w.Wm},customRef:function(){return w.ZM},defineAsyncComponent:function(){return w.RC},defineComponent:function(){return w.aZ},defineCustomElement:function(){return w.MW},defineEmits:function(){return w.Bz},defineExpose:function(){return w.WY},defineProps:function(){return w.yb},defineSSRCustomElement:function(){return w.Ah},devtools:function(){return w.mW},effect:function(){return w.cE},effectScope:function(){return w.B},getCurrentInstance:function(){return w.FN},getCurrentScope:function(){return w.nZ},getTransitionRawChildren:function(){return w.Q6},guardReactiveProps:function(){return w.F4},h:function(){return w.h},handleError:function(){return w.S3},hydrate:function(){return w.ZB},initCustomFormatter:function(){return w.Mr},initDirectivesForSSR:function(){return w.Nd},inject:function(){return w.f3},isMemoSame:function(){return w.nQ},isProxy:function(){return w.X3},isReactive:function(){return w.PG},isReadonly:function(){return w.$y},isRef:function(){return w.dq},isRuntimeOnly:function(){return w.of},isShallow:function(){return w.yT},isVNode:function(){return w.lA},markRaw:function(){return w.Xl},mergeDefaults:function(){return w.u_},mergeProps:function(){return w.dG},nextTick:function(){return w.Y3},normalizeClass:function(){return w.C_},normalizeProps:function(){return w.vs},normalizeStyle:function(){return w.j5},onActivated:function(){return w.dl},onBeforeMount:function(){return w.wF},onBeforeUnmount:function(){return w.Jd},onBeforeUpdate:function(){return w.Xn},onDeactivated:function(){return w.se},onErrorCaptured:function(){return w.d1},onMounted:function(){return w.bv},onRenderTracked:function(){return w.bT},onRenderTriggered:function(){return w.Yq},onScopeDispose:function(){return w.EB},onServerPrefetch:function(){return w.vl},onUnmounted:function(){return w.SK},onUpdated:function(){return w.ic},openBlock:function(){return w.wg},popScopeId:function(){return w.Cn},provide:function(){return w.JJ},proxyRefs:function(){return w.WL},pushScopeId:function(){return w.dD},queuePostFlushCb:function(){return w.qb},reactive:function(){return w.qj},readonly:function(){return w.OT},ref:function(){return w.iH},registerRuntimeCompiler:function(){return w.Y1},render:function(){return w.sY},renderList:function(){return w.Ko},renderSlot:function(){return w.WI},resolveComponent:function(){return w.up},resolveDirective:function(){return w.Q2},resolveDynamicComponent:function(){return w.LL},resolveFilter:function(){return w.eq},resolveTransitionHooks:function(){return w.U2},setBlockTracking:function(){return w.qZ},setDevtoolsHook:function(){return w.ec},setTransitionHooks:function(){return w.nK},shallowReactive:function(){return w.Um},shallowReadonly:function(){return w.YS},shallowRef:function(){return w.XI},ssrContextKey:function(){return w.Uc},ssrUtils:function(){return w.G},stop:function(){return w.sT},toDisplayString:function(){return w.zw},toHandlerKey:function(){return w.hR},toHandlers:function(){return w.mx},toRaw:function(){return w.IU},toRef:function(){return w.Vh},toRefs:function(){return w.BK},transformVNodeArgs:function(){return w.C3},triggerRef:function(){return w.oR},unref:function(){return w.SU},useAttrs:function(){return w.l1},useCssModule:function(){return w.fb},useCssVars:function(){return w.sj},useSSRContext:function(){return w.Zq},useSlots:function(){return w.Rr},useTransitionState:function(){return w.Y8},vModelCheckbox:function(){return w.e8},vModelDynamic:function(){return w.YZ},vModelRadio:function(){return w.G2},vModelSelect:function(){return w.bM},vModelText:function(){return w.nr},vShow:function(){return w.F8},version:function(){return w.i8},warn:function(){return w.ZK},watch:function(){return w.YP},watchEffect:function(){return w.m0},watchPostEffect:function(){return w.Rh},watchSyncEffect:function(){return w.yX},withAsyncContext:function(){return w.mv},withCtx:function(){return w.w5},withDefaults:function(){return w.b9},withDirectives:function(){return w.wy},withKeys:function(){return w.D2},withMemo:function(){return w.MX},withModifiers:function(){return w.iM},withScopeId:function(){return w.HX}});var i={};n.r(i),n.d(i,{$reactive:function(){return Jd},$reactiveproxy:function(){return Zd},$skipreactive:function(){return Xd},Atom:function(){return ch},Observer:function(){return Pd},Reaction:function(){return Fd},autorun:function(){return sh},autorunAsync:function(){return ah},createAtom:function(){return uh},hasRunningReaction:function(){return Id},isActionRunning:function(){return Rd},isReactive:function(){return Qd},isTrackingDisabled:function(){return $d},markRaw:function(){return th},reaction:function(){return jd},reactive:function(){return rh},runInAction:function(){return Nd},runningReaction:function(){return zd},untracked:function(){return Hd},untrackedCB:function(){return Vd}});var o=n(3396),s=n(7139);const a={class:"document"},c=(0,o.Uk)(" Back "),u={style:{color:"var(--va-dark)"}},l=(0,o.Uk)(" Copy Link "),d=(0,o.Uk)(" Download "),h=(0,o.Uk)(" Syncing document... ");function f(t,e,n,r,i,f){const p=(0,o.up)("Canvas"),g=(0,o.up)("va-button"),m=(0,o.up)("va-navbar-item"),v=(0,o.up)("Avatar"),y=(0,o.up)("va-avatar"),b=(0,o.up)("va-popover"),w=(0,o.up)("va-navbar"),E=(0,o.up)("va-icon"),S=(0,o.up)("va-modal");return(0,o.wg)(),(0,o.iD)("div",a,[(0,o.Wm)(p,{document:t.document},null,8,["document"]),(0,o.Wm)(w,{class:"nav",style:{background:"linear-gradient(var(--va-background) 60%, transparent 100%)"}},{left:(0,o.w5)((()=>[(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(g,{flat:"",icon:"arrow_back","text-color":"dark",to:{name:"home"}},{default:(0,o.w5)((()=>[c])),_:1}),(0,o.Wm)(g,{flat:"",icon:"undo","text-color":"dark",disabled:0===t.document.undoStack.length,onClick:e[0]||(e[0]=e=>t.document.undo())},null,8,["disabled"]),(0,o.Wm)(g,{flat:"",icon:"redo","text-color":"dark",disabled:0===t.document.redoStack.length,onClick:e[1]||(e[1]=e=>t.document.redo())},null,8,["disabled"])])),_:1})])),center:(0,o.w5)((()=>[(0,o._)("b",u,(0,s.zw)(t.state.context),1)])),right:(0,o.w5)((()=>[(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.users,(e=>((0,o.wg)(),(0,o.j4)(b,{key:e.id,message:e.id===t.document.localUser.id?`${e.name} (Me)`:e.name,color:"gray"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{size:37,style:{"margin-right":"0.5rem"}},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{class:"avatar",variant:"beam",name:e.name},null,8,["name"])])),_:2},1024)])),_:2},1032,["message"])))),128))])),_:1}),(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(g,{gradient:"",style:{"margin-right":"0.5rem"}},{default:(0,o.w5)((()=>[l])),_:1}),(0,o.Wm)(g,{outline:""},{default:(0,o.w5)((()=>[d])),_:1})])),_:1})])),_:1}),(0,o.Wm)(S,{modelValue:t.loading,"onUpdate:modelValue":e[2]||(e[2]=e=>t.loading=e),"hide-default-actions":!0},{default:(0,o.w5)((()=>[(0,o.WI)(t.$slots,"default",{},(()=>[(0,o.Wm)(E,{name:"loop",spin:"counter-clockwise"}),h]),!0)])),_:3},8,["modelValue"])])}var p=n(6605),g=n(7318),m=n(2528),v=n(5538),y=(n(6699),n(3857)),b=n(2900),w=n(9242),E=n(2581),S=n(9351),D=n(4906),k=n(4945),x=n(4885);n(1950);const C=E.V["with"](class{constructor(){this.modelValue=(0,E.p)({type:Boolean,default:!1}),this.attachElement=(0,E.p)({type:String,default:"body"}),this.disableAttachment=(0,E.p)({type:Boolean,default:!1}),this.title=(0,E.p)({type:String,default:""}),this.message=(0,E.p)({type:String,default:""}),this.okText=(0,E.p)({type:String,default:"OK"}),this.cancelText=(0,E.p)({type:String,default:"Cancel"}),this.hideDefaultActions=(0,E.p)({type:Boolean,default:!1}),this.fullscreen=(0,E.p)({type:Boolean,default:!1}),this.mobileFullscreen=(0,E.p)({type:Boolean,default:!0}),this.noDismiss=(0,E.p)({type:Boolean,default:!1}),this.noOutsideDismiss=(0,E.p)({type:Boolean,default:!1}),this.noEscDismiss=(0,E.p)({type:Boolean,default:!1}),this.maxWidth=(0,E.p)({type:String,default:""}),this.maxHeight=(0,E.p)({type:String,default:""}),this.size=(0,E.p)({type:String,default:"medium",validator:t=>["medium","small","large"].includes(t)}),this.fixedLayout=(0,E.p)({type:Boolean,default:!1}),this.withoutTransitions=(0,E.p)({type:Boolean,default:!1}),this.overlay=(0,E.p)({type:Boolean,default:!0}),this.overlayOpacity=(0,E.p)({type:[Number,String],default:.6}),this.zIndex=(0,E.p)({type:[Number,String],default:void 0})}});class _{constructor(){this.isTransition=(0,E.p)({type:Boolean,default:!0})}}let O=class extends(E.V["with"](_)){render(){const t=this.$slots.default?this.$slots.default(this.$attrs):null;return this.$props.isTransition?(0,o.h)(w.uT,{...this.$attrs},this.$slots):t}};O=(0,b.gn)([(0,E.O)({name:"ModalElement"})],O);let A=class extends((0,E.m)(S.C,D.S,C)){created(){(0,o.YP)((()=>this.valueComputed),(t=>{t?window.addEventListener("keyup",this.listenKeyUp):window.removeEventListener("keyup",this.listenKeyUp)}))}get computedClass(){return{"va-modal--fullscreen":this.$props.fullscreen,"va-modal--mobile-fullscreen":this.$props.mobileFullscreen,"va-modal--fixed-layout":this.$props.fixedLayout,[`va-modal--size-${this.$props.size}`]:"medium"!==this.$props.size}}get computedOverlayStyles(){return document.querySelectorAll(".va-modal__overlay").length?{}:{"background-color":`rgba(0, 0, 0, ${this.$props.overlayOpacity})`,"z-index":this.$props.zIndex?Number(this.$props.zIndex)-1:void 0}}get computedModalContainerStyle(){return{"z-index":this.$props.zIndex}}get hasContentSlot(){return this.$slots.default}get hasHeaderSlot(){return this.$slots.header}get hasFooterSlot(){return this.$slots.footer}show(){this.valueComputed=!0}hide(){this.valueComputed=!1}toggle(){this.valueComputed=!this.valueComputed}cancel(){this.hide(),this.$emit("cancel")}ok(){this.hide(),this.$emit("ok")}listenKeyUp(t){"Escape"!==t.code||this.$props.noEscDismiss||this.$props.noDismiss||this.cancel()}onOutsideClick(){this.$props.noOutsideDismiss||this.$props.noDismiss||(this.$emit("click-outside"),this.cancel())}onBeforeEnterTransition(t){this.$emit("before-open",t)}onAfterEnterTransition(t){this.$emit("open",t)}onBeforeLeaveTransition(t){this.$emit("before-close",t)}onAfterLeaveTransition(t){this.$emit("close",t)}};A=(0,b.gn)([(0,E.O)({name:"VaModal",components:{VaButton:g.Z,VaIcon:k.Z,ModalElement:O},emits:["update:modelValue","cancel","ok","before-open","open","before-close","close","click-outside"]})],A);var M=A;const T={class:"va-modal"},R={key:1,class:"va-modal__header"},N={key:2,class:"va-modal__message"},P={key:3,class:"va-modal__message"},B={key:4,class:"va-modal__footer"},F={key:5,class:"va-modal__footer"};(0,x.s)(":root{--va-modal-title-margin-bottom:1.5rem;--va-modal-position:fixed;--va-modal-top:0;--va-modal-left:0;--va-modal-display:flex;--va-modal-width:100%;--va-modal-height:100%;--va-modal-align-items:center;--va-modal-justify-content:center;--va-modal-overflow:hidden;--va-modal-outline:0;--va-modal-z-index:var(--va-z-index-teleport-overlay);--va-modal-container-z-index:100;--va-modal-dialog-background:#fff;--va-modal-dialog-min-height:3.125rem;--va-modal-dialog-height:fit-content;--va-modal-dialog-border-radius:0.375rem;--va-modal-dialog-margin:1rem;--va-modal-dialog-box-shadow:0 4px 70px -18px #707070;--va-modal-dialog-max-width:768px;--va-modal-dialog-max-height:calc(100vh - 2rem);--va-modal-dialog-position:relative;--va-modal-overlay-position:fixed;--va-modal-overlay-top:0;--va-modal-overlay-left:0;--va-modal-overlay-z-index:calc(var(--va-modal-container-z-index) - 1);--va-modal-overlay-width:100vw;--va-modal-overlay-height:100vh}.va-modal{align-items:var(--va-modal-align-items);display:var(--va-modal-display);font-family:var(--va-font-family);height:var(--va-modal-height);justify-content:var(--va-modal-justify-content);left:var(--va-modal-left);outline:var(--va-modal-outline);overflow:var(--va-modal-overflow);position:var(--va-modal-position);top:var(--va-modal-top);width:var(--va-modal-width);z-index:var(--va-modal-z-index)}.va-modal__title{font-size:.625rem;font-weight:700;letter-spacing:.6px;line-height:1.2;margin-bottom:1.5rem;text-transform:uppercase}.va-modal__container{z-index:var(--va-modal-container-z-index)}.va-modal__container--transition-enter-from,.va-modal__container--transition-leave-to{opacity:0;transform:translateY(-30%)}.va-modal__container--transition-enter-active,.va-modal__container--transition-leave-active{transition:opacity .15s cubic-bezier(1,.5,.8,1),transform .3s ease}.va-modal__dialog{background:var(--va-modal-dialog-background);border-radius:var(--va-modal-dialog-border-radius,var(--va-block-border-radius));box-shadow:var(--va-modal-dialog-box-shadow,var(--va-block-box-shadow));height:var(--va-modal-dialog-height);margin:var(--va-modal-dialog-margin);max-height:var(--va-modal-dialog-max-height);max-width:var(--va-modal-dialog-max-width);min-height:var(--va-modal-dialog-min-height);overflow:auto;position:var(--va-modal-dialog-position)}.va-modal__overlay{height:var(--va-modal-overlay-height);left:var(--va-modal-overlay-left);position:var(--va-modal-overlay-position);top:var(--va-modal-overlay-top);width:var(--va-modal-overlay-width);z-index:var(--va-modal-overlay-z-index)}.va-modal__overlay--transition-enter-from,.va-modal__overlay--transition-leave-to{opacity:0}.va-modal__overlay--transition-enter-active,.va-modal__overlay--transition-leave-active{transition:opacity .2s cubic-bezier(1,.5,.8,1)}.va-modal--fullscreen{border-radius:0;margin:0;min-height:100vh!important;min-width:100vw!important}@media (max-width:576px){.va-modal--mobile-fullscreen{border-radius:0;margin:0!important;min-height:100vh!important;min-width:100vw!important}}.va-modal--size-small{max-width:576px}@media (max-width:576px){.va-modal--size-small{max-width:100vw!important}}.va-modal--size-small .va-modal__inner{max-width:576px}@media (max-width:576px){.va-modal--size-small .va-modal__inner{max-width:100vw!important}}.va-modal--size-large,.va-modal--size-large .va-modal__inner{max-width:992px}.va-modal--fixed-layout .va-modal__inner{max-height:calc(100vh - 2rem);overflow:hidden;padding:1.25rem 0 1.5rem}.va-modal--fixed-layout .va-modal__inner .va-modal__footer,.va-modal--fixed-layout .va-modal__inner .va-modal__header,.va-modal--fixed-layout .va-modal__inner .va-modal__title{padding:0 1.875rem 0 1.5rem}.va-modal--fixed-layout .va-modal__inner .va-modal__message{overflow:auto;padding:0 1.875rem 0 1.5rem}.va-modal--fixed-layout .va-modal__dialog{overflow:hidden}.va-modal__message{margin-bottom:1.5rem}.va-modal__inner{display:flex;flex-flow:column;margin:auto;max-width:768px;overflow:visible;padding:1.25rem 1.875rem 1.5rem 1.5rem;position:relative}.va-modal__inner>div:last-of-type{margin-bottom:0!important}.va-modal__close{color:#babfc2;cursor:pointer;font-size:1.5rem!important;font-style:normal!important;position:absolute;right:1rem;top:1rem;z-index:1}.va-modal__footer{display:flex;flex-wrap:wrap;justify-content:center;margin-top:auto;min-height:-webkit-fit-content;min-height:-moz-fit-content;min-height:fit-content}.va-modal__footer:last-of-type{margin-bottom:0!important}"),M.render=function(t,e,n,r,i,a){const c=(0,o.up)("modal-element"),u=(0,o.up)("va-icon"),l=(0,o.up)("va-button");return t.valueComputed?((0,o.wg)(),(0,o.j4)(o.lR,{key:0,to:t.attachElement,disabled:t.disableAttachment},[(0,o._)("div",T,[(0,o.Wm)(c,{name:"va-modal__overlay--transition",isTransition:!t.$props.withoutTransitions,onClick:t.onOutsideClick,appear:""},{default:(0,o.w5)((()=>[(0,o._)("div",{class:"va-modal__overlay",style:(0,s.j5)(t.$props.overlay&&t.computedOverlayStyles)},null,4)])),_:1},8,["isTransition","onClick"]),(0,o.Wm)(c,{name:"va-modal__container--transition",isTransition:!t.$props.withoutTransitions,appear:"",onBeforeEnter:t.onBeforeEnterTransition,onAfterEnter:t.onAfterEnterTransition,onBeforeLeave:t.onBeforeLeaveTransition,onAfterLeave:t.onAfterLeaveTransition},{default:(0,o.w5)((()=>[t.valueComputed?((0,o.wg)(),(0,o.iD)("div",{key:0,class:"va-modal__container",style:(0,s.j5)(t.computedModalContainerStyle)},[(0,o._)("div",{class:(0,s.C_)(["va-modal__dialog",t.computedClass]),style:(0,s.j5)({maxWidth:t.$props.maxWidth,maxHeight:t.$props.maxHeight}),ref:"modal"},[t.$props.fullscreen?((0,o.wg)(),(0,o.j4)(u,{key:0,onClick:e[0]||(e[0]=e=>t.cancel()),name:"close",class:"va-modal__close"})):(0,o.kq)("v-if",!0),(0,o._)("div",{class:"va-modal__inner",style:(0,s.j5)({maxWidth:t.$props.maxWidth,maxHeight:t.$props.maxHeight})},[t.title?((0,o.wg)(),(0,o.iD)("div",{key:0,class:"va-modal__title",style:(0,s.j5)({color:t.theme.getColor("primary")})},(0,s.zw)(t.$props.title),5)):(0,o.kq)("v-if",!0),t.hasHeaderSlot?((0,o.wg)(),(0,o.iD)("div",R,[(0,o.WI)(t.$slots,"header")])):(0,o.kq)("v-if",!0),t.$props.message?((0,o.wg)(),(0,o.iD)("div",N,(0,s.zw)(t.$props.message),1)):(0,o.kq)("v-if",!0),t.hasContentSlot?((0,o.wg)(),(0,o.iD)("div",P,[(0,o.WI)(t.$slots,"default")])):(0,o.kq)("v-if",!0),!t.$props.cancelText&&!t.$props.okText||t.$props.hideDefaultActions?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.iD)("div",B,[t.$props.cancelText?((0,o.wg)(),(0,o.j4)(l,{key:0,color:"gray",class:"mr-2",flat:"",onClick:t.cancel},{default:(0,o.w5)((()=>[(0,o.Uk)((0,s.zw)(t.$props.cancelText),1)])),_:1},8,["onClick"])):(0,o.kq)("v-if",!0),(0,o.Wm)(l,{onClick:t.ok},{default:(0,o.w5)((()=>[(0,o.Uk)((0,s.zw)(t.$props.okText),1)])),_:1},8,["onClick"])])),t.hasFooterSlot?((0,o.wg)(),(0,o.iD)("div",F,[(0,o.WI)(t.$slots,"footer")])):(0,o.kq)("v-if",!0)],4)],6)],4)):(0,o.kq)("v-if",!0)])),_:3},8,["isTransition","onBeforeEnter","onAfterEnter","onBeforeLeave","onAfterLeave"])])],8,["to","disabled"])):(0,o.kq)("v-if",!0)},M.__file="src/components/va-modal/VaModal.vue";var I=(0,y.w)(M),z=n(8729),j=n(4892),L=n.n(j);const $={class:"viewport"};function H(t,e,n,r,i,a){const c=(0,o.up)("Node"),u=(0,o.up)("Cursor"),l=(0,o.up)("Moveable"),d=(0,o.up)("VueSelecto"),h=(0,o.up)("vue-infinite-viewer");return(0,o.wg)(),(0,o.j4)(h,{class:"canvas",ref:"canvas",style:(0,s.j5)({"background-position":`${-t.x*t.zoom}px ${-t.y*t.zoom}px`,"background-size":`${15*t.zoom}px ${15*t.zoom}px`}),maxPinchWheel:10,onScroll:t.panCanvas,onPinch:t.zoomCanvas,onDblclick:t.newNode},{default:(0,o.w5)((()=>[(0,o._)("div",$,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.store.value.nodes,(e=>((0,o.wg)(),(0,o.j4)(c,{key:e.id,ref_for:!0,ref:e.id,node:e,selected:t.selection.some((t=>t.id===e.id)),onDblclick:(0,w.iM)((n=>t.editNode(e)),["stop"])},null,8,["node","selected","onDblclick"])))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.document.users,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id},[t.document.localUser.id!==e.id?((0,o.wg)(),(0,o.j4)(u,{key:0,id:e.id,name:e.name,x:e.cursorX,y:e.cursorY},null,8,["id","name","x","y"])):(0,o.kq)("",!0)])))),128)),(0,o.Wm)(l,{ref:"moveable",className:"moveable",target:t.selection,draggable:!0,resizable:1===t.selection.length&&!t.store.value.nodes[t.selection[0].id].parent,renderDirections:["e"],onClickGroup:t.cancelSelectionWhenClickEmpty,onDrag:t.dragNodes,onDragGroup:t.dragNodes,onDragEnd:t.commitNodePositions,onDragGroupEnd:t.commitNodePositions,onResize:t.resizeNode,onResizeEnd:t.commitNodeSize},null,8,["target","resizable","onClickGroup","onDrag","onDragGroup","onDragEnd","onDragGroupEnd","onResize","onResizeEnd"]),(0,o.Wm)(d,{ref:"selecto",container:t.$refs.canvas,dragContainer:t.$refs.canvas,selectableTargets:[".node.selectable"],selectByClick:!0,selectFromInside:!1,toggleContinueSelect:["shift"],keyContainer:t.$refs.canvas,hitRate:0,ratio:0,onDragStart:t.preventSelectionWhenDragging,onSelect:t.selectNode,onSelectEnd:t.commitSelections},null,8,["container","dragContainer","selectableTargets","keyContainer","onDragStart","onSelect","onSelectEnd"])])])),_:1},8,["style","onScroll","onPinch","onDblclick"])}n(1703);var V="function",W="object",U="string",q="number",G="undefined",K=typeof window!==G,Y=(typeof document!==G&&document,[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}]),X=1e-7,J={cm:function(t){return 96*t/2.54},mm:function(t){return 96*t/254},in:function(t){return 96*t},pt:function(t){return 96*t/72},pc:function(t){return 96*t/6},"%":function(t,e){return t*e/100},vw:function(t,e){return void 0===e&&(e=window.innerWidth),t/100*e},vh:function(t,e){return void 0===e&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return void 0===e&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return void 0===e&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};function Z(t,e,n,r){return(t*r+e*n)/(n+r)}function Q(t){return typeof t===G}function tt(t){return t&&typeof t===W}function et(t){return Array.isArray(t)}function nt(t){return typeof t===U}function rt(t){return typeof t===q}function it(t){return typeof t===V}function ot(t,e){var n=""===t||" "==t,r=""===e||" "==e;return r&&n||t===e}function st(t,e,n,r,i){var o=at(t,e,n);return o?n:ct(t,e,n+1,r,i)}function at(t,e,n){if(!t.ignore)return null;var r=e.slice(Math.max(n-3,0),n+3).join("");return new RegExp(t.ignore).exec(r)}function ct(t,e,n,r,i){for(var o,s=function(n){var s=e[n].trim();if(s===t.close&&!at(t,e,n))return{value:n};var a=n,c=yt(i,(function(t){var e=t.open;return e===s}));if(c&&(a=st(c,e,n,r,i)),-1===a)return o=n,"break";n=a,o=n},a=n;a<r;++a){var c=s(a);if(a=o,"object"===typeof c)return c.value;if("break"===c)break}return-1}function ut(t,e){var n=nt(e)?{separator:e}:e,r=n.separator,i=void 0===r?",":r,o=n.isSeparateFirst,s=n.isSeparateOnlyOpenClose,a=n.isSeparateOpenClose,c=void 0===a?s:a,u=n.openCloseCharacters,l=void 0===u?Y:u,d=l.map((function(t){var e=t.open,n=t.close;return e===n?e:e+"|"+n})).join("|"),h="(\\s*"+i+"\\s*|"+d+"|\\s+)",f=new RegExp(h,"g"),p=t.split(f).filter(Boolean),g=p.length,m=[],v=[];function y(){return!!v.length&&(m.push(v.join("")),v=[],!0)}for(var b,w=function(t){var e=p[t].trim(),n=t,r=yt(l,(function(t){var n=t.open;return n===e})),a=yt(l,(function(t){var n=t.close;return n===e}));if(r){if(n=st(r,p,t,g,l),-1!==n&&c)return y()&&o?(b=t,"break"):(m.push(p.slice(t,n+1).join("")),t=n,o?(b=t,"break"):(b=t,"continue"))}else{if(a&&!at(a,p,t))throw new Error("invalid format: "+a.close);if(ot(e,i)&&!s)return y(),o?(b=t,"break"):(b=t,"continue")}-1===n&&(n=g-1),v.push(p.slice(t,n+1).join("")),t=n,b=t},E=0;E<g;++E){var S=w(E);if(E=b,"break"===S)break}return v.length&&m.push(v.join("")),m}function lt(t){return ut(t,"")}function dt(t){return ut(t,",")}function ht(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function ft(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var n=e[1],r=e[2],i=e[3];return{prefix:n,unit:i,value:parseFloat(r)}}function pt(t){return t.replace(/[\s-_]([a-z])/g,(function(t,e){return e.toUpperCase()}))}function gt(t,e){return void 0===e&&(e="-"),t.replace(/([a-z])([A-Z])/g,(function(t,n,r){return""+n+e+r.toLowerCase()}))}function mt(){return Date.now?Date.now():(new Date).getTime()}function vt(t,e,n){void 0===n&&(n=-1);for(var r=t.length,i=0;i<r;++i)if(e(t[i],i,t))return i;return n}function yt(t,e,n){var r=vt(t,e);return r>-1?t[r]:n}var bt=function(){var t=mt(),e=K&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(e){var n=mt(),r=window.setTimeout((function(){e(n-t)}),1e3/60);return r}}(),wt=function(){var t=K&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(t){clearTimeout(t)}}();function Et(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in e)e.push(n);return e}function St(t,e){var n=ft(t),r=n.value,i=n.unit;if(tt(e)){var o=e[i];if(o){if(it(o))return o(r);if(J[i])return J[i](r,o)}}else if("%"===i)return r*e/100;return J[i]?J[i](r):r}function Dt(t,e,n){return Math.max(e,Math.min(t,n))}function kt(t,e,n){return[[Rt(e[0],X),Rt(e[0]*t[1]/t[0],X)],[Rt(e[1]*t[0]/t[1],X),Rt(e[1],X)]].filter((function(t){return t.every((function(t,r){return n?t<=e[r]:t>=e[r]}))}))[0]||t}function xt(t,e,n,r){if(!r)return t.map((function(t,r){return Dt(t,e[r],n[r])}));var i=t[0],o=t[1],s=kt(t,e,!1),a=s[0],c=s[1],u=kt(t,n,!0),l=u[0],d=u[1];return i<a||o<c?(i=a,o=c):(i>l||o>d)&&(i=l,o=d),[i,o]}function Ct(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return n}function _t(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return e?n/e:0}function Ot(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=Math.atan2(r,n);return i>=0?i:i+2*Math.PI}function At(t){return[0,1].map((function(e){return _t(t.map((function(t){return t[e]})))}))}function Mt(t){var e=At(t),n=Ot(e,t[0]),r=Ot(e,t[1]);return n<r&&r-n<Math.PI||n>r&&r-n<-Math.PI?1:-1}function Tt(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function Rt(t,e){return e?Math.round(t/e)*e:t}function Nt(t,e){return t.forEach((function(n,r){t[r]=Rt(t[r],e)})),t}function Pt(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function Bt(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function Ft(t,e){if(t.classList)t.classList.remove(e);else{var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ")}}function It(t,e,n,r){t.addEventListener(e,n,r)}function zt(t,e,n,r){t.removeEventListener(e,n,r)}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var jt=function(){return jt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},jt.apply(this,arguments)};function Lt(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var $t=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e){if(tt(t))for(var n in t)this.on(n,t[n]);else this._addEvent(t,e,{});return this},e.off=function(t,e){if(t)if(tt(t))for(var n in t)this.off(n);else if(e){var r=this._events[t];if(r){var i=vt(r,(function(t){return t.listener===e}));i>-1&&r.splice(i,1)}}else this._events[t]=[];else this._events={};return this},e.once=function(t,e){var n=this;return e&&this._addEvent(t,e,{once:!0}),new Promise((function(e){n._addEvent(t,e,{once:!0})}))},e.emit=function(t,e){var n=this;void 0===e&&(e={});var r=this._events[t];if(!t||!r)return!0;var i=!1;return e.eventType=t,e.stop=function(){i=!0},e.currentTarget=this,Lt(r).forEach((function(r){r.listener(e),r.once&&n.off(t,r.listener)})),!i},e.trigger=function(t,e){return void 0===e&&(e={}),this.emit(t,e)},e._addEvent=function(t,e,n){var r=this._events;r[t]=r[t]||[];var i=r[t];i.push(jt({listener:e},n))},t}(),Ht=$t,Vt=function(t,e){return Vt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Vt(t,e)};function Wt(t,e){function n(){this.constructor=t}Vt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Ut=function(){return Ut=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Ut.apply(this,arguments)};function qt(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=Math.atan2(r,n);return i>=0?i:i+2*Math.PI}function Gt(t){return qt([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}function Kt(t){return t.touches&&t.touches.length>=2}function Yt(t){return t?t.touches?Zt(t.touches):[Qt(t)]:[]}function Xt(t,e,n){var r=n.length,i=te(t,r),o=i.clientX,s=i.clientY,a=i.originalClientX,c=i.originalClientY,u=te(e,r),l=u.clientX,d=u.clientY,h=te(n,r),f=h.clientX,p=h.clientY,g=o-l,m=s-d,v=o-f,y=s-p;return{clientX:a,clientY:c,deltaX:g,deltaY:m,distX:v,distY:y}}function Jt(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function Zt(t){for(var e=Math.min(t.length,2),n=[],r=0;r<e;++r)n.push(Qt(t[r]));return n}function Qt(t){return{clientX:t.clientX,clientY:t.clientY}}function te(t,e){void 0===e&&(e=t.length);for(var n={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=0;r<e;++r){var i=t[r];n.originalClientX+="originalClientX"in i?i.originalClientX:i.clientX,n.originalClientY+="originalClientY"in i?i.originalClientY:i.clientY,n.clientX+=i.clientX,n.clientY+=i.clientY}return e?{clientX:n.clientX/e,clientY:n.clientY/e,originalClientX:n.originalClientX/e,originalClientY:n.originalClientY/e}:n}var ee=function(){function t(t){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=t,this.prevClients=t,this.length=t.length}var e=t.prototype;return e.getAngle=function(t){return void 0===t&&(t=this.prevClients),Gt(t)},e.getRotation=function(t){return void 0===t&&(t=this.prevClients),Gt(t)-Gt(this.startClients)},e.getPosition=function(t,e){void 0===t&&(t=this.prevClients);var n=Xt(t||this.prevClients,this.prevClients,this.startClients),r=n.deltaX,i=n.deltaY;return this.movement+=Math.sqrt(r*r+i*i),this.prevClients=t,n},e.getPositions=function(t){void 0===t&&(t=this.prevClients);var e=this.prevClients;return this.startClients.map((function(n,r){return Xt([t[r]],[e[r]],[n])}))},e.getMovement=function(t){var e=this.movement;if(!t)return e;var n=te(t,this.length),r=te(this.prevClients,this.length),i=n.clientX-r.clientX,o=n.clientY-r.clientY;return Math.sqrt(i*i+o*o)+e},e.getDistance=function(t){return void 0===t&&(t=this.prevClients),Jt(t)},e.getScale=function(t){return void 0===t&&(t=this.prevClients),Jt(t)/Jt(this.startClients)},e.move=function(t,e){this.startClients.forEach((function(n){n.clientX-=t,n.clientY-=e}))},t}(),ne=["textarea","input"],re=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;r.options={},r.flag=!1,r.pinchFlag=!1,r.datas={},r.isDrag=!1,r.isPinch=!1,r.isMouse=!1,r.isTouch=!1,r.clientStores=[],r.targets=[],r.prevTime=0,r.doubleFlag=!1,r._dragFlag=!1,r.onDragStart=function(t,e){if(void 0===e&&(e=!0),r.flag||!1!==t.cancelable){var n=r.options,i=n.container,o=n.pinchOutside,s=n.preventRightClick,a=n.preventDefault,c=n.checkInput,u=r.isTouch,l=!r.flag;if(l){var d=document.activeElement,h=t.target,f=h.tagName.toLowerCase(),p=ne.indexOf(f)>-1,g=h.isContentEditable;if(p||g){if(c||d===h)return!1;if(d&&g&&d.isContentEditable&&d.contains(h))return!1}else if((a||"touchstart"===t.type)&&d){var m=d.tagName;(d.isContentEditable||ne.indexOf(m)>-1)&&d.blur()}if(r.clientStores=[new ee(Yt(t))],r.flag=!0,r.isDrag=!1,r._dragFlag=!0,r.datas={},s&&(3===t.which||2===t.button))return r.initDrag(),!1;r.doubleFlag=mt()-r.prevTime<200;var v=r.emit("dragStart",Ut(Ut({datas:r.datas,inputEvent:t,isTrusted:e,isDouble:r.doubleFlag},r.getCurrentStore().getPosition()),{preventDefault:function(){t.preventDefault()},preventDrag:function(){r._dragFlag=!1}}));!1===v&&r.initDrag(),r.flag&&a&&t.preventDefault()}if(!r.flag)return!1;var y=0;if(l&&u&&o&&(y=setTimeout((function(){It(i,"touchstart",r.onDragStart,{passive:!1})}))),!l&&u&&o&&zt(i,"touchstart",r.onDragStart),r.flag&&Kt(t)){if(clearTimeout(y),l&&t.touches.length!==t.changedTouches.length)return;r.pinchFlag||r.onPinchStart(t)}}},r.onDrag=function(t,e){if(r.flag){var n=Yt(t),i=r.moveClients(n,t,!1);if(r._dragFlag){if(r.pinchFlag||i.deltaX||i.deltaY){var o=r.emit("drag",Ut(Ut({},i),{isScroll:!!e,inputEvent:t}));if(!1===o)return void r.stop()}r.pinchFlag&&r.onPinch(t,n)}r.getCurrentStore().getPosition(n,!0)}},r.onDragEnd=function(t){if(r.flag){var e=r.options,n=e.pinchOutside,i=e.container;r.isTouch&&n&&zt(i,"touchstart",r.onDragStart),r.pinchFlag&&r.onPinchEnd(t);var o=(null===t||void 0===t?void 0:t.touches)?Yt(t):[],s=o.length;0!==s&&r.options.keepDragging?r._addStore(new ee(o)):r.flag=!1;var a=r._getPosition(),c=mt(),u=!r.isDrag&&r.doubleFlag;r.prevTime=r.isDrag||u?0:c,r.flag||(r.emit("dragEnd",Ut({datas:r.datas,isDouble:u,isDrag:r.isDrag,isClick:!r.isDrag,inputEvent:t},a)),r.clientStores=[])}},r.onBlur=function(){r.onDragEnd()};var i=[].concat(e);r.options=Ut({checkInput:!1,container:i.length>1?window:i[0],preventRightClick:!0,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},n);var o=r.options,s=o.container,a=o.events,c=o.checkWindowBlur;if(r.isTouch=a.indexOf("touch")>-1,r.isMouse=a.indexOf("mouse")>-1,r.targets=i,r.isMouse&&(i.forEach((function(t){It(t,"mousedown",r.onDragStart)})),It(s,"mousemove",r.onDrag),It(s,"mouseup",r.onDragEnd),It(s,"contextmenu",r.onDragEnd)),c&&It(window,"blur",r.onBlur),r.isTouch){var u={passive:!1};i.forEach((function(t){It(t,"touchstart",r.onDragStart,u)})),It(s,"touchmove",r.onDrag,u),It(s,"touchend",r.onDragEnd,u),It(s,"touchcancel",r.onDragEnd,u)}return r}Wt(e,t);var n=e.prototype;return n.stop=function(){this.isDrag=!1,this.flag=!1,this.clientStores=[],this.datas={}},n.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce((function(t,e){return t+e.movement}),0)},n.isDragging=function(){return this.isDrag},n.isFlag=function(){return this.flag},n.isPinchFlag=function(){return this.pinchFlag},n.isDoubleFlag=function(){return this.doubleFlag},n.isPinching=function(){return this.isPinch},n.scrollBy=function(t,e,n,r){void 0===r&&(r=!0),this.flag&&(this.clientStores[0].move(t,e),r&&this.onDrag(n,!0))},n.move=function(t,e){var n=t[0],r=t[1],i=this.getCurrentStore(),o=i.prevClients;return this.moveClients(o.map((function(t){var e=t.clientX,i=t.clientY;return{clientX:e+n,clientY:i+r,originalClientX:e,originalClientY:i}})),e,!0)},n.triggerDragStart=function(t){this.onDragStart(t,!1)},n.setEventDatas=function(t){var e=this.datas;for(var n in t)e[n]=t[n];return this},n.getCurrentEvent=function(t){return Ut(Ut({datas:this.datas},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:t})},n.getEventDatas=function(){return this.datas},n.unset=function(){var t=this,e=this.targets,n=this.options.container;this.off(),zt(window,"blur",this.onBlur),this.isMouse&&(e.forEach((function(e){zt(e,"mousedown",t.onDragStart)})),zt(n,"mousemove",this.onDrag),zt(n,"mouseup",this.onDragEnd),zt(n,"contextmenu",this.onDragEnd)),this.isTouch&&(e.forEach((function(e){zt(e,"touchstart",t.onDragStart)})),zt(n,"touchstart",this.onDragStart),zt(n,"touchmove",this.onDrag),zt(n,"touchend",this.onDragEnd),zt(n,"touchcancel",this.onDragEnd))},n.onPinchStart=function(t){var e=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>e)){var n=new ee(Yt(t));this.pinchFlag=!0,this._addStore(n);var r=this.emit("pinchStart",Ut(Ut({datas:this.datas,angle:n.getAngle(),touches:this.getCurrentStore().getPositions()},n.getPosition()),{inputEvent:t}));!1===r&&(this.pinchFlag=!1)}},n.onPinch=function(t,e){if(this.flag&&this.pinchFlag&&!(e.length<2)){var n=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",Ut(Ut({datas:this.datas,movement:this.getMovement(e),angle:n.getAngle(e),rotation:n.getRotation(e),touches:n.getPositions(e),scale:n.getScale(e),distance:n.getDistance(e)},n.getPosition(e)),{inputEvent:t}))}},n.onPinchEnd=function(t){if(this.pinchFlag){var e=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var n=this.getCurrentStore();this.emit("pinchEnd",Ut(Ut({datas:this.datas,isPinch:e,touches:n.getPositions()},n.getPosition()),{inputEvent:t}))}},n.initDrag=function(){this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1},n.getCurrentStore=function(){return this.clientStores[0]},n.moveClients=function(t,e,n){var r=this._getPosition(t,n);return(r.deltaX||r.deltaY)&&(this.isDrag=!0),Ut(Ut({datas:this.datas},r),{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:e})},n._addStore=function(t){this.clientStores.splice(0,0,t)},n._getPosition=function(t,e){var n=this.getCurrentStore(),r=n.getPosition(t,e),i=this.clientStores.slice(1).reduce((function(t,e){var n=e.getPosition();return t.distX+=n.distX,t.distY+=n.distY,t}),r),o=i.distX,s=i.distY;return Ut(Ut({},r),{distX:o,distY:s})},e}(Ht),ie=re;function oe(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.map((function(e){return e.split(" ").map((function(e){return e?""+t+e:""})).join(" ")})).join(" ")}function se(t,e){return e.replace(/([^}{]*){/gm,(function(e,n){return n.replace(/\.([^{,\s\d.]+)/g,"."+t+"$1")+"{"}))}function ae(t,e){return function(n){n&&(t[e]=n)}}function ce(t,e,n){return function(r){r&&(t[e][n]=r)}}function ue(t,e){return function(n){var r=n.prototype;t.forEach((function(t){e(r,t)}))}}function le(t,e){return void 0===e&&(e={}),function(n,r){t.forEach((function(t){var i=e[t]||t;i in n||(n[i]=function(){for(var e,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var o=(e=this[r])[t].apply(e,n);return o===this[r]?this:o})}))}}function de(t){var e=5381,n=t.length;while(n)e=33*e^t.charCodeAt(--n);return e>>>0}var he=de;function fe(t){return he(t).toString(36)}function pe(t){if(t&&t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e}}function ge(t,e,n){return n.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/gm,(function(e,n){var r=n.trim();return(r?dt(r):[""]).map((function(e){var n=e.trim();return 0===n.indexOf("@")?n:n.indexOf(":global")>-1?n.replace(/\:global/g,""):n.indexOf(":host")>-1?""+n.replace(/\:host/g,"."+t):n?"."+t+" "+n:"."+t})).join(", ")+" {"}))}function me(t,e,n,r){var i=document.createElement("style");return i.setAttribute("type","text/css"),i.setAttribute("data-styled-id",t),n.nonce&&i.setAttribute("nonce",n.nonce),i.innerHTML=ge(t,e,n),(r||document.head||document.body).appendChild(i),i}function ve(t){var e,n="rCS"+fe(t),r=0;return{className:n,inject:function(i,o){void 0===o&&(o={});var s,a=pe(i),c=0===r;return(a||c)&&(s=me(n,t,o,a)),c&&(e=s),a||++r,{destroy:function(){a?(i.removeChild(s),s=null):(r>0&&--r,0===r&&e&&(e.parentNode.removeChild(e),e=null))}}}}}var ye=ve;function be(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return!0;return!1}function we(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return t[r];return null}function Ee(t){var e=t;if("undefined"===typeof e){if("undefined"===typeof navigator||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function Se(t,e){try{return new RegExp(t,"g").exec(e)}catch(Xw){return null}}function De(){if("undefined"===typeof navigator||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!(!e||!e.length)}function ke(t,e){var n=Se("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return n?n[3]:""}function xe(t){return t.replace(/_/g,".")}function Ce(t,e){var n=null,r="-1";return be(t,(function(t){var i=Se("("+t.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!(!i||t.brand)&&(n=t,r=i[3]||"-1",t.versionAlias?r=t.versionAlias:t.versionTest&&(r=ke(t.versionTest.toLowerCase(),e)||r),r=xe(r),!0)})),{preset:n,version:r}}function _e(t,e){var n={brand:"",version:"-1"};return be(t,(function(t){var r=Oe(e,t);return!!r&&(n.brand=t.id,n.version=t.versionAlias||r.version,"-1"!==n.version)})),n}function Oe(t,e){return we(t,(function(t){var n=t.brand;return Se(""+e.test,n.toLowerCase())}))}var Ae=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],Me=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],Te=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],Re=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],Ne=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function Pe(t){return!!Ce(Re,t).preset}function Be(t){var e=Ee(t),n=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:Pe(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},o=Ce(Ae,e),s=o.preset,a=o.version,c=Ce(Ne,e),u=c.preset,l=c.version,d=Ce(Me,e);if(r.chromium=!!d.preset,r.chromiumVersion=d.version,!r.chromium){var h=Ce(Te,e);r.webkit=!!h.preset,r.webkitVersion=h.version}return u&&(i.name=u.id,i.version=l,i.majorVersion=parseInt(l,10)),s&&(r.name=s.id,r.version=a,r.webview&&"ios"===i.name&&"safari"!==r.name&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:n,isHints:!1}}function Fe(t){var e=navigator.userAgentData,n=(e.uaList||e.brands).slice(),r=t&&t.fullVersionList,i=e.mobile||!1,o=n[0],s=(t&&t.platform||e.platform||navigator.platform).toLowerCase(),a={name:o.brand,version:o.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!_e(Re,n).brand||Pe(Ee())},c={name:"unknown",version:"-1",majorVersion:-1};a.webkit=!a.chromium&&be(Te,(function(t){return Oe(n,t)}));var u=_e(Me,n);if(a.chromium=!!u.brand,a.chromiumVersion=u.version,!a.chromium){var l=_e(Te,n);a.webkit=!!l.brand,a.webkitVersion=l.version}var d=we(Ne,(function(t){return new RegExp(""+t.test,"g").exec(s)}));if(c.name=d?d.id:"",t&&(c.version=t.platformVersion),r&&r.length){var h=_e(Ae,r);a.name=h.brand||a.name,a.version=h.version||a.version}else{var f=_e(Ae,n);a.name=f.brand||a.name,a.version=f.brand&&t?t.uaFullVersion:f.version}return a.webkit&&(c.name=i?"ios":"mac"),"ios"===c.name&&a.webview&&(a.version="-1"),c.version=xe(c.version),a.version=xe(a.version),c.majorVersion=parseInt(c.version,10),a.majorVersion=parseInt(a.version,10),{browser:a,os:c,isMobile:i,isHints:!0}}function Ie(t){return"undefined"===typeof t&&De()?Fe():Be(t)}var ze=Ie,je=function(t,e){return je=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},je(t,e)};function Le(t,e){function n(){this.constructor=t}je(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var $e=function(){return $e=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},$e.apply(this,arguments)};function He(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}function Ve(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var We=ze(),Ue="safari"===We.browser.name,qe="infinite-viewer-",Ge=qe+"wrapper",Ke=qe+"scroll-area",Ye=qe+"scroll-bar",Xe=qe+"horizontal-scroll-bar",Je=qe+"vertical-scroll-bar",Ze=qe+"scroll-thumb",Qe=ye(se(qe,"\n{\n    position: relative;\n    overscroll-behavior: none;\n}\n.wrapper {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    overflow: auto;\n    top: 0;\n    left: 0;\n    will-change: scroll-position;\n}\n.wrapper::-webkit-scrollbar {\n    display: none;\n}\n.scroll-area {\n    position:absolute;\n    top:0;\n    left:0;\n    transform-origin: 0 0;\n}\n.scroll-bar {\n    position:absolute;\n    width: 10px;\n    height: 10px;\n    box-sizing: border-box;\n    right: 0;\n    bottom: 0;\n    overflow: hidden;\n}\n.horizontal-scroll-bar {\n    width: 100%;\n    height: 14px;\n}\n.vertical-scroll-bar {\n    height: 100%;\n    width: 14px;\n}\n.scroll-thumb {\n    position:relative;\n    opacity: 0.7;\n    background: #333;\n    border-radius: 3px;\n    left: 0px;\n    top: 0px;\n    z-index: 10;\n    width: 6px;\n    height: 6px;\n    transition: all ease 0.2s;\n}\n.horizontal-scroll-bar .scroll-thumb {\n    margin: 4px 0px;\n    transition-property: margin, height, border-radius;\n}\n.vertical-scroll-bar .scroll-thumb {\n    margin: 0px 4px;\n    transition-property: margin, width, border-radius;\n}\n.horizontal-scroll-bar:hover .scroll-thumb {\n    height: 10px;\n    margin: 2px 0px;\n    border-radius: 5px;\n}\n.vertical-scroll-bar:hover .scroll-thumb {\n    width: 10px;\n    margin: 0px 2px;\n    border-radius: 5px;\n}\n")),tn={margin:500,threshold:100,zoom:1,rangeX:[-1/0,1/0],rangeY:[-1/0,1/0],rangeOffsetX:[0,0],rangeOffsetY:[0,0],wrapperElement:null,scrollAreaElement:null,horizontalScrollElement:null,verticalScrollElement:null,usePinch:!1,pinchThreshold:30,cspNonce:"",maxPinchWheel:1/0,wheelScale:.01,displayHorizontalScroll:!0,displayVerticalScroll:!0,useTransform:!0,useWheelPinch:!0,useWheelScroll:Ue,zoomOffsetX:"50%",zoomOffsetY:"50%",translateZ:0,useGesture:!0},en=Qe.className,nn=["margin","threshold","zoomOffsetX","zoomOffsetY","zoom","rangeX","rangeY","rangeOffsetX","rangeOffsetY","usePinch","pinchThreshold","maxPinchWheel","wheelScale","displayVerticalScroll","displayHorizontalScroll","useWheelScroll","translateZ"],rn=Ve(nn,["useWheel","useGesture","cspNonce","wrapperElement","scrollAreaElement","verticalScrollElement","horizontalScrollElement"]),on=(Boolean,Boolean,Boolean,Boolean,Boolean,Boolean,Boolean,["scroll","abortPinch","dragStart","dragEnd","pinchStart","pinch"]),sn=["getScrollLeft","getScrollTop","getScrollWidth","getScrollHeight","scrollTo","scrollBy","scrollCenter","getContainer","getViewport","getWrapper","setZoom","getRangeX","getRangeY"],an=1e-6;function cn(t){var e=t.deltaX,n=t.deltaY,r=t.datas,i=Date.now(),o=r.speed;if(!o)return r.speed=[0,0],void(r.time=i);var s=i-r.time;r.speed=[o[0]/2+e/s,o[1]/2+n/s]}function un(t,e){var n=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return Math.abs(n/e)}function ln(t,e){var n=un(t,e);return[t[0]/2*n,t[1]/2*n]}function dn(t){return Math.abs(t)}function hn(t,e,n,r,i){var o=i||isFinite(n[0])?n[0]:Math.min(-1,Math.floor(t/e))*e-r,s=i||isFinite(n[1])?n[1]:Math.max(1,Math.ceil(t/e))*e+r;return[o,s]}var fn=function(t){function e(e,n){var r=t.call(this)||this;r.type=e,r.isAppend=!1,r.pos=0,r.size=0,r.scrollSize=0,r.isHorizontal=!1,r.onWheel=function(t){var e=r.isHorizontal?t.deltaX:t.deltaY;e&&t.preventDefault(),r.trigger("scroll",{delta:e})};var i,o="horizontal"===e,s=n;return n?i=n.querySelector("."+Ze):(s=document.createElement("div"),i=document.createElement("div"),s.insertBefore(i,null),r.isAppend=!0),Bt(s,o?Xe:Je),Bt(s,Ye),Bt(i,Ze),r.thumbElement=i,r.barElement=s,r.isHorizontal=o,r.gesto=new ie(s,{container:window}).on("dragStart",(function(t){var e=t.inputEvent.target,n=t.datas,i=r.thumbElement===e;i||setTimeout((function(){requestAnimationFrame((function(){var e=r.thumbElement.getBoundingClientRect(),n=e[o?"left":"top"],i=e[o?"width":"height"],s=n+i,a=t[o?"clientX":"clientY"];if(!(n<=a&&a<=s)){var c=r.size,u=c*c/r.scrollSize;r.scrollBy(n<a?u:-u)}}))}),100),n.isThumb=i,t.inputEvent.stopPropagation(),t.inputEvent.preventDefault()})).on("drag",(function(t){t.datas.isThumb&&r.scrollBy(r.isHorizontal?t.deltaX:t.deltaY)})),It(r.barElement,"wheel",r.onWheel,{passive:!1}),r}Le(e,t);var n=e.prototype;return n.scrollBy=function(t){var e=t/this.size;this.trigger("scroll",{delta:this.scrollSize*e})},n.render=function(t,e,n,r){this.pos=e,this.size=n,this.scrollSize=r;var i=t&&r>n?"block":"none",o=this.isHorizontal?["X","width"]:["Y","height"],s=o[0],a=o[1];this.barElement.style.cssText="display: "+i+";",this.thumbElement.style.cssText+=a+": "+n*n/r+"px;transform: translate"+s+"("+e/r*n+"px)"},n.destroy=function(){zt(this.barElement,"wheel",this.onWheel),this.gesto.off(),this.off()},e}(Ht),pn=function(t){function e(e,n,r){void 0===r&&(r={});var i=t.call(this)||this;return i.containerElement=e,i.viewportElement=n,i.offsetX=0,i.offsetY=0,i.containerWidth=0,i.containerHeight=0,i.viewportWidth=0,i.viewportHeight=0,i.scrollLeft=0,i.scrollTop=0,i.timer=0,i.tempScale=1,i.dragFlag=!1,i.isLoop=!1,i.resize=function(){var t=i.containerElement,e=t.offsetWidth,n=t.offsetHeight,r=i.viewportElement,o=r.offsetWidth,s=r.offsetHeight;i.containerWidth=e,i.containerHeight=n,i.viewportWidth=o,i.viewportHeight=s},i.onScroll=function(){var t=i.wrapperElement,e=t.scrollLeft,n=t.scrollTop,r=i.zoom,o=void 0===r?tn.zoom:r,s=e-i.scrollLeft,a=n-i.scrollTop,c=i.getScrollLeft(),u=i.getScrollTop();i.isLoop&&(i.isLoop=!1),i.scrollLeft=e,i.scrollTop=n,i.scrollTo(c+s/o,u+a/o)},i.onWheel=function(t){var e=i.options,n=e.maxPinchWheel||1/0;if(e.useWheelPinch&&t.ctrlKey){var r=t.deltaY,o=r>=0?1:-1,s=Math.min(n,Math.abs(r));r=o*s;var a=-r,c=Math.max(1+a*(e.wheelScale||.01),an);i.trigger("pinch",{distance:s,scale:c,rotation:0,zoom:i.zoom*c,inputEvent:t,isWheel:!0})}else{if(!e.useWheelScroll)return;var u=i.zoom,l=t.deltaX;r=t.deltaY;t.shiftKey&&!l&&(l=r,r=0),i.scrollBy(l/u,r/u)}t.preventDefault()},i.onGestureStart=function(t){i.tempScale=i.zoom,t.preventDefault()},i.onGestureChange=function(t){if(t.preventDefault(),!i.gesto.isFlag()&&i.tempScale){var e=t.scale;i.trigger("pinch",{distance:0,scale:e,rotation:t.rotation,zoom:i.tempScale*e,inputEvent:t,isWheel:!0})}else i.tempScale=0},i.options=$e($e({},tn),r),i.init(),i}Le(e,t);var n=e.prototype;return n.getContainer=function(){return this.containerElement},n.getViewport=function(){return this.viewportElement},n.getWrapper=function(){return this.wrapperElement},n.geScrollArea=function(){return this.scrollAreaElement},n.destroy=function(){this.off(),this.gesto.unset(),this.verticalScrollbar.destroy(),this.horizontalScrollbar.destroy(),this.injectResult.destroy();var t=this.containerElement;zt(window,"resize",this.resize),zt(this.wrapperElement,"scroll",this.onScroll),zt(t,"wheel",this.onWheel),zt(t,"tgesturestart",this.onGestureStart),zt(t,"gesturechange",this.onGestureChange),this.gesto=null,this.injectResult=null,this.containerElement=null,this.viewportElement=null,this.options=null},n.getScrollTop=function(t){return this.scrollTop/this.zoom+this.offsetY+(t?dn(this.getRangeY()[0]):0)},n.getScrollLeft=function(t){return this.scrollLeft/this.zoom+this.offsetX+(t?dn(this.getRangeX()[0]):0)},n.getScrollWidth=function(t){var e=this.getRangeX(t);return this.containerWidth+dn(e[0])+dn(e[1])},n.getScrollHeight=function(t){var e=this.getRangeY(t);return this.containerHeight+dn(e[0])+dn(e[1])},n.scrollCenter=function(){this.resize();var t=this.zoom,e=-(this.containerWidth/t-this.viewportWidth)/2,n=-(this.containerHeight/t-this.viewportHeight)/2;return this.scrollTo(e,n)},n.scrollBy=function(t,e){return this.scrollTo(this.getScrollLeft()+t,this.getScrollTop()+e)},n.scrollTo=function(t,e){var n=this,r=this,i=r.zoom,o=void 0===i?tn.zoom:i,s=r.margin,a=void 0===s?tn.margin:s,c=r.threshold,u=void 0===c?tn.threshold:c,l=r.scrollLeft,d=r.scrollTop,h=this.getRangeX(!0,!0),f=h[0],p=h[1],g=this.getRangeY(!0,!0),m=g[0],v=g[1],y=Math.round(l),b=Math.round(d),w=this.getScrollAreaWidth(),E=this.getScrollAreaHeight(),S=t*o,D=e*o;if(S-u<=f){var k=Math.max(0,S-f);y=k,t=(f+k)/o}else if(S+u>=p){var x=Math.max(0,p-S);y=w-x,t=(p-x)/o}else y<u?y+=a:y>w-u&&(y-=a);if(D-u<=m){k=Math.max(0,D-m);b=k,e=(m+k)/o}else if(D+u>=v){x=Math.max(0,v-D);b=E-x,e=(v-x)/o}else b<u?b+=a:b>E-u&&(b-=a);y=Math.round(y),b=Math.round(b),this.scrollLeft=y,this.scrollTop=b,this.offsetX=Math.round(t-y/o),this.offsetY=Math.round(e-b/o),this.render();var C=this.getScrollLeft(),_=this.getScrollTop();return this.trigger("scroll",{scrollLeft:C,scrollTop:_}),Math.round(l)===y&&Math.round(d)===b||(this.isLoop=!0,this.move(y,b),requestAnimationFrame((function(){if(n.isLoop){n.isLoop=!1;var t=n.wrapperElement,e=t.scrollLeft,r=t.scrollTop;n.scrollLeft=e,n.scrollTop=r,y===Math.round(e)&&b===Math.round(r)||n.scrollTo(C,_)}})),!1)},n.setZoom=function(t){var e=this,n=e.containerWidth,r=e.containerHeight,i=e.zoomOffsetX,o=void 0===i?tn.zoomOffsetX:i,s=e.zoomOffsetY,a=void 0===s?tn.zoomOffsetY:s,c=e.zoom,u=this.getScrollLeft(),l=this.getScrollTop();this.options.zoom=t;var d=this.getScrollLeft(),h=this.getScrollTop(),f=St(""+o,n),p=St(""+a,r),g=u+f/c,m=l+p/c,v=d+f/t,y=h+p/t;this.scrollBy(g-v,m-y),this.render()},n.getRangeX=function(t,e){var n=this,r=n.rangeX,i=void 0===r?tn.rangeX:r,o=n.rangeOffsetX,s=void 0===o?tn.rangeOffsetX:o,a=n.margin,c=void 0===a?tn.margin:a,u=n.zoom,l=void 0===u?tn.zoom:u,d=n.threshold,h=hn(this.getScrollLeft(),c,i,d,e);return t?[h[0]*l+s[0],Math.max(this.viewportWidth*l-this.containerWidth,h[1]*l+s[1])]:[h[0]+s[0],h[1]+s[1]]},n.getRangeY=function(t,e){var n=this,r=n.rangeY,i=void 0===r?tn.rangeY:r,o=n.margin,s=void 0===o?tn.margin:o,a=n.zoom,c=void 0===a?tn.zoom:a,u=n.threshold,l=hn(this.getScrollTop(),s,i,u,e);return t?[l[0]*c,Math.max(this.viewportHeight*c-this.containerHeight,l[1]*c)]:l},n.init=function(){var t=this,e=this.containerElement,n=this.options,r=n.wrapperElement||e.querySelector("."+Ge),i=n.scrollAreaElement||e.querySelector("."+Ke),o=n.horizontalScrollElement||e.querySelector("."+Xe),s=n.verticalScrollElement||e.querySelector("."+Je);r||(r=document.createElement("div"),r.insertBefore(this.viewportElement,null),e.insertBefore(r,null)),this.wrapperElement=r,i||(i=document.createElement("div"),r.insertBefore(i,r.firstChild)),this.scrollAreaElement=i,Bt(e,en),Bt(r,Ge),Bt(i,Ke),this.horizontalScrollbar=new fn("horizontal",o),this.verticalScrollbar=new fn("vertical",s),this.horizontalScrollbar.on("scroll",(function(e){t.scrollBy(e.delta/t.zoom,0)})),this.verticalScrollbar.on("scroll",(function(e){t.scrollBy(0,e.delta/t.zoom)})),this.horizontalScrollbar.isAppend&&e.insertBefore(this.horizontalScrollbar.barElement,null),this.verticalScrollbar.isAppend&&e.insertBefore(this.verticalScrollbar.barElement,null),this.injectResult=Qe.inject(e,{nonce:this.options.cspNonce}),this.gesto=new ie(e,{container:document.body,events:["touch"]}).on("dragStart",(function(e){var n=e.inputEvent,r=e.datas,i=e.stop;t.pauseAnimation(),t.dragFlag=!1;var o=t.trigger("dragStart",{inputEvent:n});!1!==o?(n.preventDefault(),r.startEvent=n):i()})).on("drag",(function(e){if(!t.options.usePinch||e.isPinch){t.trigger("drag",$e($e({},e),{inputEvent:e.inputEvent})),cn(e);var r=t.zoom;t.scrollBy(-e.deltaX/r,-e.deltaY/r)}else!t.dragFlag&&e.movement>n.pinchThreshold&&(t.dragFlag=!0,t.trigger("abortPinch",{inputEvent:e.datas.startEvent||e.inputEvent}))})).on("dragEnd",(function(e){t.trigger("dragEnd",{isDrag:e.isDrag,isDouble:e.isDouble,inputEvent:e.inputEvent}),t.startAnimation(e.datas.speed)})).on("pinchStart",(function(e){var n=e.inputEvent,r=e.datas,i=e.stop;n.preventDefault(),t.pauseAnimation(),r.startZoom=t.zoom;var o=t.trigger("pinchStart",{inputEvent:n});!1===o&&i()})).on("pinch",(function(e){t.trigger("pinch",{rotation:e.rotation,distance:e.distance,scale:e.scale,zoom:e.datas.startZoom*e.scale,inputEvent:e.inputEvent,isWheel:!1})})),It(r,"scroll",this.onScroll),It(window,"resize",this.resize),(n.useWheelPinch||n.useWheelScroll)&&It(e,"wheel",this.onWheel,{passive:!1}),n.useGesture&&(It(e,"gesturestart",this.onGestureStart,{passive:!1}),It(e,"gesturechange",this.onGestureChange,{passive:!1})),this.resize(),this.render(),this.scrollTo(0,0)},n.render=function(){var t=this,e=t.offsetX,n=t.offsetY,r=t.zoom,i=void 0===r?tn.zoom:r,o=t.translateZ,s=void 0===o?0:o,a=this.options.useTransform,c=void 0===a?tn.useTransform:a,u=-e*i,l=-n*i;this.scrollAreaElement.style.cssText="width:calc(100% + "+this.getScrollAreaWidth()+"px);height:calc(100% + "+this.getScrollAreaHeight()+"px);";var d=this.viewportElement.style;d.cssText+=!1===c?"position: relative; top: "+l+"px; left: "+u+"px;":"transform-origin: 0 0;transform:translate3d("+u+"px, "+l+"px, "+s+"px) scale("+i+");",this.renderScroll()},n.renderScroll=function(){var t=this,e=t.containerWidth,n=t.containerHeight,r=t.zoom,i=this.getScrollLeft(!0)*r,o=this.getScrollTop(!0)*r,s=this.getScrollWidth(!0),a=this.getScrollHeight(!0);this.horizontalScrollbar.render(this.displayHorizontalScroll,i,e,s),this.verticalScrollbar.render(this.displayVerticalScroll,o,n,a)},n.move=function(t,e){var n=this.wrapperElement;n.scrollLeft=t,n.scrollTop=e},n.startAnimation=function(t){var e=this;if(t&&(t[0]||t[1])){var n=-6e-4,r=function(t){return 1-Math.pow(1-t,3)},i=un(t,n),o=ln(t,n),s=Date.now(),a=s,c=function(){var t=Date.now(),n=t-s;i<n&&(n=i);var u=r(n/i),l=r((a-s)/i);a=t,e.scrollBy(-o[0]*(u-l),-o[1]*(u-l)),n>=i||(e.timer=requestAnimationFrame(c))};this.timer=requestAnimationFrame(c)}},n.pauseAnimation=function(){cancelAnimationFrame(this.timer)},n.getScrollAreaWidth=function(){var t=this.getRangeX(!0),e=t[0],n=t[1];return e||n?2*this.margin:0},n.getScrollAreaHeight=function(){var t=this.getRangeY(!0),e=t[0],n=t[1];return e||n?2*this.margin:0},e=He([ue(nn,(function(t,e){var n={enumerable:!0,configurable:!0,get:function(){return this.options[e]}},r=pt("set "+e);t[r]?n.set=function(t){this[r](t)}:n.set=function(t){this.options[e]=t},Object.defineProperty(t,e,n)}))],e),e}(Ht),gn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Le(e,t),e}(pn),mn=gn,vn=function(){return vn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},vn.apply(this,arguments)},yn={};sn.forEach((function(t){yn[t]=function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];(e=this.infiniteViewer)[t].apply(e,n)}}));var bn={name:"infinite-viewer",methods:yn,props:rn,mounted:function(){var t=this,e={},n=this.$props;rn.forEach((function(t){var r=n[t];Q(r)||(e[t]=n[t])}));var r=this.$refs;this.infiniteViewer=new mn(r.containerElement,r.scrollAreaElement.nextElementSibling,vn(vn({},e),{wrapperElement:r.wrapperElement,scrollAreaElement:r.scrollAreaElement,horizontalScrollElement:r.horizontalScrollElement,verticalScrollElement:r.verticalScrollElement}));var i=this.infiniteViewer;on.forEach((function(e){i.on(e,(function(n){t.$emit(e,vn({},n))}))}))},updated:function(){var t=this.$props,e=this.infiniteViewer;nn.forEach((function(n){var r=t[n];e[n]===r||Q(r)||(e[n]=t[n])}))},beforeUnmount:function(){this.infiniteViewer.destroy()}};const wn={ref:"containerElement"},En={ref:"wrapperElement"},Sn={ref:"scrollAreaElement"},Dn={ref:"horizontalScrollElement"},kn=(0,o.Wm)("div",{class:"infinite-viewer-scroll-thumb"},null,-1),xn={ref:"verticalScrollElement"},Cn=(0,o.Wm)("div",{class:"infinite-viewer-scroll-thumb"},null,-1);function _n(t,e,n,r,i,s){return(0,o.wg)(),(0,o.j4)("div",wn,[(0,o.Wm)("div",En,[(0,o.Wm)("div",Sn,null,512),(0,o.WI)(t.$slots,"default")],512),(0,o.Wm)("div",Dn,[kn],512),(0,o.Wm)("div",xn,[Cn],512)],512)}bn.render=_n,bn.__file="src/InfiniteViewer.vue";var On=function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,e){var n=this.keys,r=this.values,i=n.indexOf(t),o=-1===i?n.length:i;n[o]=t,r[o]=e},t}(),An=function(){function t(){this.object={}}var e=t.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,e){this.object[t]=e},t}(),Mn="function"===typeof Map,Tn=function(){function t(){}var e=t.prototype;return e.connect=function(t,e){this.prev=t,this.next=e,t&&(t.next=this),e&&(e.prev=this)},e.disconnect=function(){var t=this.prev,e=this.next;t&&(t.next=e),e&&(e.prev=t)},e.getIndex=function(){var t=this,e=-1;while(t)t=t.prev,++e;return e},t}();function Rn(t,e){var n=[],r=[];return t.forEach((function(t){var e=t[0],i=t[1],o=new Tn;n[e]=o,r[i]=o})),n.forEach((function(t,e){t.connect(n[e-1])})),t.filter((function(t,n){return!e[n]})).map((function(t,e){var i=t[0],o=t[1];if(i===o)return[0,0];var s=n[i],a=r[o-1],c=s.getIndex();s.disconnect(),a?s.connect(a,a.next):s.connect(void 0,n[0]);var u=s.getIndex();return[c,u]}))}var Nn=function(){function t(t,e,n,r,i,o,s,a){this.prevList=t,this.list=e,this.added=n,this.removed=r,this.changed=i,this.maintained=o,this.changedBeforeAdded=s,this.fixed=a}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t=Rn(this.changedBeforeAdded,this.fixed),e=this.changed,n=[];this.cacheOrdered=t.filter((function(t,r){var i=t[0],o=t[1],s=e[r],a=s[0],c=s[1];if(i!==o)return n.push([a,c]),!0})),this.cachePureChanged=n},t}();function Pn(t,e,n){var r=Mn?Map:n?An:On,i=n||function(t){return t},o=[],s=[],a=[],c=t.map(i),u=e.map(i),l=new r,d=new r,h=[],f=[],p={},g=[],m=0,v=0;return c.forEach((function(t,e){l.set(t,e)})),u.forEach((function(t,e){d.set(t,e)})),c.forEach((function(t,e){var n=d.get(t);"undefined"===typeof n?(++v,s.push(e)):p[n]=v})),u.forEach((function(t,e){var n=l.get(t);"undefined"===typeof n?(o.push(e),++m):(a.push([n,e]),v=p[e]||0,h.push([n-v,e-m]),f.push(e===n),n!==e&&g.push([n,e]))})),s.reverse(),new Nn(t,e,o,s,g,a,h,f)}var Bn=function(){function t(t,e){void 0===t&&(t=[]),this.findKeyCallback=e,this.list=[].slice.call(t)}var e=t.prototype;return e.update=function(t){var e=[].slice.call(t),n=Pn(this.list,e,this.findKeyCallback);return this.list=e,n},t}(),Fn=Bn,In=function(t,e){return In=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},In(t,e)};function zn(t,e){function n(){this.constructor=t}In(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var jn=function(){return jn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},jn.apply(this,arguments)};function Ln(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function $n(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function Hn(t,e){if(t===e)return!1;for(var n in t)if(!(n in e))return!0;for(var n in e)if(t[n]!==e[n])return!0;return!1}function Vn(t,e){var n=Object.keys(t),r=Object.keys(e),i=Pn(n,r,(function(t){return t})),o={},s={},a={};return i.added.forEach((function(t){var n=r[t];o[n]=e[n]})),i.removed.forEach((function(e){var r=n[e];s[r]=t[r]})),i.maintained.forEach((function(r){var i=r[0],o=n[i],s=[t[o],e[o]];t[o]!==e[o]&&(a[o]=s)})),{added:o,removed:s,changed:a}}function Wn(t){t.forEach((function(t){t()}))}function Un(t){var e=0;return t.map((function(t){return null==t?"$compat"+ ++e:""+t}))}function qn(t,e,n,r){if(nt(t)||rt(t))return new nr("text_"+t,e,n,r,null,{});var i="string"===typeof t.type?rr:t.type.prototype.render?cr:sr;return new i(t.type,e,n,r,t.ref,t.props)}function Gn(t){var e=[];return t.forEach((function(t){e=e.concat(et(t)?Gn(t):t)})),e}function Kn(t){var e=t.className,n=Ln(t,["className"]);return null!=e&&(n.class=e),delete n.style,delete n.children,n}function Yn(t,e){if(!e)return t;for(var n in e)Q(t[n])&&(t[n]=e[n]);return t}function Xn(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=e||{},o=i.key,s=i.ref,a=Ln(i,["key","ref"]);return{type:t,key:o,ref:s,props:jn(jn({},a),{children:Gn(n).filter((function(t){return null!=t&&!1!==t}))})}}var Jn=function(){function t(t,e,n,r,i,o){void 0===o&&(o={}),this.type=t,this.key=e,this.index=n,this.container=r,this.ref=i,this.props=o,this._providers=[]}var e=t.prototype;return e._should=function(t,e){return!0},e._update=function(t,e,n,r){if(this.base&&!nt(e)&&!r&&!this._should(e.props,n))return!1;this.original=e,this._setState(n);var i=this.props;return nt(e)||(this.props=e.props,this.ref=e.ref),this._render(t,this.base?i:{},n),!0},e._mounted=function(){var t=this.ref;t&&t(this.base)},e._setState=function(t){},e._updated=function(){var t=this.ref;t&&t(this.base)},e._destroy=function(){var t=this.ref;t&&t(null)},t}();function Zn(t,e,n){var r=Vn(t,e),i=r.added,o=r.removed,s=r.changed;for(var a in i)n.setAttribute(a,i[a]);for(var a in s)n.setAttribute(a,s[a][1]);for(var a in o)n.removeAttribute(a)}function Qn(t,e,n){var r=Vn(t,e),i=r.added,o=r.removed,s=r.changed;for(var a in o)n.removeEventListener(a);for(var a in i)n.addEventListener(a,i[a]);for(var a in s)n.removeEventListener(a),n.addEventListener(a,s[a][1]);for(var a in o)n.removeEventListener(a)}function tr(t,e,n){var r=n.style,i=Vn(t,e),o=i.added,s=i.removed,a=i.changed;for(var c in o){var u=gt(c,"-");r.setProperty?r.setProperty(u,o[c]):r[u]=o[c]}for(var c in a){u=gt(c,"-");r.setProperty?r.setProperty(u,a[c][1]):r[u]=a[c][1]}for(var c in s){u=gt(c,"-");r.removeProperty?r.removeProperty(u):r[u]=""}}function er(t){var e={},n={};for(var r in t)0===r.indexOf("on")?n[r.replace("on","").toLowerCase()]=t[r]:e[r]=t[r];return{attributes:e,events:n}}var nr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}zn(e,t);var n=e.prototype;return n._render=function(t){var e=this,n=!this.base;return n&&(this.base=document.createTextNode(this.type.replace("text_",""))),t.push((function(){n?e._mounted():e._updated()})),!0},n._unmount=function(){this.base.parentNode.removeChild(this.base)},e}(Jn),rr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.events={},e._isSVG=!1,e}zn(e,t);var n=e.prototype;return n.addEventListener=function(t,e){var n=this.events;n[t]=function(t){t.nativeEvent=t,e(t)},this.base.addEventListener(t,n[t])},n.removeEventListener=function(t){var e=this.events;this.base.removeEventListener(t,e[t]),delete e[t]},n._should=function(t){return Hn(this.props,t)},n._render=function(t,e){var n=this,r=!this.base;if(r){var i=this._hasSVG();this._isSVG=i;var o=this.props.portalContainer;if(!o){var s=this.type;o=i?document.createElementNS("http://www.w3.org/2000/svg",s):document.createElement(s)}this.base=o}gr(this,this._providers,this.props.children,t,null);var a=this.base,c=er(e),u=c.attributes,l=c.events,d=er(this.props),h=d.attributes,f=d.events;return Zn(Kn(u),Kn(h),a),Qn(l,f,this),tr(e.style||{},this.props.style||{},a),t.push((function(){r?n._mounted():n._updated()})),!0},n._unmount=function(){var t=this.events,e=this.base;for(var n in t)e.removeEventListener(n,t[n]);this._providers.forEach((function(t){t._unmount()})),this.events={},this.props.portalContainer||e.parentNode.removeChild(e)},n._hasSVG=function(){if(this._isSVG||"svg"===this.type)return!0;var t=ir(this.container);return t&&"ownerSVGElement"in t},e}(Jn);function ir(t){if(!t)return null;var e=t.base;return e instanceof Node?e:ir(t.container)}function or(t){if(!t)return null;if(t instanceof Node)return t;var e=t.$_provider._providers;return e.length?or(e[0].base):null}var sr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}zn(e,t);var n=e.prototype;return n._render=function(t){var e=this.type(this.props);return gr(this,this._providers,e?[e]:[],t),!0},n._unmount=function(){this._providers.forEach((function(t){t._unmount()}))},e}(Jn),ar=function(t){function e(e){var n=t.call(this,"container","container",0,null)||this;return n.base=e,n}zn(e,t);var n=e.prototype;return n._render=function(){return!0},n._unmount=function(){},e}(Jn),cr=function(t){function e(e,n,r,i,o,s){return void 0===s&&(s={}),t.call(this,e,n,r,i,o,Yn(s,e.defaultProps))||this}zn(e,t);var n=e.prototype;return n._should=function(t,e){return this.base.shouldComponentUpdate(Yn(t,this.type.defaultProps),e||this.base.state)},n._render=function(t,e,n){var r=this;this.props=Yn(this.props,this.type.defaultProps);var i=!this.base;i?(this.base=new this.type(this.props),this.base.$_provider=this):this.base.props=this.props;var o=this.base,s=o.state,a=o.render();a&&a.props&&!a.props.children.length&&(a.props.children=this.props.children),gr(this,this._providers,a?[a]:[],t,n,null),t.push((function(){i?(r._mounted(),o.componentDidMount()):(r._updated(),o.componentDidUpdate(e,s))}))},n._setState=function(t){var e=this.base;e&&t&&(e.state=t)},n._unmount=function(){this._providers.forEach((function(t){t._unmount()})),clearTimeout(this.base.$_timer),this.base.componentWillUnmount()},e}(Jn),ur=function(){function t(t){void 0===t&&(t={}),this.props=t,this.state={},this.$_timer=0,this.$_state={}}var e=t.prototype;return e.shouldComponentUpdate=function(t,e){return!0},e.render=function(){return null},e.setState=function(t,e,n){var r=this;this.$_timer||(this.$_state={}),clearTimeout(this.$_timer),this.$_timer=0,this.$_state=jn(jn({},this.$_state),t),n?this.$_setState(e,n):this.$_timer=setTimeout((function(){r.$_timer=0,r.$_setState(e,n)}))},e.forceUpdate=function(t){this.setState({},t,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(t,e){},e.componentWillUnmount=function(){},e.$_setState=function(t,e){var n=[],r=this.$_provider,i=gr(r.container,[r],[r.original],n,jn(jn({},this.state),this.$_state),e);i&&(t&&n.push(t),Wn(n))},t}(),lr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}zn(e,t);var n=e.prototype;return n.shouldComponentUpdate=function(t,e){return Hn(this.props,t)||Hn(this.state,e)},e}(ur),dr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}zn(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this.props,e=t.element,n=t.container;this._portalProvider=new ar(n),mr(e,n,this._portalProvider)},n.componentDidUpdate=function(){var t=this.props,e=t.element,n=t.container;mr(e,n,this._portalProvider)},n.componentWillUnmount=function(){var t=this.props.container;mr(null,t,this._portalProvider),this._portalProvider=null},e}(lr);function hr(t,e,n){var r=[];gr(t,t._providers,e,r,n),Wn(r)}function fr(t,e){for(var n=t._providers,r=n.length,i=e.index+1;i<r;++i){var o=or(n[i].base);if(o)return o}return null}function pr(t,e,n){var r=n.map((function(t){return nt(t)?null:t.key})),i=Un(e.map((function(t){return t.key}))),o=Un(r),s=Pn(i,o,(function(t){return t}));s.removed.forEach((function(t){e.splice(t,1)[0]._unmount()})),s.ordered.forEach((function(t){var n=t[0],r=t[1],i=e.splice(n,1)[0];e.splice(r,0,i);var o=or(i.base),s=or(e[r+1]&&e[r+1].base);o&&o.parentNode.insertBefore(o,s)})),s.added.forEach((function(i){e.splice(i,0,qn(n[i],r[i],i,t))}));var a=s.maintained.filter((function(i){i[0];var o=i[1],s=n[o],a=e[o],c=nt(s)?"text_"+s:s.type;return c!==a.type?(a._unmount(),e.splice(o,1,qn(s,r[o],o,t)),!0):(a.index=o,!1)}));return $n(s.added,a.map((function(t){t[0];var e=t[1];return e})))}function gr(t,e,n,r,i,o){var s=pr(t,e,n),a=e.filter((function(t,e){return t._update(r,n[e],i,o)})),c=ir(t);return c&&s.reverse().forEach((function(n){var r=e[n],i=or(r.base);if(i&&c!==i&&!i.parentNode){var o=fr(t,r);c.insertBefore(i,o)}})),a.length>0}function mr(t,e,n){void 0===n&&(n=e.__REACT_COMPAT__);var r=!!n;return n||(n=new ar(e)),hr(n,t?[t]:[]),r||(e.__REACT_COMPAT__=n),n}function vr(t,e,n){var r=e.__REACT_COMPAT__;t&&!r&&(e.innerHTML=""),mr(t,e,r),n&&n()}function yr(t,e){return Xn(dr,{element:t,container:e})}var br="simple-1.1.0";function wr(t,e,n,r,i,o){for(var s=0;s<i;++s){var a=n+s*i,c=r+s*i;t[a]+=t[c]*o,e[a]+=e[c]*o}}function Er(t,e,n,r,i){for(var o=0;o<i;++o){var s=n+o*i,a=r+o*i,c=t[s],u=e[s];t[s]=t[a],t[a]=c,e[s]=e[a],e[a]=u}}function Sr(t,e,n,r,i){for(var o=0;o<r;++o){var s=n+o*r;t[s]/=i,e[s]/=i}}function Dr(t,e,n){void 0===n&&(n=Math.sqrt(t.length));for(var r=t.slice(),i=0;i<n;++i)r[i*n+e-1]=0,r[(e-1)*n+i]=0;return r[(e-1)*(n+1)]=1,r}function kr(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=t.slice(),r=Ur(e),i=0;i<e;++i){var o=e*i+i;if(!Rt(n[o],X))for(var s=i+1;s<e;++s)if(n[e*i+s]){Er(n,r,i,s,e);break}if(!Rt(n[o],X))return[];Sr(n,r,i,e,n[o]);for(s=0;s<e;++s){var a=s,c=s+i*e,u=n[c];Rt(u,X)&&i!==s&&wr(n,r,a,i,e,-u)}}return r}function xr(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=[],r=0;r<e;++r)for(var i=0;i<e;++i)n[i*e+r]=t[e*r+i];return n}function Cr(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=[],r=t[e*e-1],i=0;i<e-1;++i)n[i]=t[e*(e-1)+i]/r;return n[e-1]=0,n}function _r(t,e){for(var n=Ur(e),r=0;r<e-1;++r)n[e*(e-1)+r]=t[r]||0;return n}function Or(t,e){for(var n=t.slice(),r=t.length;r<e-1;++r)n[r]=0;return n[e-1]=1,n}function Ar(t,e,n){if(void 0===e&&(e=Math.sqrt(t.length)),e===n)return t;for(var r=Ur(n),i=Math.min(e,n),o=0;o<i-1;++o){for(var s=0;s<i-1;++s)r[o*n+s]=t[o*e+s];r[(o+1)*n-1]=t[(o+1)*e-1],r[(n-1)*n+o]=t[(e-1)*e+o]}return r[n*n-1]=t[e*e-1],r}function Mr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=Ur(t);return e.forEach((function(e){r=Tr(r,e,t)})),r}function Tr(t,e,n){void 0===n&&(n=Math.sqrt(t.length));var r=[],i=t.length/n,o=e.length/i;if(!i)return e;if(!o)return t;for(var s=0;s<n;++s)for(var a=0;a<o;++a){r[a*n+s]=0;for(var c=0;c<i;++c)r[a*n+s]+=t[c*n+s]*e[a*i+c]}return r}function Rr(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]+e[i];return r}function Nr(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]-e[i];return r}function Pr(t,e){return void 0===e&&(e=6===t.length),e?[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]:t}function Br(t,e){return void 0===e&&(e=9===t.length),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function Fr(t,e,n){void 0===n&&(n=e.length);var r=Tr(t,e,n),i=r[n-1];return r.map((function(t){return t/i}))}function Ir(t,e){return Tr(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function zr(t,e){return Tr(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function jr(t,e){return Tr(t,Wr(e,4))}function Lr(t,e){var n=e[0],r=void 0===n?1:n,i=e[1],o=void 0===i?1:i,s=e[2],a=void 0===s?1:s;return Tr(t,[r,0,0,0,0,o,0,0,0,0,a,0,0,0,0,1],4)}function $r(t,e){return Fr(Wr(e,3),Or(t,3))}function Hr(t,e){var n=e[0],r=void 0===n?0:n,i=e[1],o=void 0===i?0:i,s=e[2],a=void 0===s?0:s;return Tr(t,[1,0,0,0,0,1,0,0,0,0,1,0,r,o,a,1],4)}function Vr(t,e){return Tr(t,e,4)}function Wr(t,e){var n=Math.cos(t),r=Math.sin(t),i=Ur(e);return i[0]=n,i[1]=r,i[e]=-r,i[e+1]=n,i}function Ur(t){for(var e=t*t,n=[],r=0;r<e;++r)n[r]=r%(t+1)?0:1;return n}function qr(t,e){for(var n=Ur(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[(e+1)*i]=t[i];return n}function Gr(t,e){for(var n=Ur(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[e*(e-1)+i]=t[i];return n}function Kr(t,e,n,r,i,o,s,a){var c=t[0],u=t[1],l=e[0],d=e[1],h=n[0],f=n[1],p=r[0],g=r[1],m=i[0],v=i[1],y=o[0],b=o[1],w=s[0],E=s[1],S=a[0],D=a[1],k=[c,0,l,0,h,0,p,0,u,0,d,0,f,0,g,0,1,0,1,0,1,0,1,0,0,c,0,l,0,h,0,p,0,u,0,d,0,f,0,g,0,1,0,1,0,1,0,1,-m*c,-v*c,-y*l,-b*l,-w*h,-E*h,-S*p,-D*p,-m*u,-v*u,-y*d,-b*d,-w*f,-E*f,-S*g,-D*g],x=kr(k,8);if(!x.length)return[];var C=Tr(x,[m,v,y,b,w,E,S,D],8);return C[8]=1,Ar(xr(C),3,4)}function Yr(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Xr(t){return Qr(ti(t))}function Jr(t,e){var n=Fr(t,[e[0],e[1]||0,e[2]||0,1],4),r=n[3]||1;return[n[0]/r,n[1]/r,n[2]/r]}function Zr(t,e){void 0===e&&(e=document.body);var n=t,r=Yr();while(n){var i=getComputedStyle(n).transform;if(r=Vr(Xr(i),r),n===e)break;n=n.parentElement}return r=kr(r,4),r[12]=0,r[13]=0,r[14]=0,r}function Qr(t){var e=Yr();return t.forEach((function(t){var n=t.matrixFunction,r=t.functionValue;n&&(e=n(e,r))})),e}function ti(t){var e=et(t)?t:lt(t);return e.map((function(t){var e=ht(t),n=e.prefix,r=e.value,i=null,o=n,s="";if("translate"===n||"translateX"===n||"translate3d"===n){var a=dt(r).map((function(t){return parseFloat(t)})),c=a[0],u=a[1],l=void 0===u?0:u,d=a[2],h=void 0===d?0:d;i=Hr,s=[c,l,h]}else if("translateY"===n){l=parseFloat(r);i=Hr,s=[0,l,0]}else if("translateZ"===n){h=parseFloat(r);i=Hr,s=[0,0,h]}else if("scale"===n||"scale3d"===n){var f=dt(r).map((function(t){return parseFloat(t)})),p=f[0],g=f[1],m=void 0===g?p:g,v=f[2],y=void 0===v?1:v;i=Lr,s=[p,m,y]}else if("scaleX"===n){p=parseFloat(r);i=Lr,s=[p,1,1]}else if("scaleY"===n){m=parseFloat(r);i=Lr,s=[1,m,1]}else if("scaleZ"===n){y=parseFloat(r);i=Lr,s=[1,1,y]}else if("rotate"===n||"rotateZ"===n||"rotateX"===n||"rotateY"===n){var b=ft(r),w=b.unit,E=b.value,S="rad"===w?E:E*Math.PI/180;"rotate"===n||"rotateZ"===n?(o="rotateZ",i=jr):"rotateX"===n?i=Ir:"rotateY"===n&&(i=zr),s=S}else if("matrix3d"===n)i=Vr,s=dt(r).map((function(t){return parseFloat(t)}));else if("matrix"===n){var D=dt(r).map((function(t){return parseFloat(t)}));i=Vr,s=[D[0],D[1],0,0,D[2],D[3],0,0,0,0,1,0,D[4],D[5],0,1]}else o="";return{name:n,functionName:o,value:r,matrixFunction:i,functionValue:s}}))}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var ei=function(t,e){return ei=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},ei(t,e)};function ni(t,e){function n(){this.constructor=t}ei(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var ri="function"===typeof Map?void 0:function(){var t=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++t)}}(),ii=function(t){function e(e){return void 0===e&&(e=[]),t.call(this,e,ri)||this}return ni(e,t),e}(Fn);function oi(t,e){return Pn(t,e,ri)}var si=ii;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function ai(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function ci(t){return t.length<3?0:Math.abs(Ct(t.map((function(e,n){var r=t[n+1]||t[0];return e[0]*r[1]-r[0]*e[1]}))))/2}function ui(t,e){var n=e.width,r=e.height,i=e.left,o=e.top,s=li(t),a=s.minX,c=s.minY,u=s.maxX,l=s.maxY,d=n/(u-a),h=r/(l-c);return t.map((function(t){return[i+(t[0]-a)*d,o+(t[1]-c)*h]}))}function li(t){var e=t.map((function(t){return t[0]})),n=t.map((function(t){return t[1]}));return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,n),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,n)}}function di(t,e,n){var r=t[0],i=t[1],o=li(e),s=o.minX,a=o.minY,c=o.maxX,u=o.maxY,l=[[s,i],[c,i]],d=[[r,a],[r,u]],h=hi(l[0],l[1]),f=hi(d[0],d[1]),p=gi(e),g=[],m=[];return p.forEach((function(t){var e=hi(t[0],t[1]),n=pi(fi(h,e),[l,t]),o=pi(fi(f,e),[d,t]);1===n.length&&t[0][1]===i||g.push.apply(g,n),1===o.length&&t[0][0]===r||m.push.apply(m,o),e[0]||g.push.apply(g,n),e[1]||m.push.apply(m,o)})),!n&&(vt(g,(function(t){return t[0]===r}))>-1||vt(m,(function(t){return t[1]===i}))>-1)||!!(g.filter((function(t){return t[0]>r})).length%2&&m.filter((function(t){return t[1]>i})).length%2)}function hi(t,e){var n=t[0],r=t[1],i=e[0],o=e[1];if(n===i&&r===o)return[0,0,0];if(n===i)return[1,0,-n];if(r===o)return[0,1,-r];var s=(i-n)/(r-o),a=-n-s*r;return[1,s,a]}function fi(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],a=e[2],c=0===n&&0===o,u=0===r&&0===s;if(c&&u)return[];if(c){var l=-i/r,d=-a/s;return l!==d?[]:[[-1/0,l],[1/0,l]]}if(u){var h=-i/n,f=-a/o;return h!==f?[]:[[h,-1/0],[h,1/0]]}if(0===n){var p=-i/r,g=-(s*p+a)/o;return[[g,p]]}if(0===o){p=-a/s,g=-(r*p+i)/n;return[[g,p]]}if(0===r){g=-i/n,p=-(o*g+a)/s;return[[g,p]]}if(0===s){g=-a/o,p=-(n*g+i)/r;return[[g,p]]}g=(r*a-s*i)/(s*n-r*o),p=-(n*g+i)/r;return[[g,p]]}function pi(t,e){var n=e.map((function(t){return[0,1].map((function(e){return[Math.min(t[0][e],t[1][e]),Math.max(t[0][e],t[1][e])]}))}));if(2===t.length){var r=t[0],i=r[0],o=r[1];if(i===t[1][0]){var s=Math.max.apply(Math,n.map((function(t){return t[1][0]}))),a=Math.min.apply(Math,n.map((function(t){return t[1][1]})));return s>a?[]:[[i,s],[i,a]]}if(o===t[1][1]){var c=Math.max.apply(Math,n.map((function(t){return t[0][0]}))),u=Math.min.apply(Math,n.map((function(t){return t[0][1]})));return c>u?[]:[[c,o],[u,o]]}}return t.filter((function(t){return n.every((function(e){return e[0][0]<=t[0]&&t[0]<=e[0][1]&&e[1][0]<=t[1]&&t[1]<=e[1][1]}))}))}function gi(t){return ai(t.slice(1),[t[0]]).map((function(e,n){return[t[n],e]}))}function mi(t,e){var n=t.slice(),r=e.slice();-1===Mt(n)&&n.reverse(),-1===Mt(r)&&r.reverse();var i=gi(n),o=gi(r),s=i.map((function(t){return hi(t[0],t[1])})),a=o.map((function(t){return hi(t[0],t[1])})),c=[];s.forEach((function(t,e){var n=i[e],s=[];a.forEach((function(r,i){var a=fi(t,r),c=pi(a,[n,o[i]]);s.push.apply(s,c.map((function(t){return{index1:e,index2:i,pos:t}})))})),s.sort((function(t,e){return Tt(n[0],t.pos)-Tt(n[0],e.pos)})),c.push.apply(c,s),di(n[1],r)&&c.push({index1:e,index2:-1,pos:n[1]})})),o.forEach((function(t,e){if(di(t[1],n)){var r=!1,i=vt(c,(function(t){var n=t.index2;return n===e?(r=!0,!1):!!r}));-1===i&&(r=!1,i=vt(c,(function(t){var n=t.index1,i=t.index2;return-1===n&&i+1===e?(r=!0,!1):!!r}))),-1===i?c.push({index1:-1,index2:e,pos:t[1]}):c.splice(i,0,{index1:-1,index2:e,pos:t[1]})}}));var u=c.map((function(t){var e=t.pos;return e})),l={};return u.filter((function(t){var e=t[0]+"x"+t[1];return!l[e]&&(l[e]=!0,!0)}))}function vi(t,e){var n=mi(t,e);return ci(n)}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var yi=function(t,e){return yi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},yi(t,e)};function bi(t,e){function n(){this.constructor=t}yi(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var wi=function(){return wi=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},wi.apply(this,arguments)};function Ei(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}var Si=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._startRect=null,e._startPos=[],e._prevTime=0,e._timer=0,e._prevScrollPos=[0,0],e._isWait=!1,e}bi(e,t);var n=e.prototype;return n.dragStart=function(t,e){var n=e.container,r=0,i=0,o=0,s=0;if(n===document.body)o=window.innerWidth,s=window.innerHeight;else{var a=n.getBoundingClientRect();r=a.top,i=a.left,o=a.width,s=a.height}this._startPos=[t.clientX,t.clientY],this._startRect={top:r,left:i,width:o,height:s},this._prevScrollPos=this._getScrollPosition([0,0],e)},n.drag=function(t,e){var n=t.clientX,r=t.clientY,i=e.threshold,o=void 0===i?0:i,s=this,a=s._startRect,c=s._startPos,u=[0,0];return a.top>r-o?(c[1]>a.top||r<c[1])&&(u[1]=-1):a.top+a.height<r+o&&(c[1]<a.top+a.height||r>c[1])&&(u[1]=1),a.left>n-o?(c[0]>a.left||n<c[0])&&(u[0]=-1):a.left+a.width<n+o&&(c[0]<a.left+a.width||n>c[0])&&(u[0]=1),clearTimeout(this._timer),!(!u[0]&&!u[1])&&this._continueDrag(wi(wi({},e),{direction:u,inputEvent:t,isDrag:!0}))},n.checkScroll=function(t){var e=this;if(this._isWait)return!1;var n=t.prevScrollPos,r=void 0===n?this._prevScrollPos:n,i=t.direction,o=t.throttleTime,s=void 0===o?0:o,a=t.inputEvent,c=t.isDrag,u=this._getScrollPosition(i||[0,0],t),l=u[0]-r[0],d=u[1]-r[1],h=i||[l?Math.abs(l)/l:0,d?Math.abs(d)/d:0];return this._prevScrollPos=u,!(!l&&!d)&&(this.trigger("move",{offsetX:h[0]?l:0,offsetY:h[1]?d:0,inputEvent:a}),s&&c&&(this._timer=window.setTimeout((function(){e._continueDrag(t)}),s)),!0)},n.dragEnd=function(){clearTimeout(this._timer)},n._getScrollPosition=function(t,e){var n=e.container,r=e.getScrollPosition,i=void 0===r?Ei:r;return i({container:n,direction:t})},n._continueDrag=function(t){var e=this,n=t.container,r=t.direction,i=t.throttleTime,o=t.useScroll,s=t.isDrag,a=t.inputEvent;if(!s||!this._isWait){var c=mt(),u=Math.max(i+this._prevTime-c,0);if(u>0)return this._timer=window.setTimeout((function(){e._continueDrag(t)}),u),!1;this._prevTime=c;var l=this._getScrollPosition(r,t);return this._prevScrollPos=l,s&&(this._isWait=!0),this.trigger("scroll",{container:n,direction:r,inputEvent:a}),this._isWait=!1,o||this.checkScroll(wi(wi({},t),{prevScrollPos:l,direction:r,inputEvent:a}))}},e}(Ht),Di=Si,ki=function(t,e){return ki=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},ki(t,e)};function xi(t,e){function n(){this.constructor=t}ki(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Ci=function(){return Ci=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Ci.apply(this,arguments)};function _i(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}var Oi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.injectResult=null,e.tag="div",e}xi(e,t);var n=e.prototype;return n.render=function(){var t=this.props,e=t.className,n=void 0===e?"":e,r=(t.cspNonce,t.portalContainer),i=_i(t,["className","cspNonce","portalContainer"]),o=this.injector.className,s=this.tag,a={};return(br||"").indexOf("simple")>-1&&r&&(a={portalContainer:r}),Xn(s,Ci({ref:ae(this,"element"),"data-styled-id":o,className:n+" "+o},a,i))},n.componentDidMount=function(){this.injectResult=this.injector.inject(this.element,{nonce:this.props.cspNonce})},n.componentWillUnmount=function(){this.injectResult.destroy(),this.injectResult=null},n.getElement=function(){return this.element},e}(ur);function Ai(t,e){var n=ye(e);return function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.injector=n,r.tag=t,r}return xi(r,e),r}(Oi)}var Mi=Ai,Ti=function(){return Ti=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Ti.apply(this,arguments)};function Ri(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var Ni=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e){if(tt(t))for(var n in t)this.on(n,t[n]);else this._addEvent(t,e,{});return this},e.off=function(t,e){if(t)if(tt(t))for(var n in t)this.off(n);else if(e){var r=this._events[t];if(r){var i=vt(r,(function(t){return t.listener===e}));i>-1&&r.splice(i,1)}}else this._events[t]=[];else this._events={};return this},e.once=function(t,e){var n=this;return e&&this._addEvent(t,e,{once:!0}),new Promise((function(e){n._addEvent(t,e,{once:!0})}))},e.emit=function(t,e){var n=this;void 0===e&&(e={});var r=this._events[t];if(!t||!r)return!0;var i=!1;return e.eventType=t,e.stop=function(){i=!0},e.currentTarget=this,Ri(r).forEach((function(r){r.listener(e),r.once&&n.off(t,r.listener)})),!i},e.trigger=function(t,e){return void 0===e&&(e={}),this.emit(t,e)},e._addEvent=function(t,e,n){var r=this._events;r[t]=r[t]||[];var i=r[t];i.push(Ti({listener:e},n))},t}(),Pi=function(t,e){return Pi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Pi(t,e)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Bi(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Pi(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Fi=function(){return Fi=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Fi.apply(this,arguments)};function Ii(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function zi(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}function ji(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function Li(t,e){var n;return Fi({events:{},props:(n={},n[t]=Boolean,n),name:t},e)}function $i(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function Hi(t){var e=$i(1,t),n=45*Math.round(t/45)%180,r="ns-resize";return 135===n?r="nwse-resize":45===n?r="nesw-resize":90===n&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(e,"') 16 16, ").concat(r,";")}var Vi=ze(),Wi=Vi.browser.webkit,Ui=Wi&&function(){var t="undefined"===typeof window?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(t.userAgent.toLowerCase());return!!e&&parseFloat(e[1])<605}(),qi="moveable-",Gi="\n{\n\tposition: absolute;\n\twidth: 1px;\n\theight: 1px;\n\tleft: 0;\n\ttop: 0;\n    z-index: 3000;\n    --moveable-color: #4af;\n    --zoom: 1;\n    --zoompx: 1px;\n    will-change: transform;\n}\n.control-box {\n    z-index: 0;\n}\n.line, .control {\n    position: absolute;\n\tleft: 0;\n    top: 0;\n    will-change: transform;\n}\n.control {\n\twidth: 14px;\n\theight: 14px;\n\tborder-radius: 50%;\n\tborder: 2px solid #fff;\n\tbox-sizing: border-box;\n    background: #4af;\n    background: var(--moveable-color);\n\tmargin-top: -7px;\n    margin-left: -7px;\n    border: 2px solid #fff;\n    z-index: 10;\n}\n.padding {\n    position: absolute;\n    top: 0px;\n    left: 0px;\n    width: 100px;\n    height: 100px;\n    transform-origin: 0 0;\n}\n.line {\n\twidth: 1px;\n    height: 1px;\n    background: #4af;\n    background: var(--moveable-color);\n\ttransform-origin: 0px 50%;\n}\n.line.dashed {\n    box-sizing: border-box;\n    background: transparent;\n}\n.line.dashed.horizontal {\n    border-top: 1px dashed #4af;\n    border-top-color: #4af;\n    border-top-color: var(--moveable-color);\n}\n.line.dashed.vertical {\n    border-left: 1px dashed #4af;\n    border-left-color: #4af;\n    border-left-color: var(--moveable-color);\n}\n.line.vertical {\n    transform: translateX(-50%);\n}\n.line.horizontal {\n    transform: translateY(-50%);\n}\n.line.vertical.bold {\n    width: 2px;\n}\n.line.horizontal.bold {\n    height: 2px;\n}\n\n.control.origin {\n\tborder-color: #f55;\n\tbackground: #fff;\n\twidth: 12px;\n\theight: 12px;\n\tmargin-top: -6px;\n    margin-left: -6px;\n\tpointer-events: none;\n}\n".concat([0,15,30,45,60,75,90,105,120,135,150,165].map((function(t){return'\n.direction[data-rotation="'.concat(t,'"] {\n\t').concat(Hi(t),"\n}\n")})).join("\n"),"\n.group {\n    z-index: -1;\n}\n.area {\n    position: absolute;\n}\n.area-pieces {\n    position: absolute;\n    top: 0;\n    left: 0;\n    display: none;\n}\n.area.avoid, .area.pass {\n    pointer-events: none;\n}\n.area.avoid+.area-pieces {\n    display: block;\n}\n.area-piece {\n    position: absolute;\n}\n\n").concat(Ui?':global svg *:before {\n\tcontent:"";\n\ttransform-origin: inherit;\n}':"","\n"),Ki=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],Yi=1e-4,Xi=1e-7,Ji=1e-9,Zi=Math.pow(10,10),Qi=-Zi,to=["n","w","s","e","nw","ne","sw","se"],eo={n:[0,1],s:[2,3],w:[2,0],e:[1,3],nw:[0],ne:[1],sw:[2],se:[3]},no={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},ro=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate"];function io(t,e,n,r,i){var o=e.gesto.move(n,t.inputEvent),s=o.originalDatas||o.datas,a=s.draggable||(s.draggable={});return Fi(Fi({},i?Cc(e,o):o),{isDrag:!0,isPinch:!!r,parentEvent:!0,datas:a,originalDatas:t.originalDatas})}var oo=function(){function t(){this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}}}var e=t.prototype;return e.dragStart=function(t,e){this.isDrag=!1,this.isFlag=!1;var n=e.originalDatas;return this.datas=n,n.draggable||(n.draggable={}),Fi(Fi({},this.move(t,e.inputEvent)),{type:"dragstart"})},e.drag=function(t,e){return this.move([t[0]-this.prevX,t[1]-this.prevY],e)},e.move=function(t,e){var n,r;return this.isFlag?(n=this.prevX+t[0],r=this.prevY+t[1],this.isDrag=!0):(this.prevX=t[0],this.prevY=t[1],this.startX=t[0],this.startY=t[1],n=t[0],r=t[1],this.isFlag=!0),this.prevX=n,this.prevY=r,{type:"drag",clientX:n,clientY:r,inputEvent:e,isDrag:this.isDrag,distX:n-this.startX,distY:r-this.startY,deltaX:t[0],deltaY:t[1],datas:this.datas.draggable,originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t}();function so(t,e,n){var r=n.originalDatas;r.groupable=r.groupable||{};var i=r.groupable;i.childDatas=i.childDatas||[];var o=i.childDatas;return t.moveables.map((function(t,r){return o[r]=o[r]||{},o[r][e]=o[r][e]||{},Fi(Fi({},n),{datas:o[r][e],originalDatas:o[r]})}))}function ao(t,e,n,r,i,o){var s=!!n.match(/Start$/g),a=!!n.match(/End$/g),c=i.isPinch,u=i.datas,l=so(t,e.name,i),d=t.moveables,h=l.map((function(t,i){var l=d[i],h=t;s?h=(new oo).dragStart(r,t):(l.state.gesto||(l.state.gesto=u.childGestos[i]),h=io(t,l.state,r,c,o));var f=e[n](l,Fi(Fi({},h),{parentFlag:!0}));return a&&(l.state.gesto=null),f}));return s&&(u.childGestos=d.map((function(t){return t.state.gesto}))),h}function co(t,e,n,r,i,o){void 0===i&&(i=function(t,e){return e});var s=!!n.match(/End$/g),a=so(t,e.name,r),c=t.moveables,u=a.map((function(t,r){var a=c[r],u=t;u=i(a,t);var l=e[n](a,Fi(Fi({},u),{parentFlag:!0}));return l&&o&&o(a,t,l,r),s&&(a.state.gesto=null),l}));return u}function uo(t,e,n,r){void 0===r&&(r="");var i=t.state,o=i.renderPoses,s=i.rotation,a=i.direction,c=t.props,u=c.renderDirections,l=void 0===u?e:u,d=c.zoom,h={};if(!l)return[];var f=a>0?1:-1,p=!0===l?to:l,g=s/Math.PI*180;return p.forEach((function(t){h[t]=!0})),p.map((function(t){var e=eo[t];if(!e||!h[t])return null;var i=(Rt(g,15)+f*no[t]+720)%180;return n.createElement("div",{className:Ca("control","direction",t,r),"data-rotation":i,"data-direction":t,key:"direction-".concat(t),style:ec.apply(void 0,ji([s,d],e.map((function(t){return o[t]})),!1))})}))}function lo(t,e,n,r,i,o){for(var s=[],a=6;a<arguments.length;a++)s[a-6]=arguments[a];var c=Ot(n,r),u=e?Rt(c/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line".concat(o),className:Ca.apply(void 0,ji(["line","direction",e],s,!1)),"data-rotation":u,"data-line-index":o,"data-direction":e,style:tc(n,r,i,c)})}function ho(t,e){return uo(t,to,e)}function fo(t,e){return uo(t,["nw","ne","sw","se"],e)}function po(t,e,n,r,i,o){var s=t.state.is3d?4:3,a=qa(t.state.rootMatrix,i,s),c=Rr([o.left,o.top],a);e.startAbsoluteOrigin=c,e.prevDeg=Ot(c,[n,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0}function go(t,e,n){var r=n.defaultDeg,i=n.prevDeg,o=i%360,s=Math.floor(i/360);o<0&&(o+=360),o>t&&o>270&&t<90?++s:o<t&&o<90&&t>270&&--s;var a=e*(360*s+t-r);return n.prevDeg=r+a,a}function mo(t,e,n,r){return go(Ot(r.startAbsoluteOrigin,[t,e])/Math.PI*180,n,r)}function vo(t,e,n,r,i,o){var s=t.props.throttleRotate,a=void 0===s?0:s,c=r,u=n.prevSnapDeg;o&&(c=Ls(t,e,n.origin,c));var l=Rt(i+c,a),d=l-i;return n.prevSnapDeg=d,[d-u,c,l]}function yo(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3];if("none"!==t){var a=(t||"top").split("-"),c=a[0],u=a[1],l=[r,i];"left"===c?l=[o,r]:"right"===c?l=[i,s]:"bottom"===c&&(l=[s,o]);var d=[(l[0][0]+l[1][0])/2,(l[0][1]+l[1][1])/2],h=ic(l,n);if(u){var f="top"===u||"left"===u,p="bottom"===c||"left"===c;d=l[f&&!p||!f&&p?0:1]}return[d,h]}}function bo(t,e){if(e.isRequest)return"rotatable"===e.requestAble;var n=e.inputEvent.target;if(Pt(n,Ca("rotation-control")))return!0;var r=t.props.rotationTarget;return!!r&&Fc(r,!0).some((function(t){return!!t&&(n===t||n.contains(t))}))}var wo={name:"rotatable",canPinch:!0,props:{rotatable:Boolean,rotationPosition:String,throttleRotate:Number,renderDirections:Object,rotationTarget:Object},events:{onRotateStart:"rotateStart",onBeforeRotate:"beforeRotate",onRotate:"rotate",onRotateEnd:"rotateEnd",onRotateGroupStart:"rotateGroupStart",onBeforeRotateGroup:"beforeRotateGroup",onRotateGroup:"rotateGroup",onRotateGroupEnd:"rotateGroupEnd"},css:[".rotation {\n            position: absolute;\n            height: 40px;\n            width: 1px;\n            transform-origin: 50% 100%;\n            height: calc(40px * var(--zoom));\n            top: auto;\n            left: 0;\n            bottom: 100%;\n            will-change: transform;\n        }\n        .rotation .rotation-line {\n            display: block;\n            width: 100%;\n            height: 100%;\n            transform-origin: 50% 50%;\n        }\n        .rotation .rotation-control {\n            border-color: #4af;\n            border-color: var(--moveable-color);\n            background:#fff;\n            cursor: alias;\n        }"],render:function(t,e){var n=t.props,r=n.rotatable,i=n.rotationPosition,o=n.zoom,s=n.renderDirections,a=t.state,c=a.renderPoses,u=a.direction;if(!r)return null;var l=yo(i,c,u),d=[];if(l){var h=l[0],f=l[1];d.push(e.createElement("div",{key:"rotation",className:Ca("rotation"),style:{transform:"translate(-50%) translate(".concat(h[0],"px, ").concat(h[1],"px) rotate(").concat(f,"rad)")}},e.createElement("div",{className:Ca("line rotation-line"),style:{transform:"scaleX(".concat(o,")")}}),e.createElement("div",{className:Ca("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(o,")")}})))}return s&&d.push.apply(d,uo(t,[],e)),d},dragControlCondition:bo,dragControlStart:function(t,e){var n=e.datas,r=e.clientX,i=e.clientY,o=e.parentRotate,s=e.parentFlag,a=e.isPinch,c=e.isRequest,u=t.state,l=u.target,d=u.left,h=u.top,f=u.origin,p=u.beforeOrigin,g=u.direction,m=u.beforeDirection,v=u.targetTransform,y=u.moveableClientRect;if(!c&&!l)return!1;var b=t.getRect();if(n.rect=b,n.transform=v,n.left=d,n.top=h,n.fixedPosition=Ea(t,wa(t)),c||a||s){var w=o||0;n.beforeInfo={origin:b.beforeOrigin,prevDeg:w,defaultDeg:w,prevSnapDeg:0},n.afterInfo=Fi(Fi({},n.beforeInfo),{origin:b.origin}),n.absoluteInfo=Fi(Fi({},n.beforeInfo),{origin:b.origin,startValue:w})}else n.beforeInfo={origin:b.beforeOrigin},n.afterInfo={origin:b.origin},n.absoluteInfo={origin:b.origin,startValue:b.rotation},po(t,n.beforeInfo,r,i,p,y),po(t,n.afterInfo,r,i,f,y),po(t,n.absoluteInfo,r,i,f,y);n.direction=g,n.beforeDirection=m,n.startValue=0,n.datas={},fa(e,"rotate");var E=fc(t,e,Fi(Fi({set:function(t){n.startValue=t*Math.PI/180}},ha(e)),{dragStart:Gs.dragStart(t,(new oo).dragStart([0,0],e))})),S=mc(t,"onRotateStart",E);return n.isRotate=!1!==S,t.state.snapRenderInfo={request:e.isRequest},!!n.isRotate&&E},dragControl:function(t,e){var n,r,i,o=e.datas,s=e.clientX,a=e.clientY,c=e.parentRotate,u=e.parentFlag,l=e.isPinch,d=e.groupDelta,h=o.beforeDirection,f=o.beforeInfo,p=o.afterInfo,g=o.absoluteInfo,m=o.isRotate,v=o.startValue,y=o.rect;if(m){Js(e,"rotate");var b,w,E,S,D,k,x=Xs(e),C=h*x,_=t.props.parentMoveable,O=0,A=0,M=0,T=180/Math.PI*v,R=g.startValue,N=!1;if(!u&&"parentDist"in e){var P=e.parentDist;b=P,E=P,D=P}else l||u?(b=go(c,h,f),E=go(c,C,p),D=go(c,C,g)):(b=mo(s,a,h,f),E=mo(s,a,C,p),D=mo(s,a,C,g),N=!0);if(w=T+b,S=T+E,k=R+D,mc(t,"onBeforeRotate",fc(t,e,{beforeRotation:w,rotation:S,absoluteRotation:k,setRotation:function(t){E=t-T,b=E,D=E}},!0)),n=vo(t,y,f,b,T,N),O=n[0],b=n[1],w=n[2],r=vo(t,y,p,E,T,N),A=r[0],E=r[1],S=r[2],i=vo(t,y,g,D,R,N),M=i[0],D=i[1],k=i[2],M||A||O||_){var B=Zs(o,"rotate(".concat(S,"deg)"),"rotate(".concat(E,"deg)")),F=Sa(t,E,o.fixedPosition,o),I=Nr(Rr(d||[0,0],F),o.prevInverseDist||[0,0]);o.prevInverseDist=F,o.requestValue=null;var z=fc(t,e,Fi({delta:A,dist:E,rotate:S,rotation:S,beforeDist:b,beforeDelta:O,beforeRotate:w,beforeRotation:w,absoluteDist:D,absoluteDelta:M,absoluteRotate:k,absoluteRotation:k,isPinch:!!l},va(t,B,I,l,e)));return mc(t,"onRotate",z),z}}},dragControlAfter:function(t,e){e.datas.requestValue},dragControlEnd:function(t,e){var n=e.datas;if(n.isRotate){n.isRotate=!1;var r=pc(t,e,{});return mc(t,"onRotateEnd",r),r}},dragGroupControlCondition:bo,dragGroupControlStart:function(t,e){var n=e.datas,r=t.state,i=r.left,o=r.top,s=r.beforeOrigin,a=this.dragControlStart(t,e);if(!a)return!1;a.set(n.beforeDirection*t.rotation);var c=co(t,this,"dragControlStart",e,(function(t,e){var n=t.state,r=n.left,a=n.top,c=n.beforeOrigin,u=Rr(Nr([r,a],[i,o]),Nr(c,s));return e.datas.groupClient=u,Fi(Fi({},e),{parentRotate:0})})),u=Fi(Fi({},a),{targets:t.props.targets,events:c}),l=mc(t,"onRotateGroupStart",u);return n.isRotate=!1!==l,!!n.isRotate&&a},dragGroupControl:function(t,e){var n=e.datas;if(n.isRotate){gc(t,"onBeforeRotate",(function(n){mc(t,"onBeforeRotateGroup",fc(t,e,Fi(Fi({},n),{targets:t.props.targets}),!0))}));var r=this.dragControl(t,e);if(r){var i=n.beforeDirection,o=r.beforeDist,s=r.beforeDelta,a=s/180*Math.PI,c=co(t,this,"dragControl",e,(function(t,e){var n=e.datas.groupClient,r=n[0],s=n[1],c=$r([r,s],a*i),u=c[0],l=c[1],d=[u-r,l-s];return e.datas.groupClient=[u,l],Fi(Fi({},e),{parentRotate:o,groupDelta:d})}));t.rotation=i*r.beforeRotation;var u=Fi({targets:t.props.targets,events:c,set:function(e){t.rotation=e},setGroupRotation:function(e){t.rotation=e}},r);return mc(t,"onRotateGroup",u),u}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isRotate){this.dragControlEnd(t,e);var i=co(t,this,"dragControlEnd",e),o=pc(t,e,{targets:t.props.targets,events:i});return mc(t,"onRotateGroupEnd",o),n}},request:function(t){var e={},n=0,r=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(t){return"deltaRotate"in t?n+=t.deltaRotate:"rotate"in t&&(n=t.rotate-r),{datas:e,parentDist:n}},requestEnd:function(){return{datas:e,isDrag:!0}}}}},Eo=["left","right","center"],So=["top","bottom","middle"],Do={start:"left",end:"right",center:"center"},ko={start:"top",end:"bottom",center:"middle"};function xo(t,e){var n=t.props,r=n.snappable,i=n.bounds,o=n.innerBounds,s=n.verticalGuidelines,a=n.horizontalGuidelines,c=n.snapGridWidth,u=n.snapGridHeight,l=t.state,d=l.guidelines,h=l.enableSnap;return!(!r||!h||e&&!0!==r&&r.indexOf(e)<0)&&!!(c||u||i||o||d&&d.length||s&&s.length||a&&a.length)}function Co(t){return!1===t?{}:!0!==t&&t?t:{left:!0,right:!0,top:!0,bottom:!0}}function _o(t,e){var n=Co(t),r={};for(var i in n)i in e&&n[i]&&(r[i]=e[i]);return r}function Oo(t,e){var n=_o(t,e),r=So.filter((function(t){return t in n})),i=Eo.filter((function(t){return t in n}));return{horizontal:r.map((function(t){return n[t]})),vertical:i.map((function(t){return n[t]}))}}function Ao(t,e,n){var r=t.state.elementRects,i=[];return[["vertical",Do,ko],["horizontal",ko,Do]].forEach((function(t){var o=t[0],s=t[1],a=t[2],c=e[s.start],u=e[s.end],l=e[s.center],d=e[a.start],h=e[a.end];function f(t){var e=t.rect;return e[s.end]<c+n?c-e[s.end]:u-n<e[s.start]?e[s.start]-u:-1}var p=r.filter((function(t){var e=t.rect;return!(e[a.start]>h||e[a.end]<d)&&f(t)>0})).sort((function(t,e){return f(t)-f(e)})),g=[];p.forEach((function(t){p.forEach((function(e){if(t!==e){var n=t.rect,r=e.rect,i=n[a.start],o=n[a.end],s=r[a.start],c=r[a.end];i>c||s>o||g.push([t,e])}}))})),g.forEach((function(t){var e=t[0],r=t[1],a=e.rect,d=r.rect,h=a[s.start],f=a[s.end],p=d[s.start],g=d[s.end],m=0,v=0,y=!1,b=!1,w=!1;if(f<=c&&u<=p){if(b=!0,m=(p-f-(u-c))/2,v=f+m+(u-c)/2,Math.abs(v-l)>n)return}else if(f<p&&g<c+n){if(y=!0,m=p-f,v=g+m,Math.abs(v-c)>n)return}else{if(!(f<p&&u-n<h))return;if(w=!0,m=p-f,v=h-m,Math.abs(v-u)>n)return}m&&i.push({type:o,pos:"vertical"===o?[v,0]:[0,v],element:r.element,size:0,className:r.className,isStart:y,isCenter:b,isEnd:w,gap:m,hide:!0,gapRects:[e,r]})}))})),i}function Mo(t,e,n,r,i,o,s){void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s={left:0,top:0,right:0,bottom:0});var a=[],c=s.left,u=s.top,l=s.bottom,d=s.right,h=n+d-c,f=r+l-u;return t&&t.forEach((function(t){a.push({type:"horizontal",pos:[c,Rt(t-o+u,.1)],size:h})})),e&&e.forEach((function(t){a.push({type:"vertical",pos:[Rt(t-i+c,.1),u],size:f})})),a}function To(t,e,n){var r=qa(t,[e.clientLeft,e.clientTop],n);return[e.left+r[0],e.top+r[1]]}function Ro(t,e){if(!e.length)return[];var n=t.state,r=n.containerClientRect,i=n.targetClientRect,o=i.top,s=i.left,a=n.rootMatrix,c=n.is3d,u=c?4:3,l=To(a,r,u),d=l[0],h=l[1],f=lc(n),p=li(f),g=p.minX,m=p.minY,v=Nr([g,m],xc(a,[s-d,o-h],u)).map((function(t){return dc(t)})),y=v[0],b=v[1];return e.map((function(t){var e=t.element.getBoundingClientRect(),n=e.left-d,r=e.top-h,i=r+e.height,o=n+e.width,s=xc(a,[n,r],u),c=s[0],l=s[1],f=xc(a,[o,i],u),p=f[0],g=f[1];return Fi(Fi({},t),{rect:{left:c+y,right:p+y,top:l+b,bottom:g+b,center:(c+p)/2+y,middle:(l+g)/2+b}})}))}function No(t){var e=t.state,n=t.props.elementGuidelines,r=void 0===n?[]:n;if(!r.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter((function(t){return!t.refresh})),o=r.map((function(t){return tt(t)&&"element"in t?t:{element:Bc(t,!0)}})).filter((function(t){return t.element})),s=oi(i.map((function(t){return t.element})),o.map((function(t){return t.element}))),a=s.maintained,c=s.added,u=[];a.forEach((function(t){var e=t[0],n=t[1];u[n]=i[e]})),Ro(t,c.map((function(t){return o[t]}))).map((function(t,e){u[c[e]]=t})),e.elementRects=u;var l=Co(t.props.elementSnapDirections),d=[];return u.forEach((function(t){var e=t.element,n=t.top,r=void 0===n?l.top:n,i=t.left,o=void 0===i?l.left:i,s=t.right,a=void 0===s?l.right:s,c=t.bottom,u=void 0===c?l.bottom:c,h=t.center,f=void 0===h?l.center:h,p=t.middle,g=void 0===p?l.middle:p,m=t.className,v=t.rect,y=Oo({top:r,right:a,left:o,bottom:u,center:f,middle:g},v),b=y.horizontal,w=y.vertical,E=v.top,S=v.left,D=v.right-S,k=v.bottom-E,x=[D,k];w.forEach((function(n){d.push({type:"vertical",element:e,pos:[Rt(n,.1),E],size:k,sizes:x,className:m,elementRect:t})})),b.forEach((function(n){d.push({type:"horizontal",element:e,pos:[S,Rt(n,.1)],size:D,sizes:x,className:m,elementRect:t})}))})),d}function Po(t){var e=t.state,n=e.snapOffset,r=e.containerClientRect,i=r.overflow,o=r.scrollHeight,s=r.scrollWidth,a=r.clientHeight,c=r.clientWidth,u=r.clientLeft,l=r.clientTop,d=t.props,h=d.snapGap,f=void 0===h||h,p=d.verticalGuidelines,g=d.horizontalGuidelines,m=d.snapThreshold,v=void 0===m?5:m,y=d.snapGridWidth,b=void 0===y?0:y,w=d.snapGridHeight,E=void 0===w?0:w,S=No(t),D=ji([],S,!0);if(f){var k=Ka(lc(t.state)),x=k.top,C=k.left,_=k.bottom,O=k.right;D.push.apply(D,Ao(t,{top:x,left:C,bottom:_,right:O,center:(C+O)/2,middle:(x+_)/2},v))}return D.push.apply(D,Bo(b,E,i?s:c,i?o:a,u,l)),D.push.apply(D,Mo(g||!1,p||!1,i?s:c,i?o:a,u,l,n)),D}function Bo(t,e,n,r,i,o){void 0===i&&(i=0),void 0===o&&(o=0);var s=[];if(e)for(var a=0;a<=r;a+=e)s.push({type:"horizontal",pos:[0,Rt(a-o,.1)],size:n,hide:!0});if(t)for(a=0;a<=n;a+=t)s.push({type:"vertical",pos:[Rt(a-i,.1),0],size:r,hide:!0});return s}function Fo(t,e,n,r){var i=t.props,o=wc(r,i.snapThreshold,5);return Io(t.state.guidelines,e,n,o)}function Io(t,e,n,r){return{vertical:$o(t,"vertical",e,r),horizontal:$o(t,"horizontal",n,r)}}function zo(t,e,n){var r=n[0],i=n[1],o=e[0],s=e[1],a=Nr(n,e),c=a[0],u=a[1],l=u>0,d=c>0;c=Mc(c),u=Mc(u);var h={isSnap:!1,offset:0,pos:0},f={isSnap:!1,offset:0,pos:0};if(0===c&&0===u)return{vertical:h,horizontal:f};var p=Fo(t,c?[r]:[],u?[i]:[]),g=p.vertical,m=p.horizontal;g.posInfos.filter((function(t){var e=t.pos;return d?e>=o:e<=o})),m.posInfos.filter((function(t){var e=t.pos;return l?e>=s:e<=s})),g.isSnap=g.posInfos.length>0,m.isSnap=m.posInfos.length>0;var v=Lo(g),y=v.isSnap,b=v.guideline,w=Lo(m),E=w.isSnap,S=w.guideline,D=E?S.pos[1]:0,k=y?b.pos[0]:0;if(0===c)E&&(f.isSnap=!0,f.pos=S.pos[1],f.offset=i-f.pos);else if(0===u)y&&(h.isSnap=!0,h.pos=k,h.offset=r-k);else{var x=u/c,C=n[1]-x*r,_=0,O=0,A=!1;y?(O=k,_=x*O+C,A=!0):E&&(_=D,O=(_-C)/x,A=!0),A&&(h.isSnap=!0,h.pos=O,h.offset=r-O,f.isSnap=!0,f.pos=_,f.offset=i-_)}return{vertical:h,horizontal:f}}function jo(t,e,n){var r=Oo(t.props.snapDirections,e);return Fo(t,r.vertical,r.horizontal,n)}function Lo(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var n=t.posInfos[0],r=n.guidelineInfos[0],i=r.offset,o=r.dist,s=r.guideline;return{isSnap:e,offset:i,dist:o,pos:n.pos,guideline:s}}function $o(t,e,n,r){if(!t||!t.length)return{isSnap:!1,index:-1,posInfos:[]};var i="vertical"===e,o=i?0:1,s=n.map((function(n,i){var s=t.map((function(t){var e=t.pos,r=n-e[o];return{offset:r,dist:Math.abs(r),guideline:t}})).filter((function(t){var n=t.guideline,i=t.dist,o=n.type;return!(o!==e||i>r)})).sort((function(t,e){return t.dist-e.dist}));return{pos:n,index:i,guidelineInfos:s}})).filter((function(t){return t.guidelineInfos.length>0})).sort((function(t,e){return t.guidelineInfos[0].dist-e.guidelineInfos[0].dist})),a=s.length>0;return{isSnap:a,index:a?s[0].index:-1,posInfos:s}}function Ho(t,e,n){var r=[];if(n[0]&&n[1])r=[n,[-n[0],n[1]],[n[0],-n[1]]].map((function(t){return aa(e,t)}));else if(n[0]||n[1])t.props.keepRatio?r=[[-1,-1],[-1,1],[1,-1],[1,1],n].map((function(t){return aa(e,t)})):(r=sa(e,n),r.length>1&&r.push([(r[0][0]+r[1][0])/2,(r[0][1]+r[1][1])/2]));else for(var i=[e[0],e[1],e[3],e[2],e[0]],o=0;o<4;++o)r.push(i[o]),r.push([(i[o][0]+i[o+1][0])/2,(i[o][1]+i[o+1][1])/2]);return Fo(t,r.map((function(t){return t[0]})),r.map((function(t){return t[1]})),1)}function Vo(t,e){var n=Math.abs(t.offset),r=Math.abs(e.offset);return t.isBound&&e.isBound?r-n:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?r-n:t.isSnap?-1:e.isSnap||n<Xi?1:r<Xi?-1:n-r}function Wo(t,e){return t.slice().sort((function(t,n){var r=t.sign[e],i=n.sign[e],o=t.offset[e],s=n.offset[e];return r?i?Vo({isBound:t.isBound,isSnap:t.isSnap,offset:o},{isBound:n.isBound,isSnap:n.isSnap,offset:s}):-1:1}))[0]}function Uo(t,e,n){var r=[];if(n)1!==Math.abs(e[0])||1!==Math.abs(e[1])?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]],[e,t]),r.push([e,t]);else if(t[0]&&t[1])r.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]]);else if(t[0]){var i=1===Math.abs(e[0])?[1]:[1,-1];i.forEach((function(n){r.push([[e[0],-1],[n*t[0],-1]],[[e[0],0],[n*t[0],0]],[[e[0],1],[n*t[0],1]])}))}else if(t[1]){i=1===Math.abs(e[1])?[1]:[1,-1];i.forEach((function(n){r.push([[-1,e[1]],[-1,n*t[1]]],[[0,e[1]],[0,n*t[1]]],[[1,e[1]],[1,n*t[1]]])}))}else r.push([e,[1,0]],[e,[-1,0]],[e,[0,-1]],[e,[0,1]],[[1,0],[1,-1]],[[1,0],[1,1]],[[0,1],[1,1]],[[0,1],[-1,1]],[[-1,0],[-1,-1]],[[-1,0],[-1,1]],[[0,-1],[1,-1]],[[0,-1],[-1,-1]]);return r}function qo(t,e){var n=_t([e[0][0],e[1][0]]),r=_t([e[0][1],e[1][1]]);return{vertical:n<=t[0],horizontal:r<=t[1]}}function Go(t,e){var n,r,i=e[0],o=e[1],s=o[0]-i[0],a=o[1]-i[1];if(Math.abs(s)<Xi&&(s=0),Math.abs(a)<Xi&&(a=0),s)if(a){var c=a/s;n=c*(t[0]-i[0])+i[1],r=t[1]}else n=i[1],r=t[1];else n=i[0],r=t[0];return n-r}function Ko(t,e,n){void 0===n&&(n=Xi);var r=Go(t[0],e)<=0;return t.slice(1).every((function(t){var i=Go(t,e),o=i<=0;return o===r||Math.abs(i)<=n}))}function Yo(t,e,n,r,i){return void 0===i&&(i=0),r&&e-i<=t||!r&&t<=n+i?{isBound:!0,offset:r?e-t:n-t}:{isBound:!1,offset:0}}function Xo(t,e,n){var r=t.props.innerBounds;if(!r)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var i=r.left,o=r.top,s=r.width,a=r.height,c=[[i,o],[i,o+a]],u=[[i,o],[i+s,o]],l=[[i+s,o],[i+s,o+a]],d=[[i,o+a],[i+s,o+a]],h=qo(n,e),f=h.horizontal,p=h.vertical;if(Ko([n,[i,o],[i+s,o],[i,o+a],[i+s,o+a]],e))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var g=Jo(e,u,p),m=Jo(e,d,p),v=Jo(e,c,f),y=Jo(e,l,f),b=g.isBound&&m.isBound,w=g.isBound||m.isBound,E=v.isBound&&y.isBound,S=v.isBound||y.isBound,D=kc(g.offset,m.offset),k=kc(v.offset,y.offset),x=[0,0],C=!1,_=!1;return Math.abs(k)<Math.abs(D)?(x=[D,0],C=w,_=b):(x=[0,k],C=S,_=E),{isAllBound:_,isVerticalBound:w,isHorizontalBound:S,isBound:C,offset:x}}function Jo(t,e,n,r,i){var o=t[0],s=t[1],a=e[0],c=e[1],u=Mc(s[1]-o[1]),l=Mc(s[0]-o[0]),d=Mc(c[1]-a[1]),h=Mc(c[0]-a[0]);if(!h){if(i&&!u)return{isBound:!1,offset:0};if(l){var f=u/l*(a[0]-o[0])+o[1];return Yo(f,a[1],c[1],n,r)}var p=a[0]-o[0],g=Math.abs(p)<=(r||0);return{isBound:g,offset:g?p:0}}if(!d){if(i&&!l)return{isBound:!1,offset:0};if(u){var m=(a[1]-o[1])/(u/l)+o[0];return Yo(m,a[0],c[0],n,r)}p=a[1]-o[1],g=Math.abs(p)<=(r||0);return{isBound:g,offset:g?p:0}}return{isBound:!1,offset:0}}function Zo(t,e,n,r){return e.map((function(e){var i=e[0],o=e[1],s=e[2],a=Xo(t,[o,s],n),c=a.isBound,u=a.offset,l=a.isVerticalBound,d=a.isHorizontalBound,h=na({datas:r,distX:u[0],distY:u[1]}).map((function(t,e){return t*(i[e]?2/i[e]:0)}));return{sign:i,isBound:c,isVerticalBound:l,isHorizontalBound:d,isSnap:!1,offset:h}}))}function Qo(t,e,n){var r,i=es(e,[0,0],!1).map((function(t){var e=t[0],n=t[1],r=t[2];return[e.map((function(t){return 2*Math.abs(t)})),n,r]})),o=Zo(t,i,aa(e,[0,0]),n),s=Wo(o,0),a=Wo(o,1),c=0,u=0,l=s.isVerticalBound||a.isVerticalBound,d=s.isHorizontalBound||a.isHorizontalBound;return(l||d)&&(r=ra({datas:n,distX:-s.offset[0],distY:-a.offset[1]}),c=r[0],u=r[1]),{vertical:{isBound:l,offset:c},horizontal:{isBound:d,offset:u}}}function ts(t,e){var n=[],r=t[0],i=t[1];return r&&i?n.push([[0,2*i],t,[-r,i]],[[2*r,0],t,[r,-i]]):r?(n.push([[2*r,0],[r,1],[r,-1]]),e&&n.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):i?(n.push([[0,2*i],[1,i],[-1,i]]),e&&n.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):n.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),n}function es(t,e,n){return ts(e,n).map((function(e){var n=e[0],r=e[1],i=e[2];return[n,aa(t,r),aa(t,i)]}))}function ns(t,e,n,r){var i=r?t.map((function(t){return $r(t,r)})):t,o=ji([n],e,!0);return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some((function(t){return!Ko(o,t)}))}function rs(t){var e=t[0],n=t[1],r=n[0]-e[0],i=n[1]-e[1];if(!r)return Math.abs(e[0]);if(!i)return Math.abs(e[1]);var o=i/r;return Math.abs((-o*e[0]+e[1])/Math.sqrt(Math.pow(o,2)+1))}function is(t){var e=t[0],n=t[1],r=n[0]-e[0],i=n[1]-e[1];if(!r)return[e[0],0];if(!i)return[0,e[1]];var o=i/r,s=-o*e[0]+e[1];return[-s/(o+1/o),s/(o*o+1)]}function ss(t,e,n,r,i){var o=t.props.innerBounds,s=i*Math.PI/180;if(!o)return[];var a=o.left,c=o.top,u=o.width,l=o.height,d=a-r[0],h=a+u-r[0],f=c-r[1],p=c+l-r[1],g=[[d,f],[h,f],[d,p],[h,p]],m=aa(n,[0,0]);if(!ns(n,g,m,0))return[];var v=[],y=g.map((function(t){return[Za(t),Ot([0,0],t)]}));return[[n[0],n[1]],[n[1],n[3]],[n[3],n[2]],[n[2],n[0]]].forEach((function(t){var n=Ot([0,0],is(t)),r=rs(t);v.push.apply(v,y.filter((function(t){var e=t[0];return e&&r<=e})).map((function(t){var e=t[0],i=t[1],o=Math.acos(e?r/e:0),a=i+o,c=i-o;return[s+a-n,s+c-n]})).reduce((function(t,e){return t.push.apply(t,e),t}),[]).filter((function(t){return!ns(e,g,m,t)})).map((function(t){return Rt(180*t/Math.PI,Xi)})))})),v}function as(t){var e=t.props.innerBounds;if(!e)return{vertical:[],horizontal:[]};var n=t.getRect(),r=n.pos1,i=n.pos2,o=n.pos3,s=n.pos4,a=[r,i,o,s],c=aa(a,[0,0]),u=e.left,l=e.top,d=e.width,h=e.height,f=[[u,l],[u,l+h]],p=[[u,l],[u+d,l]],g=[[u+d,l],[u+d,l+h]],m=[[u,l+h],[u+d,l+h]],v=[[r,i],[i,s],[s,o],[o,r]],y=[],b=[],w={top:!1,bottom:!1,left:!1,right:!1};return v.forEach((function(t){var e=qo(c,t),n=e.horizontal,r=e.vertical,i=Jo(t,p,r,1,!0),o=Jo(t,m,r,1,!0),s=Jo(t,f,n,1,!0),a=Jo(t,g,n,1,!0);i.isBound&&!w.top&&(y.push(l),w.top=!0),o.isBound&&!w.bottom&&(y.push(l+h),w.bottom=!0),s.isBound&&!w.left&&(b.push(u),w.left=!0),a.isBound&&!w.right&&(b.push(u+d),w.right=!0)})),{horizontal:y,vertical:b}}function cs(t,e,n){var r=t||{},i=r.position,o=void 0===i?"client":i,s=r.left,a=void 0===s?-1/0:s,c=r.top,u=void 0===c?-1/0:c,l=r.right,d=void 0===l?1/0:l,h=r.bottom,f=void 0===h?1/0:h,p={position:o,left:a,top:u,right:d,bottom:f};return{vertical:ds(p,e,!0),horizontal:ds(p,n,!1)}}function us(t,e){var n=t.state,r=n.containerClientRect,i=r.clientHeight,o=r.clientWidth,s=r.clientLeft,a=r.clientTop,c=n.snapOffset,u=c.left,l=c.top,d=c.right,h=c.bottom,f=e||t.props.bounds||{},p=f.position||"client",g="css"===p,m=f.left,v=void 0===m?-1/0:m,y=f.top,b=void 0===y?-1/0:y,w=f.right,E=void 0===w?g?-1/0:1/0:w,S=f.bottom,D=void 0===S?g?-1/0:1/0:S;return g&&(E=o+d-u-E,D=i+h-l-D),{left:v+u-s,right:E+u-s,top:b+l-a,bottom:D+l-a}}function ls(t,e,n){var r=us(t),i=r.left,o=r.top,s=r.right,a=r.bottom,c=n[0],u=n[1],l=Nr(n,e),d=l[0],h=l[1];Math.abs(d)<Xi&&(d=0),Math.abs(h)<Xi&&(h=0);var f=h>0,p=d>0,g={isBound:!1,offset:0,pos:0},m={isBound:!1,offset:0,pos:0};if(0===d&&0===h)return{vertical:g,horizontal:m};if(0===d)f?a<u&&(m.pos=a,m.offset=u-a):o>u&&(m.pos=o,m.offset=u-o);else if(0===h)p?s<c&&(g.pos=s,g.offset=c-s):i>c&&(g.pos=i,g.offset=c-i);else{var v=h/d,y=n[1]-v*c,b=0,w=0,E=!1;p&&s<=c?(b=v*s+y,w=s,E=!0):!p&&c<=i&&(b=v*i+y,w=i,E=!0),E&&(b<o||b>a)&&(E=!1),E||(f&&a<=u?(b=a,w=(b-y)/v,E=!0):!f&&u<=o&&(b=o,w=(b-y)/v,E=!0)),E&&(g.isBound=!0,g.pos=w,g.offset=c-w,m.isBound=!0,m.pos=b,m.offset=u-b)}return{vertical:g,horizontal:m}}function ds(t,e,n){var r=t[n?"left":"top"],i=t[n?"right":"bottom"],o=Math.min.apply(Math,e),s=Math.max.apply(Math,e),a=[];return r+1>o&&a.push({isBound:!0,offset:o-r,pos:r}),i-1<s&&a.push({isBound:!0,offset:s-i,pos:i}),a.length||a.push({isBound:!1,offset:0,pos:0}),a.sort((function(t,e){return Math.abs(e.offset)-Math.abs(t.offset)}))}function hs(t,e,n){var r=n?t.map((function(t){return $r(t,n)})):t;return r.some((function(t){return t[0]<e.left&&Math.abs(t[0]-e.left)>.1||t[0]>e.right&&Math.abs(t[0]-e.right)>.1||t[1]<e.top&&Math.abs(t[1]-e.top)>.1||t[1]>e.bottom&&Math.abs(t[1]-e.bottom)>.1}))}function fs(t,e,n){var r=Za(t),i=Math.sqrt(r*r-e*e)||0;return[i,-i].sort((function(e,r){return Math.abs(e-t[n?0:1])-Math.abs(r-t[n?0:1])})).map((function(t){return Ot([0,0],n?[t,e]:[e,t])}))}function ps(t,e,n,r,i){if(!t.props.bounds)return[];var o=i*Math.PI/180,s=us(t),a=s.left,c=s.top,u=s.right,l=s.bottom,d=a-r[0],h=u-r[0],f=c-r[1],p=l-r[1],g={left:d,top:f,right:h,bottom:p};if(!hs(n,g,0))return[];var m=[];return[[d,0],[h,0],[f,1],[p,1]].forEach((function(t){var r=t[0],i=t[1];n.forEach((function(t){var n=Ot([0,0],t);m.push.apply(m,fs(t,r,i).map((function(t){return o+t-n})).filter((function(t){return!hs(e,g,t)})).map((function(t){return Rt(180*t/Math.PI,Xi)})))}))})),m}function gs(t,e){var n,r=t.direction,i=t.classNames,o=t.size,s=t.pos,a=t.zoom,c=t.key,u="horizontal"===r,l=u?"Y":"X";return e.createElement("div",{key:c,className:i.join(" "),style:(n={},n[u?"width":"height"]="".concat(o),n.transform="translate(".concat(s[0],", ").concat(s[1],") translate").concat(l,"(-50%) scale").concat(l,"(").concat(a,")"),n)})}function ms(t,e){return gs(Fi(Fi({},t),{classNames:ji([Ca("line","guideline",t.direction)],t.classNames,!0).filter((function(t){return t})),size:t.size||"".concat(t.sizeValue,"px"),pos:t.pos||t.posValue.map((function(t){return"".concat(Rt(t,.1),"px")}))}),e)}function vs(t,e,n,r,i,o,s,a){var c=t.props.zoom;return n.map((function(t,n){var u=t.type,l=t.pos,d=[0,0];return d[s]=r,d[s?0:1]=-i+l,ms({key:"".concat(e,"TargetGuideline").concat(n),classNames:[Ca("target","bold",u)],posValue:d,sizeValue:o,zoom:c,direction:e},a)}))}function ys(t,e,n,r,i,o){var s=t.props,a=s.zoom,c=s.isDisplayInnerSnapDigit,u="horizontal"===e?Do:ko,l=i[u.start],d=i[u.end];return n.filter((function(t){var e=t.hide,n=t.elementRect;if(e)return!1;if(c&&n){var r=n.rect;if(r[u.start]<=l&&d<=r[u.end])return!1}return!0})).map((function(t,n){var i=t.pos,s=t.size,c=t.element,u=[-r[0]+i[0],-r[1]+i[1]];return ms({key:"".concat(e,"-default-guideline-").concat(n),classNames:c?[Ca("bold")]:[],direction:e,posValue:u,sizeValue:s,zoom:a},o)}))}function bs(t,e,n,r,i,o,s,a){var c,u=t.props,l=u.snapDigit,d=void 0===l?0:l,h=u.isDisplaySnapDigit,f=void 0===h||h,p=u.snapDistFormat,g=void 0===p?function(t){return t}:p,m=u.zoom,v="horizontal"===e?"X":"Y",y="vertical"===e?"height":"width",b=Math.abs(i),w=f?parseFloat(b.toFixed(d)):0;return a.createElement("div",{key:"".concat(e,"-").concat(n,"-guideline-").concat(r),className:Ca("guideline-group",e),style:(c={left:"".concat(o[0],"px"),top:"".concat(o[1],"px")},c[y]="".concat(b,"px"),c)},ms({direction:e,classNames:[Ca(n),s],size:"100%",posValue:[0,0],sizeValue:b,zoom:m},a),a.createElement("div",{className:Ca("size-value","gap"),style:{transform:"translate".concat(v,"(-50%) scale(").concat(m,")")}},w>0?g(w):""))}function ws(t,e,n,r){var i="vertical"===t?0:1,o="vertical"===t?1:0,s=i?Do:ko,a=n[s.start],c=n[s.end];return Ec(e,(function(t){return t.pos[i]})).map((function(e){var n=[],u=[],l=[];return e.forEach((function(e){var l,d,h=e.element,f=e.elementRect.rect;if(f[s.end]<a)n.push(e);else if(c<f[s.start])u.push(e);else if(f[s.start]<=a&&c<=f[s.end]&&r){var p=e.pos,g={element:h,rect:Fi(Fi({},f),(l={},l[s.end]=f[s.start],l))},m={element:h,rect:Fi(Fi({},f),(d={},d[s.start]=f[s.end],d))},v=[0,0],y=[0,0];v[i]=p[i],v[o]=p[o],y[i]=p[i],y[o]=p[o]+e.size,n.push({type:t,pos:v,size:0,elementRect:g}),u.push({type:t,pos:y,size:0,elementRect:m})}})),n.sort((function(t,e){return e.pos[o]-t.pos[o]})),u.sort((function(t,e){return t.pos[o]-e.pos[o]})),{total:e,start:n,end:u,inner:l}}))}function Es(t,e,n,r,i){var o=t.props.isDisplayInnerSnapDigit,s=[];return["vertical","horizontal"].forEach((function(a){var c=e.filter((function(t){return t.type===a})),u="vertical"===a?1:0,l=u?0:1,d=ws(a,c,r,o),h=u?ko:Do,f=u?Do:ko,p=r[h.start],g=r[h.end];d.forEach((function(e){var o=e.total,c=e.start,d=e.end,m=e.inner,v=n[l]+o[0].pos[l]-r[f.start],y=r;c.forEach((function(e){var r=e.elementRect.rect,o=y[h.start]-r[h.end];if(o>0){var c=[0,0];c[u]=n[u]+y[h.start]-p-o,c[l]=v,s.push(bs(t,a,"dashed",s.length,o,c,e.className,i))}y=r})),y=r,d.forEach((function(e){var r=e.elementRect.rect,o=r[h.start]-y[h.end];if(o>0){var c=[0,0];c[u]=n[u]+y[h.end]-p,c[l]=v,s.push(bs(t,a,"dashed",s.length,o,c,e.className,i))}y=r})),m.forEach((function(e){var r=e.elementRect.rect,o=p-r[h.start],c=r[h.end]-g,d=[0,0],f=[0,0];d[u]=n[u]-o,d[l]=v,f[u]=n[u]+g-p,f[l]=v,s.push(bs(t,a,"dashed",s.length,o,d,e.className,i)),s.push(bs(t,a,"dashed",s.length,c,f,e.className,i))}))}))})),s}function Ss(t,e,n,r,i){var o=[];return["horizontal","vertical"].forEach((function(s){var a=e.filter((function(t){return t.type===s})),c="vertical"===s?0:1,u=c?0:1,l=c?ko:Do,d=c?Do:ko,h=r[l.start],f=r[l.end],p=r[d.start],g=r[d.end];a.forEach((function(e){var r=e.gap,s=e.gapRects,a=e.className,m=Math.max.apply(Math,ji([p],s.map((function(t){var e=t.rect;return e[d.start]})),!1)),v=Math.min.apply(Math,ji([g],s.map((function(t){var e=t.rect;return e[d.end]})),!1)),y=(m+v)/2;m!==v&&y!==(p+g)/2&&s.forEach((function(e){var s=e.rect,d=[n[0],n[1]];if(s[l.end]<h)d[c]+=s[l.end]-h;else{if(!(f<s[l.start]))return;d[c]+=s[l.start]-h-r}d[u]+=y-p,o.push(bs(t,c?"vertical":"horizontal","gap",o.length,r,d,a,i))}))}))})),o}function Ds(t,e,n,r){var i=e[0]-t[0],o=e[1]-t[1];if(Math.abs(i)<X&&(i=0),Math.abs(o)<X&&(o=0),!i)return r?[0,0]:[0,n];if(!o)return r?[n,0]:[0,0];var s=o/i,a=t[1]-s*t[0];if(r){var c=s*(e[0]+n)+a;return[n,c-e[1]]}var u=(e[1]+n-a)/s;return[u-e[0],n]}function ks(t,e,n,r,i){var o=Ds(t,e,n,r);if(!o)return{isOutside:!1,offset:[0,0]};var s=Tt(t,e),a=Tt(o,t),c=Tt(o,e),u=a>s||c>s,l=na({datas:i,distX:o[0],distY:o[1]}),d=l[0],h=l[1];return{offset:[d,h],isOutside:u}}function xs(t,e){return t.isBound?t.offset:e.isSnap?Lo(e).offset:0}function Cs(t,e,n,r,i){var o=e[0],s=e[1],a=n[0],c=n[1],u=r[0],l=r[1],d=i[0],h=i[1],f=-d,p=-h;if(t&&o&&s){f=0,p=0;var g=[];if(a&&c?g.push([0,h],[d,0]):a?g.push([d,0]):c?g.push([0,h]):u&&l?g.push([0,h],[d,0]):u?g.push([d,0]):l&&g.push([0,h]),g.length){g.sort((function(t,e){return Za(Nr([o,s],t))-Za(Nr([o,s],e))}));var m=g[0];if(m[0]&&Math.abs(o)>X)f=-m[0],p=s*Math.abs(o+f)/Math.abs(o)-s;else if(m[1]&&Math.abs(s)>X){var v=s;p=-m[1],f=o*Math.abs(s+p)/Math.abs(v)-o}if(t&&c&&a)if(Math.abs(f)>X&&Math.abs(f)<Math.abs(d)){var y=Math.abs(d)/Math.abs(f);f*=y,p*=y}else if(Math.abs(p)>X&&Math.abs(p)<Math.abs(h)){y=Math.abs(h)/Math.abs(p);f*=y,p*=y}else f=kc(-d,f),p=kc(-h,p)}}else f=o||a?-d:0,p=s||c?-h:0;return[f,p]}function _s(t,e,n,r,i,o){if(!xo(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var s=uc(o.absolutePoses,[e,n]),a=Ka(s),c=a.left,u=a.right,l=a.top,d=a.bottom,h={horizontal:s.map((function(t){return t[1]})),vertical:s.map((function(t){return t[0]}))},f=Co(t.props.snapDirections),p=Oo(f,{left:c,right:u,top:l,bottom:d,center:(c+u)/2,middle:(l+d)/2}),g=Os(t,i,p,h),m=g.vertical,v=g.horizontal,y=Qo(t,s,o),b=y.vertical,w=y.horizontal,E=m.isSnap,S=v.isSnap,D=m.isBound||b.isBound,k=v.isBound||w.isBound,x=kc(m.offset,b.offset),C=kc(v.offset,w.offset),_=Cs(r,[e,n],[D,k],[E,S],[x,C]),O=_[0],A=_[1];return[{isBound:D,isSnap:E,offset:O},{isBound:k,isSnap:S,offset:A}]}function Os(t,e,n,r){void 0===r&&(r=n);var i=cs(us(t),r.vertical,r.horizontal),o=i.horizontal,s=i.vertical,a=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:Fo(t,n.vertical,n.horizontal),c=a.horizontal,u=a.vertical,l=xs(o[0],c),d=xs(s[0],u),h=Math.abs(l),f=Math.abs(d);return{horizontal:{isBound:o[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:l,dist:h,bounds:o,snap:c},vertical:{isBound:s[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:d,dist:f,bounds:s,snap:u}}}function As(t,e,n,r,i){var o=cs(e,n,r),s=o.horizontal,a=o.vertical,c=Io(t,n,r,i),u=c.horizontal,l=c.vertical,d=xs(s[0],u),h=xs(a[0],l),f=Math.abs(d),p=Math.abs(h);return{horizontal:{isBound:s[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:d,dist:f,bounds:s,snap:u},vertical:{isBound:a[0].isBound,isSnap:l.isSnap,snapIndex:l.index,offset:h,dist:p,bounds:a,snap:l}}}function Ms(t,e,n,r){var i=Ot(t,e)/Math.PI*180,o=n.vertical,s=o.isBound,a=o.isSnap,c=o.dist,u=n.horizontal,l=u.isBound,d=u.isSnap,h=u.dist,f=i%180,p=f<3||f>177,g=f>87&&f<93;return h<c&&(s||a&&!g&&(!r||!p))?"vertical":!l&&(!d||p||r&&g)?"":"horizontal"}function Ts(t,e,n,r,i,o){return n.map((function(n){var s=n[0],a=n[1],c=aa(e,s),u=aa(e,a),l=r?Ns(t,c,u,i):Os(t,i,{vertical:[u[0]],horizontal:[u[1]]}),d=l.horizontal,h=d.offset,f=d.isBound,p=d.isSnap,g=l.vertical,m=g.offset,v=g.isBound,y=g.isSnap,b=Nr(a,s);if(!m&&!h)return{isBound:v||f,isSnap:y||p,sign:b,offset:[0,0]};var w=Ms(c,u,l,r);if(!w)return{sign:b,isBound:!1,isSnap:!1,offset:[0,0]};var E="vertical"===w,S=ks(c,u,-(E?m:h),E,o).offset.map((function(t,e){return t*(b[e]?2/b[e]:0)}));return{sign:b,isBound:E?v:f,isSnap:E?y:p,offset:S}}))}function Rs(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function Ns(t,e,n,r){var i=ls(t,e,n),o=i.horizontal,s=i.vertical,a=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:zo(t,e,n),c=a.horizontal,u=a.vertical,l=Rs(o,c),d=Rs(s,u),h=Math.abs(l),f=Math.abs(d);return{horizontal:{isBound:o.isBound,isSnap:c.isSnap,offset:l,dist:h},vertical:{isBound:s.isBound,isSnap:u.isSnap,offset:d,dist:f}}}function Ps(t,e,n,r,i){var o=[-n[0],-n[1]],s=t.state,a=s.width,c=s.height,u=t.props.bounds,l=1/0,d=1/0;if(u){var h=[[n[0],-n[1]],[-n[0],n[1]]],f=u.left,p=void 0===f?-1/0:f,g=u.top,m=void 0===g?-1/0:g,v=u.right,y=void 0===v?1/0:v,b=u.bottom,w=void 0===b?1/0:b;h.forEach((function(t){var n=t[0]!==o[0],s=t[1]!==o[1],u=aa(e,t),h=360*Ot(r,u)/Math.PI;if(s){var f=u.slice();(Math.abs(h-360)<2||Math.abs(h-180)<2)&&(f[1]=r[1]);var g=ks(r,f,(r[1]<u[1]?w:m)-u[1],!1,i),v=g.offset,b=v[1],E=g.isOutside;isNaN(b)||(d=c+(E?1:-1)*Math.abs(b))}if(n){f=u.slice();(Math.abs(h-90)<2||Math.abs(h-270)<2)&&(f[0]=r[0]);var S=ks(r,f,(r[0]<u[0]?y:p)-u[0],!0,i),D=S.offset[0],k=S.isOutside;isNaN(D)||(l=a+(k?1:-1)*Math.abs(D))}}))}return{maxWidth:l,maxHeight:d}}function Bs(t){var e=t.state;if(!e.guidelines||!e.guidelines.length){var n=t.state.container,r=t.props.snapContainer||n,i=e.containerClientRect,o={left:0,top:0,bottom:0,right:0};if(n!==r){var s=Bc(r,!0);if(s){var a=ac(s),c=jc(e,[a.left-i.left,a.top-i.top]),u=jc(e,[a.right-i.right,a.bottom-i.bottom]);o.left=Rt(c[0],.1),o.top=Rt(c[1],.1),o.right=Rt(u[0],.1),o.bottom=Rt(u[1],.1)}}e.snapOffset=o,e.guidelines=Po(t),e.enableSnap=!0}}function Fs(t,e,n,r,i,o){var s=Ga(t,e,n,o?4:3),a=aa(s,r);return uc(s,Nr(i,a))}function Is(t,e,n,r,i,o){var s=o.fixedDirection,a=Uo(n,s,r),c=es(e,n,r),u=ji(ji([],Ts(t,e,a,r,i,o),!0),Zo(t,c,aa(e,[0,0]),o),!0),l=Wo(u,0),d=Wo(u,1);return{width:{isBound:l.isBound,offset:l.offset[0]},height:{isBound:d.isBound,offset:d.offset[1]}}}function zs(t,e,n,r,i,o,s,a,c){var u=aa(e,s),l=Os(t,a,{vertical:[u[0]],horizontal:[u[1]]}),d=l.horizontal.offset,h=l.vertical.offset;if(h||d){var f=na({datas:c,distX:-h,distY:-d}),p=f[0],g=f[1],m=Math.min(i||1/0,n+s[0]*p),v=Math.min(o||1/0,r+s[1]*g);return[m-n,v-r]}return[0,0]}function js(t,e,n,r,i,o,s,a){for(var c=lc(t.state),u=t.props.keepRatio,l=0,d=0,h=0;h<2;++h){var f=e(l,d),p=Is(t,f,i,u,s,a),g=p.width,m=p.height,v=g.isBound,y=m.isBound,b=g.offset,w=m.offset;if(1===h&&(v||(b=0),y||(w=0)),0===h&&s&&!v&&!y)return[0,0];if(u){var E=Math.abs(b)*(n?1/n:1),S=Math.abs(w)*(r?1/r:1),D=v&&y?E<S:y||!v&&E<S;D?b=n*w/r:w=r*b/n}l+=b,d+=w}if(i[0]&&i[1]){var k=Ps(t,c,i,o,a),x=k.maxWidth,C=k.maxHeight,_=zs(t,e(l,d).map((function(t){return t.map((function(t){return Rt(t,Yi)}))})),n+l,r+d,x,C,i,s,a);b=_[0],w=_[1];l+=b,d+=w}return[l,d]}function Ls(t,e,n,r){if(!xo(t,"rotatable"))return r;var i=e.pos1,o=e.pos2,s=e.pos3,a=e.pos4,c=r*Math.PI/180,u=[i,o,s,a].map((function(t){return Nr(t,n)})),l=u.map((function(t){return $r(t,c)})),d=ji(ji([],ps(t,u,l,n,r),!0),ss(t,u,l,n,r),!0);return d.sort((function(t,e){return Math.abs(t-r)-Math.abs(e-r)})),d.length?d[0]:r}function $s(t,e,n,r,i,o,s){if(!xo(t,"resizable"))return[0,0];var a=s.fixedDirection,c=t.state,u=c.allMatrix,l=c.is3d;return js(t,(function(t,r){return Fs(u,e+t,n+r,a,i,l)}),e,n,r,i,o,s)}function Hs(t,e,n,r,i){if(!xo(t,"scalable"))return[0,0];var o=i.startOffsetWidth,s=i.startOffsetHeight,a=i.fixedPosition,c=i.fixedDirection,u=i.is3d,l=js(t,(function(t,n){return Fs(da(i,Rr(e,[t/o,n/s])),o,s,c,a,u)}),o,s,n,a,r,i);return[l[0]/o,l[1]/s]}function Vs(t,e){e.absolutePoses=lc(t.state)}function Ws(t){var e=[];return t.forEach((function(t){t.guidelineInfos.forEach((function(t){var n=t.guideline;e.indexOf(n)>-1||e.push(n)}))})),e}function Us(t,e,n,r,i,o){var s=cs(us(t,o),e,n),a=s.vertical,c=s.horizontal;a.forEach((function(t){t.isBound&&r.push({type:"bounds",pos:t.pos})})),c.forEach((function(t){t.isBound&&i.push({type:"bounds",pos:t.pos})}));var u=as(t),l=u.vertical,d=u.horizontal;l.forEach((function(t){vt(r,(function(e){var n=e.type,r=e.pos;return"bounds"===n&&r===t}))>=0||r.push({type:"bounds",pos:t})})),d.forEach((function(t){vt(i,(function(e){var n=e.type,r=e.pos;return"bounds"===n&&r===t}))>=0||i.push({type:"bounds",pos:t})}))}var qs={name:"snappable",dragRelation:"strong",props:{snappable:[Boolean,Array],snapContainer:Object,snapDirections:[Boolean,Object],elementSnapDirections:[Boolean,Object],snapGap:Boolean,snapGridWidth:Number,snapGridHeight:Number,isDisplaySnapDigit:Boolean,isDisplayInnerSnapDigit:Boolean,snapDigit:Number,snapThreshold:Number,horizontalGuidelines:Array,verticalGuidelines:Array,elementGuidelines:Array,bounds:Object,innerBounds:Object,snapDistFormat:Function},events:{onSnap:"snap"},css:[":host {\n    --bounds-color: #d66;\n}\n.guideline {\n    pointer-events: none;\n    z-index: 2;\n}\n.guideline.bounds {\n    background: #d66;\n    background: var(--bounds-color);\n}\n.guideline-group {\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n.guideline-group .size-value {\n    position: absolute;\n    color: #f55;\n    font-size: 12px;\n    font-weight: bold;\n}\n.guideline-group.horizontal .size-value {\n    transform-origin: 50% 100%;\n    transform: translateX(-50%);\n    left: 50%;\n    bottom: 5px;\n}\n.guideline-group.vertical .size-value {\n    transform-origin: 0% 50%;\n    top: 50%;\n    transform: translateY(-50%);\n    left: 5px;\n}\n.guideline.gap {\n    background: #f55;\n}\n.size-value.gap {\n    color: #f55;\n}\n"],render:function(t,e){var n=t.state,r=n.top,i=n.left,o=n.pos1,s=n.pos2,a=n.pos3,c=n.pos4,u=n.snapRenderInfo;if(!u||!xo(t,""))return[];n.guidelines=Po(t);var l=Math.min(o[0],s[0],a[0],c[0]),d=Math.min(o[1],s[1],a[1],c[1]),h=u.externalPoses||[],f=lc(t.state),p=[],g=[],m=[],v=[],y=[],b=Ka(f),w=b.width,E=b.height,S=b.top,D=b.left,k=b.bottom,x=b.right,C={left:D,right:x,top:S,bottom:k,center:(D+x)/2,middle:(S+k)/2},_=h.length>0,O=_?Ka(h):{};if(!u.request){if(u.direction&&y.push(Ho(t,f,u.direction)),u.snap){var A=Ka(f);u.center&&(A.middle=(A.top+A.bottom)/2,A.center=(A.left+A.right)/2),y.push(jo(t,A,1))}_&&(u.center&&(O.middle=(O.top+O.bottom)/2,O.center=(O.left+O.right)/2),y.push(jo(t,O,1))),y.forEach((function(t){var e=t.vertical.posInfos,n=t.horizontal.posInfos;p.push.apply(p,e.filter((function(t){var e=t.guidelineInfos;return e.some((function(t){var e=t.guideline;return!e.hide}))})).map((function(t){return{type:"snap",pos:t.pos}}))),g.push.apply(g,n.filter((function(t){var e=t.guidelineInfos;return e.some((function(t){var e=t.guideline;return!e.hide}))})).map((function(t){return{type:"snap",pos:t.pos}}))),m.push.apply(m,Ws(e)),v.push.apply(v,Ws(n))}))}Us(t,[D,x],[S,k],p,g),_&&Us(t,[O.left,O.right],[O.top,O.bottom],p,g,u.externalBounds);var M=ji(ji([],m,!0),v,!0),T=M.filter((function(t){return t.element&&!t.gapRects})),R=M.filter((function(t){return t.gapRects}));return mc(t,"onSnap",{guidelines:M.filter((function(t){var e=t.element;return!e})),elements:T,gaps:R},!0),ji(ji(ji(ji(ji(ji([],Es(t,T,[l,d],C,e),!0),Ss(t,R,[l,d],C,e),!0),ys(t,"horizontal",v,[i,r],C,e),!0),ys(t,"vertical",m,[i,r],C,e),!0),vs(t,"horizontal",g,l,r,w,0,e),!0),vs(t,"vertical",p,d,i,E,1,e),!0)},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},Bs(t)},drag:function(t){var e=t.state;e.guidelines=Po(t)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){return!(!Tc(t,e)&&!bo(t,e))||(!e.isRequest&&e.inputEvent?Pt(e.inputEvent.target,Ca("snap-control")):void 0)},dragControlStart:function(t){t.state.snapRenderInfo=null,Bs(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,Bs(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}},Gs={name:"draggable",props:{draggable:Boolean,throttleDrag:Number,throttleDragRotate:Number,startDragRotate:Number,edgeDraggable:Boolean},events:{onDragStart:"dragStart",onDrag:"drag",onDragEnd:"dragEnd",onDragGroupStart:"dragGroupStart",onDragGroup:"dragGroup",onDragGroupEnd:"dragGroupEnd"},render:function(t,e){var n=t.props,r=n.throttleDragRotate,i=n.zoom,o=t.state,s=o.dragInfo,a=o.beforeOrigin;if(!r||!s)return[];var c=s.dist;if(!c[0]&&!c[1])return[];var u=Za(c),l=Ot(c,[0,0]);return[e.createElement("div",{className:Ca("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(u,"px"),transform:"translate(".concat(a[0],"px, ").concat(a[1],"px) rotate(").concat(l,"rad) scaleY(").concat(i,")")}})]},dragStart:function(t,e){var n=e.datas,r=e.parentEvent,i=e.parentGesto,o=t.state,s=o.target,a=o.gesto;if(a)return!1;o.gesto=i||t.targetGesto;var c=vc(s);n.datas={},n.left=parseFloat(c.left||"")||0,n.top=parseFloat(c.top||"")||0,n.bottom=parseFloat(c.bottom||"")||0,n.right=parseFloat(c.right||"")||0,n.startValue=[0,0],Ys(t,e),fa(e,"translate"),Vs(t,n),n.prevDist=[0,0],n.prevBeforeDist=[0,0],n.isDrag=!1,n.deltaOffset=[0,0];var u=fc(t,e,Fi({set:function(t){n.startValue=t}},ha(e))),l=r||mc(t,"onDragStart",u);return!1!==l?(n.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(o.gesto=null,n.isPinch=!1),!!n.isDrag&&u},drag:function(t,e){if(e){Js(e,"translate");var n=e.datas,r=e.parentEvent,i=e.parentFlag,o=e.isPinch,s=e.isRequest,a=e.deltaOffset,c=e.distX,u=e.distY,l=n.isDrag,d=n.prevDist,h=n.prevBeforeDist,f=n.startValue;if(l){a&&(c+=a[0],u+=a[1]);var p=t.props,g=p.parentMoveable,m=r?0:p.throttleDrag||0,v=r?0:p.throttleDragRotate||0,y=!1,b=0;if(!r&&v>0&&(c||u)){var w=p.startDragRotate||0,E=Rt(w+180*Ot([0,0],[c,u])/Math.PI,v)-w,S=u*Math.abs(Math.cos((E-90)/180*Math.PI)),D=c*Math.abs(Math.cos(E/180*Math.PI)),k=Za([D,S]);b=E*Math.PI/180,c=k*Math.cos(b),u=k*Math.sin(b)}if(!o&&!r&&!i&&(!v||c||u)){var x=_s(t,c,u,v,s||a,n),C=x[0],_=x[1],O=C.isSnap,A=C.isBound,M=C.offset,T=_.isSnap,R=_.isBound,N=_.offset;y=O||T||A||R,c+=M,u+=N}var P=Rr(ea({datas:n,distX:c,distY:u}),f),B=Rr(Qs({datas:n,distX:c,distY:u}),f);v||y||(Nt(B,m),Nt(P,m));var F=Nr(P,f),I=Nr(B,f),z=Nr(I,d),j=Nr(F,h);n.prevDist=I,n.prevBeforeDist=F,n.passDelta=z,n.passDist=I;var L=n.left+F[0],$=n.top+F[1],H=n.right-F[0],V=n.bottom-F[1],W=Zs(n,"translate(".concat(B[0],"px, ").concat(B[1],"px)"),"translate(".concat(I[0],"px, ").concat(I[1],"px)"));if(ga(e,W),t.state.dragInfo.dist=r?[0,0]:I,r||g||!z.every((function(t){return!t}))||!j.some((function(t){return!t}))){var U=t.state,q=U.width,G=U.height,K=fc(t,e,{transform:W,dist:I,delta:z,translate:B,beforeDist:F,beforeDelta:j,beforeTranslate:P,left:L,top:$,right:H,bottom:V,width:q,height:G,isPinch:o});return!r&&mc(t,"onDrag",K),K}}}},dragAfter:function(t,e){var n=e.datas,r=n.deltaOffset;return!(!r[0]&&!r[1])&&(n.deltaOffset=[0,0],this.drag(t,Fi(Fi({},e),{deltaOffset:r})))},dragEnd:function(t,e){var n=e.parentEvent,r=e.datas;if(t.state.gesto=null,t.state.dragInfo=null,r.isDrag){r.isDrag=!1;var i=pc(t,e,{});return!n&&mc(t,"onDragEnd",i),i}},dragGroupStart:function(t,e){var n=e.datas,r=e.clientX,i=e.clientY,o=this.dragStart(t,e);if(!o)return!1;var s=ao(t,this,"dragStart",[r||0,i||0],e,!1),a=Fi(Fi({},o),{targets:t.props.targets,events:s}),c=mc(t,"onDragGroupStart",a);return n.isDrag=!1!==c,!!n.isDrag&&o},dragGroup:function(t,e){var n=e.datas;if(n.isDrag){var r=this.drag(t,e),i=e.datas.passDelta,o=ao(t,this,"drag",i,e,!1);if(r){var s=Fi({targets:t.props.targets,events:o},r);return mc(t,"onDragGroup",s),s}}},dragGroupEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isDrag){this.dragEnd(t,e);var i=ao(t,this,"dragEnd",[0,0],e,!1);return mc(t,"onDragGroupEnd",pc(t,e,{targets:t.props.targets,events:i})),n}},request:function(t){var e={},n=t.getRect(),r=0,i=0;return{isControl:!1,requestStart:function(){return{datas:e}},request:function(t){return"x"in t?r=t.x-n.left:"deltaX"in t&&(r+=t.deltaX),"y"in t?i=t.y-n.top:"deltaY"in t&&(i+=t.deltaY),{datas:e,distX:r,distY:i}},requestEnd:function(){return{datas:e,isDrag:!0}}}},unset:function(t){t.state.dragInfo=null}};function Ks(t,e){var n=e.clientX,r=e.clientY,i=e.datas,o=t.state,s=o.moveableClientRect,a=o.rootMatrix,c=o.is3d,u=o.pos1,l=s.left,d=s.top,h=c?4:3,f=Nr(xc(a,[n-l,r-d],h),u),p=f[0],g=f[1],m=na({datas:i,distX:p,distY:g}),v=m[0],y=m[1];return[v,y]}function Ys(t,e){var n=e.datas,r=t.state,i=r.allMatrix,o=r.beforeMatrix,s=r.is3d,a=r.left,c=r.top,u=r.origin,l=r.offsetMatrix,d=r.targetMatrix,h=r.transformOrigin,f=s?4:3;n.is3d=s,n.matrix=i,n.targetMatrix=d,n.beforeMatrix=o,n.offsetMatrix=l,n.transformOrigin=h,n.inverseMatrix=kr(i,f),n.inverseBeforeMatrix=kr(o,f),n.absoluteOrigin=Or(Rr([a,c],u),f),n.startDragBeforeDist=Fr(n.inverseBeforeMatrix,n.absoluteOrigin,f),n.startDragDist=Fr(n.inverseMatrix,n.absoluteOrigin,f)}function Xs(t){return Ja(t.datas.beforeTransform,[50,50],100,100).direction}function Js(t,e){var n=t.datas,r=t.originalDatas.beforeRenderable,i=n.transformIndex,o=r.nextTransforms,s=r.nextTransformAppendedIndexes,a=0;-1===i?(a=o.length,n.transformIndex=a):a=i+s.filter((function(t){return t<i})).length;var c=Nc(o,a),u=c.targetFunction,l="rotate"===e?"rotateZ":e;n.beforeFunctionTexts=c.beforeFunctionTexts,n.afterFunctionTexts=c.afterFunctionTexts,n.beforeTransform=c.beforeFunctionMatrix,n.beforeTransform2=c.beforeFunctionMatrix2,n.targetTansform=c.targetFunctionMatrix,n.afterTransform=c.afterFunctionMatrix,n.afterTransform2=c.afterFunctionMatrix2,n.targetAllTransform=c.allFunctionMatrix,u.functionName===l?(n.afterFunctionTexts.splice(0,1),n.isAppendTransform=!1):(n.isAppendTransform=!0,r.nextTransformAppendedIndexes=ji(ji([],s,!0),[a],!1))}function Zs(t,e,n){return"".concat(t.beforeFunctionTexts.join(" ")," ").concat(t.isAppendTransform?n:e," ").concat(t.afterFunctionTexts.join(" "))}function Qs(t){var e=t.datas,n=t.distX,r=t.distY,i=ea({datas:e,distX:n,distY:r}),o=i[0],s=i[1],a=ta(e,_r([o,s],4));return Fr(a,Or([0,0,0],4),4)}function ta(t,e,n){var r=t.beforeTransform,i=t.afterTransform,o=t.beforeTransform2,s=t.afterTransform2,a=t.targetAllTransform,c=n?Tr(a,e,4):Tr(e,a,4),u=Tr(kr(n?o:r,4),c,4),l=Tr(u,kr(n?s:i,4),4);return l}function ea(t){var e=t.datas,n=t.distX,r=t.distY,i=e.inverseBeforeMatrix,o=e.is3d,s=e.startDragBeforeDist,a=e.absoluteOrigin,c=o?4:3;return Nr(Fr(i,Rr(a,[n,r]),c),s)}function na(t,e){var n=t.datas,r=t.distX,i=t.distY,o=n.inverseBeforeMatrix,s=n.inverseMatrix,a=n.is3d,c=n.startDragBeforeDist,u=n.startDragDist,l=n.absoluteOrigin,d=a?4:3;return Nr(Fr(e?o:s,Rr(l,[r,i]),d),e?c:u)}function ra(t,e){var n=t.datas,r=t.distX,i=t.distY,o=n.beforeMatrix,s=n.matrix,a=n.is3d,c=n.startDragBeforeDist,u=n.startDragDist,l=n.absoluteOrigin,d=a?4:3;return Nr(Fr(e?o:s,Rr(e?c:u,[r,i]),d),l)}function ia(t,e,n,r,i,o){return void 0===r&&(r=e),void 0===i&&(i=n),void 0===o&&(o=[0,0]),t?t.map((function(t,s){var a=ft(t),c=a.value,u=a.unit,l=s?i:r,d=s?n:e;if("%"===t||isNaN(c)){var h=l?o[s]/l:0;return d*h}return"%"!==u?c:d*c/100})):o}function oa(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function sa(t,e){return oa(e).map((function(e){return t[e]}))}function aa(t,e){var n=sa(t,e);return[_t(n.map((function(t){return t[0]}))),_t(n.map((function(t){return t[1]})))]}function ca(t,e,n,r,i,o){var s=Ga(e,n,r,i),a=aa(s,o),c=t[0]-a[0],u=t[1]-a[1];return[c,u]}function ua(t,e,n,r){return Tr(t,Oa(e,r,n),r)}function la(t,e,n){var r=t.transformOrigin,i=t.offsetMatrix,o=t.is3d,s=e.beforeTransform,a=e.afterTransform,c=o?4:3,u=Xr([n]);return ua(i,Ar(Tr(Tr(s,u,4),a,4),4,c),r,c)}function da(t,e){var n=t.transformOrigin,r=t.offsetMatrix,i=t.is3d,o=t.targetMatrix,s=i?4:3;return ua(r,Tr(o,qr(e,s),s),n,s)}function ha(t){var e=t.originalDatas.beforeRenderable;return{setTransform:function(n,r){void 0===r&&(r=-1),e.startTransforms=et(n)?n:lt(n),pa(t,r)},setTransformIndex:function(e){pa(t,e)}}}function fa(t,e){var n=t.originalDatas.beforeRenderable,r=n.startTransforms;pa(t,vt(r,(function(t){return 0===t.indexOf("".concat(e,"("))})))}function pa(t,e){var n=t.originalDatas.beforeRenderable,r=t.datas;if(r.transformIndex=e,-1!==e){var i=n.startTransforms[e];if(i){var o=ti([i]);r.startValue=o[0].functionValue}}}function ga(t,e){var n=t.originalDatas.beforeRenderable;n.nextTransforms=lt(e)}function ma(t){var e=t.originalDatas.beforeRenderable;return e.nextTransforms.join(" ")}function va(t,e,n,r,i){return ga(i,e),{transform:e,drag:Gs.drag(t,io(i,t.state,n,r,!1))}}function ya(t,e,n,r,i){var o=t.state,s=o.left,a=o.top,c=t.props.groupable,u=la(t.state,i,e),l=c?s:0,d=c?a:0,h=Ea(t,n,u),f=Nr(r,h);return Nr(f,[l,d])}function ba(t,e,n,r,i){var o=ya(t,"scale(".concat(e.join(", "),")"),n,r,i);return o}function wa(t){var e=t.state,n=e.width,r=e.height,i=e.transformOrigin;return[i[0]/(n/2)-1,i[1]/(r/2)-1]}function Ea(t,e,n){void 0===n&&(n=t.state.allMatrix);var r=t.state,i=r.width,o=r.height,s=r.is3d,a=s?4:3,c=[i/2*(1+e[0]),o/2*(1+e[1])];return qa(n,c,a)}function Sa(t,e,n,r){var i=wa(t);return ya(t,"rotate(".concat(e,"deg)"),i,n,r)}function Da(t,e,n,r,i,o){var s=t.props.groupable,a=t.state,c=a.transformOrigin,u=a.targetMatrix,l=a.offsetMatrix,d=a.is3d,h=a.width,f=a.height,p=a.left,g=a.top,m=d?4:3,v=ia(o,e,n,h,f,c),y=s?p:0,b=s?g:0,w=ua(l,u,v,m),E=ca(i,w,e,n,m,r);return Nr(E,[y,b])}function ka(t,e){return aa(lc(t.state),e)}function xa(t,e){return[t[0]*e[0],t[1]*e[1]]}function Ca(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return oe.apply(void 0,ji([qi],t,!1))}function _a(t){return t&&"none"!==t?tt(t)?t:Xr(t):[1,0,0,1,0,0]}function Oa(t,e,n){return Mr(e,Gr(n,e),t,Gr(n.map((function(t){return-t})),e))}function Aa(t,e,n){if("%"===e){var r=Va(t.ownerSVGElement);return r[n?"width":"height"]/100}return 1}function Ma(t){var e=Ta(vc(t,":before"));return e.map((function(e,n){var r=ft(e),i=r.value,o=r.unit;return i*Aa(t,o,0===n)}))}function Ta(t){var e=t.transformOrigin;return e?e.split(" "):["0","0"]}function Ra(t,e){void 0===e&&(e=vc(t));var n=e.transform;if(n&&"none"!==n)return e.transform;if("transform"in t){var r=t.transform,i=r.baseVal;if(!i)return"";var o=i.length;if(!o)return"";for(var s=[],a=function(t){var e=i[0].matrix;s.push("matrix(".concat(["a","b","c","d","e","f"].map((function(t){return e[t]})).join(", "),")"))},c=0;c<o;++c)a(c);return s.join(" ")}return""}function Na(t,e,n){var r=document.body,i=!t||n?t:t.parentElement,o=t===e||i===e,s="relative";while(i&&i!==r){e===i&&(o=!0);var a=vc(i),c=i.tagName.toLowerCase(),u=Ra(i,a);if(s=a.position,"svg"===c||"static"!==s||u&&"none"!==u)break;i=i.parentElement,s="relative"}return{isStatic:"static"===s,isEnd:o||!i||i===r,offsetParent:i||r}}function Pa(t,e){var n,r,i,o=t.tagName.toLowerCase(),s=t.offsetLeft,a=t.offsetTop,c=Q(s),u=!c;return u||"svg"===o?(r=Ta(e).map((function(t){return parseFloat(t)})),i=r.slice()):(r=Ui?Ma(t):Ta(e).map((function(t){return parseFloat(t)})),i=r.slice(),u=!0,n=Ua(t,r),s=n[0],a=n[1],r[0]=n[2],r[1]=n[3]),{tagName:o,isSVG:c,hasOffset:u,offset:[s||0,a||0],origin:r,targetOrigin:i}}function Ba(t,e,n){void 0===n&&(n=vc(t));var r=vc(document.body),i=r.position;if(!e&&(!i||"static"===i))return[0,0];var o=parseInt(r.marginLeft,10),s=parseInt(r.marginTop,10);return"absolute"===n.position&&("auto"===n.top&&"auto"===n.bottom||(s=0),"auto"===n.left&&"auto"===n.right||(o=0)),[o,s]}function Fa(t){t.forEach((function(t){var e=t.matrix;e&&(t.matrix=Ar(e,3,4))}))}function Ia(){return[document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop]}function za(t){var e=t.parentElement,n=!1;while(e){var r=vc(e).transform;if(r&&"none"!==r){n=!0;break}if(e===document.body)break;e=e.parentElement}return{fixedContainer:e||document.body,hasTransform:n}}function ja(t,e,n){var r,i,o,s=t,a=[],c=!n&&t===e||t===document.body,u=c,l=!1,d=3,h=!1,f=Na(e,e,!0).offsetParent;while(s&&!u){u=c;var p=vc(s),g=p.position,m=Ra(s,p),v=Pr(_a(m)),y="fixed"===g,b={hasTransform:!1,fixedContainer:null};y&&(h=!0,b=za(s),f=b.fixedContainer);var w=v.length;l||16!==w||(l=!0,d=4,Fa(a),o&&(o=Ar(o,3,4))),l&&9===w&&(v=Ar(v,3,4));var E=Pa(s,p),S=E.tagName,D=E.hasOffset,k=E.isSVG,x=E.origin,C=E.targetOrigin,_=E.offset,O=_[0],A=_[1];"svg"===S&&o?(a.push({type:"target",target:s,matrix:Wa(s,d)}),a.push({type:"offset",target:s,matrix:Ur(d)})):"g"===S&&t!==s&&(O=0,A=0);var M=void 0,T=!1,R=!1;if(y)M=b.fixedContainer,T=!0;else{var N=Na(s,e);M=N.offsetParent,T=N.isEnd,R=N.isStatic}Wi&&D&&!k&&R&&("relative"===g||"static"===g)&&(O-=M.offsetLeft,A-=M.offsetTop,c=c||T);var P=0,B=0,F=0,I=0;if(y)D&&b.hasTransform&&(F=M.clientLeft,I=M.clientTop);else if(D&&f!==M&&(P=M.clientLeft,B=M.clientTop),D&&M===document.body){var z=Ba(s,!1,p);O+=z[0],A+=z[1]}if(a.push({type:"target",target:s,matrix:Oa(v,d,x)}),D?a.push({type:"offset",target:s,matrix:Gr([O-s.scrollLeft+P-F,A-s.scrollTop+B-I],d)}):a.push({type:"offset",target:s,origin:x}),o||(o=v),r||(r=x),i||(i=C),u||y)break;s=M,c=T,n&&s!==document.body||(u=c)}return o||(o=Ur(d)),r||(r=[0,0]),i||(i=[0,0]),{offsetContainer:f,matrixes:a,targetMatrix:o,transformOrigin:r,targetOrigin:i,is3d:l,hasFixed:h}}function La(t,e,n,r){void 0===n&&(n=e);var i=0,o=0,s=0,a={};if(t){var c=rc(t),u=c.offsetWidth,l=c.offsetHeight;i=u,o=l}if(t){var d=$a(t,e,n,r),h=Ja(d.allMatrix,d.transformOrigin,i,o);a=Fi(Fi({},d),h);var f=Ja(d.allMatrix,[50,50],100,100);s=ic([f.pos1,f.pos2],f.direction)}var p=r?4:3;return Fi({width:i,height:o,rotation:s,rootMatrix:Ur(p),beforeMatrix:Ur(p),offsetMatrix:Ur(p),allMatrix:Ur(p),targetMatrix:Ur(p),targetTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!r,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1},a)}function $a(t,e,n,r){var i;void 0===n&&(n=e);var o=ja(t,e),s=o.matrixes,a=o.is3d,c=o.targetMatrix,u=o.transformOrigin,l=o.targetOrigin,d=o.offsetContainer,h=o.hasFixed,f=ja(d,n,!0),p=f.matrixes,g=f.is3d,m=r||g||a,v=m?4:3,y="svg"!==t.tagName.toLowerCase()&&"ownerSVGElement"in t,b=c,w=Ur(v),E=Ur(v),S=Ur(v),D=Ur(v),k=s.length;p.reverse(),s.reverse(),!a&&m&&(b=Ar(b,3,4),Fa(s)),!g&&m&&Fa(p),p.forEach((function(t){E=Tr(E,t.matrix,v)}));var x=n||document.body,C=(null===(i=p[0])||void 0===i?void 0:i.target)||Na(x,x,!0).offsetParent,_=p.slice(1).reduce((function(t,e){return Tr(t,e.matrix,v)}),Ur(v));s.forEach((function(t,e){if(k-2===e&&(S=w.slice()),k-1===e&&(D=w.slice()),!t.matrix){var n=s[e+1],r=Xa(t,n,C,v,Tr(_,w,v));t.matrix=Gr(r,v)}w=Tr(w,t.matrix,v)}));var O=!y&&a;b||(b=Ur(O?4:3));var A=Ha(y&&16===b.length?Ar(b,4,3):b,O);return E=Dr(E,v,v),{hasFixed:h,rootMatrix:E,beforeMatrix:S,offsetMatrix:D,allMatrix:w,targetMatrix:b,targetTransform:A,transformOrigin:u,targetOrigin:l,is3d:m}}function Ha(t,e){return void 0===e&&(e=t.length>9),"".concat(e?"matrix3d":"matrix","(").concat(Br(t,!e).join(","),")")}function Va(t){var e=t.clientWidth,n=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:n};var r=t.viewBox,i=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||n,clientWidth:e,clientHeight:n}}function Wa(t,e){var n=Va(t),r=n.width,i=n.height,o=n.clientWidth,s=n.clientHeight,a=o/r,c=s/i,u=t.preserveAspectRatio.baseVal,l=u.align,d=u.meetOrSlice,h=[0,0],f=[a,c],p=[0,0];if(1!==l){var g=(l-2)%3,m=Math.floor((l-2)/3);h[0]=r*g/2,h[1]=i*m/2;var v=2===d?Math.max(c,a):Math.min(a,c);f[0]=v,f[1]=v,p[0]=(o-r)/2*g,p[1]=(s-i)/2*m}var y=qr(f,e);return y[e*(e-1)]=p[0],y[e*(e-1)+1]=p[1],Oa(y,e,h)}function Ua(t,e){if(!t.getBBox||"g"===t.tagName.toLowerCase())return[0,0,0,0];var n=t.getBBox(),r=Va(t.ownerSVGElement),i=n.x-r.x,o=n.y-r.y;return[i,o,e[0]-i,e[1]-o]}function qa(t,e,n){return Fr(t,Or(e,n),n)}function Ga(t,e,n,r){return[[0,0],[e,0],[0,n],[e,n]].map((function(e){return qa(t,e,r)}))}function Ka(t){var e=t.map((function(t){return t[0]})),n=t.map((function(t){return t[1]})),r=Math.min.apply(Math,e),i=Math.min.apply(Math,n),o=Math.max.apply(Math,e),s=Math.max.apply(Math,n),a=o-r,c=s-i;return{left:r,top:i,right:o,bottom:s,width:a,height:c}}function Ya(t,e,n,r){var i=Ga(t,e,n,r);return Ka(i)}function Xa(t,e,n,r,i){var o,s=t.target,a=t.origin,c=e.matrix,u=rc(s),l=u.offsetWidth,d=u.offsetHeight,h=n.getBoundingClientRect(),f=[0,0];n===document.body&&(f=Ba(s,!0));var p=s.getBoundingClientRect(),g=p.left-h.left+n.scrollLeft-(n.clientLeft||0)+f[0],m=p.top-h.top+n.scrollTop-(n.clientTop||0)+f[1],v=p.width,y=p.height,b=Mr(r,i,c),w=Ya(b,l,d,r),E=w.left,S=w.top,D=w.width,k=w.height,x=qa(b,a,r),C=Nr(x,[E,S]),_=[g+C[0]*v/D,m+C[1]*y/k],O=[0,0],A=0;while(++A<10){var M=kr(i,r);o=Nr(qa(M,_,r),qa(M,x,r)),O[0]=o[0],O[1]=o[1];var T=Mr(r,i,Gr(O,r),c),R=Ya(T,l,d,r),N=R.left,P=R.top,B=N-g,F=P-m;if(Math.abs(B)<2&&Math.abs(F)<2)break;_[0]-=B,_[1]-=F}return O.map((function(t){return Math.round(t)}))}function Ja(t,e,n,r){var i=16===t.length,o=i?4:3,s=Ga(t,n,r,o),a=s[0],c=a[0],u=a[1],l=s[1],d=l[0],h=l[1],f=s[2],p=f[0],g=f[1],m=s[3],v=m[0],y=m[1],b=qa(t,e,o),w=b[0],E=b[1],S=Math.min(c,d,p,v),D=Math.min(u,h,g,y),k=Math.max(c,d,p,v),x=Math.max(u,h,g,y);c=c-S||0,d=d-S||0,p=p-S||0,v=v-S||0,u=u-D||0,h=h-D||0,g=g-D||0,y=y-D||0,w=w-S||0,E=E-D||0;var C=Mt(s);return{left:S,top:D,right:k,bottom:x,origin:[w,E],pos1:[c,u],pos2:[d,h],pos3:[p,g],pos4:[v,y],direction:C}}function Za(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Qa(t,e){return Za([e[0]-t[0],e[1]-t[1]])}function tc(t,e,n,r){void 0===n&&(n=1),void 0===r&&(r=Ot(t,e));var i=Qa(t,e);return{transform:"translateY(-50%) translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(r,"rad) scaleY(").concat(n,")"),width:"".concat(i,"px")}}function ec(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n.length,o=n.reduce((function(t,e){return t+e[0]}),0)/i,s=n.reduce((function(t,e){return t+e[1]}),0)/i;return{transform:"translateZ(0px) translate(".concat(o,"px, ").concat(s,"px) rotate(").concat(t,"rad) scale(").concat(e,")")}}function nc(t){var e=vc(t);return[parseFloat(e.width),parseFloat(e.height)]}function rc(t,e){void 0===e&&(e=vc(t));var n=!Q(t.offsetWidth);if(n||"svg"===t.tagName.toLowerCase()){var r="border-box"===e.boxSizing,i=parseFloat(e.borderLeftWidth)||0,o=parseFloat(e.borderRightWidth)||0,s=parseFloat(e.borderTopWidth)||0,a=parseFloat(e.borderBottomWidth)||0,c=parseFloat(e.paddingLeft)||0,u=parseFloat(e.paddingRight)||0,l=parseFloat(e.paddingTop)||0,d=parseFloat(e.paddingBottom)||0,h=parseFloat(e.width),f=parseFloat(e.height),p=(D=h,k=f,h),g=f,m=c+u,v=l+d,y=i+o,b=s+a,w=m+y,E=v+b;return r?(h=D-w,f=k-E):(D=h+w,k=f+E),p=h+m,g=f+v,{svg:!1,offsetWidth:D,offsetHeight:k,clientWidth:p,clientHeight:g,cssWidth:h,cssHeight:f}}var S=t.getBBox(),D=S.width,k=S.height;return{svg:!0,offsetWidth:D,offsetHeight:k,clientWidth:D,clientHeight:k,cssWidth:D,cssHeight:k}}function ic(t,e){return Ot(e>0?t[0]:t[1],e>0?t[1]:t[0])}function oc(t,e,n,r,i){var o=1,s=[0,0],a=sc(),c=sc(),u=sc(),l=La(e,n,i,!1);if(e){var d=l.is3d?4:3,h=Ja(l.offsetMatrix,Rr(l.transformOrigin,Cr(l.targetMatrix,d)),l.width,l.height);o=h.direction,s=Rr(h.origin,[h.left-l.left,h.top-l.top]),a=ac(e),c=ac(Na(r,r,!0).offsetParent||document.body,!0),t&&(u=ac(t))}return Fi({targetClientRect:a,containerClientRect:c,moveableClientRect:u,beforeDirection:o,beforeOrigin:s,originalBeforeOrigin:s,target:e},l)}function sc(){return{left:0,right:0,top:0,bottom:0,width:0,height:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function ac(t,e){var n,r=0,i=0,o=0,s=0;if(t===document.body||t===document.documentElement){o=window.innerWidth,s=window.innerHeight;var a=Ia();n=[-a[0],-a[1]],r=n[0],i=n[1]}else{var c=t.getBoundingClientRect();r=c.left,i=c.top,o=c.width,s=c.height}var u={left:r,right:r+o,top:i,bottom:i+s,width:o,height:s};return e&&(u.clientLeft=t.clientLeft,u.clientTop=t.clientTop,u.clientWidth=t.clientWidth,u.clientHeight=t.clientHeight,u.scrollWidth=t.scrollWidth,u.scrollHeight=t.scrollHeight,u.overflow="visible"!==vc(t).overflow),u}function cc(t){if(t){var e=t.getAttribute("data-direction");if(e){var n=[0,0];return e.indexOf("w")>-1&&(n[0]=-1),e.indexOf("e")>-1&&(n[0]=1),e.indexOf("n")>-1&&(n[1]=-1),e.indexOf("s")>-1&&(n[1]=1),n}}}function uc(t,e){return[Rr(e,t[0]),Rr(e,t[1]),Rr(e,t[2]),Rr(e,t[3])]}function lc(t){var e=t.left,n=t.top,r=t.pos1,i=t.pos2,o=t.pos3,s=t.pos4;return uc([r,i,o,s],[e,n])}function dc(t){return Math.round(t%1===-.5?t-1:t)}function hc(t,e){var n;null===(n=t[e])||void 0===n||n.unset(),t[e]=null}function fc(t,e,n,r){var i=e.datas;i.datas||(i.datas={});var o=Fi(Fi({},n),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:i.datas});return i.isStartEvent?r||(i.lastEvent=o):i.isStartEvent=!0,o}function pc(t,e,n){var r=e.datas,i="isDrag"in n?n.isDrag:e.isDrag;return r.datas||(r.datas={}),Fi(Fi({isDrag:i},n),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas})}function gc(t,e,n){t._emitter.on(e,n)}function mc(t,e,n,r){return t.triggerEvent(e,n,r)}function vc(t,e){return window.getComputedStyle(t,e)}function yc(t,e,n){var r={},i={};return t.filter((function(t){var o=t.name;if(r[o]||!e.some((function(e){return t[e]})))return!1;if(!n&&t.ableGroup){if(i[t.ableGroup])return!1;i[t.ableGroup]=!0}return r[o]=!0,!0}))}function bc(t,e){return t===e||null==t&&null==e}function wc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.length-1,r=0;r<n;++r){var i=t[r];if(!Q(i))return i}return t[n]}function Ec(t,e){var n=[],r=[];return t.forEach((function(i,o){var s=e(i,o,t),a=r.indexOf(s),c=n[a]||[];-1===a&&(r.push(s),n.push(c)),c.push(i)})),n}function Sc(t,e){var n=[],r={};return t.forEach((function(i,o){var s=e(i,o,t),a=r[s];a||(a=[],r[s]=a,n.push(a)),a.push(i)})),n}function Dc(t){return t.reduce((function(t,e){return t.concat(e)}),[])}function kc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort((function(t,e){return Math.abs(e)-Math.abs(t)})),t[0]}function xc(t,e,n){return Fr(kr(t,n),Or(e,n),n)}function Cc(t,e){var n,r=t.is3d,i=t.rootMatrix,o=r?4:3;return n=xc(i,[e.distX,e.distY],o),e.distX=n[0],e.distY=n[1],e}function _c(t,e,n,r,i){return Nr(qa(t,Rr(n,e),i),r)}function Oc(t,e,n){return n?"".concat(t/e*100,"%"):"".concat(t,"px")}function Ac(t,e,n,r){var i=t[e],o=i.direction,s=i.sub,a=t.map((function(){return[0,0]})),c=o?o.split(""):[];if(r&&e<8){var u=c.filter((function(t){return"w"===t||"e"===t}))[0],l=c.filter((function(t){return"n"===t||"s"===t}))[0];a[e]=n,t.forEach((function(t,e){var r=t.direction;r&&(r.indexOf(u)>-1&&(a[e][0]=n[0]),r.indexOf(l)>-1&&(a[e][1]=n[1]))})),u&&(a[1][0]=n[0]/2,a[5][0]=n[0]/2),l&&(a[3][1]=n[1]/2,a[7][1]=n[1]/2)}else o&&!s?c.forEach((function(e){var r="n"===e||"s"===e;t.forEach((function(t,i){var o=t.direction,s=t.horizontal,c=t.vertical;o&&-1!==o.indexOf(e)&&(a[i]=[r||!s?0:n[0],r&&c?n[1]:0])}))})):a[e]=n;return a}function Mc(t){return Math.abs(t)<=Xi?0:t}function Tc(t,e){return e.isRequest?("resizable"===e.requestAble||"scalable"===e.requestAble)&&e.parentDirection:Pt(e.inputEvent.target,Ca("direction"))}function Rc(t){var e={};for(var n in t)e[t[n]]=n;return e}function Nc(t,e){var n=t.slice(0,e<0?void 0:e),r=t.slice(0,e<0?void 0:e+1),i=t[e]||"",o=e<0?[]:t.slice(e),s=e<0?[]:t.slice(e+1),a=ti(n),c=ti(r),u=ti([i]),l=ti(o),d=ti(s),h=Qr(a),f=Qr(c),p=Qr(l),g=Qr(d),m=Tr(h,p,4);return{transforms:t,beforeFunctionMatrix:h,beforeFunctionMatrix2:f,targetFunctionMatrix:Qr(u),afterFunctionMatrix:p,afterFunctionMatrix2:g,allFunctionMatrix:m,beforeFunctions:a,beforeFunctions2:c,targetFunction:u[0],afterFunctions:l,afterFunctions2:d,beforeFunctionTexts:n,beforeFunctionTexts2:r,targetFunctionText:i,afterFunctionTexts:o,afterFunctionTexts2:s}}function Pc(t){return!(!t||!tt(t))&&(!(t instanceof Element)&&(et(t)||"length"in t))}function Bc(t,e){return t?nt(t)?e?document.querySelector(t):t:it(t)?t():"current"in t?t.current:t:null}function Fc(t,e){if(!t)return[];var n=Pc(t)?[].slice.call(t):[t];return n.reduce((function(t,n){return nt(n)&&e?ji(ji([],t,!0),[].slice.call(document.querySelectorAll(n)),!0):(t.push(Bc(n,e)),t)}),[])}function Ic(t,e){var n=[];return t.forEach((function(t){t&&(nt(t)?e[t]&&n.push.apply(n,e[t]):n.push(t))})),n}function zc(t,e,n){var r=Ot(t,e)/Math.PI*180;return r=n>=0?r:180-r,r=r>=0?r:360+r,r}function jc(t,e){var n=t.rootMatrix,r=t.is3d,i=r?4:3,o=kr(n,i);return r||(o=Ar(o,3,4)),o[12]=0,o[13]=0,o[14]=0,Jr(o,e)}function Lc(t,e,n,r){var i=n.ratio,o=n.startOffsetWidth,s=n.startOffsetHeight,a=0,c=0,u=r.distX,l=r.distY,d=r.parentDistance,h=r.parentDist,f=r.parentScale,p=r.isPinch,g=n.fixedDirection;if(h)a=h[0],c=h[1],e&&(a?c||(c=a/i):a=c*i);else if(f)a=(f[0]-1)*o,c=(f[1]-1)*s;else if(p)d&&(a=d,c=d*s/o);else{var m=na({datas:n,distX:u,distY:l});if(m=[0,1].map((function(e){var n=Math.abs(t[e]-g[e]);return 0!==n&&(n=2/n),m[e]*n})),e&&o&&s){var v=Ot([0,0],m),y=Ot([0,0],t),b=Za(m),w=Math.cos(v-y)*b;if(t[0])if(t[1]){var E=2*t[0]*o,S=2*t[1]*s,D=Za([E+m[0],S+m[1]])-Za([E,S]),k=Ot([0,0],[i,1]);a=Math.cos(k)*D,c=Math.sin(k)*D}else a=w,c=a/i;else c=w,a=c*i}else a=t[0]*m[0],c=t[1]*m[1]}return{distWidth:a,distHeight:c}}var $c=Li("pinchable",{events:{onPinchStart:"pinchStart",onPinch:"pinch",onPinchEnd:"pinchEnd",onPinchGroupStart:"pinchGroupStart",onPinchGroup:"pinchGroup",onPinchGroupEnd:"pinchGroupEnd"},dragStart:function(){return!0},pinchStart:function(t,e){var n=e.datas,r=e.targets,i=e.angle,o=e.originalDatas,s=t.props,a=s.pinchable,c=s.ables;if(!a)return!1;var u="onPinch".concat(r?"Group":"","Start"),l="drag".concat(r?"Group":"","ControlStart"),d=(!0===a?t.controlAbles:c.filter((function(t){return a.indexOf(t.name)>-1}))).filter((function(t){return t.canPinch&&t[l]})),h=fc(t,e,{});r&&(h.targets=r);var f=mc(t,u,h);n.isPinch=!1!==f,n.ables=d;var p=n.isPinch;return!!p&&(d.forEach((function(n){if(o[n.name]=o[n.name]||{},n[l]){var r=Fi(Fi({},e),{datas:o[n.name],parentRotate:i,isPinch:!0});n[l](t,r)}})),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},p)},pinch:function(t,e){var n=e.datas,r=e.scale,i=e.distance,o=e.originalDatas,s=e.inputEvent,a=e.targets,c=e.angle;if(n.isPinch){var u=i*(1-1/r),l=fc(t,e,{});a&&(l.targets=a);var d="onPinch".concat(a?"Group":"");mc(t,d,l);var h=n.ables,f="drag".concat(a?"Group":"","Control");return h.forEach((function(n){n[f]&&n[f](t,Fi(Fi({},e),{datas:o[n.name],inputEvent:s,parentDistance:u,parentRotate:c,isPinch:!0}))})),l}},pinchEnd:function(t,e){var n=e.datas,r=e.isPinch,i=e.inputEvent,o=e.targets,s=e.originalDatas;if(n.isPinch){var a="onPinch".concat(o?"Group":"","End"),c=pc(t,e,{isDrag:r});o&&(c.targets=o),mc(t,a,c);var u=n.ables,l="drag".concat(o?"Group":"","ControlEnd");return u.forEach((function(n){n[l]&&n[l](t,Fi(Fi({},e),{isDrag:r,datas:s[n.name],inputEvent:i,isPinch:!0}))})),r}},pinchGroupStart:function(t,e){return this.pinchStart(t,Fi(Fi({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,Fi(Fi({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,Fi(Fi({},e),{targets:t.props.targets}))}}),Hc={name:"resizable",ableGroup:"size",canPinch:!0,props:{resizable:Boolean,throttleResize:Number,renderDirections:Array,keepRatio:Boolean,resizeFormat:Function},events:{onResizeStart:"resizeStart",onBeforeResize:"beforeResize",onResize:"resize",onResizeEnd:"resizeEnd",onResizeGroupStart:"resizeGroupStart",onBeforeResizeGroup:"beforeResizeGroup",onResizeGroup:"resizeGroup",onResizeGroupEnd:"resizeGroupEnd"},render:function(t,e){var n=t.props,r=n.resizable,i=n.edge;if(r)return i?fo(t,e):ho(t,e)},dragControlCondition:Tc,dragControlStart:function(t,e){var n,r=e.inputEvent,i=e.isPinch,o=e.parentDirection,s=e.datas,a=e.parentFlag,c=o||(i?[0,0]:cc(r.target)),u=t.state,l=u.target,d=u.width,h=u.height;if(!c||!l)return!1;!i&&Ys(t,e),s.datas={},s.direction=c,s.startOffsetWidth=d,s.startOffsetHeight=h,s.prevWidth=0,s.prevHeight=0,n=nc(l),s.startWidth=n[0],s.startHeight=n[1];var f=[Math.max(0,d-s.startWidth),Math.max(0,h-s.startHeight)];if(s.minSize=f,s.maxSize=[1/0,1/0],!a){var p=vc(l),g=p.position,m=p.minWidth,v=p.minHeight,y=p.maxWidth,b=p.maxHeight,w="static"===g||"relative"===g,E=w?l.parentElement:l.offsetParent,S=d,D=h;if(E&&(S=E.clientWidth,D=E.clientHeight,w)){var k=vc(E);S-=parseFloat(k.paddingLeft)||0,D-=parseFloat(k.paddingTop)||0}s.minSize=Rr([St(m,S)||0,St(v,D)||0],f),s.maxSize=Rr([St(y,S)||1/0,St(b,D)||1/0],f)}var x=t.props.transformOrigin||"% %";function C(t){s.ratio=t&&isFinite(t)?t:0}function _(t){s.fixedDirection=t,s.fixedPosition=aa(s.startPositions,t)}s.transformOrigin=x&&nt(x)?x.split(" "):x,s.isWidth=!c[0]&&!c[1]||c[0]||!c[1],s.startPositions=lc(t.state),C(d/h),_([-c[0],-c[1]]),s.setFixedDirection=_;var O=fc(t,e,{direction:c,set:function(t){var e=t[0],n=t[1];s.startWidth=e,s.startHeight=n},setMin:function(t){s.minSize=t},setMax:function(t){s.maxSize=[t[0]||1/0,t[1]||1/0]},setRatio:C,setFixedDirection:_,setOrigin:function(t){s.transformOrigin=t},dragStart:Gs.dragStart(t,(new oo).dragStart([0,0],e))}),A=mc(t,"onResizeStart",O);return!1!==A&&(s.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:c}),!!s.isResize&&O},dragControl:function(t,e){var n,r=e.datas,i=e.parentFlag,o=e.isPinch,s=e.parentKeepRatio,a=e.dragClient,c=e.parentDist,u=e.isRequest,l=r.isResize,d=r.transformOrigin,h=r.startWidth,f=r.startHeight,p=r.prevWidth,g=r.prevHeight,m=r.minSize,v=r.maxSize,y=r.ratio,b=r.isWidth,w=r.startOffsetWidth,E=r.startOffsetHeight;if(l){var S=t.props,D=S.resizeFormat,k=S.throttleResize,x=void 0===k?1:k,C=S.parentMoveable,_=S.snapThreshold,O=void 0===_?5:_,A=r.direction,M=A,T=0,R=0;A[0]||A[1]||(M=[1,1]);var N=y&&(null!=s?s:S.keepRatio)||!1,P=V(),B=P[0],F=P[1];r.setFixedDirection(r.fixedDirection),mc(t,"onBeforeResize",fc(t,e,{setFixedDirection:function(t){var e;return r.setFixedDirection(t),e=V(),B=e[0],F=e[1],[B,F]},boundingWidth:B,boundingHeight:F,setSize:function(t){B=t[0],F=t[1]}},!0));var I=a;a||(I=!i&&o?ka(t,[0,0]):r.fixedPosition);var z=[0,0];if(o||(z=$s(t,B,F,A,I,u,r)),c&&(!c[0]&&(z[0]=0),!c[1]&&(z[1]=0)),N){M[0]&&M[1]&&z[0]&&z[1]&&(Math.abs(z[0])>Math.abs(z[1])?z[1]=0:z[0]=0);var j=!z[0]&&!z[1];j&&W(),M[0]&&!M[1]||z[0]&&!z[1]||j&&b?(B+=z[0],F=B/y):(!M[0]&&M[1]||!z[0]&&z[1]||j&&!b)&&(F+=z[1],B=F*y)}else w+T<-O&&(z[0]=0),w+R<-O&&(z[1]=0),B+=z[0],F+=z[1];n=xt([B,F],m,v,N),B=n[0],F=n[1],W(),T=B-w,R=F-E;var L=[T-p,R-g];r.prevWidth=T,r.prevHeight=R;var $=Da(t,B,F,r.fixedDirection,I,d);if(C||!L.every((function(t){return!t}))||!$.every((function(t){return!t}))){var H=fc(t,e,{width:h+T,height:f+R,offsetWidth:Math.round(B),offsetHeight:Math.round(F),boundingWidth:B,boundingHeight:F,direction:A,dist:[T,R],delta:L,isPinch:!!o,drag:Gs.drag(t,io(e,t.state,$,!!o,!1))});return mc(t,"onResize",H),H}}function V(){var t=Lc(M,N,r,e);T=t.distWidth,R=t.distHeight;var n=M[0]||N?Math.max(w+T,Xi):w,i=M[1]||N?Math.max(E+R,Xi):E;return N&&w&&E&&(b?i=n/y:n=i*y),[n,i]}function W(){var t;D&&(t=D([B,F]),B=t[0],F=t[1]),B=Rt(B,x),F=Rt(F,x)}},dragControlAfter:function(t,e){var n=e.datas,r=n.isResize,i=n.startOffsetWidth,o=n.startOffsetHeight,s=n.prevWidth,a=n.prevHeight;if(r){var c=t.state,u=c.width,l=c.height,d=u-(i+s),h=l-(o+a),f=Math.abs(d)>3,p=Math.abs(h)>3;return f&&(n.startWidth+=d,n.startOffsetWidth+=d,n.prevWidth+=d),p&&(n.startHeight+=h,n.startOffsetHeight+=h,n.prevHeight+=h),f||p?this.dragControl(t,e):void 0}},dragControlEnd:function(t,e){var n=e.datas;if(n.isResize){n.isResize=!1;var r=pc(t,e,{});return mc(t,"onResizeEnd",r),r}},dragGroupControlCondition:Tc,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,e);if(!r)return!1;var i=so(t,"resizable",e);function o(e,r){var i=n.fixedDirection,o=n.fixedPosition,s=r.datas.startPositions||lc(e.state),a=aa(s,i),c=Fr(Wr(-t.rotation/180*Math.PI,3),[a[0]-o[0],a[1]-o[1],1],3),u=c[0],l=c[1];return r.datas.originalX=u,r.datas.originalY=l,r}var s=co(t,this,"dragControlStart",e,(function(t,e){return o(t,e)})),a=function(t){r.setFixedDirection(t),s.forEach((function(e,n){e.setFixedDirection(t),o(e.moveable,i[n])}))};n.setFixedDirection=a;var c=Fi(Fi({},r),{targets:t.props.targets,events:s,setFixedDirection:a}),u=mc(t,"onResizeGroupStart",c);return n.isResize=!1!==u,!!n.isResize&&r},dragGroupControl:function(t,e){var n=e.datas;if(n.isResize){gc(t,"onBeforeResize",(function(n){mc(t,"onBeforeResizeGroup",fc(t,e,Fi(Fi({},n),{targets:t.props.targets}),!0))}));var r=this.dragControl(t,e);if(r){var i=r.boundingWidth,o=r.boundingHeight,s=r.dist,a=t.props.keepRatio,c=[i/(i-s[0]),o/(o-s[1])],u=n.fixedPosition,l=co(t,this,"dragControl",e,(function(e,n){var r=Fr(Wr(t.rotation/180*Math.PI,3),[n.datas.originalX*c[0],n.datas.originalY*c[1],1],3),i=r[0],o=r[1];return Fi(Fi({},n),{parentDist:null,parentScale:c,dragClient:Rr(u,[i,o]),parentKeepRatio:a})})),d=Fi({targets:t.props.targets,events:l},r);return mc(t,"onResizeGroup",d),d}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isResize){this.dragControlEnd(t,e);var i=co(t,this,"dragControlEnd",e),o=pc(t,e,{targets:t.props.targets,events:i});return mc(t,"onResizeGroupEnd",o),n}},request:function(t){var e={},n=0,r=0,i=t.getRect();return{isControl:!0,requestStart:function(t){return{datas:e,parentDirection:t.direction||[1,1]}},request:function(t){return"offsetWidth"in t?n=t.offsetWidth-i.offsetWidth:"deltaWidth"in t&&(n+=t.deltaWidth),"offsetHeight"in t?r=t.offsetHeight-i.offsetHeight:"deltaHeight"in t&&(r+=t.deltaHeight),{datas:e,parentDist:[n,r],parentKeepRatio:t.keepRatio}},requestEnd:function(){return{datas:e,isDrag:!0}}}}},Vc={name:"scalable",ableGroup:"size",canPinch:!0,props:{scalable:Boolean,throttleScale:Number,renderDirections:String,keepRatio:Boolean},events:{onScaleStart:"scaleStart",onBeforeScale:"beforeScale",onScale:"scale",onScaleEnd:"scaleEnd",onScaleGroupStart:"scaleGroupStart",onBeforeScaleGroup:"beforeScaleGroup",onScaleGroup:"scaleGroup",onScaleGroupEnd:"scaleGroupEnd"},render:function(t,e){var n=t.props,r=n.resizable,i=n.scalable,o=n.edge;if(!r&&i)return o?fo(t,e):ho(t,e)},dragControlCondition:Tc,dragControlStart:function(t,e){var n=e.datas,r=e.isPinch,i=e.inputEvent,o=e.parentDirection,s=o||(r?[0,0]:cc(i.target)),a=t.state,c=a.width,u=a.height,l=a.targetTransform,d=a.target,h=a.pos1,f=a.pos2,p=a.pos4;if(!s||!d)return!1;r||Ys(t,e),n.datas={},n.transform=l,n.prevDist=[1,1],n.direction=s,n.startOffsetWidth=c,n.startOffsetHeight=u,n.startValue=[1,1];var g=Tt(h,f),m=Tt(f,p),v=!s[0]&&!s[1]||s[0]||!s[1];function y(t){n.ratio=t&&isFinite(t)?t:0}function b(t){n.fixedDirection=t,n.fixedPosition=aa(n.startPositions,t)}n.scaleWidth=g,n.scaleHeight=m,n.scaleXRatio=g/c,n.scaleYRatio=m/u,fa(e,"scale"),n.isWidth=v,n.startPositions=lc(t.state),n.setFixedDirection=b,y(Tt(h,f)/Tt(f,p)),b([-s[0],-s[1]]);var w=fc(t,e,Fi(Fi({direction:s,set:function(t){n.startValue=t},setRatio:y,setFixedDirection:b},ha(e)),{dragStart:Gs.dragStart(t,(new oo).dragStart([0,0],e))})),E=mc(t,"onScaleStart",w);return!1!==E&&(n.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:s}),!!n.isScale&&w},dragControl:function(t,e){Js(e,"scale");var n=e.datas,r=e.parentKeepRatio,i=e.parentFlag,o=e.isPinch,s=e.dragClient,a=e.isRequest,c=n.prevDist,u=n.direction,l=n.startOffsetWidth,d=n.startOffsetHeight,h=n.isScale,f=n.startValue,p=n.isWidth,g=n.ratio;if(!h)return!1;var m=t.props,v=m.throttleScale,y=m.parentMoveable,b=u;u[0]||u[1]||(b=[1,1]);var w=g&&(null!=r?r:m.keepRatio)||!1,E=t.state;function S(){var t=Lc(b,w,n,e),r=t.distWidth,i=t.distHeight,o=(l+r)/l,s=(d+i)/d;return o=b[0]||w?o*f[0]:f[0],s=b[1]||w?s*f[1]:f[1],0===o&&(o=(c[0]>0?1:-1)*Ji),0===s&&(s=(c[1]>0?1:-1)*Ji),[o,s]}var D=S();if(!o&&t.props.groupable){var k=E.snapRenderInfo||{},x=k.direction;et(x)&&(x[0]||x[1])&&(E.snapRenderInfo={direction:u,request:e.isRequest})}mc(t,"onBeforeScale",fc(t,e,{scale:D,setFixedDirection:function(t){return n.setFixedDirection(t),D=S(),D},setScale:function(t){D=t}},!0));var C=[D[0]/f[0],D[1]/f[1]],_=s,O=[0,0];if(s||(_=!i&&o?ka(t,[0,0]):n.fixedPosition),o||(O=Hs(t,C,u,a,n)),w){b[0]&&b[1]&&O[0]&&O[1]&&(Math.abs(O[0]*l)>Math.abs(O[1]*d)?O[1]=0:O[0]=0);var A=!O[0]&&!O[1];if(A&&(p?C[0]=Rt(C[0]*f[0],v)/f[0]:C[1]=Rt(C[1]*f[1],v)/f[1]),b[0]&&!b[1]||O[0]&&!O[1]||A&&p){C[0]+=O[0];var M=l*C[0]*f[0]/g;C[1]=M/d/f[1]}else if(!b[0]&&b[1]||!O[0]&&O[1]||A&&!p){C[1]+=O[1];var T=d*C[1]*f[1]*g;C[0]=T/l/f[0]}}else C[0]+=O[0],C[1]+=O[1],O[0]||(C[0]=Rt(C[0]*f[0],v)/f[0]),O[1]||(C[1]=Rt(C[1]*f[1],v)/f[1]);0===C[0]&&(C[0]=(c[0]>0?1:-1)*Ji),0===C[1]&&(C[1]=(c[1]>0?1:-1)*Ji);var R=[C[0]/c[0],C[1]/c[1]];D=xa(C,f);var N=ba(t,C,n.fixedDirection,_,n),P=Nr(N,n.prevInverseDist||[0,0]);if(n.prevDist=C,n.prevInverseDist=N,D[0]===c[0]&&D[1]===c[1]&&P.every((function(t){return!t}))&&!y)return!1;var B=Zs(n,"scale(".concat(D.join(", "),")"),"scale(".concat(C.join(", "),")")),F=fc(t,e,Fi({offsetWidth:l,offsetHeight:d,direction:u,scale:D,dist:C,delta:R,isPinch:!!o},va(t,B,P,o,e)));return mc(t,"onScale",F),F},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return!!n.isScale&&(n.isScale=!1,mc(t,"onScaleEnd",pc(t,e,{})),r)},dragGroupControlCondition:Tc,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,e);if(!r)return!1;var i=so(t,"resizable",e);function o(e,r){var i=n.fixedDirection,o=n.fixedPosition,s=r.datas.startPositions||lc(e.state),a=aa(s,i),c=Fr(Wr(-t.rotation/180*Math.PI,3),[a[0]-o[0],a[1]-o[1],1],3),u=c[0],l=c[1];return r.datas.originalX=u,r.datas.originalY=l,r}n.moveableScale=t.scale;var s=co(t,this,"dragControlStart",e,(function(t,e){return o(t,e)})),a=function(t){r.setFixedDirection(t),s.forEach((function(e,n){e.setFixedDirection(t),o(e.moveable,i[n])}))};n.setFixedDirection=a;var c=Fi(Fi({},r),{targets:t.props.targets,events:s,setFixedDirection:a}),u=mc(t,"onScaleGroupStart",c);return n.isScale=!1!==u,!!n.isScale&&c},dragGroupControl:function(t,e){var n=e.datas;if(n.isScale){gc(t,"onBeforeScale",(function(n){mc(t,"onBeforeScaleGroup",fc(t,e,Fi(Fi({},n),{targets:t.props.targets}),!0))}));var r=this.dragControl(t,e);if(r){var i=n.moveableScale;t.scale=[r.scale[0]*i[0],r.scale[1]*i[1]];var o=t.props.keepRatio,s=r.dist,a=r.scale,c=n.fixedPosition,u=co(t,this,"dragControl",e,(function(e,n){var r=Fr(Wr(t.rotation/180*Math.PI,3),[n.datas.originalX*s[0],n.datas.originalY*s[1],1],3),i=r[0],u=r[1];return Fi(Fi({},n),{parentDist:null,parentScale:a,parentKeepRatio:o,dragClient:Rr(c,[i,u])})})),l=Fi({targets:t.props.targets,events:u},r);return mc(t,"onScaleGroup",l),l}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isScale){this.dragControlEnd(t,e);var i=co(t,this,"dragControlEnd",e),o=pc(t,e,{targets:t.props.targets,events:i});return mc(t,"onScaleGroupEnd",o),n}},request:function(){var t={},e=0,n=0;return{isControl:!0,requestStart:function(e){return{datas:t,parentDirection:e.direction||[1,1]}},request:function(r){return e+=r.deltaWidth,n+=r.deltaHeight,{datas:t,parentDist:[e,n],parentKeepRatio:r.keepRatio}},requestEnd:function(){return{datas:t,isDrag:!0}}}}};function Wc(t,e){return t.map((function(t,n){return Z(t,e[n],1,2)}))}function Uc(t,e,n){var r=Ot(t,e),i=Ot(t,n),o=i-r;return o>=0?o:o+2*Math.PI}function qc(t,e){var n=Uc(t[0],t[1],t[2]),r=Uc(e[0],e[1],e[2]),i=Math.PI;return!(n>=i&&r<=i||n<=i&&r>=i)}var Gc={name:"warpable",ableGroup:"size",props:{warpable:Boolean,renderDirections:Array},events:{onWarpStart:"warpStart",onWarp:"warp",onWarpEnd:"warpEnd"},render:function(t,e){var n=t.props,r=n.resizable,i=n.scalable,o=n.warpable,s=n.zoom;if(r||i||!o)return[];var a=t.state,c=a.pos1,u=a.pos2,l=a.pos3,d=a.pos4,h=Wc(c,u),f=Wc(u,c),p=Wc(c,l),g=Wc(l,c),m=Wc(l,d),v=Wc(d,l),y=Wc(u,d),b=Wc(d,u);return ji([e.createElement("div",{className:Ca("line"),key:"middeLine1",style:tc(h,m,s)}),e.createElement("div",{className:Ca("line"),key:"middeLine2",style:tc(f,v,s)}),e.createElement("div",{className:Ca("line"),key:"middeLine3",style:tc(p,y,s)}),e.createElement("div",{className:Ca("line"),key:"middeLine4",style:tc(g,b,s)})],ho(t,e),!0)},dragControlCondition:function(t,e){return!e.isRequest&&Pt(e.inputEvent.target,Ca("direction"))},dragControlStart:function(t,e){var n=e.datas,r=e.inputEvent,i=t.props.target,o=r.target,s=cc(o);if(!s||!i)return!1;var a=t.state,c=a.transformOrigin,u=a.is3d,l=a.targetTransform,d=a.targetMatrix,h=a.width,f=a.height,p=a.left,g=a.top;n.datas={},n.targetTransform=l,n.warpTargetMatrix=u?d:Ar(d,3,4),n.targetInverseMatrix=Dr(kr(n.warpTargetMatrix,4),3,4),n.direction=s,n.left=p,n.top=g,n.poses=[[0,0],[h,0],[0,f],[h,f]].map((function(t){return Nr(t,c)})),n.nextPoses=n.poses.map((function(t){var e=t[0],r=t[1];return Fr(n.warpTargetMatrix,[e,r,0,1],4)})),n.startValue=Ur(4),n.prevMatrix=Ur(4),n.absolutePoses=lc(a),n.posIndexes=oa(s),Ys(t,e),fa(e,"matrix3d"),a.snapRenderInfo={request:e.isRequest,direction:s};var m=fc(t,e,Fi({set:function(t){n.startValue=t}},ha(e))),v=mc(t,"onWarpStart",m);return!1!==v&&(n.isWarp=!0),n.isWarp},dragControl:function(t,e){var n=e.datas,r=e.isRequest,i=e.distX,o=e.distY,s=n.targetInverseMatrix,a=n.prevMatrix,c=n.isWarp,u=n.startValue,l=n.poses,d=n.posIndexes,h=n.absolutePoses;if(!c)return!1;if(Js(e,"matrix3d"),xo(t,"warpable")){var f=d.map((function(t){return h[t]}));f.length>1&&f.push([(f[0][0]+f[1][0])/2,(f[0][1]+f[1][1])/2]);var p=Os(t,r,{horizontal:f.map((function(t){return t[1]+o})),vertical:f.map((function(t){return t[0]+i}))}),g=p.horizontal,m=p.vertical;o-=g.offset,i-=m.offset}var v=na({datas:n,distX:i,distY:o},!0),y=n.nextPoses.slice();if(d.forEach((function(t){y[t]=Rr(y[t],v)})),!Ki.every((function(t){return qc(t.map((function(t){return l[t]})),t.map((function(t){return y[t]})))})))return!1;var b=Kr(l[0],l[2],l[1],l[3],y[0],y[2],y[1],y[3]);if(!b.length)return!1;var w=Tr(s,b,4),E=ta(n,w,!0),S=Tr(kr(a,4),E,4);n.prevMatrix=E;var D=Tr(u,E,4),k=Zs(n,"matrix3d(".concat(D.join(", "),")"),"matrix3d(".concat(E.join(", "),")"));return ga(e,k),mc(t,"onWarp",fc(t,e,{delta:S,matrix:D,dist:E,multiply:Tr,transform:k})),!0},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return!!n.isWarp&&(n.isWarp=!1,mc(t,"onWarpEnd",pc(t,e,{})),r)}},Kc=Ca("area-pieces"),Yc=Ca("area-piece"),Xc=Ca("avoid");function Jc(t){var e=t.areaElement;if(e){var n=t.state,r=n.width,i=n.height;Ft(e,Xc),e.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(i,"px")}}function Zc(t){return t.createElement("div",{key:"area_pieces",className:Kc},t.createElement("div",{className:Yc}),t.createElement("div",{className:Yc}),t.createElement("div",{className:Yc}),t.createElement("div",{className:Yc}))}var Qc={name:"dragArea",props:{dragArea:Boolean,passDragArea:Boolean},events:{onClick:"click",onClickGroup:"clickGroup"},render:function(t,e){var n=t.props,r=n.target,i=n.dragArea,o=n.groupable,s=n.passDragArea,a=t.state,c=a.width,u=a.height,l=a.renderPoses,d=s?Ca("area","pass"):Ca("area");if(o)return[e.createElement("div",{key:"area",ref:ae(t,"areaElement"),className:d}),Zc(e)];if(!r||!i)return[];var h=Kr([0,0],[c,0],[0,u],[c,u],l[0],l[1],l[2],l[3]),f=h.length?Ha(h,!0):"none";return[e.createElement("div",{key:"area",ref:ae(t,"areaElement"),className:d,style:{top:"0px",left:"0px",width:"".concat(c,"px"),height:"".concat(u,"px"),transformOrigin:"0 0",transform:f}}),Zc(e)]},dragStart:function(t,e){var n=e.datas,r=e.clientX,i=e.clientY,o=e.inputEvent;if(!o)return!1;n.isDragArea=!1;var s=t.areaElement,a=t.state,c=a.moveableClientRect,u=a.renderPoses,l=a.rootMatrix,d=a.is3d,h=c.left,f=c.top,p=Ka(u),g=p.left,m=p.top,v=p.width,y=p.height,b=d?4:3,w=xc(l,[r-h,i-f],b),E=w[0],S=w[1];E-=g,S-=m;var D=[{left:g,top:m,width:v,height:S-10},{left:g,top:m,width:E-10,height:y},{left:g,top:m+S+10,width:v,height:y-S-10},{left:g+E+10,top:m,width:v-E-10,height:y}],k=[].slice.call(s.nextElementSibling.children);D.forEach((function(t,e){k[e].style.cssText="left: ".concat(t.left,"px;top: ").concat(t.top,"px; width: ").concat(t.width,"px; height: ").concat(t.height,"px;")})),Bt(s,Xc),a.disableNativeEvent=!0},drag:function(t,e){var n=e.datas,r=e.inputEvent;if(this.enableNativeEvent(t),!r)return!1;n.isDragArea||(n.isDragArea=!0,Jc(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var n=e.inputEvent,r=e.datas;if(!n)return!1;r.isDragArea||Jc(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){Jc(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&bt((function(){e.disableNativeEvent=!1}))}},tu=Li("origin",{render:function(t,e){var n=t.props.zoom,r=t.state,i=r.beforeOrigin,o=r.rotation;return[e.createElement("div",{className:Ca("control","origin"),style:ec(o,n,i),key:"beforeOrigin"})]}});function eu(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var nu={name:"scrollable",canPinch:!0,props:{scrollable:Boolean,scrollContainer:Object,scrollThreshold:Number,getScrollPosition:Function},events:{onScroll:"scroll",onScrollGroup:"scrollGroup"},dragRelation:"strong",dragStart:function(t,e){var n=t.props,r=n.scrollContainer,i=void 0===r?t.getContainer():r,o=new Di,s=Bc(i,!0);e.datas.dragScroll=o;var a=e.isControl?"controlGesto":"targetGesto",c=e.targets;o.on("scroll",(function(n){var r=n.container,i=n.direction,o=fc(t,e,{scrollContainer:r,direction:i}),s=c?"onScrollGroup":"onScroll";c&&(o.targets=c),mc(t,s,o)})).on("move",(function(n){var r=n.offsetX,i=n.offsetY;t[a].scrollBy(r,i,e.inputEvent,!1)})),o.dragStart(e,{container:s})},checkScroll:function(t,e){var n=e.datas.dragScroll;if(n){var r=t.props,i=r.scrollContainer,o=void 0===i?t.getContainer():i,s=r.scrollThreshold,a=void 0===s?0:s,c=r.getScrollPosition,u=void 0===c?eu:c;return n.drag(e,{container:o,threshold:a,getScrollPosition:function(t){return u({scrollContainer:t.container,direction:t.direction})}}),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,Fi(Fi({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,Fi(Fi({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,Fi(Fi({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,Fi(Fi({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,Fi(Fi({},e),{targets:t.props.targets,isControl:!0}))},dragGroupContro:function(t,e){return this.drag(t,Fi(Fi({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,Fi(Fi({},e),{targets:t.props.targets}))}},ru={name:"",props:{target:Object,dragTarget:Object,container:Object,portalContainer:Object,rootContainer:Object,useResizeObserver:Boolean,zoom:Number,transformOrigin:Array,edge:Boolean,ables:Array,className:String,pinchThreshold:Number,pinchOutside:Boolean,triggerAblesSimultaneously:Boolean,checkInput:Boolean,cspNonce:String,translateZ:Number,hideDefaultLines:Boolean,props:Object},events:{}},iu=Li("padding",{render:function(t,e){var n=t.props;if(n.dragArea)return[];var r=n.padding||{},i=r.left,o=void 0===i?0:i,s=r.top,a=void 0===s?0:s,c=r.right,u=void 0===c?0:c,l=r.bottom,d=void 0===l?0:l,h=t.state,f=h.renderPoses,p=h.pos1,g=h.pos2,m=h.pos3,v=h.pos4,y=[p,g,m,v],b=[];return o>0&&b.push([0,2]),a>0&&b.push([0,1]),u>0&&b.push([1,3]),d>0&&b.push([2,3]),b.map((function(t,n){var r=t[0],i=t[1],o=y[r],s=y[i],a=f[r],c=f[i],u=Kr([0,0],[100,0],[0,100],[100,100],o,s,a,c);if(u.length)return e.createElement("div",{key:"padding".concat(n),className:Ca("padding"),style:{transform:Ha(u,!0)}})}))}}),ou=["nw","ne","se","sw"];function su(t,e){var n=t[0]+t[1],r=n>e?e/n:1;return t[0]*=r,t[1]=e-t[1]*r,t}var au=[1,2,5,6],cu=[0,3,4,7],uu=[1,-1,-1,1],lu=[1,1,-1,-1];function du(t,e,n,r,i,o,s,a,c){void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=r),void 0===c&&(c=i);var u=[],l=!1,d=t.map((function(t,d){var h=e[d],f=h.horizontal,p=h.vertical;if(p&&!l&&(l=!0,u.push("/")),l){var g=Math.max(0,1===p?t[1]-s:c-t[1]);return u.push(Oc(g,i,n)),g}g=Math.max(0,1===f?t[0]-o:a-t[0]);return u.push(Oc(g,r,n)),g}));return{styles:u,raws:d}}function hu(t){for(var e=[0,0],n=[0,0],r=t.length,i=0;i<r;++i){var o=t[i];o.sub&&(o.horizontal&&(0===e[1]&&(e[0]=i),e[1]=i-e[0]+1,n[0]=i+1),o.vertical&&(0===n[1]&&(n[0]=i),n[1]=i-n[0]+1))}return{horizontalRange:e,verticalRange:n}}function fu(t,e,n,r,i,o){var s,a,c,u;void 0===o&&(o=[0,0]);var l=t.indexOf("/"),d=(l>-1?t.slice(0,l):t).length,h=t.slice(0,d),f=t.slice(d+1),p=h[0],g=void 0===p?"0px":p,m=h[1],v=void 0===m?g:m,y=h[2],b=void 0===y?g:y,w=h[3],E=void 0===w?v:w,S=f[0],D=void 0===S?g:S,k=f[1],x=void 0===k?D:k,C=f[2],_=void 0===C?D:C,O=f[3],A=void 0===O?x:O,M=[g,v,b,E].map((function(t){return St(t,e)})),T=[D,x,_,A].map((function(t){return St(t,n)})),R=M.slice(),N=T.slice();s=su([R[0],R[1]],e),R[0]=s[0],R[1]=s[1],a=su([R[3],R[2]],e),R[3]=a[0],R[2]=a[1],c=su([N[0],N[3]],n),N[0]=c[0],N[3]=c[1],u=su([N[1],N[2]],n),N[1]=u[0],N[2]=u[1];var P=R.slice(0,Math.max(o[0],h.length)),B=N.slice(0,Math.max(o[1],f.length));return ji(ji([],P.map((function(t,e){var o=ou[e];return{horizontal:uu[e],vertical:0,pos:[r+t,i+(-1===lu[e]?n:0)],sub:!0,raw:M[e],direction:o}})),!0),B.map((function(t,n){var o=ou[n];return{horizontal:0,vertical:lu[n],pos:[r+(-1===uu[n]?e:0),i+t],sub:!0,raw:T[n],direction:o}})),!0)}function pu(t,e,n,r,i){void 0===i&&(i=e.length);var o=hu(t.slice(r)),s=o.horizontalRange,a=o.verticalRange,c=n-r,u=0;if(0===c)u=i;else if(c>0&&c<s[1])u=s[1]-c;else{if(!(c>=a[0]))return;u=a[0]+a[1]-c}t.splice(n,u),e.splice(n,u)}function gu(t,e,n,r,i,o,s,a,c,u,l){void 0===u&&(u=0),void 0===l&&(l=0);var d=hu(t.slice(n)),h=d.horizontalRange,f=d.verticalRange;if(r>-1)for(var p=1===uu[r]?o-u:a-o,g=h[1];g<=r;++g){var m=1===lu[g]?l:c,v=0;if(r===g?v=o:0===g?v=u+p:-1===uu[g]&&(v=a-(e[n][0]-u)),t.splice(n+g,0,{horizontal:uu[g],vertical:0,pos:[v,m]}),e.splice(n+g,0,[v,m]),0===g)break}else if(i>-1){var y=1===lu[i]?s-l:c-s;if(0===h[1]&&0===f[1]){var b=[u+y,l];t.push({horizontal:uu[0],vertical:0,pos:b}),e.push(b)}var w=f[0];for(g=f[1];g<=i;++g){v=1===uu[g]?u:a,m=0;if(i===g?m=s:0===g?m=l+y:1===lu[g]?m=e[n+w][1]:-1===lu[g]&&(m=c-(e[n+w][1]-l)),t.push({horizontal:0,vertical:lu[g],pos:[v,m]}),e.push([v,m]),0===g)break}}}function mu(t,e){void 0===e&&(e=t.map((function(t){return t.raw})));var n=t.map((function(t,n){return t.horizontal?e[n]:null})).filter((function(t){return null!=t})),r=t.map((function(t,n){return t.vertical?e[n]:null})).filter((function(t){return null!=t}));return{horizontals:n,verticals:r}}var vu=[[0,-1,"n"],[1,0,"e"]],yu=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function bu(t,e,n){var r=t.props.clipRelative,i=t.state,o=i.width,s=i.height,a=e,c=a.type,u=a.poses,l="rect"===c,d="circle"===c;if("polygon"===c)return n.map((function(t){return"".concat(Oc(t[0],o,r)," ").concat(Oc(t[1],s,r))}));if(l||"inset"===c){var h=n[1][1],f=n[3][0],p=n[7][0],g=n[5][1];if(l)return[h,f,g,p].map((function(t){return"".concat(t,"px")}));var m=[h,o-f,s-g,p].map((function(t,e){return Oc(t,e%2?o:s,r)}));if(n.length>8){var v=Nr(n[4],n[0]),y=v[0],b=v[1];m.push.apply(m,ji(["round"],du(n.slice(8),u.slice(8),r,y,b,p,h,f,g).styles,!1))}return m}if(d||"ellipse"===c){var w=n[0],E=Oc(Math.abs(n[1][1]-w[1]),d?Math.sqrt((o*o+s*s)/2):s,r);m=d?[E]:[Oc(Math.abs(n[2][0]-w[0]),o,r),E];return m.push("at",Oc(w[0],o,r),Oc(w[1],s,r)),m}}function wu(t,e,n,r){var i=[r,(r+e)/2,e],o=[t,(t+n)/2,n];return yu.map((function(t){var e=t[0],n=t[1],r=t[2],s=i[e+1],a=o[n+1];return{vertical:Math.abs(n),horizontal:Math.abs(e),direction:r,pos:[s,a]}}))}function Eu(t,e,n,r,i){var o,s,a,c,u,l,d,h=i;if(!h){var f=vc(t),p=f.clipPath;h="none"!==p?p:f.clip}if(h&&"none"!==h&&"auto"!==h||(h=r,h)){var g=ht(h),m=g.prefix,v=void 0===m?h:m,y=g.value,b=void 0===y?"":y,w="circle"===v,E=" ";if("polygon"===v){var S=dt(b||"0% 0%, 100% 0%, 100% 100%, 0% 100%");E=",";var D=S.map((function(t){var r=t.split(" "),i=r[0],o=r[1];return{vertical:1,horizontal:1,pos:[St(i,e),St(o,n)]}}));return{type:v,clipText:h,poses:D,splitter:E}}if(w||"ellipse"===v){var k="",x="",C=0,_=0;S=lt(b);if(w){var O="";o=S[0],O=void 0===o?"50%":o,s=S[2],k=void 0===s?"50%":s,a=S[3],x=void 0===a?"50%":a,C=St(O,Math.sqrt((e*e+n*n)/2)),_=C}else{var A="",M="";c=S[0],A=void 0===c?"50%":c,u=S[1],M=void 0===u?"50%":u,l=S[3],k=void 0===l?"50%":l,d=S[4],x=void 0===d?"50%":d,C=St(A,e),_=St(M,n)}var T=[St(k,e),St(x,n)];D=ji([{vertical:1,horizontal:1,pos:T,direction:"nesw"}],vu.slice(0,w?1:2).map((function(t){return{vertical:Math.abs(t[1]),horizontal:t[0],direction:t[2],sub:!0,pos:[T[0]+t[0]*C,T[1]+t[1]*_]}})),!0);return{type:v,clipText:h,radiusX:C,radiusY:_,left:T[0]-C,top:T[1]-_,poses:D,splitter:E}}if("inset"===v){S=lt(b||"0 0 0 0");var R=S.indexOf("round"),N=(R>-1?S.slice(0,R):S).length,P=S.slice(N+1),B=S.slice(0,N),F=B[0],I=B[1],z=void 0===I?F:I,j=B[2],L=void 0===j?F:j,$=B[3],H=void 0===$?z:$,V=[F,L].map((function(t){return St(t,n)})),W=V[0],U=V[1],q=[H,z].map((function(t){return St(t,e)})),G=q[0],K=q[1],Y=e-K,X=n-U,J=fu(P,Y-G,X-W,G,W);D=ji(ji([],wu(W,Y,X,G),!0),J,!0);return{type:"inset",clipText:h,poses:D,top:W,left:G,right:Y,bottom:X,radius:P,splitter:E}}if("rect"===v){S=dt(b||"0px, ".concat(e,"px, ").concat(n,"px, 0px"));E=",";var Z=S.map((function(t){var e=ft(t).value;return e}));W=Z[0],K=Z[1],U=Z[2],G=Z[3],D=wu(W,K,U,G);return{type:"rect",clipText:h,poses:D,top:W,right:K,bottom:U,left:G,values:S,splitter:E}}}}function Su(t,e){var n=Ks(t,e),r=n[0],i=n[1],o=e.datas,s=o.clipPath,a=o.index,c=s,u=c.type,l=c.poses,d=c.splitter,h=l.map((function(t){return t.pos}));if("polygon"===u)h.splice(a,0,[r,i]);else{if("inset"!==u)return;var f=au.indexOf(a),p=cu.indexOf(a),g=l.length;if(gu(l,h,8,f,p,r,i,h[4][0],h[4][1],h[0][0],h[0][1]),g===l.length)return}var m=bu(t,s,h);mc(t,"onClip",fc(t,e,{clipEventType:"added",clipType:u,poses:h,clipStyles:m,clipStyle:"".concat(u,"(").concat(m.join(d),")"),distX:0,distY:0}))}function Du(t,e){var n=e.datas,r=n.clipPath,i=n.index,o=r,s=o.type,a=o.poses,c=o.splitter,u=a.map((function(t){return t.pos})),l=u.length;if("polygon"===s)a.splice(i,1),u.splice(i,1);else{if("inset"!==s)return;if(i<8)return;if(pu(a,u,i,8,l),l===a.length)return}var d=bu(t,r,u);mc(t,"onClip",fc(t,e,{clipEventType:"removed",clipType:s,poses:u,clipStyles:d,clipStyle:"".concat(s,"(").concat(d.join(c),")"),distX:0,distY:0}))}var ku={name:"clippable",props:{clippable:Boolean,defaultClipPath:String,customClipPath:String,clipRelative:Boolean,clipArea:Boolean,dragWithClip:Boolean,clipTargetBounds:Boolean,clipVerticalGuidelines:Array,clipHorizontalGuidelines:Array,clipSnapThreshold:Boolean},events:{onClipStart:"clipStart",onClip:"clip",onClipEnd:"clipEnd"},css:[".control.clip-control {\n    background: #6d6;\n    cursor: pointer;\n}\n.control.clip-control.clip-radius {\n    background: #d66;\n}\n.line.clip-line {\n    background: #6e6;\n    cursor: move;\n    z-index: 1;\n}\n.clip-area {\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n.clip-ellipse {\n    position: absolute;\n    cursor: move;\n    border: 1px solid #6d6;\n    border: var(--zoompx) solid #6d6;\n    border-radius: 50%;\n    transform-origin: 0px 0px;\n}",":host {\n    --bounds-color: #d66;\n}",".guideline {\n    pointer-events: none;\n    z-index: 2;\n}",".line.guideline.bounds {\n    background: #d66;\n    background: var(--bounds-color);\n}"],render:function(t,e){var n=t.props,r=n.customClipPath,i=n.defaultClipPath,o=n.clipArea,s=n.zoom,a=t.state,c=a.target,u=a.width,l=a.height,d=a.allMatrix,h=a.is3d,f=a.left,p=a.top,g=a.pos1,m=a.pos2,v=a.pos3,y=a.pos4,b=a.clipPathState,w=a.snapBoundInfos,E=a.rotation;if(!c)return[];var S=Eu(c,u,l,i||"inset",b||r);if(!S)return[];var D=h?4:3,k=S.type,x=S.poses,C=x.map((function(t){var e=qa(d,t.pos,D);return[e[0]-f,e[1]-p]})),_=[],O=[],A="rect"===k,M="inset"===k,T="polygon"===k;if(A||M||T){var R=M?C.slice(0,8):C;O=R.map((function(t,n){var r=0===n?R[R.length-1]:R[n-1],i=Ot(r,t),o=Qa(r,t);return e.createElement("div",{key:"clipLine".concat(n),className:Ca("line","clip-line","snap-control"),"data-clip-index":n,style:{width:"".concat(o,"px"),transform:"translate(".concat(r[0],"px, ").concat(r[1],"px) rotate(").concat(i,"rad) scaleY(").concat(s,")")}})}))}if(_=C.map((function(t,n){return e.createElement("div",{key:"clipControl".concat(n),className:Ca("control","clip-control","snap-control"),"data-clip-index":n,style:{transform:"translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(E,"rad) scale(").concat(s,")")}})})),M&&_.push.apply(_,C.slice(8).map((function(t,n){return e.createElement("div",{key:"clipRadiusControl".concat(n),className:Ca("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+n,style:{transform:"translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(E,"rad) scale(").concat(s,")")}})}))),"circle"===k||"ellipse"===k){var N=S.left,P=S.top,B=S.radiusX,F=S.radiusY,I=Nr(qa(d,[N,P],D),qa(d,[0,0],D)),z=I[0],j=I[1],L="none";if(!o){for(var $=Math.max(10,B/5,F/5),H=[],V=0;V<=$;++V){var W=2*Math.PI/$*V;H.push([B+(B-s)*Math.cos(W),F+(F-s)*Math.sin(W)])}H.push([B,-2]),H.push([-2,-2]),H.push([-2,2*F+2]),H.push([2*B+2,2*F+2]),H.push([2*B+2,-2]),H.push([B,-2]),L="polygon(".concat(H.map((function(t){return"".concat(t[0],"px ").concat(t[1],"px")})).join(", "),")")}_.push(e.createElement("div",{key:"clipEllipse",className:Ca("clip-ellipse","snap-control"),style:{width:"".concat(2*B,"px"),height:"".concat(2*F,"px"),clipPath:L,transform:"translate(".concat(-f+z,"px, ").concat(-p+j,"px) ").concat(Ha(d))}}))}if(o){var U=Ka(ji([g,m,v,y],C,!0)),q=U.width,G=U.height,K=U.left,Y=U.top;if(T||A||M){H=M?C.slice(0,8):C;_.push(e.createElement("div",{key:"clipArea",className:Ca("clip-area","snap-control"),style:{width:"".concat(q,"px"),height:"".concat(G,"px"),transform:"translate(".concat(K,"px, ").concat(Y,"px)"),clipPath:"polygon(".concat(H.map((function(t){return"".concat(t[0]-K,"px ").concat(t[1]-Y,"px")})).join(", "),")")}}))}}return w&&["vertical","horizontal"].forEach((function(t){var n=w[t],r="horizontal"===t;n.isSnap&&O.push.apply(O,n.snap.posInfos.map((function(n,i){var o=n.pos,a=Nr(qa(d,r?[0,o]:[o,0],D),[f,p]),c=Nr(qa(d,r?[u,o]:[o,l],D),[f,p]);return lo(e,"",a,c,s,"clip".concat(t,"snap").concat(i),"guideline")}))),n.isBound&&O.push.apply(O,n.bounds.map((function(n,i){var o=n.pos,a=Nr(qa(d,r?[0,o]:[o,0],D),[f,p]),c=Nr(qa(d,r?[u,o]:[o,l],D),[f,p]);return lo(e,"",a,c,s,"clip".concat(t,"bounds").concat(i),"guideline","bounds","bold")})))})),ji(ji([],_,!0),O,!0)},dragControlCondition:function(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,e){var n=t.props,r=n.dragWithClip,i=void 0===r||r;return!i&&this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,Fi(Fi({},e),{isDragTarget:!0}))},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var n=t.state,r=t.props,i=r.defaultClipPath,o=r.customClipPath,s=n.target,a=n.width,c=n.height,u=e.inputEvent?e.inputEvent.target:null,l=u&&u.getAttribute("class")||"",d=e.datas,h=Eu(s,a,c,i||"inset",o);if(!h)return!1;var f=h.clipText,p=h.type,g=h.poses,m=mc(t,"onClipStart",fc(t,e,{clipType:p,clipStyle:f,poses:g.map((function(t){return t.pos}))}));return!1===m?(d.isClipStart=!1,!1):(d.isControl=l&&l.indexOf("clip-control")>-1,d.isLine=l.indexOf("clip-line")>-1,d.isArea=l.indexOf("clip-area")>-1||l.indexOf("clip-ellipse")>-1,d.index=u?parseInt(u.getAttribute("data-clip-index"),10):-1,d.clipPath=h,d.isClipStart=!0,n.clipPathState=f,Ys(t,e),!0)},dragControl:function(t,e){var n,r=e.datas,i=e.originalDatas,o=e.isDragTarget;if(!r.isClipStart)return!1;var s=r,a=s.isControl,c=s.isLine,u=s.isArea,l=s.index,d=s.clipPath;if(!d)return!1;var h=0,f=0,p=i.draggable,g=na(e);o&&p?(n=p.prevBeforeDist,h=n[0],f=n[1]):(h=g[0],f=g[1]);var m=[h,f],v=t.props,y=t.state,b=y.width,w=y.height,E=!u&&!a&&!c,S=d.type,D=d.poses,k=d.splitter,x=D.map((function(t){return t.pos}));E&&(h=-h,f=-f);var C=!a||"nesw"===D[l].direction,_="inset"===S||"rect"===S,O=D.map((function(){return[0,0]}));if(a&&!C){var A=D[l],M=A.horizontal,T=A.vertical,R=[h*Math.abs(M),f*Math.abs(T)];O=Ac(D,l,R,_)}else C&&(O=x.map((function(){return[h,f]})));var N=x.map((function(t,e){return Rr(t,O[e])})),P=ji([],N,!0);y.snapBoundInfos=null;var B="circle"===d.type,F="ellipse"===d.type;if(B||F){var I=Ka(N),z=Math.abs(I.bottom-I.top),j=Math.abs(F?I.right-I.left:z),L=N[0][1]+z,$=N[0][0]-j,H=N[0][0]+j;B&&(P.push([H,I.bottom]),O.push([1,0])),P.push([I.left,L]),O.push([0,1]),P.push([$,I.bottom]),O.push([1,0])}var V=Mo((v.clipHorizontalGuidelines||[]).map((function(t){return St("".concat(t),w)})),(v.clipVerticalGuidelines||[]).map((function(t){return St("".concat(t),b)})),b,w),W=[],U=[];if(B||F)W=[P[4][0],P[2][0]],U=[P[1][1],P[3][1]];else if(_){var q=[P[0],P[2],P[4],P[6]],G=[O[0],O[2],O[4],O[6]];W=q.filter((function(t,e){return G[e][0]})).map((function(t){return t[0]})),U=q.filter((function(t,e){return G[e][1]})).map((function(t){return t[1]}))}else W=P.filter((function(t,e){return O[e][0]})).map((function(t){return t[0]})),U=P.filter((function(t,e){return O[e][1]})).map((function(t){return t[1]}));for(var K=[0,0],Y=function(t){var e=As(V,v.clipTargetBounds&&{left:0,top:0,right:b,bottom:w},W,U,5),n=e.horizontal,r=e.vertical,i=n.offset,o=r.offset;if(n.isBound&&(K[1]+=i),r.isBound&&(K[0]+=o),!F&&!B||0!==O[0][0]||0!==O[0][1])return P.forEach((function(t,e){var n=O[e];n[0]&&(t[0]-=o),n[1]&&(t[1]-=i)})),"break";var s=Ka(N),a=s.bottom-s.top,c=F?s.right-s.left:a,u=r.isBound?Math.abs(o):0===r.snapIndex?-o:o,l=n.isBound?Math.abs(i):0===n.snapIndex?-i:i;c-=u,a-=l,B&&(a=Vo(r,n)>0?a:c,c=a);var d=P[0];P[1][1]=d[1]-a,P[2][0]=d[0]+c,P[3][1]=d[1]+a,P[4][0]=d[0]-c},X=0;X<2;++X){var J=Y();if("break"===J)break}var Z=bu(t,d,N),Q="".concat(S,"(").concat(Z.join(k),")");if(y.clipPathState=Q,B||F)W=[P[4][0],P[2][0]],U=[P[1][1],P[3][1]];else if(_){q=[P[0],P[2],P[4],P[6]];W=q.map((function(t){return t[0]})),U=q.map((function(t){return t[1]}))}else W=P.map((function(t){return t[0]})),U=P.map((function(t){return t[1]}));if(y.snapBoundInfos=As(V,v.clipTargetBounds&&{left:0,top:0,right:b,bottom:w},W,U,1),p){var tt=y.is3d,et=y.allMatrix,nt=tt?4:3,rt=K;o&&(rt=[m[0]+K[0]-g[0],m[1]+K[1]-g[1]]),p.deltaOffset=Tr(et,[rt[0],rt[1],0,0],nt)}return mc(t,"onClip",fc(t,e,{clipEventType:"changed",clipType:S,poses:N,clipStyle:Q,clipStyles:Z,distX:h,distY:f})),!0},dragControlEnd:function(t,e){this.unset(t);var n=e.isDrag,r=e.datas,i=e.isDouble,o=r.isLine,s=r.isClipStart,a=r.isControl;return!!s&&(mc(t,"onClipEnd",pc(t,e,{})),i&&(a?Du(t,e):o&&Su(t,e)),i||n)},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},xu={name:"originDraggable",props:{originDraggable:Boolean,originRelative:Boolean},events:{onDragOriginStart:"dragOriginStart",onDragOrigin:"dragOrigin",onDragOriginEnd:"dragOriginEnd"},css:[":host[data-able-origindraggable] .control.origin {\n    pointer-events: auto;\n}"],dragControlCondition:function(t,e){return e.isRequest?"originDraggable"===e.requestAble:Pt(e.inputEvent.target,Ca("origin"))},dragControlStart:function(t,e){var n=e.datas;Ys(t,e);var r=fc(t,e,{dragStart:Gs.dragStart(t,(new oo).dragStart([0,0],e))}),i=mc(t,"onDragOriginStart",r);return n.startOrigin=t.state.transformOrigin,n.startTargetOrigin=t.state.targetOrigin,n.prevOrigin=[0,0],n.isDragOrigin=!0,!1===i?(n.isDragOrigin=!1,!1):r},dragControl:function(t,e){var n=e.datas,r=e.isPinch,i=e.isRequest;if(!n.isDragOrigin)return!1;var o=na(e),s=o[0],a=o[1],c=t.state,u=c.width,l=c.height,d=c.offsetMatrix,h=c.targetMatrix,f=c.is3d,p=t.props.originRelative,g=void 0===p||p,m=f?4:3,v=[s,a];if(i){var y=e.distOrigin;(y[0]||y[1])&&(v=y)}var b=Rr(n.startOrigin,v),w=Rr(n.startTargetOrigin,v),E=Nr(v,n.prevOrigin),S=ua(d,h,b,m),D=t.getRect(),k=Ka(Ga(S,u,l,m)),x=[D.left-k.left,D.top-k.top];n.prevOrigin=v;var C=[Oc(w[0],u,g),Oc(w[1],l,g)].join(" "),_=fc(t,e,{width:u,height:l,origin:b,dist:v,delta:E,transformOrigin:C,drag:Gs.drag(t,io(e,t.state,x,!!r,!1))});return mc(t,"onDragOrigin",_),_},dragControlEnd:function(t,e){var n=e.datas;return!!n.isDragOrigin&&(mc(t,"onDragOriginEnd",pc(t,e,{})),!0)},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){var n=this.dragControlStart(t,e);return!!n},dragGroupControl:function(t,e){var n=this.dragControl(t,e);return!!n&&(t.transformOrigin=n.transformOrigin,!0)},request:function(t){var e={},n=t.getRect(),r=0,i=0,o=n.transformOrigin,s=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(t){return"deltaOrigin"in t?(s[0]+=t.deltaOrigin[0],s[1]+=t.deltaOrigin[1]):"origin"in t?(s[0]=t.origin[0]-o[0],s[1]=t.origin[1]-o[1]):("x"in t?r=t.x-n.left:"deltaX"in t&&(r+=t.deltaX),"y"in t?i=t.y-n.top:"deltaY"in t&&(i+=t.deltaY)),{datas:e,distX:r,distY:i,distOrigin:s}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function Cu(t,e,n,r,i,o,s){var a=mu(t),c=a.horizontals,u=a.verticals,l=c.length,d=u.length,h=-1,f=-1;0===n?0===l?h=0:1===l&&(h=1):3===n&&(l<=2?h=2:l<=3&&(h=3)),2===n?0===d?f=0:d<4&&(f=3):1===n&&(d<=1?f=1:d<=2&&(f=2)),gu(t,e,0,h,f,r,i,o,s)}function _u(t,e,n,r,i){var o;void 0===r&&(r=[0,0]);var s=[];if(i)o=i;else{var a=vc(t);o=a&&a.borderRadius||""}return s=!o||!i&&"0px"===o?[]:lt(o),fu(s,e,n,0,0,r)}function Ou(t,e,n,r,i,o){var s=t.state,a=s.width,c=s.height,u=du(o,i,t.props.roundRelative,a,c),l=u.raws,d=u.styles,h=mu(i,l),f=h.horizontals,p=h.verticals,g=d.join(" ");s.borderRadiusState=g,mc(t,"onRound",fc(t,e,{horizontals:f,verticals:p,borderRadius:g,width:a,height:c,delta:r,dist:n}))}var Au={name:"roundable",props:{roundable:Boolean,roundRelative:Boolean,minRoundControls:Array,maxRoundControls:Array,roundClickable:Boolean},events:{onRoundStart:"roundStart",onRound:"round",onRoundEnd:"roundEnd"},css:[".control.border-radius {\n    background: #d66;\n    cursor: pointer;\n}",":host[data-able-roundable] .line.direction {\n    cursor: pointer;\n}"],render:function(t,e){var n=t.state,r=n.target,i=n.width,o=n.height,s=n.allMatrix,a=n.is3d,c=n.left,u=n.top,l=n.borderRadiusState,d=t.props,h=d.minRoundControls,f=void 0===h?[0,0]:h,p=d.maxRoundControls,g=void 0===p?[4,4]:p,m=d.zoom;if(!r)return null;var v=a?4:3,y=_u(r,i,o,f,l);if(!y)return null;var b=0,w=0;return y.map((function(t,n){w+=Math.abs(t.horizontal),b+=Math.abs(t.vertical);var r=Nr(qa(s,t.pos,v),[c,u]),i=t.vertical?b<=g[1]:w<=g[0];return e.createElement("div",{key:"borderRadiusControl".concat(n),className:Ca("control","border-radius"),"data-radius-index":n,style:{display:i?"block":"none",transform:"translate(".concat(r[0],"px, ").concat(r[1],"px) scale(").concat(m,")")}})}))},dragControlCondition:function(t,e){if(!e.inputEvent||e.isRequest)return!1;var n=e.inputEvent.target.getAttribute("class")||"";return n.indexOf("border-radius")>-1||n.indexOf("moveable-line")>-1&&n.indexOf("moveable-direction")>-1},dragControlStart:function(t,e){var n=e.inputEvent,r=e.datas,i=n.target,o=i.getAttribute("class")||"",s=o.indexOf("border-radius")>-1,a=o.indexOf("moveable-line")>-1&&o.indexOf("moveable-direction")>-1,c=s?parseInt(i.getAttribute("data-radius-index"),10):-1,u=a?parseInt(i.getAttribute("data-line-index"),10):-1;if(!s&&!a)return!1;var l=mc(t,"onRoundStart",fc(t,e,{}));if(!1===l)return!1;r.lineIndex=u,r.controlIndex=c,r.isControl=s,r.isLine=a,Ys(t,e);var d=t.props,h=d.roundRelative,f=d.minRoundControls,p=void 0===f?[0,0]:f,g=t.state,m=g.target,v=g.width,y=g.height;r.isRound=!0,r.prevDist=[0,0];var b=_u(m,v,y,p)||[];return r.controlPoses=b,g.borderRadiusState=du(b.map((function(t){return t.pos})),b,h,v,y).styles.join(" "),!0},dragControl:function(t,e){var n=e.datas;if(!n.isRound||!n.isControl||!n.controlPoses.length)return!1;var r=n.controlIndex,i=n.controlPoses,o=na(e),s=o[0],a=o[1],c=[s,a],u=Nr(c,n.prevDist),l=t.props.maxRoundControls,d=void 0===l?[4,4]:l,h=t.state,f=h.width,p=h.height,g=i[r],m=g.vertical,v=g.horizontal,y=i.map((function(t){var e=t.horizontal,n=t.vertical,r=[e*v*c[0],n*m*c[1]];if(e){if(1===d[0])return r;if(d[0]<4&&e!==v)return r}else{if(0===d[1])return r[1]=n*v*c[0]/f*p,r;if(m){if(1===d[1])return r;if(d[1]<4&&n!==m)return r}}return[0,0]}));y[r]=c;var b=i.map((function(t,e){return Rr(t.pos,y[e])}));return n.prevDist=[s,a],Ou(t,e,c,u,i,b),!0},dragControlEnd:function(t,e){var n=t.state;n.borderRadiusState="";var r=e.datas,i=e.isDouble;if(!r.isRound)return!1;var o=n.width,s=n.height,a=r.isControl,c=r.controlIndex,u=r.isLine,l=r.lineIndex,d=r.controlPoses,h=d.map((function(t){return t.pos})),f=h.length,p=t.props.roundClickable,g=void 0===p||p;if(i&&g){if(a)pu(d,h,c,0);else if(u){var m=Ks(t,e),v=m[0],y=m[1];Cu(d,h,l,v,y,o,s)}f!==d.length&&Ou(t,e,[0,0],[0,0],d,h)}return mc(t,"onRoundEnd",pc(t,e,{})),n.borderRadiusState="",!0},unset:function(t){t.state.borderRadiusState=""}};function Mu(t,e){var n=e?"matrix3d(".concat(Ur(4)):"matrix(".concat(Ur(3),")");return t===n||"matrix(1,0,0,1,0,0)"===t}var Tu={isPinch:!0,name:"beforeRenderable",props:{},events:{onBeforeRenderStart:"beforeRenderStart",onBeforeRender:"beforeRender",onBeforeRenderEnd:"beforeRenderEnd",onBeforeRenderGroupStart:"beforeRenderGroupStart",onBeforeRenderGroup:"beforeRenderGroup",onBeforeRenderGroupEnd:"beforeRenderGroupEnd"},dragRelation:"weak",setTransform:function(t,e){var n=t.state,r=n.is3d,i=n.target,o=n.targetMatrix,s=null===i||void 0===i?void 0:i.style.transform,a=r?"matrix3d(".concat(o.join(","),")"):"matrix(".concat(Br(o,!0),")"),c=s&&"none"!==s?s:a;e.datas.startTransforms=Mu(c,r)?[]:lt(c)},resetTransform:function(t){t.datas.nextTransforms=t.datas.startTransforms,t.datas.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return fc(t,e,{setTransform:function(t){e.datas.startTransforms=et(t)?t:lt(t)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return fc(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),mc(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){this.resetTransform(e),mc(t,"onBeforeRender",fc(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){mc(t,"onBeforeRenderEnd",fc(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var n=this;this.dragStart(t,e);var r=so(t,"beforeRenderable",e),i=t.moveables,o=r.map((function(t,e){var r=i[e];return n.setTransform(r,t),n.fillDragStartParams(r,t)}));mc(t,"onBeforeRenderGroupStart",fc(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:o}))},dragGroup:function(t,e){var n=this;this.drag(t,e);var r=so(t,"beforeRenderable",e),i=t.moveables,o=r.map((function(t,e){var r=i[e];return n.resetTransform(t),n.fillDragParams(r,t)}));mc(t,"onBeforeRenderGroup",fc(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:o}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),mc(t,"onBeforeRenderGroupEnd",fc(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},Ru={name:"renderable",props:{},events:{onRenderStart:"renderStart",onRender:"render",onRenderEnd:"renderEnd",onRenderGroupStart:"renderGroupStart",onRenderGroup:"renderGroup",onRenderGroupEnd:"renderGroupEnd"},dragRelation:"weak",dragStart:function(t,e){mc(t,"onRenderStart",fc(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){mc(t,"onRender",this.fillDragParams(t,e))},dragAfter:function(t,e){if(e.resultCount)return this.drag(t,e)},dragEnd:function(t,e){mc(t,"onRenderEnd",this.fillDragEndParams(t,e))},dragGroupStart:function(t,e){mc(t,"onRenderGroupStart",fc(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){var n=this,r=so(t,"beforeRenderable",e),i=t.moveables,o=r.map((function(t,e){var r=i[e];return n.fillDragParams(r,t)}));mc(t,"onRenderGroup",fc(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,transform:ma(e),events:o}))},dragGroupEnd:function(t,e){var n=this,r=so(t,"beforeRenderable",e),i=t.moveables,o=r.map((function(t,e){var r=i[e];return n.fillDragEndParams(r,t)}));mc(t,"onRenderGroupEnd",fc(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets,events:o}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlAfter:function(t,e){return this.dragAfter(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)},fillDragParams:function(t,e){return fc(t,e,{isPinch:!!e.isPinch,transform:ma(e)})},fillDragEndParams:function(t,e){return fc(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag})}};function Nu(t,e,n,r,i,o,s){var a="Start"===i,c=t.state.target,u=o.isRequest;if(!c||a&&r.indexOf("Control")>-1&&!u&&t.areaElement===o.inputEvent.target)return!1;var l="".concat(n).concat(r).concat(i),d="".concat(n).concat(r,"Condition"),h="End"===i,f="After"===i,p=a&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());p&&t.updateRect(i,!0,!1),""!==i||u||Cc(t.state,o);var g=ji([],t[e],!0);if(u){var m=o.requestAble;g.some((function(t){return t.name===m}))||g.push.apply(g,t.props.ables.filter((function(t){return t.name===m})))}if(!g.length)return!1;var v=ji(ji([Tu],g,!0),[Ru],!1).filter((function(t){return t[l]})),y=o.datas;p&&v.forEach((function(e){e.unset&&e.unset(t)}));var b,w=o.inputEvent;h&&w&&(b=document.elementFromPoint(o.clientX,o.clientY)||w.target);var E=0,S=v.filter((function(e){var n=e.name,r=y[n]||(y[n]={});if(a&&(r.isEventStart=!e[d]||e[d](t,o)),r.isEventStart){var i=e[l](t,Fi(Fi({},o),{resultCount:E,datas:r,originalDatas:y,inputTarget:b}));return t._emitter.off(),a&&!1===i&&(r.isEventStart=!1),E+=i?1:0,i}return!1})),D=S.length,k=!1;return a&&v.length&&!D&&(k=0===v.filter((function(t){var e=t.name,n=y[e];return!!n.isEventStart&&("strong"!==t.dragRelation||(n.isEventStart=!1,!1))})).length),(h||k)&&(t.state.gesto=null,t.moveables&&t.moveables.forEach((function(t){t.state.gesto=null}))),p&&k&&v.forEach((function(e){e.unset&&e.unset(t)})),a&&!u&&D&&(null===o||void 0===o||o.preventDefault()),!t.isUnmounted&&!k&&((!a&&D&&!s||h)&&(t.updateRect(h?i:"",!0,!1),t.forceUpdate()),a||h||f||!D||s||Nu(t,e,n,r,i+"After",o),!0)}function Pu(t,e,n){var r=t.controlBox.getElement(),i=[];i.push(r),t.props.dragArea&&!t.props.dragTarget||i.push(e);var o=function(e){var n=e.inputEvent.target,r=t.areaElement;return n===r||!t.isMoveableElement(n)&&!t.controlBox.getElement().contains(n)||Pt(n,"moveable-area")||Pt(n,"moveable-padding")};return Bu(t,i,"targetAbles",n,{dragStart:o,pinchStart:o})}function Bu(t,e,n,r,i){void 0===i&&(i={});var o=t.props,s=o.pinchOutside,a=o.pinchThreshold,c={preventDefault:!1,container:window,pinchThreshold:a,pinchOutside:s},u=new ie(e,c);return["drag","pinch"].forEach((function(e){["Start","","End"].forEach((function(o){u.on("".concat(e).concat(o),(function(s){var a=s.eventType;if(!i[a]||i[a](s)){var c=Nu(t,n,e,r,o,s);c||s.stop()}else s.stop()}))}))})),u}var Fu=function(){function t(t,e,n){var r=this;this.target=t,this.moveable=e,this.eventName=n,this.ables=[],this._onEvent=function(t){var e=r.eventName,n=r.moveable;n.state.disableNativeEvent||r.ables.forEach((function(r){r[e](n,{inputEvent:t})}))},t.addEventListener(n.toLowerCase(),this._onEvent)}var e=t.prototype;return e.setAbles=function(t){this.ables=t},e.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},t}(),Iu=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=Fi({container:null,gesto:null,renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1},oc(null)),e.enabledAbles=[],e.targetAbles=[],e.controlAbles=[],e.rotation=0,e.scale=[1,1],e.isUnmounted=!1,e.events={mouseEnter:null,mouseLeave:null},e._emitter=new Ni,e._prevTarget=null,e._prevDragArea=!1,e._observer=null,e._observerId=0,e.onPreventClick=function(t){t.stopPropagation(),zt(window,"click",e.onPreventClick,!0)},e.checkUpdateRect=function(){if(!e.isDragging()){var t=e.props.parentMoveable;t?t.checkUpdateRect():(wt(e._observerId),e._observerId=bt((function(){e.isDragging()||e.updateRect()})))}},e}Bi(e,t);var n=e.prototype;return n.render=function(){var t=this.props,e=this.state,n=t.parentPosition,r=t.className,i=t.target,o=t.zoom,s=t.cspNonce,a=t.translateZ,c=t.cssStyled,u=t.portalContainer;this.checkUpdate(),this.updateRenderPoses();var l=n||{left:0,top:0},d=l.left,h=l.top,f=e.left,p=e.top,g=e.target,m=e.direction,v=e.hasFixed,y=t.targets,b=(y&&y.length||i)&&g,w=this.isDragging(),E={};return this.getEnabledAbles().forEach((function(t){E["data-able-".concat(t.name.toLowerCase())]=!0})),Xn(c,Fi({cspNonce:s,ref:ae(this,"controlBox"),className:"".concat(Ca("control-box",-1===m?"reverse":"",w?"dragging":"")," ").concat(r)},E,{onClick:this.onPreventClick,portalContainer:u,style:{position:v?"fixed":"absolute",display:b?"block":"none",transform:"translate3d(".concat(f-d,"px, ").concat(p-h,"px, ").concat(a,")"),"--zoom":o,"--zoompx":"".concat(o,"px")}}),this.renderAbles(),this._renderLines())},n.componentDidMount=function(){this.isUnmounted=!1,this.controlBox.getElement();var t=this.props,e=t.parentMoveable,n=t.container,r=t.wrapperMoveable;this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),n||e||r||this.updateRect("",!1,!0),this.updateCheckInput(),this._updateObserver(this.props)},n.componentDidUpdate=function(t){this._updateNativeEvents(),this._updateEvents(),this._updateTargets(),this.updateCheckInput(),this._updateObserver(t)},n.componentWillUnmount=function(){this.isUnmounted=!0,this._emitter.off(),hc(this,"targetGesto"),hc(this,"controlGesto");var t=this.events;for(var e in t){var n=t[e];n&&n.destroy()}},n.getContainer=function(){var t=this.props,e=t.parentMoveable,n=t.wrapperMoveable,r=t.container;return r||n&&n.getContainer()||e&&e.getContainer()||this.controlBox.getElement().parentElement},n.isMoveableElement=function(t){return t&&(t.getAttribute("class")||"").indexOf(qi)>-1},n.dragStart=function(t){var e=this.targetGesto;return e&&!e.isFlag()&&e.triggerDragStart(t),this},n.hitTest=function(t){var e,n=this.state,r=n.target,i=n.pos1,o=n.pos2,s=n.pos3,a=n.pos4,c=n.targetClientRect;if(!r)return 0;if(t instanceof Element){var u=t.getBoundingClientRect();e={left:u.left,top:u.top,width:u.width,height:u.height}}else e=Fi({width:0,height:0},t);var l=e.left,d=e.top,h=e.width,f=e.height,p=ui([i,o,a,s],c),g=vi(p,[[l,d],[l+h,d],[l+h,d+f],[l,d+f]]),m=ci(p);return g&&m?Math.min(100,g/m*100):0},n.isInside=function(t,e){var n=this.state,r=n.target,i=n.pos1,o=n.pos2,s=n.pos3,a=n.pos4,c=n.targetClientRect;return!!r&&di([t,e],ui([i,o,a,s],c))},n.updateRect=function(t,e,n){void 0===n&&(n=!0);var r=this.props,i=r.parentMoveable,o=this.state,s=o.target||this.props.target,a=this.getContainer(),c=i?i.props.rootContainer:r.rootContainer;this.updateState(oc(this.controlBox&&this.controlBox.getElement(),s,a,a,c||a),!i&&n)},n.isDragging=function(){return!!this.targetGesto&&this.targetGesto.isFlag()||!!this.controlGesto&&this.controlGesto.isFlag()},n.updateTarget=function(t){this.updateRect(t,!0)},n.getRect=function(){var t=this.state,e=lc(this.state),n=e[0],r=e[1],i=e[2],o=e[3],s=Ka(e),a=t.width,c=t.height,u=s.width,l=s.height,d=s.left,h=s.top,f=[t.left,t.top],p=Rr(f,t.origin),g=Rr(f,t.beforeOrigin),m=t.transformOrigin;return{width:u,height:l,left:d,top:h,pos1:n,pos2:r,pos3:i,pos4:o,offsetWidth:a,offsetHeight:c,beforeOrigin:g,origin:p,transformOrigin:m,rotation:this.getRotation()}},n.getManager=function(){return this},n.getRotation=function(){var t=this.state,e=t.pos1,n=t.pos2,r=t.direction;return zc(e,n,r)},n.request=function(t,e,n){void 0===e&&(e={});var r=this.props,i=r.ables,o=r.groupable,s=i.filter((function(e){return e.name===t}))[0];if(this.isDragging()||!s||!s.request)return{request:function(){return this},requestEnd:function(){return this}};var a=this,c=s.request(this),u=n||e.isInstant,l=c.isControl?"controlAbles":"targetAbles",d="".concat(o?"Group":"").concat(c.isControl?"Control":""),h={request:function(e){return Nu(a,l,"drag",d,"",Fi(Fi({},c.request(e)),{requestAble:t,isRequest:!0}),u),this},requestEnd:function(){return Nu(a,l,"drag",d,"End",Fi(Fi({},c.requestEnd()),{requestAble:t,isRequest:!0}),u),this}};return Nu(a,l,"drag",d,"Start",Fi(Fi({},c.requestStart(e)),{requestAble:t,isRequest:!0}),u),u?h.request(e).requestEnd():h},n.destroy=function(){this.componentWillUnmount()},n.updateRenderPoses=function(){var t=this.state,e=this.props,n=t.originalBeforeOrigin,r=t.transformOrigin,i=t.allMatrix,o=t.is3d,s=t.pos1,a=t.pos2,c=t.pos3,u=t.pos4,l=t.left,d=t.top,h=e.padding||{},f=h.left,p=void 0===f?0:f,g=h.top,m=void 0===g?0:g,v=h.bottom,y=void 0===v?0:v,b=h.right,w=void 0===b?0:b,E=o?4:3,S=e.groupable?n:Rr(n,[l,d]);t.renderPoses=[Rr(s,_c(i,[-p,-m],r,S,E)),Rr(a,_c(i,[w,-m],r,S,E)),Rr(c,_c(i,[-p,y],r,S,E)),Rr(u,_c(i,[w,y],r,S,E))]},n.checkUpdate=function(){var t=this.props,e=t.target,n=t.container,r=t.parentMoveable,i=this.state,o=i.target,s=i.container;if(o||e){this.updateAbles();var a=!bc(o,e)||!bc(s,n);if(a){var c=n||this.controlBox;c&&this.unsetAbles(),this.updateState({target:e,container:n}),!r&&c&&this.updateRect("End",!1,!1)}}},n.triggerEvent=function(t,e){this._emitter.trigger(t,e);var n=this.props[t];return n&&n(e)},n.useCSS=function(t,e){var n=this.props.customStyledMap,r=t+e;return n[r]||(n[r]=Mi(t,e)),n[r]},n.unsetAbles=function(){var t=this;this.targetAbles.forEach((function(e){e.unset&&e.unset(t)}))},n.updateAbles=function(t,e){void 0===t&&(t=this.props.ables),void 0===e&&(e="");var n=this.props,r=n.triggerAblesSimultaneously,i=t.filter((function(t){return t&&(t.always&&!1!==n[t.name]||n[t.name])})),o="drag".concat(e,"Start"),s="pinch".concat(e,"Start"),a="drag".concat(e,"ControlStart"),c=yc(i,[o,s],r),u=yc(i,[a],r);this.enabledAbles=i,this.targetAbles=c,this.controlAbles=u},n.updateState=function(t,e){if(e){if(this.isUnmounted)return;this.setState(t)}else{var n=this.state;for(var r in t)n[r]=t[r]}},n.getEnabledAbles=function(){var t=this.props,e=t.ables;return e.filter((function(e){return e&&t[e.name]}))},n.renderAbles=function(){var t=this,e=this.props,n=e.triggerAblesSimultaneously,r={createElement:Xn};return Sc(Dc(yc(this.getEnabledAbles(),["render"],n).map((function(e){var n=e.render;return n(t,r)||[]}))).filter((function(t){return t})),(function(t){var e=t.key;return e})).map((function(t){return t[0]}))},n.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},n._updateObserver=function(t){var e,n=this.props,r=n.target;if(window.ResizeObserver&&r&&n.useResizeObserver){if(t.target!==r||!this._observer){var i=new ResizeObserver(this.checkUpdateRect);i.observe(r,{box:"border-box"}),this._observer=i}}else null===(e=this._observer)||void 0===e||e.disconnect()},n._updateEvents=function(){var t=this.controlBox.getElement(),e=this.targetAbles.length,n=this.controlAbles.length,r=this.props,i=r.dragTarget||r.target,o=!e&&this.targetGesto||this._isTargetChanged(!0);o&&(hc(this,"targetGesto"),this.updateState({gesto:null})),n||hc(this,"controlGesto"),i&&e&&!this.targetGesto&&(this.targetGesto=Pu(this,i,"")),!this.controlGesto&&n&&(this.controlGesto=Bu(this,t,"controlAbles","Control"))},n._updateTargets=function(){var t=this.props;this._prevTarget=t.dragTarget||t.target,this._prevDragArea=t.dragArea},n._renderLines=function(){var t=this.props,e=t.edge,n=t.zoom,r=t.hideDefaultLines;if(r)return[];var i=this.state.renderPoses,o={createElement:Xn};return[lo(o,e?"n":"",i[0],i[1],n,0),lo(o,e?"e":"",i[1],i[3],n,1),lo(o,e?"w":"",i[0],i[2],n,2),lo(o,e?"s":"",i[2],i[3],n,3)]},n._isTargetChanged=function(t){var e=this.props,n=e.dragTarget||e.target,r=this._prevTarget,i=this._prevDragArea,o=e.dragArea,s=!o&&r!==n,a=(t||o)&&i!==o;return s||a},n._updateNativeEvents=function(){var t=this,e=this.props,n=e.dragArea?this.areaElement:this.state.target,r=this.events,i=Et(r);if(this._isTargetChanged())for(var o in r){var s=r[o];s&&s.destroy(),r[o]=null}if(n){var a=this.enabledAbles;i.forEach((function(e){var i=yc(a,[e]),o=i.length>0,s=r[e];o?(s||(s=new Fu(n,t,e),r[e]=s),s.setAbles(i)):s&&(s.destroy(),r[e]=null)}))}},e.defaultProps={target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,edge:!1,parentMoveable:null,wrapperMoveable:null,parentPosition:null,portalContainer:null,useResizeObserver:!1,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{}},e}(lr),zu={name:"groupable",props:{defaultGroupRotate:Number,defaultGroupOrigin:String,groupable:Boolean},events:{},render:function(t,e){var n=t.props.targets||[];t.moveables=[];var r=t.state,i=r.left,o=r.top,s={left:i,top:o},a=t.props;return n.map((function(n,r){return e.createElement(Iu,{key:"moveable"+r,ref:ce(t,"moveables",r),target:n,origin:!1,cssStyled:a.cssStyled,customStyledMap:a.customStyledMap,useResizeObserver:a.useResizeObserver,parentMoveable:t,parentPosition:s})}))}},ju=Li("clickable",{props:{clickable:Boolean},events:{onClick:"click",onClickGroup:"clickGroup"},always:!0,dragRelation:"weak",dragStart:function(t,e){e.isRequest||It(window,"click",t.onPreventClick,!0)},dragControlStart:function(t,e){this.dragStart(t,e)},dragGroupStart:function(t,e){this.dragStart(t,e),e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){this.endEvent(t);var n=t.state.target,r=e.inputEvent,i=e.inputTarget,o=t.isMoveableElement(i),s=!o&&t.controlBox.getElement().contains(i);if(e.isDrag&&!s||this.unset(t),r&&i&&!e.isDrag&&!t.isMoveableElement(i)&&!s){var a=n.contains(i);mc(t,"onClick",fc(t,e,{isDouble:e.isDouble,inputTarget:i,isTarget:n===i,containsTarget:a}))}},dragGroupEnd:function(t,e){this.endEvent(t);var n=e.inputEvent,r=e.inputTarget;if(n&&r&&!e.isDrag&&!t.isMoveableElement(r)&&e.datas.inputTarget!==r){var i=t.props.targets,o=i.indexOf(r),s=o>-1,a=!1;-1===o&&(o=vt(i,(function(t){return t.contains(r)})),a=o>-1),mc(t,"onClickGroup",fc(t,e,{isDouble:e.isDouble,targets:i,inputTarget:r,targetIndex:o,isTarget:s,containsTarget:a}))}},dragControlEnd:function(t,e){this.dragEnd(t,e)},dragGroupControlEnd:function(t,e){this.dragEnd(t,e)},endEvent:function(t){var e=this;bt((function(){e.unset(t)}))},unset:function(t){zt(window,"click",t.onPreventClick,!0)}});function Lu(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),Fi(Fi({},t),{datas:e})}var $u=Li("edgeDraggable",{dragControlCondition:function(t,e){if(!t.props.edgeDraggable||!e.inputEvent)return!1;var n=e.inputEvent.target;return Pt(n,Ca("direction"))&&Pt(n,Ca("line"))},dragControlStart:function(t,e){return Gs.dragStart(t,Lu(e))},dragControl:function(t,e){return Gs.drag(t,Lu(e))},dragControlEnd:function(t,e){return Gs.dragEnd(t,Lu(e))},dragGroupControlCondition:function(t,e){if(!t.props.edgeDraggable||!e.inputEvent)return!1;var n=e.inputEvent.target;return Pt(n,Ca("direction"))&&Pt(n,Ca("line"))},dragGroupControlStart:function(t,e){return Gs.dragGroupStart(t,Lu(e))},dragGroupControl:function(t,e){return Gs.dragGroup(t,Lu(e))},dragGroupControlEnd:function(t,e){return Gs.dragGroupEnd(t,Lu(e))},unset:function(t){return Gs.unset(t)}}),Hu={name:"individualGroupable",props:{individualGroupable:Boolean},events:{}},Vu=[Tu,ru,qs,$c,Gs,$u,wo,Hc,Vc,Gc,nu,iu,tu,xu,ku,Au,zu,Hu,ju,Qc,Ru],Wu=Vu.reduce((function(t,e){return Fi(Fi({},t),"events"in e?e.events:{})}),{}),Uu=Vu.reduce((function(t,e){return Fi(Fi({},t),e.props)}),{}),qu=Rc(Wu),Gu=Object.keys(qu),Ku=Object.keys(Uu);function Yu(t,e){return Math.max.apply(Math,t.map((function(t){var n=t[0],r=t[1],i=t[2],o=t[3];return Math.max(n[e],r[e],i[e],o[e])})))}function Xu(t,e){return Math.min.apply(Math,t.map((function(t){var n=t[0],r=t[1],i=t[2],o=t[3];return Math.min(n[e],r[e],i[e],o[e])})))}function Ju(t,e){if(!t.length)return[0,0,0,0];var n=t.map((function(t){var e=t.state;return lc(e)})),r=Zi,i=Zi,o=0,s=0,a=Rt(e,Xi);if(a%90){var c=a/180*Math.PI,u=Math.tan(c),l=-1/u,d=[Qi,Zi],h=[Qi,Zi];n.forEach((function(t){t.forEach((function(t){var e=t[1]-u*t[0],n=t[1]-l*t[0];d[0]=Math.max(d[0],e),d[1]=Math.min(d[1],e),h[0]=Math.max(h[0],n),h[1]=Math.min(h[1],n)}))})),d.forEach((function(t){h.forEach((function(e){var n=(e-t)/(u-l),o=u*n+t;r=Math.min(r,n),i=Math.min(i,o)}))}));var f=n.map((function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return[$r(e,-c),$r(n,-c),$r(r,-c),$r(i,-c)]}));o=Yu(f,0)-Xu(f,0),s=Yu(f,1)-Xu(f,1)}else if(r=Xu(n,0),i=Xu(n,1),o=Yu(n,0)-r,s=Yu(n,1)-i,a%180){var p=o;o=s,s=p}return[r,i,o,s]}var Zu=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.differ=new si,e.moveables=[],e.transformOrigin="50% 50%",e}Bi(e,t);var n=e.prototype;return n.checkUpdate=function(){this.updateAbles()},n.updateRect=function(t,e,n){if(void 0===n&&(n=!0),this.controlBox){this.moveables.forEach((function(e){e.updateRect(t,!1,!1)}));var r=this.state,i=this.props,o=r.target||i.target;(!e||""!==t&&i.updateGroup)&&(this.rotation=i.defaultGroupRotate,this.transformOrigin=i.defaultGroupOrigin||"50% 50%",this.scale=[1,1]);var s=this.rotation,a=this.scale,c=Ju(this.moveables,s),u=c[0],l=c[1],d=c[2],h=c[3],f="rotate(".concat(s,"deg) scale(").concat(a[0]>=0?1:-1,", ").concat(a[1]>=0?1:-1,")");o.style.cssText+="left:0px;top:0px; transform-origin: ".concat(this.transformOrigin,"; width:").concat(d,"px; height:").concat(h,"px;")+"transform:".concat(f),r.width=d,r.height=h;var p=this.getContainer(),g=oc(this.controlBox.getElement(),o,this.controlBox.getElement(),this.getContainer(),this.props.rootContainer||p),m=[g.left,g.top],v=lc(g),y=v[0],b=v[1],w=v[2],E=v[3],S=li([y,b,w,E]),D=[S.minX,S.minY];g.pos1=Nr(y,D),g.pos2=Nr(b,D),g.pos3=Nr(w,D),g.pos4=Nr(E,D),g.left=u-g.left+D[0],g.top=l-g.top+D[1],g.origin=Nr(Rr(m,g.origin),D),g.beforeOrigin=Nr(Rr(m,g.beforeOrigin),D),g.originalBeforeOrigin=Rr(m,g.originalBeforeOrigin);var k=g.targetClientRect,x=a[0]*a[1]>0?1:-1;k.top+=g.top-r.top,k.left+=g.left-r.left,o.style.transform="translate(".concat(-D[0],"px, ").concat(-D[1],"px) ").concat(f),this.updateState(Fi(Fi({},g),{direction:x,beforeDirection:x}),n)}},n.getRect=function(){return Fi(Fi({},t.prototype.getRect.call(this)),{children:this.moveables.map((function(t){return t.getRect()}))})},n.triggerEvent=function(e,n,r){if(r||e.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,e,n);this._emitter.trigger(e,n)},n.updateAbles=function(){t.prototype.updateAbles.call(this,ji(ji([],this.props.ables,!0),[zu],!1),"Group")},n._updateTargets=function(){t.prototype._updateTargets.call(this),this._prevTarget=this.props.dragTarget||this.areaElement},n._updateEvents=function(){var t=this.state,e=this.props,n=this._prevTarget,r=e.dragTarget||this.areaElement;n!==r&&(hc(this,"targetGesto"),hc(this,"controlGesto"),t.target=null),t.target||(t.target=this.areaElement,this.controlBox.getElement().style.display="block",this.targetGesto=Pu(this,r,"Group"),this.controlGesto=Bu(this,this.controlBox.getElement(),"controlAbles","GroupControl"));var i=!bc(t.container,e.container);i&&(t.container=e.container);var o=this.differ.update(e.targets),s=o.added,a=o.changed,c=o.removed;(i||s.length||a.length||c.length)&&this.updateRect()},n._updateObserver=function(){},e.defaultProps=Fi(Fi({},Iu.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e}(Iu),Qu=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.moveables=[],e}Bi(e,t);var n=e.prototype;return n.render=function(){var t=this,e=this.props,n=e.cspNonce,r=e.cssStyled,i=e.targets;return Xn(r,{cspNonce:n,ref:ae(this,"controlBox"),className:Ca("control-box")},i.map((function(e,n){return Xn(Iu,Fi({key:"moveable"+n,ref:ce(t,"moveables",n)},t.props,{target:e,wrapperMoveable:t}))})))},n.componentDidUpdate=function(){},n.updateRect=function(t,e,n){void 0===n&&(n=!0),this.moveables.forEach((function(r){r.updateRect(t,e,n)}))},n.getRect=function(){return Fi(Fi({},t.prototype.getRect.call(this)),{children:this.moveables.map((function(t){return t.getRect()}))})},n.request=function(){return{request:function(){return this},requestEnd:function(){return this}}},n.dragStart=function(){return this},n.hitTest=function(){return 0},n.isInside=function(){return!1},n.isDragging=function(){return!1},n.updateRenderPoses=function(){},n.checkUpdate=function(){},n.triggerEvent=function(){},n.updateAbles=function(){},n._updateEvents=function(){},n._updateObserver=function(){},e}(Iu),tl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.refTargets=[],e.selectorMap={},e}Bi(e,t);var n=e.prototype;return e.makeStyled=function(){var t={},e=this.getTotalAbles();e.forEach((function(e){var n=e.css;n&&n.forEach((function(e){t[e]=!0}))}));var n=Et(t).join("\n");this.defaultStyled=Mi("div",se(qi,Gi+n))},e.getTotalAbles=function(){return ji([ru,zu,Hu,Qc],this.defaultAbles,!0)},n.render=function(){var t=this.constructor;t.defaultStyled||t.makeStyled();var e=this.props,n=e.ables,r=e.props,i=Ii(e,["ables","props"]),o=this._updateRefs(!0),s=Ic(o,this.selectorMap),a=s.length>1,c=t.getTotalAbles(),u=ji(ji([],c,!0),n||[],!0),l=Fi(Fi(Fi({},i),r||{}),{ables:u,cssStyled:t.defaultStyled,customStyledMap:t.customStyledMap});return a?i.individualGroupable?Xn(Qu,Fi({key:"individual-group",ref:ae(this,"moveable")},l,{target:null,targets:s})):Xn(Zu,Fi({key:"group",ref:ae(this,"moveable")},l,{target:null,targets:s})):Xn(Iu,Fi({key:"single",ref:ae(this,"moveable")},l,{target:s[0]}))},n.componentDidMount=function(){this._updateRefs()},n.componentDidUpdate=function(){this._updateRefs()},n.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},n.getManager=function(){return this.moveable},n._updateRefs=function(t){var e=this.refTargets,n=Fc(this.props.target||this.props.targets),r="undefined"!==typeof document,i=e.length!==n.length||e.some((function(t,e){var r=n[e];return!(!t&&!r)&&t!==r})),o=this.selectorMap,s={};return this.refTargets.forEach((function(t){if(nt(t)){var e=o[t];e?s[t]=o[t]:r&&(i=!0,s[t]=[].slice.call(document.querySelectorAll(t)))}})),this.refTargets=n,this.selectorMap=s,!t&&i&&this.forceUpdate(),n},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,zi([le(ro)],e.prototype,"moveable",void 0),e}(lr),el=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Bi(e,t),e.defaultAbles=Vu,e}(tl);var nl=el,rl=function(t,e){return rl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},rl(t,e)};function il(t,e){function n(){this.constructor=t}rl(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var ol=function(){return ol=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},ol.apply(this,arguments)};function sl(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}var al=function(t){function e(e){var n=t.call(this,e)||this;return n.state={},n.state=n.props,n}il(e,t);var n=e.prototype;return n.render=function(){return yr(Xn(nl,ol({ref:ae(this,"moveable")},this.state)),this.state.parentElement)},e}(ur),cl=Ku,ul=ro,ll=Gu,dl=function(){return dl=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},dl.apply(this,arguments)};function hl(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var fl=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e){if(tt(t))for(var n in t)this.on(n,t[n]);else this._addEvent(t,e,{});return this},e.off=function(t,e){if(t)if(tt(t))for(var n in t)this.off(n);else if(e){var r=this._events[t];if(r){var i=vt(r,(function(t){return t.listener===e}));i>-1&&r.splice(i,1)}}else this._events[t]=[];else this._events={};return this},e.once=function(t,e){var n=this;return e&&this._addEvent(t,e,{once:!0}),new Promise((function(e){n._addEvent(t,e,{once:!0})}))},e.emit=function(t,e){var n=this;void 0===e&&(e={});var r=this._events[t];if(!t||!r)return!0;var i=!1;return e.eventType=t,e.stop=function(){i=!0},e.currentTarget=this,hl(r).forEach((function(r){r.listener(e),r.once&&n.off(t,r.listener)})),!i},e.trigger=function(t,e){return void 0===e&&(e={}),this.emit(t,e)},e._addEvent=function(t,e,n){var r=this._events;r[t]=r[t]||[];var i=r[t];i.push(dl({listener:e},n))},t}(),pl=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;r.tempElement=document.createElement("div");var i=ol({},n),o={};ll.forEach((function(t){o[pt("on "+t)]=function(e){return r.trigger(t,e)}})),vr(Xn(al,ol({ref:ae(r,"innerMoveable"),parentElement:e},i,o)),r.tempElement);var s=i.target;return et(s)&&s.length>1&&r.updateRect(),r}il(e,t);var n=e.prototype;return n.setState=function(t,e){this.innerMoveable.setState(t,e)},n.forceUpdate=function(t){this.innerMoveable.forceUpdate(t)},n.dragStart=function(t){var e=this.innerMoveable;e.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(t)},n.destroy=function(){vr(null,this.tempElement),this.off(),this.tempElement=null,this.innerMoveable=null},n.getMoveable=function(){return this.innerMoveable.moveable},e=sl([ue(ul,(function(t,e){t[e]||(t[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this.getMoveable();if(r&&r[e])return r[e].apply(r,t)})})),ue(cl,(function(t,e){Object.defineProperty(t,e,{get:function(){return this.getMoveable().props[e]},set:function(t){var n;this.setState((n={},n[e]=t,n))},enumerable:!0,configurable:!0})}))],e),e}(fl),gl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return il(e,t),e}(pl);var ml=gl,vl=function(){return vl=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},vl.apply(this,arguments)},yl={};ul.forEach((function(t){yl[t]=function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];(e=this.$_moveable)[t].apply(e,n)}}));var bl={};cl.forEach((function(t){bl[t]=function(e){this.$_moveable[t]=e}}));var wl={name:"moveable",methods:yl,props:cl,watch:bl,mounted:function(){var t=this,e={},n=this.$props;cl.forEach((function(t){var r=n[t];Q(r)||(e[t]=n[t])}));var r=this.$refs,i=r.moveableElement,o=new ml(i,vl(vl({},e),{portalContainer:i}));ll.forEach((function(e){o.on(e,(function(n){t.$emit(e,vl({},n))}))})),this.$_moveable=o},beforeUnmount:function(){this.$_moveable.destroy()}};const El={ref:"moveableElement"};function Sl(t,e,n,r,i,s){return(0,o.wg)(),(0,o.j4)("div",El,null,512)}wl.render=Sl,wl.__file="src/Moveable.vue";var Dl=wl,kl=function(t,e){return kl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},kl(t,e)};function xl(t,e){function n(){this.constructor=t}kl(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Cl="object",_l="string";function Ol(t){return t&&typeof t===Cl}function Al(t){return Array.isArray(t)}function Ml(t){return typeof t===_l}function Tl(t,e,n){void 0===n&&(n=-1);for(var r=t.length,i=0;i<r;++i)if(e(t[i],i,t))return i;return n}function Rl(t,e,n,r){t.addEventListener(e,n,r)}function Nl(t,e,n){t.removeEventListener(e,n)}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Pl=function(){return Pl=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Pl.apply(this,arguments)};function Bl(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var Fl=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e){if(Ol(t))for(var n in t)this.on(n,t[n]);else this._addEvent(t,e,{});return this},e.off=function(t,e){if(t)if(Ol(t))for(var n in t)this.off(n);else if(e){var r=this._events[t];if(r){var i=Tl(r,(function(t){return t.listener===e}));i>-1&&r.splice(i,1)}}else this._events[t]=[];else this._events={};return this},e.once=function(t,e){var n=this;return e&&this._addEvent(t,e,{once:!0}),new Promise((function(e){n._addEvent(t,e,{once:!0})}))},e.emit=function(t,e){var n=this;void 0===e&&(e={});var r=this._events[t];if(!t||!r)return!0;var i=!1;return e.eventType=t,e.stop=function(){i=!0},e.currentTarget=this,Bl(r).forEach((function(r){r.listener(e),r.once&&n.off(t,r.listener)})),!i},e.trigger=function(t,e){return void 0===e&&(e={}),this.emit(t,e)},e._addEvent=function(t,e,n){var r=this._events;r[t]=r[t]||[];var i=r[t];i.push(Pl({listener:e},n))},t}();function Il(t,e){return e={exports:{}},t(e,e.exports),e.exports}var zl,jl=Il((function(t,e){function n(t){if(t&&"object"===typeof t){var e=t.which||t.keyCode||t.charCode;e&&(t=e)}if("number"===typeof t)return s[t];var n=String(t),o=r[n.toLowerCase()];if(o)return o;o=i[n.toLowerCase()];return o||(1===n.length?n.charCodeAt(0):void 0)}n.isEventKey=function(t,e){if(t&&"object"===typeof t){var n=t.which||t.keyCode||t.charCode;if(null===n||void 0===n)return!1;if("string"===typeof e){var o=r[e.toLowerCase()];if(o)return o===n;o=i[e.toLowerCase()];if(o)return o===n}else if("number"===typeof e)return e===n;return!1}},e=t.exports=n;var r=e.code=e.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},i=e.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};
/*!
   * Programatically add the following
   */
for(o=97;o<123;o++)r[String.fromCharCode(o)]=o-32;for(var o=48;o<58;o++)r[o-48]=o;for(o=1;o<13;o++)r["f"+o]=o+111;for(o=0;o<10;o++)r["numpad "+o]=o+96;var s=e.names=e.title={};for(o in r)s[r[o]]=o;for(var a in i)r[a]=i[a]})),Ll=(jl.code,jl.codes,jl.aliases,jl.names),$l=(jl.title,{"+":"plus","left command":"meta","right command":"meta"}),Hl={shift:1,ctrl:2,alt:3,meta:4};function Vl(t){var e=Ll[t]||"";for(var n in $l)e=e.replace(n,$l[n]);return e.replace(/\s/g,"")}function Wl(t,e){void 0===e&&(e=Vl(t.keyCode));var n=Ul(t);return-1===n.indexOf(e)&&n.push(e),n.filter(Boolean)}function Ul(t){var e=[t.shiftKey&&"shift",t.ctrlKey&&"ctrl",t.altKey&&"alt",t.metaKey&&"meta"];return e.filter(Boolean)}function ql(t){var e=t.slice();return e.sort((function(t,e){var n=Hl[t]||5,r=Hl[e]||5;return n-r})),e}var Gl=function(t){function e(e){void 0===e&&(e=window);var n=t.call(this)||this;return n.container=e,n.ctrlKey=!1,n.altKey=!1,n.shiftKey=!1,n.metaKey=!1,n.clear=function(){return n.ctrlKey=!1,n.altKey=!1,n.shiftKey=!1,n.metaKey=!1,n},n.keydownEvent=function(t){n.triggerEvent("keydown",t)},n.keyupEvent=function(t){n.triggerEvent("keyup",t)},n.blur=function(){n.clear(),n.trigger("blur")},Rl(e,"blur",n.blur),Rl(e,"keydown",n.keydownEvent),Rl(e,"keyup",n.keyupEvent),n}xl(e,t);var n=e.prototype;return Object.defineProperty(e,"global",{get:function(){return zl||(zl=new e)},enumerable:!1,configurable:!0}),e.setGlobal=function(){return this.global},n.destroy=function(){var t=this.container;this.clear(),this.off(),Nl(t,"blur",this.blur),Nl(t,"keydown",this.keydownEvent),Nl(t,"keyup",this.keyupEvent)},n.keydown=function(t,e){return this.addEvent("keydown",t,e)},n.offKeydown=function(t,e){return this.removeEvent("keydown",t,e)},n.offKeyup=function(t,e){return this.removeEvent("keyup",t,e)},n.keyup=function(t,e){return this.addEvent("keyup",t,e)},n.addEvent=function(t,e,n){return Al(e)?this.on(t+"."+ql(e).join("."),n):Ml(e)?this.on(t+"."+e,n):this.on(t,e),this},n.removeEvent=function(t,e,n){return Al(e)?this.off(t+"."+ql(e).join("."),n):Ml(e)?this.off(t+"."+e,n):this.off(t,e),this},n.triggerEvent=function(t,e){this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey;var n=Vl(e.keyCode),r="ctrl"===n||"shift"===n||"meta"===n||"alt"===n,i={key:n,isToggle:r,inputEvent:e,keyCode:e.keyCode,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey};this.trigger(t,i),this.trigger(t+"."+n,i);var o=Wl(e,n);o.length>1&&this.trigger(t+"."+o.join("."),i)},e}(Fl),Kl=Gl,Yl=function(t,e){return Yl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Yl(t,e)};function Xl(t,e){function n(){this.constructor=t}Yl(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Jl=function(){return Jl=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Jl.apply(this,arguments)};function Zl(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function Ql(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}function td(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function ed(t){if("touches"in t){var e=t.touches[0]||t.changedTouches[0];return{clientX:e.clientX,clientY:e.clientY}}return{clientX:t.clientX,clientY:t.clientY}}function nd(t,e,n){var r=t.tag,i=t.children,o=t.attributes,s=t.className,a=t.style,c=e||document.createElement(r);for(var u in o)c.setAttribute(u,o[u]);var l=c.children;if(i.forEach((function(t,e){nd(t,l[e],c)})),s&&s.split(" ").forEach((function(t){Pt(c,t)||Bt(c,t)})),a){var d=c.style;for(var u in a)d[u]=a[u]}return!e&&n&&n.appendChild(c),c}function rd(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=e||{},o=i.className,s=void 0===o?"":o,a=i.style,c=void 0===a?{}:a,u=Zl(i,["className","style"]);return{tag:t,className:s,style:c,attributes:u,children:n}}function id(t,e,n){t!==e&&n(t,e)}function od(t,e,n){var r;void 0===n&&(n=t.datas.boundArea);var i=t.distX,o=void 0===i?0:i,s=t.distY,a=void 0===s?0:s,c=t.datas,u=c.startX,l=c.startY;if(e>0){var d=Math.sqrt((o*o+a*a)/(1+e*e)),h=e*d;o=(o>=0?1:-1)*h,a=(a>=0?1:-1)*d}var f=Math.abs(o),p=Math.abs(a),g=o<0?u-n.left:n.right-u,m=a<0?l-n.top:n.bottom-l;r=xt([f,p],[0,0],[g,m],!!e),f=r[0],p=r[1],o=(o>=0?1:-1)*f,a=(a>=0?1:-1)*p;var v=Math.min(0,o),y=Math.min(0,a),b=u+v,w=l+y;return{left:b,top:w,right:b+f,bottom:w+p,width:f,height:p}}function sd(t){var e=t.getBoundingClientRect(),n=e.left,r=e.top,i=e.width,o=e.height;return{pos1:[n,r],pos2:[n+i,r],pos3:[n,r+o],pos4:[n+i,r+o]}}function ad(t,e,n){var r=oi(t,e),i=r.list,o=r.prevList,s=r.added,a=r.removed,c=r.maintained;return td(s.map((function(t){return i[t]})),a.map((function(t){return o[t]})),n?c.map((function(t){var e=t[1];return i[e]})):[])}var cd=ye("\n:host {\n    position: fixed;\n    display: none;\n    border: 1px solid #4af;\n    background: rgba(68, 170, 255, 0.5);\n    pointer-events: none;\n    will-change: transform;\n    z-index: 100;\n}\n"),ud="selecto-selection "+cd.className,ld=["boundContainer","selectableTargets","selectByClick","selectFromInside","continueSelect","toggleContinueSelect","keyContainer","hitRate","scrollOptions","checkInput","preventDefault","ratio","getElementRect","preventDragFromInside","rootContainer","dragCondition","clickBySelectEnd"],dd=td(["dragContainer","cspNonce","continueSelectWithoutDeselect"],ld),hd=(Boolean,Boolean,Boolean,Boolean,Boolean,Boolean,Boolean,Boolean,["dragStart","drag","dragEnd","selectStart","select","selectEnd","keydown","keyup","scroll"]),fd=["clickTarget","getSelectableElements","setSelectedTargets","getElementPoints","getSelectedTargets","findSelectableTargets","triggerDragStart","checkScroll"],pd=function(t){function e(e){void 0===e&&(e={});var n=t.call(this)||this;return n.selectedTargets=[],n.dragScroll=new Di,n._onDragStart=function(t,e){var r=t.datas,i=t.clientX,o=t.clientY,s=t.inputEvent,a=n.options,c=a.continueSelect,u=a.continueSelectWithoutDeselect,l=a.selectFromInside,d=a.selectByClick,h=a.rootContainer,f=a.boundContainer,p=a.preventDragFromInside,g=void 0===p||p,m=a.clickBySelectEnd,v=a.dragCondition;if(!v||v(t)){n.findSelectableTargets(r),r.startSelectedTargets=n.selectedTargets,r.scaleMatrix=Yr(),r.containerX=0,r.containerY=0;var y={left:-1/0,top:-1/0,right:1/0,bottom:1/0};if(h){var b=n.container.getBoundingClientRect();r.containerX=b.left,r.containerY=b.top,r.scaleMatrix=Zr(n.container,h)}if(f){var w=tt(f)&&"element"in f?Jl({left:!0,top:!0,bottom:!0,right:!0},f):{element:f,left:!0,top:!0,bottom:!0,right:!0},E=w.element,S=void 0;if(E){S=nt(E)?document.querySelector(E):!0===E?n.container:E;var D=S.getBoundingClientRect();w.left&&(y.left=D.left),w.top&&(y.top=D.top),w.right&&(y.right=D.right),w.bottom&&(y.bottom=D.bottom)}}r.boundArea=y;var k={left:i,top:o,right:i,bottom:o,width:0,height:0},x=[];if(!l||d&&!m){var C=n._findElement(e||document.elementFromPoint(i,o),r.selectableTargets);x=C?[C]:[]}var _=x.length>0,O=!l&&_;if(O&&!d)return t.stop(),!1;var A=s.type,M="mousedown"===A||"touchstart"===A,T=!(!t.isClick&&M)||n.emit("dragStart",Jl({},t));if(!T)return t.stop(),!1;c?(x=ad(n.selectedTargets,x,u),r.startPassedTargets=n.selectedTargets):r.startPassedTargets=[],n._select(n.selectedTargets,x,k,s,!0),r.startX=i,r.startY=o,r.selectFlag=!1,r.preventDragFromInside=!1;var R=Jr(r.scaleMatrix,[i-r.containerX,o-r.containerY]);if(r.boundsArea=n.target.style.cssText+="position: "+(h?"absolute":"fixed")+";left:0px;top:0px;transform: translate("+R[0]+"px, "+R[1]+"px)",O&&d&&!m)s.preventDefault(),g&&(n._selectEnd(r.startSelectedTargets,r.startPassedTargets,k,t),r.preventDragFromInside=!0);else{r.selectFlag=!0,"touchstart"===A&&s.preventDefault();var N=n.options.scrollOptions;N&&N.container&&n.dragScroll.dragStart(t,N),m&&(r.selectFlag=!1,t.preventDrag())}return!0}t.stop()},n._onDrag=function(t){var e;if(t.datas.selectFlag){var r=n.scrollOptions;if((null===(e=r)||void 0===e?void 0:e.container)&&n.dragScroll.drag(t,r))return}n._checkSelected(t)},n._onDragEnd=function(t){var e=t.datas,r=t.inputEvent,i=od(t,n.options.ratio),o=e.selectFlag;if(r&&!t.isClick&&n.emit("dragEnd",Jl(Jl({isDouble:!!t.isDouble,isDrag:!1,isSelect:o},t),{isClick:!!t.isClick,rect:i})),n.target.style.cssText+="display: none;",o)e.selectFlag=!1,n.dragScroll.dragEnd();else if(n.selectByClick&&n.clickBySelectEnd){var s=n._findElement(document.elementFromPoint(t.clientX,t.clientY),e.selectableTargets);n._select(n.selectedTargets,s?[s]:[],i,r)}e.preventDragFromInside||n._selectEnd(e.startSelectedTargets,e.startPassedTargets,i,t)},n._onKeyDown=function(t){n._sameCombiKey(t)&&(n.continueSelect=!0,n.emit("keydown",{}))},n._onKeyUp=function(t){n._sameCombiKey(t,!0)&&(n.continueSelect=!1,n.emit("keyup",{}))},n._onBlur=function(){n.toggleContinueSelect&&n.continueSelect&&(n.continueSelect=!1,n.emit("keyup",{}))},n._onDocumentSelectStart=function(t){if(n.gesto.isFlag()){var e=n.dragContainer;e===window&&(e=document.documentElement);var r=e instanceof Element?[e]:[].slice.call(e),i=t.target;r.some((function(e){if(e===i||e.contains(i))return t.preventDefault(),!0}))}},n.target=e.portalContainer,n.container=e.container||document.body,n.options=Jl({portalContainer:null,container:null,dragContainer:null,selectableTargets:[],selectByClick:!0,selectFromInside:!0,clickBySelectEnd:!1,hitRate:100,continueSelect:!1,continueSelectWithoutDeselect:!1,toggleContinueSelect:null,keyContainer:null,scrollOptions:void 0,checkInput:!1,preventDefault:!1,boundContainer:!1,preventDragFromInside:!0,dragCondition:null,rootContainer:null,getElementRect:sd,cspNonce:"",ratio:0},e),n.initElement(),n.initDragScroll(),n.setKeyController(),n}Xl(e,t);var n=e.prototype;return n.setSelectedTargets=function(t){return this.selectedTargets=t,this},n.getSelectedTargets=function(){return this.selectedTargets},n.setKeyContainer=function(t){var e=this,n=this.options;id(n.keyContainer,t,(function(){n.keyContainer=t,e.setKeyController()}))},n.setToggleContinueSelect=function(t){var e=this,n=this.options;id(n.toggleContinueSelect,t,(function(){n.toggleContinueSelect=t,e.setKeyEvent()}))},n.setPreventDefault=function(t){this.gesto.options.preventDefault=t},n.setCheckInput=function(t){this.gesto.options.checkInput=t},n.triggerDragStart=function(t){return this.gesto.triggerDragStart(t),this},n.destroy=function(){this.off(),this.keycon&&this.keycon.destroy(),this.gesto.unset(),this.injectResult.destroy(),zt(document,"selectstart",this._onDocumentSelectStart),this.keycon=null,this.gesto=null,this.injectResult=null,this.target=null,this.container=null,this.options=null},n.getElementPoints=function(t){var e=this.getElementRect||sd,n=e(t),r=[n.pos1,n.pos2,n.pos4,n.pos3];if(e!==sd){var i=t.getBoundingClientRect();return ui(r,i)}return r},n.getSelectableElements=function(){var t=[];return this.options.selectableTargets.forEach((function(e){if(tt(e))t.push(e);else{var n=[].slice.call(document.querySelectorAll(e));n.forEach((function(e){t.push(e)}))}})),t},n.checkScroll=function(){var t;if(this.gesto.isFlag()){var e=this.scrollOptions;(null===(t=e)||void 0===t?void 0:t.container)&&this.dragScroll.checkScroll(Jl({inputEvent:this.gesto.getCurrentEvent()},e))}},n.findSelectableTargets=function(t){var e=this;void 0===t&&(t=this.gesto.getEventDatas());var n=this.getSelectableElements(),r=n.map((function(t){return e.getElementPoints(t)}));t.selectableTargets=n,t.selectablePoints=r},n.clickTarget=function(t,e){var n=ed(t),r=n.clientX,i=n.clientY,o={datas:{selectFlag:!1},clientX:r,clientY:i,inputEvent:t,isClick:!0,stop:function(){return!1}};return this._onDragStart(o,e)&&this._onDragEnd(o),this},n.setKeyController=function(){var t=this.options,e=t.keyContainer,n=t.toggleContinueSelect;this.keycon&&(this.keycon.destroy(),this.keycon=null),n&&(this.keycon=new Kl(e||window),this.keycon.keydown(this._onKeyDown).keyup(this._onKeyUp).on("blur",this._onBlur))},n.setKeyEvent=function(){var t=this.options.toggleContinueSelect;t&&!this.keycon&&this.setKeyController()},n.initElement=function(){this.target=nd(rd("div",{className:ud}),this.target,this.container);var t=this.target,e=this.options,n=e.dragContainer,r=e.checkInput,i=e.preventDefault;this.dragContainer="string"===typeof n?[].slice.call(document.querySelectorAll(n)):n||this.target.parentNode,this.gesto=new ie(this.dragContainer,{checkWindowBlur:!0,container:window,checkInput:r,preventDefault:i}).on({dragStart:this._onDragStart,drag:this._onDrag,dragEnd:this._onDragEnd}),It(document,"selectstart",this._onDocumentSelectStart),this.injectResult=cd.inject(t,{nonce:this.options.cspNonce})},n.hitTest=function(t,e,n,r,i){var o=this.options,s=o.hitRate,a=o.selectByClick,c=t.left,u=t.top,l=t.right,d=t.bottom,h=[[c,u],[l,u],[l,d],[c,d]];return r.filter((function(t,r){var o=i[r],c=di([e,n],o);if(a&&c)return!0;var u=mi(h,o);if(!u.length)return!1;var l=ci(u),d=ci(o),f=ft(""+s);if("px"===f.unit)return l>=f.value;var p=Dt(Math.round(l/d*100),0,100);return p>=Math.min(100,f.value)}))},n.initDragScroll=function(){var t=this;this.dragScroll.on("scroll",(function(e){var n=e.container,r=e.direction;t.emit("scroll",{container:n,direction:r})})).on("move",(function(e){var n=e.offsetX,r=e.offsetY,i=e.inputEvent,o=t.gesto;if(o&&o.isFlag()){var s=t.gesto.getEventDatas(),a=s.boundArea;s.startX-=n,s.startY-=r,s.selectablePoints.forEach((function(t){t.forEach((function(t){t[0]-=n,t[1]-=r}))})),a.left-=n,a.right-=n,a.top-=r,a.bottom-=r,t.gesto.scrollBy(n,r,i.inputEvent,!1),t._checkSelected(t.gesto.getCurrentEvent())}}))},n._select=function(t,e,n,r,i){var o=oi(t,e),s=o.added,a=o.removed,c=o.prevList,u=o.list;this.selectedTargets=e,i&&this.emit("selectStart",{selected:e,added:s.map((function(t){return u[t]})),removed:a.map((function(t){return c[t]})),rect:n,inputEvent:r}),(s.length||a.length)&&this.emit("select",{selected:e,added:s.map((function(t){return u[t]})),removed:a.map((function(t){return c[t]})),rect:n,inputEvent:r})},n._selectEnd=function(t,e,n,r){var i=r.inputEvent,o=r.isDouble,s=oi(t,this.selectedTargets),a=s.added,c=s.removed,u=s.prevList,l=s.list,d=oi(e,this.selectedTargets),h=d.added,f=d.removed,p=d.prevList,g=d.list,m=i&&i.type,v="mousedown"===m||"touchstart"===m;this.emit("selectEnd",{selected:this.selectedTargets,added:a.map((function(t){return l[t]})),removed:c.map((function(t){return u[t]})),afterAdded:h.map((function(t){return g[t]})),afterRemoved:f.map((function(t){return p[t]})),isDragStart:v,isClick:!!r.isClick,isDouble:!!o,rect:n,inputEvent:i})},n._checkSelected=function(t,e){void 0===e&&(e=od(t,this.options.ratio));var n=t.datas,r=t.inputEvent,i=e.top,o=e.left,s=e.width,a=e.height,c=n.selectFlag,u=this.options,l=n.containerX,d=n.containerY,h=n.scaleMatrix,f=Jr(h,[o-l,i-d]),p=Jr(h,[s,a]),g=[],m=[];if(c){this.target.style.cssText+="display: block;left:0px;top:0px;transform: translate("+f[0]+"px, "+f[1]+"px);width:"+p[0]+"px;height:"+p[1]+"px;";var v=this.hitTest(e,n.startX,n.startY,n.selectableTargets,n.selectablePoints);g=this.selectedTargets,m=ad(n.startPassedTargets,v,u.continueSelect&&u.continueSelectWithoutDeselect),this.selectedTargets=m}var y=this.emit("drag",Jl(Jl({},t),{isSelect:c,rect:e}));if(!1===y)return this.target.style.cssText+="display: none;",void t.stop();c&&this._select(g,m,e,r)},n._sameCombiKey=function(t,e){var n=[].concat(this.options.toggleContinueSelect),r=Wl(t.inputEvent,t.key),i=et(n[0])?n:[n];if(e){var o=t.key;return i.some((function(t){return t.some((function(t){return t===o}))}))}return i.some((function(t){return t.every((function(t){return r.indexOf(t)>-1}))}))},n._findElement=function(t,e){var n=t;while(n){if(e.indexOf(n)>-1)break;n=n.parentElement}return n},e=Ql([ue(ld,(function(t,e){var n={enumerable:!0,configurable:!0,get:function(){return this.options[e]}},r=pt("set "+e);t[r]?n.set=function(t){this[r](t)}:n.set=function(t){this.options[e]=t},Object.defineProperty(t,e,n)}))],e),e}(Ht),gd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Xl(e,t),e}(pd),md=gd,vd=function(){return vd=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},vd.apply(this,arguments)},yd={};fd.forEach((function(t){yd[t]=function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];(e=this.$_selecto)[t].apply(e,n)}}));var bd={};ld.forEach((function(t){bd[t]=function(e){return this.$_selecto[t]=e}}));var wd={name:"selecto",methods:yd,props:dd,watch:bd,mounted:function(){var t=this,e=this.$props,n={};dd.forEach((function(t){var r=e[t];Q(r)||(n[t]=r)}));var r=new md(vd(vd({},n),{portalContainer:this.$refs.target}));this.$_selecto=r,hd.forEach((function(e){r.on(e,(function(n){t.$emit(e,vd({},n))}))}))},beforeUnmount:function(){this.$_selecto.destroy()}};const Ed={ref:"selectoElement"};function Sd(t,e,n,r,i,s){return(0,o.wg)(),(0,o.j4)("div",Ed,null,512)}wd.render=Sd,wd.__file="src/Selecto.vue";var Dd=n(691);function kd(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var xd=n(4870);const Cd=()=>{0};function _d(){return _d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_d.apply(this,arguments)}function Od(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Ad(t,e)}function Ad(t,e){return Ad=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ad(t,e)}function Md(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Td=0;function Rd(){return Td>0}function Nd(t){Td++;try{return t()}finally{Td--,0===Td&&Ud()}}var Pd=function(){function t(t){this.trigger=t,this.observing=new Map}var e=t.prototype;return e.registerConnection=function(t){var e=this.observing.get(t.observable);e||(e={byKey:new Set,iterate:!1},this.observing.set(t.observable,e)),"iterate"===t.type?e.iterate=!0:e.byKey.add(t.key)},e.removeObservers=function(){var t=this;this.observing.forEach((function(e,n){e.iterate&&n[Jd].connections.iterate.delete(t),e.byKey.forEach((function(e){n[Jd].connections.byKey.get(e).delete(t)}))})),this.observing.clear()},t}(),Bd=[],Fd=function(t){function e(e,n,r){var i;if(i=t.call(this,(function(){return i._trigger()}))||this,i.func=e,i.options=n,i.effect=r,i.isInitial=!0,i.reaction=function(){Bd.push(Md(i));try{i.func()}finally{Bd.pop()}!i.effect||i.isInitial&&!i.options.fireImmediately||i.effect(),i.isInitial=!1},!r&&!i.options.fireImmediately)throw new Error("if no effect function passed, should always fireImmediately");return i.reaction(),i}Od(e,t);var n=e.prototype;return n._trigger=function(){if(Bd.includes(this))throw new Error("already running reaction");this.removeObservers(),this.reaction()},e}(Pd);function Id(){return!!Bd.length}function zd(){return Bd.length?Bd[Bd.length-1]:void 0}function jd(t,e,n){var r=_d({name:"unnamed",fireImmediately:!0},n),i=new Fd(t,r,e);return i}var Ld=!1;function $d(){return Ld}function Hd(t){Ld=!0;try{t()}finally{Ld=!1}}function Vd(t){return function(){return Hd(t)}}var Wd=[];function Ud(){var t=[].concat(Wd);Wd=[],qd(t)}function qd(t){var e=new Set;t.forEach((function(t){var n;"add"!==t.type&&"delete"!==t.type||t.observable[Jd].connections.iterate.forEach((function(t){e.add(t)})),null==(n=t.observable[Jd].connections.byKey.get(t.key))||n.forEach((function(t){e.add(t)}))})),e.forEach((function(t){t.trigger()}))}function Gd(t){Rd()?Wd.push(t):qd([t])}function Kd(t,e){if("iterate"===t.type)t.observable[Jd].connections.iterate.add(e);else{var n=t.observable[Jd].connections.byKey.get(t.key);n||(n=new Set,t.observable[Jd].connections.byKey.set(t.key,n)),n.add(e)}}function Yd(t,e){if(!$d()){var n=zd();n&&(Kd(t,n),n.registerConnection(t)),e&&(Kd(t,e),e.registerConnection(t))}}var Xd=Symbol("$skipreactive"),Jd=Symbol("$reactive"),Zd=Symbol("$reactiveproxy");function Qd(t,e){return!(!t||!t[Zd]||t[Zd].implicitObserver!==e)}function th(t){return t[Xd]=!0,t}function eh(t){return!(!t||Qd(t)||!t[Jd])}function nh(t,e,n){if(void 0===n&&(n=!1),t[Xd])return t;if(Qd(t,e))return t;var r=ih(t,n);if(!e)return r;var i=r[Jd].proxiesWithImplicitObserver.get(e);if(!i){var o={implicitObserver:e};Object.setPrototypeOf(o,oh),i=new Proxy(r[Jd].raw,o),r[Jd].proxiesWithImplicitObserver.set(e,i)}return i}var rh=nh;function ih(t,e){if(void 0===e&&(e=!1),Qd(t))return t;if(eh(t))return t[Jd].proxy;if(t[Jd]||t[Zd])throw new Error("unexpected");var n={connections:{iterate:new Set,byKey:new Map},proxy:{},raw:t,proxiesWithImplicitObserver:new Map,shallow:e};Object.defineProperty(t,Jd,{enumerable:!1,writable:!0,configurable:!0,value:n});var r=new Proxy(t,oh);return n.proxy=r,r}var oh={has:function(t,e){var n=Reflect.has(t,e);return"symbol"===typeof e||Yd({observable:t,key:e,type:"has"},this.implicitObserver),n},get:function(t,e,n){if(e===Zd)return{implicitObserver:this.implicitObserver};var r=Reflect.get(t,e,n);if("symbol"===typeof e)return r;if("length"===e&&Array.isArray(t)?Yd({observable:t,type:"iterate"},this.implicitObserver):Yd({observable:t,key:e,type:"get"},this.implicitObserver),eh(r))return nh(r,this.implicitObserver);if(t[Jd].shallow)return r;if("object"===typeof r&&null!==r&&!Qd(r,this.implicitObserver)&&!Object.isFrozen(r)){var i=Reflect.getOwnPropertyDescriptor(t,e);if((!i||!1!==i.writable||!1!==i.configurable)&&(Id()||this.implicitObserver))return nh(r,this.implicitObserver)}return r},ownKeys:function(t){return Yd({observable:t,type:"iterate"},this.implicitObserver),Reflect.ownKeys(t)},set:function(t,e,n,r){return Nd((function(){if("symbol"===typeof e)return Reflect.set(t,e,n,r);var i=Object.hasOwnProperty.call(t,e),o=Reflect.get(t,e,r),s=Reflect.set(t,e,n,r);if(i){if(n!==o)if("length"===e&&Array.isArray(t))if(o<n);else for(var a=n+1;a<=o;a++)Gd({observable:t,key:""+(a-1),oldValue:void 0,type:"delete"});else Gd({observable:t,key:e,value:n,oldValue:o,type:"update"})}else Gd({observable:t,key:e,value:n,type:"add"});return s}))},deleteProperty:function(t,e){return Nd((function(){if("symbol"===typeof e)return Reflect.deleteProperty(t,e);var n=Object.hasOwnProperty.call(t,e),r=Reflect.get(t,e),i=Reflect.deleteProperty(t,e);return n&&Gd({observable:t,key:e,oldValue:r,type:"delete"}),i}))},preventExtensions:function(t){throw new Error("Dynamic observable objects cannot be frozen")}};function sh(t,e){var n=_d({name:"unnamed",fireImmediately:!0},e),r=new Fd(t,n);return r}function ah(t,e,n){var r=_d({name:"unnamed",fireImmediately:!0},n),i=new Fd((function(){t(e)}),r);return e=rh(e,i),e.bla=4,r.fireImmediately&&i.trigger(),i}var ch=function(){function t(){this._observable=rh({_key:1})}var e=t.prototype;return e.reportObserved=function(t){return rh(this._observable,t)._key},e.reportChanged=function(){this._observable._key++},t}();function uh(t,e,n){return new ch}n(8675),n(3462);const lh=()=>new Map,dh=t=>{const e=lh();return t.forEach(((t,n)=>{e.set(n,t)})),e},hh=(t,e,n)=>{let r=t.get(e);return void 0===r&&t.set(e,r=n()),r},fh=(t,e)=>{const n=[];for(const[r,i]of t)n.push(e(i,r));return n},ph=(t,e)=>{for(const[n,r]of t)if(e(r,n))return!0;return!1},gh=()=>new Set,mh=t=>t[t.length-1],vh=(t,e)=>{for(let n=0;n<e.length;n++)t.push(e[n])},yh=Array.from;Array.isArray;class bh{constructor(){this._observers=lh()}on(t,e){hh(this._observers,t,gh).add(e)}once(t,e){const n=(...r)=>{this.off(t,n),e(...r)};this.on(t,n)}off(t,e){const n=this._observers.get(t);void 0!==n&&(n.delete(e),0===n.size&&this._observers.delete(t))}emit(t,e){return yh((this._observers.get(t)||lh()).values()).forEach((t=>t(...e)))}destroy(){this._observers=lh()}}const wh=Math.floor,Eh=(Math.ceil,Math.abs),Sh=(Math.imul,Math.round,Math.log10),Dh=(Math.log2,Math.log,Math.sqrt,(t,e)=>t<e?t:e),kh=(t,e)=>t>e?t:e,xh=(Number.isNaN,Math.pow,Math.sign,t=>0!==t?t<0:1/t<0);n(2801);const Ch=String.fromCharCode,_h=(String.fromCodePoint,t=>t.toLowerCase()),Oh=/^\s*/g,Ah=t=>t.replace(Oh,""),Mh=/([A-Z])/g,Th=(t,e)=>Ah(t.replace(Mh,(t=>`${e}${_h(t)}`))),Rh=t=>{const e=unescape(encodeURIComponent(t)),n=e.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=e.codePointAt(i);return r},Nh="undefined"!==typeof TextEncoder?new TextEncoder:null,Ph=t=>Nh.encode(t),Bh=Nh?Ph:Rh;let Fh="undefined"===typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Fh&&1===Fh.decode(new Uint8Array).length&&(Fh=null);const Ih=t=>void 0===t?null:t;class zh{constructor(){this.map=new Map}setItem(t,e){this.map.set(t,e)}getItem(t){return this.map.get(t)}}let jh=new zh,Lh=!0;try{"undefined"!==typeof localStorage&&(jh=localStorage,Lh=!1)}catch(Xw){}const $h=jh,Hh=t=>Lh||addEventListener("storage",t),Vh="undefined"!==typeof process&&process.release&&/node|io\.js/.test(process.release.name),Wh="undefined"!==typeof window&&!Vh;"undefined"!==typeof navigator&&/Mac/.test(navigator.platform);let Uh;const qh=[],Gh=()=>{if(void 0===Uh)if(Vh){Uh=lh();const t=process.argv;let e=null;for(let n=0;n<t.length;n++){const r=t[n];"-"===r[0]?(null!==e&&Uh.set(e,""),e=r):null!==e?(Uh.set(e,r),e=null):qh.push(r)}null!==e&&Uh.set(e,"")}else"object"===typeof location?(Uh=lh(),(location.search||"?").slice(1).split("&").forEach((t=>{if(0!==t.length){const[e,n]=t.split("=");Uh.set(`--${Th(e,"-")}`,n),Uh.set(`-${Th(e,"-")}`,n)}}))):Uh=lh();return Uh},Kh=t=>Gh().has(t),Yh=t=>Ih(Vh?{NODE_ENV:"production",BASE_URL:"/"}[t.toUpperCase()]:$h.getItem(t)),Xh=t=>Kh("--"+t)||null!==Yh(t),Jh=(Xh("production"),t=>new Uint8Array(t)),Zh=(t,e,n)=>new Uint8Array(t,e,n),Qh=t=>new Uint8Array(t),tf=t=>{let e="";for(let n=0;n<t.byteLength;n++)e+=Ch(t[n]);return btoa(e)},ef=t=>Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("base64"),nf=t=>{const e=atob(t),n=Jh(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n},rf=t=>{const e=Buffer.from(t,"base64");return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)},of=Wh?tf:ef,sf=Wh?nf:rf,af=t=>{const e=Jh(t.byteLength);return e.set(t),e},cf=1,uf=2,lf=4,df=8,hf=32,ff=64,pf=128,gf=31,mf=63,vf=127,yf=2147483647,bf=(Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.isInteger||(t=>"number"===typeof t&&isFinite(t)&&wh(t)===t));Number.isNaN,Number.parseInt;class wf{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const Ef=()=>new wf,Sf=t=>{let e=t.cpos;for(let n=0;n<t.bufs.length;n++)e+=t.bufs[n].length;return e},Df=t=>{const e=new Uint8Array(Sf(t));let n=0;for(let r=0;r<t.bufs.length;r++){const i=t.bufs[r];e.set(i,n),n+=i.length}return e.set(Zh(t.cbuf.buffer,0,t.cpos),n),e},kf=(t,e)=>{const n=t.cbuf.length;n-t.cpos<e&&(t.bufs.push(Zh(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(2*kh(n,e)),t.cpos=0)},xf=(t,e)=>{const n=t.cbuf.length;t.cpos===n&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(2*n),t.cpos=0),t.cbuf[t.cpos++]=e},Cf=xf,_f=(t,e)=>{while(e>vf)xf(t,pf|vf&e),e>>>=7;xf(t,vf&e)},Of=(t,e)=>{const n=xh(e);n&&(e=-e),xf(t,(e>mf?pf:0)|(n?ff:0)|mf&e),e>>>=6;while(e>0)xf(t,(e>vf?pf:0)|vf&e),e>>>=7},Af=(t,e)=>{const n=unescape(encodeURIComponent(e)),r=n.length;_f(t,r);for(let i=0;i<r;i++)xf(t,n.codePointAt(i))},Mf=(t,e)=>{const n=t.cbuf.length,r=t.cpos,i=Dh(n-r,e.length),o=e.length-i;t.cbuf.set(e.subarray(0,i),r),t.cpos+=i,o>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(kh(2*n,o)),t.cbuf.set(e.subarray(i)),t.cpos=o)},Tf=(t,e)=>{_f(t,e.byteLength),Mf(t,e)},Rf=(t,e)=>{kf(t,e);const n=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,n},Nf=(t,e)=>Rf(t,4).setFloat32(0,e,!1),Pf=(t,e)=>Rf(t,8).setFloat64(0,e,!1),Bf=(t,e)=>Rf(t,8).setBigInt64(0,e,!1),Ff=new DataView(new ArrayBuffer(4)),If=t=>(Ff.setFloat32(0,t),Ff.getFloat32(0)===t),zf=(t,e)=>{switch(typeof e){case"string":xf(t,119),Af(t,e);break;case"number":bf(e)&&Eh(e)<=yf?(xf(t,125),Of(t,e)):If(e)?(xf(t,124),Nf(t,e)):(xf(t,123),Pf(t,e));break;case"bigint":xf(t,122),Bf(t,e);break;case"object":if(null===e)xf(t,126);else if(e instanceof Array){xf(t,117),_f(t,e.length);for(let n=0;n<e.length;n++)zf(t,e[n])}else if(e instanceof Uint8Array)xf(t,116),Tf(t,e);else{xf(t,118);const n=Object.keys(e);_f(t,n.length);for(let r=0;r<n.length;r++){const i=n[r];Af(t,i),zf(t,e[i])}}break;case"boolean":xf(t,e?120:121);break;default:xf(t,127)}};class jf extends wf{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&_f(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}const Lf=t=>{t.count>0&&(Of(t.encoder,1===t.count?t.s:-t.s),t.count>1&&_f(t.encoder,t.count-2))};class $f{constructor(){this.encoder=new wf,this.s=0,this.count=0}write(t){this.s===t?this.count++:(Lf(this),this.count=1,this.s=t)}toUint8Array(){return Lf(this),Df(this.encoder)}}const Hf=t=>{if(t.count>0){const e=t.diff<<1|(1===t.count?0:1);Of(t.encoder,e),t.count>1&&_f(t.encoder,t.count-2)}};class Vf{constructor(){this.encoder=new wf,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(Hf(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return Hf(this),Df(this.encoder)}}class Wf{constructor(){this.sarr=[],this.s="",this.lensE=new $f}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){const t=new wf;return this.sarr.push(this.s),this.s="",Af(t,this.sarr.join("")),Mf(t,this.lensE.toUint8Array()),Df(t)}}class Uf{constructor(t){this.arr=t,this.pos=0}}const qf=t=>new Uf(t),Gf=t=>t.pos!==t.arr.length,Kf=(t,e)=>{const n=Zh(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,n},Yf=t=>Kf(t,Jf(t)),Xf=t=>t.arr[t.pos++],Jf=t=>{let e=0,n=0;while(1){const r=t.arr[t.pos++];if(e|=(r&vf)<<n,n+=7,r<pf)return e>>>0;if(n>53)throw new Error("Integer out of range!")}},Zf=t=>{let e=t.arr[t.pos++],n=e&mf,r=6;const i=(e&ff)>0?-1:1;if(0===(e&pf))return i*n;while(1){if(e=t.arr[t.pos++],n|=(e&vf)<<r,r+=7,e<pf)return i*(n>>>0);if(r>53)throw new Error("Integer out of range!")}},Qf=t=>{let e=Jf(t);if(0===e)return"";{let n=String.fromCodePoint(Xf(t));if(--e<100)while(e--)n+=String.fromCodePoint(Xf(t));else while(e>0){const r=e<1e4?e:1e4,i=t.arr.subarray(t.pos,t.pos+r);t.pos+=r,n+=String.fromCodePoint.apply(null,i),e-=r}return decodeURIComponent(escape(n))}},tp=(t,e)=>{const n=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,n},ep=t=>tp(t,4).getFloat32(0,!1),np=t=>tp(t,8).getFloat64(0,!1),rp=t=>tp(t,8).getBigInt64(0,!1),ip=[t=>{},t=>null,Zf,ep,np,rp,t=>!1,t=>!0,Qf,t=>{const e=Jf(t),n={};for(let r=0;r<e;r++){const e=Qf(t);n[e]=op(t)}return n},t=>{const e=Jf(t),n=[];for(let r=0;r<e;r++)n.push(op(t));return n},Yf],op=t=>ip[127-Xf(t)](t);class sp extends Uf{constructor(t,e){super(t),this.reader=e,this.s=null,this.count=0}read(){return 0===this.count&&(this.s=this.reader(this),Gf(this)?this.count=Jf(this)+1:this.count=-1),this.count--,this.s}}class ap extends Uf{constructor(t){super(t),this.s=0,this.count=0}read(){if(0===this.count){this.s=Zf(this);const t=xh(this.s);this.count=1,t&&(this.s=-this.s,this.count=Jf(this)+2)}return this.count--,this.s}}class cp extends Uf{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(0===this.count){const t=Zf(this),e=1&t;this.diff=t>>1,this.count=1,e&&(this.count=Jf(this)+2)}return this.s+=this.diff,this.count--,this.s}}class up{constructor(t){this.decoder=new ap(t),this.str=Qf(this.decoder),this.spos=0}read(){const t=this.spos+this.decoder.read(),e=this.str.slice(this.spos,t);return this.spos=t,e}}"undefined"===typeof window||"undefined"!==typeof window.performance&&window.performance;const lp="undefined"===typeof crypto?null:crypto,dp=null!==lp?t=>{const e=new ArrayBuffer(t),n=new Uint8Array(e);return lp.getRandomValues(n),e}:t=>{const e=new ArrayBuffer(t),n=new Uint8Array(e);for(let r=0;r<t;r++)n[r]=Math.ceil(4294967295*Math.random()>>>0);return e},hp=Math.random,fp=()=>new Uint32Array(dp(4))[0],pp=[1e7]+-1e3+-4e3+-8e3+-1e11,gp=()=>pp.replace(/[018]/g,(t=>(t^fp()&15>>t/4).toString(16))),mp=t=>new Promise(t),vp=t=>Promise.reject(t),yp=t=>Promise.resolve(t),bp=t=>new Error(t),wp=()=>{throw bp("Method unimplemented")},Ep=()=>{throw bp("Unexpected case")},Sp=(Object.assign,Object.keys),Dp=t=>Sp(t).length,kp=(t,e)=>{for(const n in t)if(!e(t[n],n))return!1;return!0},xp=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),Cp=(t,e)=>t===e||Dp(t)===Dp(e)&&kp(t,((t,n)=>(void 0!==t||xp(e,n))&&e[n]===t)),_p=(t,e,n=0)=>{try{for(;n<t.length;n++)t[n](...e)}finally{n<t.length&&_p(t,e,n+1)}},Op=()=>{},Ap=(t,e)=>t===e,Mp=(t,e)=>{if(null==t||null==e)return Ap(t,e);if(t.constructor!==e.constructor)return!1;if(t===e)return!0;switch(t.constructor){case ArrayBuffer:t=new Uint8Array(t),e=new Uint8Array(e);case Uint8Array:if(t.byteLength!==e.byteLength)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;break;case Set:if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;break;case Map:if(t.size!==e.size)return!1;for(const n of t.keys())if(!e.has(n)||!Mp(t.get(n),e.get(n)))return!1;break;case Object:if(Dp(t)!==Dp(e))return!1;for(const n in t)if(!xp(t,n)||!Mp(t[n],e[n]))return!1;break;case Array:if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Mp(t[n],e[n]))return!1;break;default:return!1}return!0},Tp=Symbol;class Rp{constructor(t,e){this.left=t,this.right=e}}const Np=(t,e)=>new Rp(t,e),Pp="undefined"!==typeof document?document:{},Bp=("undefined"!==typeof DOMParser&&new DOMParser,t=>fh(t,((t,e)=>`${e}:${t};`)).join("")),Fp=(Pp.ELEMENT_NODE,Pp.TEXT_NODE,Pp.CDATA_SECTION_NODE,Pp.COMMENT_NODE,Pp.DOCUMENT_NODE,Pp.DOCUMENT_TYPE_NODE,Pp.DOCUMENT_FRAGMENT_NODE,Date.now),Ip=Tp(),zp=Tp(),jp=Tp(),Lp=Tp(),$p=Tp(),Hp=Tp(),Vp=Tp(),Wp=Tp(),Up=Tp(),qp={[Ip]:Np("font-weight","bold"),[zp]:Np("font-weight","normal"),[jp]:Np("color","blue"),[$p]:Np("color","green"),[Lp]:Np("color","grey"),[Hp]:Np("color","red"),[Vp]:Np("color","purple"),[Wp]:Np("color","orange"),[Up]:Np("color","black")},Gp={[Ip]:"[1m",[zp]:"[2m",[jp]:"[34m",[$p]:"[32m",[Lp]:"[37m",[Hp]:"[31m",[Vp]:"[35m",[Wp]:"[38;5;208m",[Up]:"[0m"},Kp=t=>{const e=[],n=[],r=lh();let i=[],o=0;for(;o<t.length;o++){const i=t[o],s=qp[i];if(void 0!==s)r.set(s.left,s.right);else{if(i.constructor!==String&&i.constructor!==Number)break;{const t=Bp(r);o>0||t.length>0?(e.push("%c"+i),n.push(t)):e.push(i)}}}for(o>0&&(i=n,i.unshift(e.join("")));o<t.length;o++){const e=t[o];e instanceof Symbol||i.push(e)}return i},Yp=t=>{const e=[],n=[];let r=0;for(;r<t.length;r++){const n=t[r],i=Gp[n];if(void 0!==i)e.push(i);else{if(n.constructor!==String&&n.constructor!==Number)break;e.push(n)}}for(r>0&&(e.push("[0m"),n.push(e.join("")));r<t.length;r++){const e=t[r];e instanceof Symbol||n.push(e)}return n},Xp=Vh?Yp:Kp,Jp=(...t)=>{console.log(...Xp(t)),Zp.forEach((e=>e.print(t)))},Zp=new Set;const Qp=[$p,Vp,Wp,jp];let tg=0,eg=Fp();const ng=t=>{const e=Qp[tg],n=Yh("log"),r=null!==n&&("*"===n||"true"===n||new RegExp(n,"gi").test(t));return tg=(tg+1)%Qp.length,t+=": ",r?(...n)=>{const r=Fp(),i=r-eg;eg=r,Jp(e,t,Up,...n.map((t=>"string"===typeof t||"symbol"===typeof t?t:JSON.stringify(t))),e," +"+i+"ms")}:Op},rg=t=>({[Symbol.iterator](){return this},next:t}),ig=(t,e)=>rg((()=>{let n;do{n=t.next()}while(!n.done&&!e(n.value));return n})),og=(t,e)=>rg((()=>{const{done:n,value:r}=t.next();return{done:n,value:n?void 0:e(r)}}));class sg{constructor(t,e){this.clock=t,this.len=e}}class ag{constructor(){this.clients=new Map}}const cg=(t,e,n)=>e.clients.forEach(((e,r)=>{const i=t.doc.store.clients.get(r);for(let o=0;o<e.length;o++){const r=e[o];mm(t,i,r.clock,r.len,n)}})),ug=(t,e)=>{let n=0,r=t.length-1;while(n<=r){const i=wh((n+r)/2),o=t[i],s=o.clock;if(s<=e){if(e<s+o.len)return i;n=i+1}else r=i-1}return null},lg=(t,e)=>{const n=t.clients.get(e.client);return void 0!==n&&null!==ug(n,e.clock)},dg=t=>{t.clients.forEach((t=>{let e,n;for(t.sort(((t,e)=>t.clock-e.clock)),e=1,n=1;e<t.length;e++){const r=t[n-1],i=t[e];r.clock+r.len>=i.clock?r.len=kh(r.len,i.clock+i.len-r.clock):(n<e&&(t[n]=i),n++)}t.length=n}))},hg=t=>{const e=new ag;for(let n=0;n<t.length;n++)t[n].clients.forEach(((r,i)=>{if(!e.clients.has(i)){const o=r.slice();for(let e=n+1;e<t.length;e++)vh(o,t[e].clients.get(i)||[]);e.clients.set(i,o)}}));return dg(e),e},fg=(t,e,n,r)=>{hh(t.clients,e,(()=>[])).push(new sg(n,r))},pg=()=>new ag,gg=t=>{const e=pg();return t.clients.forEach(((t,n)=>{const r=[];for(let e=0;e<t.length;e++){const n=t[e];if(n.deleted){const i=n.id.clock;let o=n.length;if(e+1<t.length)for(let n=t[e+1];e+1<t.length&&n.deleted;n=t[1+ ++e])o+=n.length;r.push(new sg(i,o))}}r.length>0&&e.clients.set(n,r)})),e},mg=(t,e)=>{_f(t.restEncoder,e.clients.size),e.clients.forEach(((e,n)=>{t.resetDsCurVal(),_f(t.restEncoder,n);const r=e.length;_f(t.restEncoder,r);for(let i=0;i<r;i++){const n=e[i];t.writeDsClock(n.clock),t.writeDsLen(n.len)}}))},vg=t=>{const e=new ag,n=Jf(t.restDecoder);for(let r=0;r<n;r++){t.resetDsCurVal();const n=Jf(t.restDecoder),r=Jf(t.restDecoder);if(r>0){const i=hh(e.clients,n,(()=>[]));for(let e=0;e<r;e++)i.push(new sg(t.readDsClock(),t.readDsLen()))}}return e},yg=(t,e,n)=>{const r=new ag,i=Jf(t.restDecoder);for(let o=0;o<i;o++){t.resetDsCurVal();const i=Jf(t.restDecoder),o=Jf(t.restDecoder),s=n.clients.get(i)||[],a=am(n,i);for(let n=0;n<o;n++){const n=t.readDsClock(),o=n+t.readDsLen();if(n<a){a<o&&fg(r,i,a,o-a);let t=um(s,n),c=s[t];!c.deleted&&c.id.clock<n&&(s.splice(t+1,0,Ey(e,c,n-c.id.clock)),t++);while(t<s.length){if(c=s[t++],!(c.id.clock<o))break;c.deleted||(o<c.id.clock+c.length&&s.splice(t,0,Ey(e,c,o-c.id.clock)),c.delete(e))}}else fg(r,i,n,o-n)}}if(r.clients.size>0){const t=new Og;return _f(t.restEncoder,0),mg(t,r),t.toUint8Array()}return null},bg=fp;class wg extends bh{constructor({guid:t=gp(),collectionid:e=null,gc:n=!0,gcFilter:r=(()=>!0),meta:i=null,autoLoad:o=!1,shouldLoad:s=!0}={}){super(),this.gc=n,this.gcFilter=r,this.clientID=bg(),this.guid=t,this.collectionid=e,this.share=new Map,this.store=new om,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=s,this.autoLoad=o,this.meta=i,this.isLoaded=!1,this.whenLoaded=mp((t=>{this.on("load",(()=>{this.isLoaded=!0,t(this)}))}))}load(){const t=this._item;null===t||this.shouldLoad||km(t.parent.doc,(t=>{t.subdocsLoaded.add(this)}),null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Array.from(this.subdocs).map((t=>t.guid)))}transact(t,e=null){km(this,t,e)}get(t,e=Km){const n=hh(this.share,t,(()=>{const t=new e;return t._integrate(this,null),t})),r=n.constructor;if(e!==Km&&r!==e){if(r===Km){const r=new e;r._map=n._map,n._map.forEach((t=>{for(;null!==t;t=t.left)t.parent=r})),r._start=n._start;for(let t=r._start;null!==t;t=t.right)t.parent=r;return r._length=n._length,this.share.set(t,r),r._integrate(this,null),r}throw new Error(`Type with the name ${t} has already been defined with a different constructor`)}return n}getArray(t=""){return this.get(t,fv)}getText(t=""){return this.get(t,Nv)}getMap(t=""){return this.get(t,mv)}getXmlFragment(t=""){return this.get(t,Fv)}toJSON(){const t={};return this.share.forEach(((e,n)=>{t[n]=e.toJSON()})),t}destroy(){yh(this.subdocs).forEach((t=>t.destroy()));const t=this._item;if(null!==t){this._item=null;const e=t.content;e.doc=new wg({guid:this.guid,...e.opts,shouldLoad:!1}),e.doc._item=t,km(t.parent.doc,(n=>{const r=e.doc;t.deleted||n.subdocsAdded.add(r),n.subdocsRemoved.add(this)}),null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(t,e){super.on(t,e)}off(t,e){super.off(t,e)}}class Eg{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return Jf(this.restDecoder)}readDsLen(){return Jf(this.restDecoder)}}class Sg extends Eg{readLeftID(){return Qg(Jf(this.restDecoder),Jf(this.restDecoder))}readRightID(){return Qg(Jf(this.restDecoder),Jf(this.restDecoder))}readClient(){return Jf(this.restDecoder)}readInfo(){return Xf(this.restDecoder)}readString(){return Qf(this.restDecoder)}readParentInfo(){return 1===Jf(this.restDecoder)}readTypeRef(){return Jf(this.restDecoder)}readLen(){return Jf(this.restDecoder)}readAny(){return op(this.restDecoder)}readBuf(){return af(Yf(this.restDecoder))}readJSON(){return JSON.parse(Qf(this.restDecoder))}readKey(){return Qf(this.restDecoder)}}class Dg{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Jf(this.restDecoder),this.dsCurrVal}readDsLen(){const t=Jf(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class kg extends Dg{constructor(t){super(t),this.keys=[],Jf(t),this.keyClockDecoder=new cp(Yf(t)),this.clientDecoder=new ap(Yf(t)),this.leftClockDecoder=new cp(Yf(t)),this.rightClockDecoder=new cp(Yf(t)),this.infoDecoder=new sp(Yf(t),Xf),this.stringDecoder=new up(Yf(t)),this.parentInfoDecoder=new sp(Yf(t),Xf),this.typeRefDecoder=new ap(Yf(t)),this.lenDecoder=new ap(Yf(t))}readLeftID(){return new Jg(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new Jg(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return 1===this.parentInfoDecoder.read()}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return op(this.restDecoder)}readBuf(){return Yf(this.restDecoder)}readJSON(){return op(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const t=this.stringDecoder.read();return this.keys.push(t),t}}}class xg{constructor(){this.restEncoder=Ef()}toUint8Array(){return Df(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){_f(this.restEncoder,t)}writeDsLen(t){_f(this.restEncoder,t)}}class Cg extends xg{writeLeftID(t){_f(this.restEncoder,t.client),_f(this.restEncoder,t.clock)}writeRightID(t){_f(this.restEncoder,t.client),_f(this.restEncoder,t.clock)}writeClient(t){_f(this.restEncoder,t)}writeInfo(t){Cf(this.restEncoder,t)}writeString(t){Af(this.restEncoder,t)}writeParentInfo(t){_f(this.restEncoder,t?1:0)}writeTypeRef(t){_f(this.restEncoder,t)}writeLen(t){_f(this.restEncoder,t)}writeAny(t){zf(this.restEncoder,t)}writeBuf(t){Tf(this.restEncoder,t)}writeJSON(t){Af(this.restEncoder,JSON.stringify(t))}writeKey(t){Af(this.restEncoder,t)}}class _g{constructor(){this.restEncoder=Ef(),this.dsCurrVal=0}toUint8Array(){return Df(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const e=t-this.dsCurrVal;this.dsCurrVal=t,_f(this.restEncoder,e)}writeDsLen(t){0===t&&Ep(),_f(this.restEncoder,t-1),this.dsCurrVal+=t}}class Og extends _g{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Vf,this.clientEncoder=new $f,this.leftClockEncoder=new Vf,this.rightClockEncoder=new Vf,this.infoEncoder=new jf(Cf),this.stringEncoder=new Wf,this.parentInfoEncoder=new jf(Cf),this.typeRefEncoder=new $f,this.lenEncoder=new $f}toUint8Array(){const t=Ef();return _f(t,0),Tf(t,this.keyClockEncoder.toUint8Array()),Tf(t,this.clientEncoder.toUint8Array()),Tf(t,this.leftClockEncoder.toUint8Array()),Tf(t,this.rightClockEncoder.toUint8Array()),Tf(t,Df(this.infoEncoder)),Tf(t,this.stringEncoder.toUint8Array()),Tf(t,Df(this.parentInfoEncoder)),Tf(t,this.typeRefEncoder.toUint8Array()),Tf(t,this.lenEncoder.toUint8Array()),Mf(t,Df(this.restEncoder)),Df(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){zf(this.restEncoder,t)}writeBuf(t){Tf(this.restEncoder,t)}writeJSON(t){zf(this.restEncoder,t)}writeKey(t){const e=this.keyMap.get(t);void 0===e?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(e)}}const Ag=(t,e,n,r)=>{r=kh(r,e[0].id.clock);const i=um(e,r);_f(t.restEncoder,e.length-i),t.writeClient(n),_f(t.restEncoder,r);const o=e[i];o.write(t,r-o.id.clock);for(let s=i+1;s<e.length;s++)e[s].write(t,0)},Mg=(t,e,n)=>{const r=new Map;n.forEach(((t,n)=>{am(e,n)>t&&r.set(n,t)})),sm(e).forEach(((t,e)=>{n.has(e)||r.set(e,0)})),_f(t.restEncoder,r.size),Array.from(r.entries()).sort(((t,e)=>e[0]-t[0])).forEach((([n,r])=>{Ag(t,e.clients.get(n),n,r)}))},Tg=(t,e)=>{const n=lh(),r=Jf(t.restDecoder);for(let i=0;i<r;i++){const r=Jf(t.restDecoder),i=new Array(r),o=t.readClient();let s=Jf(t.restDecoder);n.set(o,{i:0,refs:i});for(let n=0;n<r;n++){const r=t.readInfo();switch(gf&r){case 0:{const e=t.readLen();i[n]=new Gv(Qg(o,s),e),s+=e;break}case 10:{const e=Jf(t.restDecoder);i[n]=new Cy(Qg(o,s),e),s+=e;break}default:{const a=0===(r&(ff|pf)),c=new Sy(Qg(o,s),null,(r&pf)===pf?t.readLeftID():null,null,(r&ff)===ff?t.readRightID():null,a?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,a&&(r&hf)===hf?t.readString():null,Dy(t,r));i[n]=c,s+=c.length}}}}return n},Rg=(t,e,n)=>{const r=[];let i=Array.from(n.keys()).sort(((t,e)=>t-e));if(0===i.length)return null;const o=()=>{if(0===i.length)return null;let t=n.get(i[i.length-1]);while(t.refs.length===t.i){if(i.pop(),!(i.length>0))return null;t=n.get(i[i.length-1])}return t};let s=o();if(null===s&&0===r.length)return null;const a=new om,c=new Map,u=(t,e)=>{const n=c.get(t);(null==n||n>e)&&c.set(t,e)};let l=s.refs[s.i++];const d=new Map,h=()=>{for(const t of r){const e=t.id.client,r=n.get(e);r?(r.i--,a.clients.set(e,r.refs.slice(r.i)),n.delete(e),r.i=0,r.refs=[]):a.clients.set(e,[t]),i=i.filter((t=>t!==e))}r.length=0};while(1){if(l.constructor!==Cy){const i=hh(d,l.id.client,(()=>am(e,l.id.client))),o=i-l.id.clock;if(o<0)r.push(l),u(l.id.client,l.id.clock-1),h();else{const i=l.getMissing(t,e);if(null!==i){r.push(l);const t=n.get(i)||{refs:[],i:0};if(t.refs.length!==t.i){l=t.refs[t.i++];continue}u(i,am(e,i)),h()}else(0===o||o<l.length)&&(l.integrate(t,o),d.set(l.id.client,l.id.clock+l.length))}}if(r.length>0)l=r.pop();else if(null!==s&&s.i<s.refs.length)l=s.refs[s.i++];else{if(s=o(),null===s)break;l=s.refs[s.i++]}}if(a.clients.size>0){const t=new Og;return Mg(t,a,new Map),_f(t.restEncoder,0),{missing:c,update:t.toUint8Array()}}return null},Ng=(t,e)=>Mg(t,e.doc.store,e.beforeState),Pg=(t,e,n,r=new kg(t))=>km(e,(t=>{t.local=!1;let e=!1;const n=t.doc,i=n.store,o=Tg(r,n),s=Rg(t,i,o),a=i.pendingStructs;if(a){for(const[t,n]of a.missing)if(n<am(i,t)){e=!0;break}if(s){for(const[t,e]of s.missing){const n=a.missing.get(t);(null==n||n>e)&&a.missing.set(t,e)}a.update=Mm([a.update,s.update])}}else i.pendingStructs=s;const c=yg(r,t,i);if(i.pendingDs){const e=new kg(qf(i.pendingDs));Jf(e.restDecoder);const n=yg(e,t,i);i.pendingDs=c&&n?Mm([c,n]):c||n}else i.pendingDs=c;if(e){const e=i.pendingStructs.update;i.pendingStructs=null,Bg(t.doc,e)}}),n,!1),Bg=(t,e,n,r=kg)=>{const i=qf(e);Pg(i,t,n,new r(i))},Fg=(t,e,n)=>Bg(t,e,n,Sg),Ig=(t,e,n=new Map)=>{Mg(t,e.store,n),mg(t,gg(e.store))},zg=(t,e=new Uint8Array([0]),n=new Og)=>{const r=$g(e);Ig(n,t,r);const i=[n.toUint8Array()];if(t.store.pendingDs&&i.push(t.store.pendingDs),t.store.pendingStructs&&i.push(Tm(t.store.pendingStructs.update,e)),i.length>1){if(n.constructor===Cg)return Om(i.map(((t,e)=>0===e?t:Fm(t))));if(n.constructor===Og)return Mm(i)}return i[0]},jg=(t,e)=>zg(t,e,new Cg),Lg=t=>{const e=new Map,n=Jf(t.restDecoder);for(let r=0;r<n;r++){const n=Jf(t.restDecoder),r=Jf(t.restDecoder);e.set(n,r)}return e},$g=t=>Lg(new Eg(qf(t))),Hg=(t,e)=>(_f(t.restEncoder,e.size),Array.from(e.entries()).sort(((t,e)=>e[0]-t[0])).forEach((([e,n])=>{_f(t.restEncoder,e),_f(t.restEncoder,n)})),t),Vg=(t,e)=>Hg(t,sm(e.store)),Wg=(t,e=new _g)=>(t instanceof Map?Hg(e,t):Vg(e,t),e.toUint8Array()),Ug=t=>Wg(t,new xg);class qg{constructor(){this.l=[]}}const Gg=()=>new qg,Kg=(t,e)=>t.l.push(e),Yg=(t,e)=>{const n=t.l,r=n.length;t.l=n.filter((t=>e!==t)),r===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Xg=(t,e,n)=>_p(t.l,[e,n]);class Jg{constructor(t,e){this.client=t,this.clock=e}}const Zg=(t,e)=>t===e||null!==t&&null!==e&&t.client===e.client&&t.clock===e.clock,Qg=(t,e)=>new Jg(t,e),tm=t=>{for(const[e,n]of t.doc.share.entries())if(n===t)return e;throw Ep()};class em{constructor(t,e){this.ds=t,this.sv=e}}const nm=(t,e)=>new em(t,e),rm=(nm(pg(),new Map),(t,e)=>void 0===e?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!lg(e.ds,t.id)),im=(t,e)=>{const n=hh(t.meta,im,gh),r=t.doc.store;n.has(e)||(e.sv.forEach(((e,n)=>{e<am(r,n)&&fm(t,Qg(n,e))})),cg(t,e.ds,(t=>{})),n.add(e))};class om{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const sm=t=>{const e=new Map;return t.clients.forEach(((t,n)=>{const r=t[t.length-1];e.set(n,r.id.clock+r.length)})),e},am=(t,e)=>{const n=t.clients.get(e);if(void 0===n)return 0;const r=n[n.length-1];return r.id.clock+r.length},cm=(t,e)=>{let n=t.clients.get(e.id.client);if(void 0===n)n=[],t.clients.set(e.id.client,n);else{const t=n[n.length-1];if(t.id.clock+t.length!==e.id.clock)throw Ep()}n.push(e)},um=(t,e)=>{let n=0,r=t.length-1,i=t[r],o=i.id.clock;if(o===e)return r;let s=wh(e/(o+i.length-1)*r);while(n<=r){if(i=t[s],o=i.id.clock,o<=e){if(e<o+i.length)return s;n=s+1}else r=s-1;s=wh((n+r)/2)}throw Ep()},lm=(t,e)=>{const n=t.clients.get(e.client);return n[um(n,e.clock)]},dm=lm,hm=(t,e,n)=>{const r=um(e,n),i=e[r];return i.id.clock<n&&i instanceof Sy?(e.splice(r+1,0,Ey(t,i,n-i.id.clock)),r+1):r},fm=(t,e)=>{const n=t.doc.store.clients.get(e.client);return n[hm(t,n,e.clock)]},pm=(t,e,n)=>{const r=e.clients.get(n.client),i=um(r,n.clock),o=r[i];return n.clock!==o.id.clock+o.length-1&&o.constructor!==Gv&&r.splice(i+1,0,Ey(t,o,n.clock-o.id.clock+1)),o},gm=(t,e,n)=>{const r=t.clients.get(e.id.client);r[um(r,e.id.clock)]=n},mm=(t,e,n,r,i)=>{if(0===r)return;const o=n+r;let s,a=hm(t,e,n);do{s=e[a++],o<s.id.clock+s.length&&hm(t,e,o),i(s)}while(a<e.length&&e[a].id.clock<o)};class vm{constructor(t,e,n){this.doc=t,this.deleteSet=new ag,this.beforeState=sm(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=e,this.meta=new Map,this.local=n,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set}}const ym=(t,e)=>!(0===e.deleteSet.clients.size&&!ph(e.afterState,((t,n)=>e.beforeState.get(n)!==t)))&&(dg(e.deleteSet),Ng(t,e),mg(t,e.deleteSet),!0),bm=(t,e,n)=>{const r=e._item;(null===r||r.id.clock<(t.beforeState.get(r.id.client)||0)&&!r.deleted)&&hh(t.changed,e,gh).add(n)},wm=(t,e)=>{const n=t[e-1],r=t[e];n.deleted===r.deleted&&n.constructor===r.constructor&&n.mergeWith(r)&&(t.splice(e,1),r instanceof Sy&&null!==r.parentSub&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,n))},Em=(t,e,n)=>{for(const[r,i]of t.clients.entries()){const t=e.clients.get(r);for(let r=i.length-1;r>=0;r--){const o=i[r],s=o.clock+o.len;for(let r=um(t,o.clock),i=t[r];r<t.length&&i.id.clock<s;i=t[++r]){const i=t[r];if(o.clock+o.len<=i.id.clock)break;i instanceof Sy&&i.deleted&&!i.keep&&n(i)&&i.gc(e,!1)}}}},Sm=(t,e)=>{t.clients.forEach(((t,n)=>{const r=e.clients.get(n);for(let e=t.length-1;e>=0;e--){const n=t[e],i=Dh(r.length-1,1+um(r,n.clock+n.len-1));for(let t=i,e=r[t];t>0&&e.id.clock>=n.clock;e=r[--t])wm(r,t)}}))},Dm=(t,e)=>{if(e<t.length){const n=t[e],r=n.doc,i=r.store,o=n.deleteSet,s=n._mergeStructs;try{dg(o),n.afterState=sm(n.doc.store),r._transaction=null,r.emit("beforeObserverCalls",[n,r]);const a=[];n.changed.forEach(((t,e)=>a.push((()=>{null!==e._item&&e._item.deleted||e._callObserver(n,t)})))),a.push((()=>{n.changedParentTypes.forEach(((t,e)=>a.push((()=>{null!==e._item&&e._item.deleted||(t=t.filter((t=>null===t.target._item||!t.target._item.deleted)),t.forEach((t=>{t.currentTarget=e})),t.sort(((t,e)=>t.path.length-e.path.length)),Xg(e._dEH,t,n))})))),a.push((()=>r.emit("afterTransaction",[n,r])))})),_p(a,[])}finally{r.gc&&Em(o,i,r.gcFilter),Sm(o,i),n.afterState.forEach(((t,e)=>{const r=n.beforeState.get(e)||0;if(r!==t){const t=i.clients.get(e),n=kh(um(t,r),1);for(let e=t.length-1;e>=n;e--)wm(t,e)}}));for(let t=0;t<s.length;t++){const{client:e,clock:n}=s[t].id,r=i.clients.get(e),o=um(r,n);o+1<r.length&&wm(r,o+1),o>0&&wm(r,o)}if(n.local||n.afterState.get(r.clientID)===n.beforeState.get(r.clientID)||(Jp(Wp,Ip,"[yjs] ",zp,Hp,"Changed the client-id because another client seems to be using it."),r.clientID=bg()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const t=new Cg,e=ym(t,n);e&&r.emit("update",[t.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const t=new Og,e=ym(t,n);e&&r.emit("updateV2",[t.toUint8Array(),n.origin,r,n])}const{subdocsAdded:a,subdocsLoaded:c,subdocsRemoved:u}=n;(a.size>0||u.size>0||c.size>0)&&(a.forEach((t=>{t.clientID=r.clientID,null==t.collectionid&&(t.collectionid=r.collectionid),r.subdocs.add(t)})),u.forEach((t=>r.subdocs.delete(t))),r.emit("subdocs",[{loaded:c,added:a,removed:u},r,n]),u.forEach((t=>t.destroy()))),t.length<=e+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,t])):Dm(t,e+1)}}},km=(t,e,n=null,r=!0)=>{const i=t._transactionCleanups;let o=!1;null===t._transaction&&(o=!0,t._transaction=new vm(t,n,r),i.push(t._transaction),1===i.length&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{e(t._transaction)}finally{o&&i[0]===t._transaction&&Dm(i,0)}};function*xm(t){const e=Jf(t.restDecoder);for(let n=0;n<e;n++){const e=Jf(t.restDecoder),n=t.readClient();let r=Jf(t.restDecoder);for(let i=0;i<e;i++){const e=t.readInfo();if(10===e){const e=Jf(t.restDecoder);yield new Cy(Qg(n,r),e),r+=e}else if(0!==(gf&e)){const i=0===(e&(ff|pf)),o=new Sy(Qg(n,r),null,(e&pf)===pf?t.readLeftID():null,null,(e&ff)===ff?t.readRightID():null,i?t.readParentInfo()?t.readString():t.readLeftID():null,i&&(e&hf)===hf?t.readString():null,Dy(t,e));yield o,r+=o.length}else{const e=t.readLen();yield new Gv(Qg(n,r),e),r+=e}}}}class Cm{constructor(t,e){this.gen=xm(t),this.curr=null,this.done=!1,this.filterSkips=e,this.next()}next(){do{this.curr=this.gen.next().value||null}while(this.filterSkips&&null!==this.curr&&this.curr.constructor===Cy);return this.curr}}class _m{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const Om=t=>Mm(t,Sg,Cg),Am=(t,e)=>{if(t.constructor===Gv){const{client:n,clock:r}=t.id;return new Gv(Qg(n,r+e),t.length-e)}if(t.constructor===Cy){const{client:n,clock:r}=t.id;return new Cy(Qg(n,r+e),t.length-e)}{const n=t,{client:r,clock:i}=n.id;return new Sy(Qg(r,i+e),null,Qg(r,i+e-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(e))}},Mm=(t,e=kg,n=Og)=>{if(1===t.length)return t[0];const r=t.map((t=>new e(qf(t))));let i=r.map((t=>new Cm(t,!0))),o=null;const s=new n,a=new _m(s);while(1){if(i=i.filter((t=>null!==t.curr)),i.sort(((t,e)=>{if(t.curr.id.client===e.curr.id.client){const n=t.curr.id.clock-e.curr.id.clock;return 0===n?t.curr.constructor===e.curr.constructor?0:t.curr.constructor===Cy?1:-1:n}return e.curr.id.client-t.curr.id.client})),0===i.length)break;const t=i[0],e=t.curr.id.client;if(null!==o){let n=t.curr,r=!1;while(null!==n&&n.id.clock+n.length<=o.struct.id.clock+o.struct.length&&n.id.client>=o.struct.id.client)n=t.next(),r=!0;if(null===n||n.id.client!==e||r&&n.id.clock>o.struct.id.clock+o.struct.length)continue;if(e!==o.struct.id.client)Nm(a,o.struct,o.offset),o={struct:n,offset:0},t.next();else if(o.struct.id.clock+o.struct.length<n.id.clock)if(o.struct.constructor===Cy)o.struct.length=n.id.clock+n.length-o.struct.id.clock;else{Nm(a,o.struct,o.offset);const t=n.id.clock-o.struct.id.clock-o.struct.length,r=new Cy(Qg(e,o.struct.id.clock+o.struct.length),t);o={struct:r,offset:0}}else{const e=o.struct.id.clock+o.struct.length-n.id.clock;e>0&&(o.struct.constructor===Cy?o.struct.length-=e:n=Am(n,e)),o.struct.mergeWith(n)||(Nm(a,o.struct,o.offset),o={struct:n,offset:0},t.next())}}else o={struct:t.curr,offset:0},t.next();for(let n=t.curr;null!==n&&n.id.client===e&&n.id.clock===o.struct.id.clock+o.struct.length&&n.constructor!==Cy;n=t.next())Nm(a,o.struct,o.offset),o={struct:n,offset:0}}null!==o&&(Nm(a,o.struct,o.offset),o=null),Pm(a);const c=r.map((t=>vg(t))),u=hg(c);return mg(s,u),s.toUint8Array()},Tm=(t,e,n=kg,r=Og)=>{const i=$g(e),o=new r,s=new _m(o),a=new n(qf(t)),c=new Cm(a,!1);while(c.curr){const t=c.curr,e=t.id.client,n=i.get(e)||0;if(c.curr.constructor!==Cy)if(t.id.clock+t.length>n){Nm(s,t,kh(n-t.id.clock,0)),c.next();while(c.curr&&c.curr.id.client===e)Nm(s,c.curr,0),c.next()}else while(c.curr&&c.curr.id.client===e&&c.curr.id.clock+c.curr.length<=n)c.next();else c.next()}Pm(s);const u=vg(a);return mg(o,u),o.toUint8Array()},Rm=t=>{t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:Df(t.encoder.restEncoder)}),t.encoder.restEncoder=Ef(),t.written=0)},Nm=(t,e,n)=>{t.written>0&&t.currClient!==e.id.client&&Rm(t),0===t.written&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),_f(t.encoder.restEncoder,e.id.clock+n)),e.write(t.encoder,n),t.written++},Pm=t=>{Rm(t);const e=t.encoder.restEncoder;_f(e,t.clientStructs.length);for(let n=0;n<t.clientStructs.length;n++){const r=t.clientStructs[n];_f(e,r.written),Mf(e,r.restEncoder)}},Bm=(t,e,n)=>{const r=new e(qf(t)),i=new Cm(r,!1),o=new n,s=new _m(o);for(let c=i.curr;null!==c;c=i.next())Nm(s,c,0);Pm(s);const a=vg(r);return mg(o,a),o.toUint8Array()},Fm=t=>Bm(t,kg,Cg);class Im{constructor(t,e){this.target=t,this.currentTarget=t,this.transaction=e,this._changes=null,this._keys=null,this._delta=null}get path(){return zm(this.currentTarget,this.target)}deletes(t){return lg(this.transaction.deleteSet,t.id)}get keys(){if(null===this._keys){const t=new Map,e=this.target,n=this.transaction.changed.get(e);n.forEach((n=>{if(null!==n){const r=e._map.get(n);let i,o;if(this.adds(r)){let t=r.left;while(null!==t&&this.adds(t))t=t.left;if(this.deletes(r)){if(null===t||!this.deletes(t))return;i="delete",o=mh(t.content.getContent())}else null!==t&&this.deletes(t)?(i="update",o=mh(t.content.getContent())):(i="add",o=void 0)}else{if(!this.deletes(r))return;i="delete",o=mh(r.content.getContent())}t.set(n,{action:i,oldValue:o})}})),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(null===t){const e=this.target,n=gh(),r=gh(),i=[];t={added:n,deleted:r,delta:i,keys:this.keys};const o=this.transaction.changed.get(e);if(o.has(null)){let t=null;const o=()=>{t&&i.push(t)};for(let i=e._start;null!==i;i=i.right)i.deleted?this.deletes(i)&&!this.adds(i)&&(null!==t&&void 0!==t.delete||(o(),t={delete:0}),t.delete+=i.length,r.add(i)):this.adds(i)?(null!==t&&void 0!==t.insert||(o(),t={insert:[]}),t.insert=t.insert.concat(i.content.getContent()),n.add(i)):(null!==t&&void 0!==t.retain||(o(),t={retain:0}),t.retain+=i.length);null!==t&&void 0===t.retain&&o()}this._changes=t}return t}}const zm=(t,e)=>{const n=[];while(null!==e._item&&e!==t){if(null!==e._item.parentSub)n.unshift(e._item.parentSub);else{let t=0,r=e._item.parent._start;while(r!==e._item&&null!==r)r.deleted||t++,r=r.right;n.unshift(t)}e=e._item.parent}return n},jm=80;let Lm=0;class $m{constructor(t,e){t.marker=!0,this.p=t,this.index=e,this.timestamp=Lm++}}const Hm=t=>{t.timestamp=Lm++},Vm=(t,e,n)=>{t.p.marker=!1,t.p=e,e.marker=!0,t.index=n,t.timestamp=Lm++},Wm=(t,e,n)=>{if(t.length>=jm){const r=t.reduce(((t,e)=>t.timestamp<e.timestamp?t:e));return Vm(r,e,n),r}{const r=new $m(e,n);return t.push(r),r}},Um=(t,e)=>{if(null===t._start||0===e||null===t._searchMarker)return null;const n=0===t._searchMarker.length?null:t._searchMarker.reduce(((t,n)=>Eh(e-t.index)<Eh(e-n.index)?t:n));let r=t._start,i=0;null!==n&&(r=n.p,i=n.index,Hm(n));while(null!==r.right&&i<e){if(!r.deleted&&r.countable){if(e<i+r.length)break;i+=r.length}r=r.right}while(null!==r.left&&i>e)r=r.left,!r.deleted&&r.countable&&(i-=r.length);while(null!==r.left&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock)r=r.left,!r.deleted&&r.countable&&(i-=r.length);return null!==n&&Eh(n.index-i)<r.parent.length/jm?(Vm(n,r,i),n):Wm(t._searchMarker,r,i)},qm=(t,e,n)=>{for(let r=t.length-1;r>=0;r--){const i=t[r];if(n>0){let e=i.p;e.marker=!1;while(e&&(e.deleted||!e.countable))e=e.left,e&&!e.deleted&&e.countable&&(i.index-=e.length);if(null===e||!0===e.marker){t.splice(r,1);continue}i.p=e,e.marker=!0}(e<i.index||n>0&&e===i.index)&&(i.index=kh(e,i.index+n))}},Gm=(t,e,n)=>{const r=t,i=e.changedParentTypes;while(1){if(hh(i,t,(()=>[])).push(n),null===t._item)break;t=t._item.parent}Xg(r._eH,n,e)};class Km{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Gg(),this._dEH=Gg(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,e){this.doc=t,this._item=e}_copy(){throw wp()}clone(){throw wp()}_write(t){}get _first(){let t=this._start;while(null!==t&&t.deleted)t=t.right;return t}_callObserver(t,e){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){Kg(this._eH,t)}observeDeep(t){Kg(this._dEH,t)}unobserve(t){Yg(this._eH,t)}unobserveDeep(t){Yg(this._dEH,t)}toJSON(){}}const Ym=(t,e,n)=>{e<0&&(e=t._length+e),n<0&&(n=t._length+n);let r=n-e;const i=[];let o=t._start;while(null!==o&&r>0){if(o.countable&&!o.deleted){const t=o.content.getContent();if(t.length<=e)e-=t.length;else{for(let n=e;n<t.length&&r>0;n++)i.push(t[n]),r--;e=0}}o=o.right}return i},Xm=t=>{const e=[];let n=t._start;while(null!==n){if(n.countable&&!n.deleted){const t=n.content.getContent();for(let n=0;n<t.length;n++)e.push(t[n])}n=n.right}return e},Jm=(t,e)=>{let n=0,r=t._start;while(null!==r){if(r.countable&&!r.deleted){const i=r.content.getContent();for(let r=0;r<i.length;r++)e(i[r],n++,t)}r=r.right}},Zm=(t,e)=>{const n=[];return Jm(t,((r,i)=>{n.push(e(r,i,t))})),n},Qm=t=>{let e=t._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(null===n){while(null!==e&&e.deleted)e=e.right;if(null===e)return{done:!0,value:void 0};n=e.content.getContent(),r=0,e=e.right}const t=n[r++];return n.length<=r&&(n=null),{done:!1,value:t}}}},tv=(t,e)=>{const n=Um(t,e);let r=t._start;for(null!==n&&(r=n.p,e-=n.index);null!==r;r=r.right)if(!r.deleted&&r.countable){if(e<r.length)return r.content.getContent()[e];e-=r.length}},ev=(t,e,n,r)=>{let i=n;const o=t.doc,s=o.clientID,a=o.store,c=null===n?e._start:n.right;let u=[];const l=()=>{u.length>0&&(i=new Sy(Qg(s,am(a,s)),i,i&&i.lastId,c,c&&c.id,e,null,new ay(u)),i.integrate(t,0),u=[])};r.forEach((n=>{if(null===n)u.push(n);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:u.push(n);break;default:switch(l(),n.constructor){case Uint8Array:case ArrayBuffer:i=new Sy(Qg(s,am(a,s)),i,i&&i.lastId,c,c&&c.id,e,null,new Kv(new Uint8Array(n))),i.integrate(t,0);break;case wg:i=new Sy(Qg(s,am(a,s)),i,i&&i.lastId,c,c&&c.id,e,null,new Qv(n)),i.integrate(t,0);break;default:if(!(n instanceof Km))throw new Error("Unexpected content type in insert operation");i=new Sy(Qg(s,am(a,s)),i,i&&i.lastId,c,c&&c.id,e,null,new by(n)),i.integrate(t,0)}}})),l()},nv=bp("Length exceeded!"),rv=(t,e,n,r)=>{if(n>e._length)throw nv;if(0===n)return e._searchMarker&&qm(e._searchMarker,n,r.length),ev(t,e,null,r);const i=n,o=Um(e,n);let s=e._start;for(null!==o&&(s=o.p,n-=o.index,0===n&&(s=s.prev,n+=s&&s.countable&&!s.deleted?s.length:0));null!==s;s=s.right)if(!s.deleted&&s.countable){if(n<=s.length){n<s.length&&fm(t,Qg(s.id.client,s.id.clock+n));break}n-=s.length}return e._searchMarker&&qm(e._searchMarker,i,r.length),ev(t,e,s,r)},iv=(t,e,n)=>{const r=(e._searchMarker||[]).reduce(((t,e)=>e.index>t.index?e:t),{index:0,p:e._start});let i=r.p;if(i)while(i.right)i=i.right;return ev(t,e,i,n)},ov=(t,e,n,r)=>{if(0===r)return;const i=n,o=r,s=Um(e,n);let a=e._start;for(null!==s&&(a=s.p,n-=s.index);null!==a&&n>0;a=a.right)!a.deleted&&a.countable&&(n<a.length&&fm(t,Qg(a.id.client,a.id.clock+n)),n-=a.length);while(r>0&&null!==a)a.deleted||(r<a.length&&fm(t,Qg(a.id.client,a.id.clock+r)),a.delete(t),r-=a.length),a=a.right;if(r>0)throw nv;e._searchMarker&&qm(e._searchMarker,i,-o+r)},sv=(t,e,n)=>{const r=e._map.get(n);void 0!==r&&r.delete(t)},av=(t,e,n,r)=>{const i=e._map.get(n)||null,o=t.doc,s=o.clientID;let a;if(null==r)a=new ay([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:a=new ay([r]);break;case Uint8Array:a=new Kv(r);break;case wg:a=new Qv(r);break;default:if(!(r instanceof Km))throw new Error("Unexpected content type");a=new by(r)}new Sy(Qg(s,am(o.store,s)),i,i&&i.lastId,null,null,e,n,a).integrate(t,0)},cv=(t,e)=>{const n=t._map.get(e);return void 0===n||n.deleted?void 0:n.content.getContent()[n.length-1]},uv=t=>{const e={};return t._map.forEach(((t,n)=>{t.deleted||(e[n]=t.content.getContent()[t.length-1])})),e},lv=(t,e)=>{const n=t._map.get(e);return void 0!==n&&!n.deleted},dv=t=>ig(t.entries(),(t=>!t[1].deleted));class hv extends Im{constructor(t,e){super(t,e),this._transaction=e}}class fv extends Km{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const e=new fv;return e.push(t),e}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new fv}clone(){const t=new fv;return t.insert(0,this.toArray().map((t=>t instanceof Km?t.clone():t))),t}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}_callObserver(t,e){super._callObserver(t,e),Gm(this,t,new hv(this,t))}insert(t,e){null!==this.doc?km(this.doc,(n=>{rv(n,this,t,e)})):this._prelimContent.splice(t,0,...e)}push(t){null!==this.doc?km(this.doc,(e=>{iv(e,this,t)})):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,e=1){null!==this.doc?km(this.doc,(n=>{ov(n,this,t,e)})):this._prelimContent.splice(t,e)}get(t){return tv(this,t)}toArray(){return Xm(this)}slice(t=0,e=this.length){return Ym(this,t,e)}toJSON(){return this.map((t=>t instanceof Km?t.toJSON():t))}map(t){return Zm(this,t)}forEach(t){Jm(this,t)}[Symbol.iterator](){return Qm(this)}_write(t){t.writeTypeRef(hy)}}const pv=t=>new fv;class gv extends Im{constructor(t,e,n){super(t,e),this.keysChanged=n}}class mv extends Km{constructor(t){super(),this._prelimContent=null,this._prelimContent=void 0===t?new Map:new Map(t)}_integrate(t,e){super._integrate(t,e),this._prelimContent.forEach(((t,e)=>{this.set(e,t)})),this._prelimContent=null}_copy(){return new mv}clone(){const t=new mv;return this.forEach(((e,n)=>{t.set(n,e instanceof Km?e.clone():e)})),t}_callObserver(t,e){Gm(this,t,new gv(this,t,e))}toJSON(){const t={};return this._map.forEach(((e,n)=>{if(!e.deleted){const r=e.content.getContent()[e.length-1];t[n]=r instanceof Km?r.toJSON():r}})),t}get size(){return[...dv(this._map)].length}keys(){return og(dv(this._map),(t=>t[0]))}values(){return og(dv(this._map),(t=>t[1].content.getContent()[t[1].length-1]))}entries(){return og(dv(this._map),(t=>[t[0],t[1].content.getContent()[t[1].length-1]]))}forEach(t){const e={};return this._map.forEach(((e,n)=>{e.deleted||t(e.content.getContent()[e.length-1],n,this)})),e}[Symbol.iterator](){return this.entries()}delete(t){null!==this.doc?km(this.doc,(e=>{sv(e,this,t)})):this._prelimContent.delete(t)}set(t,e){return null!==this.doc?km(this.doc,(n=>{av(n,this,t,e)})):this._prelimContent.set(t,e),e}get(t){return cv(this,t)}has(t){return lv(this,t)}clear(){null!==this.doc?km(this.doc,(t=>{this.forEach((function(e,n,r){sv(t,r,n)}))})):this._prelimContent.clear()}_write(t){t.writeTypeRef(fy)}}const vv=t=>new mv,yv=(t,e)=>t===e||"object"===typeof t&&"object"===typeof e&&t&&e&&Cp(t,e);class bv{constructor(t,e,n,r){this.left=t,this.right=e,this.index=n,this.currentAttributes=r}forward(){switch(null===this.right&&Ep(),this.right.content.constructor){case ry:this.right.deleted||Dv(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const wv=(t,e,n)=>{while(null!==e.right&&n>0){switch(e.right.content.constructor){case ry:e.right.deleted||Dv(e.currentAttributes,e.right.content);break;default:e.right.deleted||(n<e.right.length&&fm(t,Qg(e.right.id.client,e.right.id.clock+n)),e.index+=e.right.length,n-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},Ev=(t,e,n)=>{const r=new Map,i=Um(e,n);if(i){const e=new bv(i.p.left,i.p,i.index,r);return wv(t,e,n-i.index)}{const i=new bv(null,e._start,0,r);return wv(t,i,n)}},Sv=(t,e,n,r)=>{while(null!==n.right&&(!0===n.right.deleted||n.right.content.constructor===ry&&yv(r.get(n.right.content.key),n.right.content.value)))n.right.deleted||r.delete(n.right.content.key),n.forward();const i=t.doc,o=i.clientID;r.forEach(((r,s)=>{const a=n.left,c=n.right,u=new Sy(Qg(o,am(i.store,o)),a,a&&a.lastId,c,c&&c.id,e,null,new ry(s,r));u.integrate(t,0),n.right=u,n.forward()}))},Dv=(t,e)=>{const{key:n,value:r}=e;null===r?t.delete(n):t.set(n,r)},kv=(t,e)=>{while(1){if(null===t.right)break;if(!(t.right.deleted||t.right.content.constructor===ry&&yv(e[t.right.content.key]||null,t.right.content.value)))break;t.forward()}},xv=(t,e,n,r)=>{const i=t.doc,o=i.clientID,s=new Map;for(const a in r){const c=r[a],u=n.currentAttributes.get(a)||null;if(!yv(u,c)){s.set(a,u);const{left:r,right:l}=n;n.right=new Sy(Qg(o,am(i.store,o)),r,r&&r.lastId,l,l&&l.id,e,null,new ry(a,c)),n.right.integrate(t,0),n.forward()}}return s},Cv=(t,e,n,r,i)=>{n.currentAttributes.forEach(((t,e)=>{void 0===i[e]&&(i[e]=null)}));const o=t.doc,s=o.clientID;kv(n,i);const a=xv(t,e,n,i),c=r.constructor===String?new uy(r):r instanceof Km?new by(r):new ey(r);let{left:u,right:l,index:d}=n;e._searchMarker&&qm(e._searchMarker,n.index,c.getLength()),l=new Sy(Qg(s,am(o.store,s)),u,u&&u.lastId,l,l&&l.id,e,null,c),l.integrate(t,0),n.right=l,n.index=d,n.forward(),Sv(t,e,n,a)},_v=(t,e,n,r,i)=>{const o=t.doc,s=o.clientID;kv(n,i);const a=xv(t,e,n,i);t:while(null!==n.right&&(r>0||a.size>0&&(n.right.deleted||n.right.content.constructor===ry))){if(!n.right.deleted)switch(n.right.content.constructor){case ry:{const{key:e,value:o}=n.right.content,s=i[e];if(void 0!==s){if(yv(s,o))a.delete(e);else{if(0===r)break t;a.set(e,o)}n.right.delete(t)}else n.currentAttributes.set(e,o);break}default:r<n.right.length&&fm(t,Qg(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let i="";for(;r>0;r--)i+="\n";n.right=new Sy(Qg(s,am(o.store,s)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,e,null,new uy(i)),n.right.integrate(t,0),n.forward()}Sv(t,e,n,a)},Ov=(t,e,n,r,i)=>{let o=n;const s=dh(i);while(o&&(!o.countable||o.deleted))o.deleted||o.content.constructor!==ry||Dv(s,o.content),o=o.right;let a=0,c=!1;while(e!==o){if(n===e&&(c=!0),!e.deleted){const n=e.content;switch(n.constructor){case ry:{const{key:o,value:u}=n;(s.get(o)||null)===u&&(r.get(o)||null)!==u||(e.delete(t),a++,c||(i.get(o)||null)!==u||(r.get(o)||null)===u||i.delete(o));break}}}e=e.right}return a},Av=(t,e)=>{while(e&&e.right&&(e.right.deleted||!e.right.countable))e=e.right;const n=new Set;while(e&&(e.deleted||!e.countable)){if(!e.deleted&&e.content.constructor===ry){const r=e.content.key;n.has(r)?e.delete(t):n.add(r)}e=e.left}},Mv=t=>{let e=0;return km(t.doc,(n=>{let r=t._start,i=t._start,o=lh();const s=dh(o);while(i){if(!1===i.deleted)switch(i.content.constructor){case ry:Dv(s,i.content);break;default:e+=Ov(n,r,i,o,s),o=dh(s),r=i;break}i=i.right}})),e},Tv=(t,e,n)=>{const r=n,i=dh(e.currentAttributes),o=e.right;while(n>0&&null!==e.right){if(!1===e.right.deleted)switch(e.right.content.constructor){case by:case ey:case uy:n<e.right.length&&fm(t,Qg(e.right.id.client,e.right.id.clock+n)),n-=e.right.length,e.right.delete(t);break}e.forward()}o&&Ov(t,o,e.right,i,e.currentAttributes);const s=(e.left||e.right).parent;return s._searchMarker&&qm(s._searchMarker,e.index,-r+n),e};class Rv extends Im{constructor(t,e,n){super(t,e),this.childListChanged=!1,this.keysChanged=new Set,n.forEach((t=>{null===t?this.childListChanged=!0:this.keysChanged.add(t)}))}get changes(){if(null===this._changes){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(null===this._delta){const t=this.target.doc,e=[];km(t,(t=>{const n=new Map,r=new Map;let i=this.target._start,o=null;const s={};let a="",c=0,u=0;const l=()=>{if(null!==o){let t;switch(o){case"delete":t={delete:u},u=0;break;case"insert":t={insert:a},n.size>0&&(t.attributes={},n.forEach(((e,n)=>{null!==e&&(t.attributes[n]=e)}))),a="";break;case"retain":if(t={retain:c},Object.keys(s).length>0){t.attributes={};for(const e in s)t.attributes[e]=s[e]}c=0;break}e.push(t),o=null}};while(null!==i){switch(i.content.constructor){case by:case ey:this.adds(i)?this.deletes(i)||(l(),o="insert",a=i.content.getContent()[0],l()):this.deletes(i)?("delete"!==o&&(l(),o="delete"),u+=1):i.deleted||("retain"!==o&&(l(),o="retain"),c+=1);break;case uy:this.adds(i)?this.deletes(i)||("insert"!==o&&(l(),o="insert"),a+=i.content.str):this.deletes(i)?("delete"!==o&&(l(),o="delete"),u+=i.length):i.deleted||("retain"!==o&&(l(),o="retain"),c+=i.length);break;case ry:{const{key:e,value:a}=i.content;if(this.adds(i)){if(!this.deletes(i)){const c=n.get(e)||null;yv(c,a)?null!==a&&i.delete(t):("retain"===o&&l(),yv(a,r.get(e)||null)?delete s[e]:s[e]=a)}}else if(this.deletes(i)){r.set(e,a);const t=n.get(e)||null;yv(t,a)||("retain"===o&&l(),s[e]=t)}else if(!i.deleted){r.set(e,a);const n=s[e];void 0!==n&&(yv(n,a)?null!==n&&i.delete(t):("retain"===o&&l(),null===a?delete s[e]:s[e]=a))}i.deleted||("insert"===o&&l(),Dv(n,i.content));break}}i=i.right}l();while(e.length>0){const t=e[e.length-1];if(void 0===t.retain||void 0!==t.attributes)break;e.pop()}})),this._delta=e}return this._delta}}class Nv extends Km{constructor(t){super(),this._pending=void 0!==t?[()=>this.insert(0,t)]:[],this._searchMarker=[]}get length(){return this._length}_integrate(t,e){super._integrate(t,e);try{this._pending.forEach((t=>t()))}catch(Xw){console.error(Xw)}this._pending=null}_copy(){return new Nv}clone(){const t=new Nv;return t.applyDelta(this.toDelta()),t}_callObserver(t,e){super._callObserver(t,e);const n=new Rv(this,t,e),r=t.doc;if(Gm(this,t,n),!t.local){let e=!1;for(const[n,i]of t.afterState.entries()){const o=t.beforeState.get(n)||0;if(i!==o&&(mm(t,r.store.clients.get(n),o,i,(t=>{t.deleted||t.content.constructor!==ry||(e=!0)})),e))break}e||cg(t,t.deleteSet,(t=>{t instanceof Gv||e||t.parent===this&&t.content.constructor===ry&&(e=!0)})),km(r,(t=>{e?Mv(this):cg(t,t.deleteSet,(e=>{e instanceof Gv||e.parent===this&&Av(t,e)}))}))}}toString(){let t="",e=this._start;while(null!==e)!e.deleted&&e.countable&&e.content.constructor===uy&&(t+=e.content.str),e=e.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:e=!0}={}){null!==this.doc?km(this.doc,(n=>{const r=new bv(null,this._start,0,new Map);for(let i=0;i<t.length;i++){const o=t[i];if(void 0!==o.insert){const s=e||"string"!==typeof o.insert||i!==t.length-1||null!==r.right||"\n"!==o.insert.slice(-1)?o.insert:o.insert.slice(0,-1);("string"!==typeof s||s.length>0)&&Cv(n,this,r,s,o.attributes||{})}else void 0!==o.retain?_v(n,this,r,o.retain,o.attributes||{}):void 0!==o.delete&&Tv(n,r,o.delete)}})):this._pending.push((()=>this.applyDelta(t)))}toDelta(t,e,n){const r=[],i=new Map,o=this.doc;let s="",a=this._start;function c(){if(s.length>0){const t={};let e=!1;i.forEach(((n,r)=>{e=!0,t[r]=n}));const n={insert:s};e&&(n.attributes=t),r.push(n),s=""}}return km(o,(o=>{t&&im(o,t),e&&im(o,e);while(null!==a){if(rm(a,t)||void 0!==e&&rm(a,e))switch(a.content.constructor){case uy:{const r=i.get("ychange");void 0===t||rm(a,t)?void 0===e||rm(a,e)?void 0!==r&&(c(),i.delete("ychange")):void 0!==r&&r.user===a.id.client&&"added"===r.state||(c(),i.set("ychange",n?n("added",a.id):{type:"added"})):void 0!==r&&r.user===a.id.client&&"removed"===r.state||(c(),i.set("ychange",n?n("removed",a.id):{type:"removed"})),s+=a.content.str;break}case by:case ey:{c();const t={insert:a.content.getContent()[0]};if(i.size>0){const e={};t.attributes=e,i.forEach(((t,n)=>{e[n]=t}))}r.push(t);break}case ry:rm(a,t)&&(c(),Dv(i,a.content));break}a=a.right}c()}),im),r}insert(t,e,n){if(e.length<=0)return;const r=this.doc;null!==r?km(r,(r=>{const i=Ev(r,this,t);n||(n={},i.currentAttributes.forEach(((t,e)=>{n[e]=t}))),Cv(r,this,i,e,n)})):this._pending.push((()=>this.insert(t,e,n)))}insertEmbed(t,e,n={}){const r=this.doc;null!==r?km(r,(r=>{const i=Ev(r,this,t);Cv(r,this,i,e,n)})):this._pending.push((()=>this.insertEmbed(t,e,n)))}delete(t,e){if(0===e)return;const n=this.doc;null!==n?km(n,(n=>{Tv(n,Ev(n,this,t),e)})):this._pending.push((()=>this.delete(t,e)))}format(t,e,n){if(0===e)return;const r=this.doc;null!==r?km(r,(r=>{const i=Ev(r,this,t);null!==i.right&&_v(r,this,i,e,n)})):this._pending.push((()=>this.format(t,e,n)))}removeAttribute(t){null!==this.doc?km(this.doc,(e=>{sv(e,this,t)})):this._pending.push((()=>this.removeAttribute(t)))}setAttribute(t,e){null!==this.doc?km(this.doc,(n=>{av(n,this,t,e)})):this._pending.push((()=>this.setAttribute(t,e)))}getAttribute(t){return cv(this,t)}getAttributes(t){return uv(this)}_write(t){t.writeTypeRef(py)}}const Pv=t=>new Nv;class Bv{constructor(t,e=(()=>!0)){this._filter=e,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,e=t&&t.content&&t.content.type;if(null!==t&&(!this._firstCall||t.deleted||!this._filter(e)))do{if(e=t.content.type,t.deleted||e.constructor!==zv&&e.constructor!==Fv||null===e._start)while(null!==t){if(null!==t.right){t=t.right;break}t=t.parent===this._root?null:t.parent._item}else t=e._start}while(null!==t&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,null===t?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class Fv extends Km{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Fv}clone(){const t=new Fv;return t.insert(0,this.toArray().map((t=>t instanceof Km?t.clone():t))),t}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(t){return new Bv(this,t)}querySelector(t){t=t.toUpperCase();const e=new Bv(this,(e=>e.nodeName&&e.nodeName.toUpperCase()===t)),n=e.next();return n.done?null:n.value}querySelectorAll(t){return t=t.toUpperCase(),Array.from(new Bv(this,(e=>e.nodeName&&e.nodeName.toUpperCase()===t)))}_callObserver(t,e){Gm(this,t,new Lv(this,e,t))}toString(){return Zm(this,(t=>t.toString())).join("")}toJSON(){return this.toString()}toDOM(t=document,e={},n){const r=t.createDocumentFragment();return void 0!==n&&n._createAssociation(r,this),Jm(this,(i=>{r.insertBefore(i.toDOM(t,e,n),null)})),r}insert(t,e){null!==this.doc?km(this.doc,(n=>{rv(n,this,t,e)})):this._prelimContent.splice(t,0,...e)}insertAfter(t,e){if(null!==this.doc)km(this.doc,(n=>{const r=t&&t instanceof Km?t._item:t;ev(n,this,r,e)}));else{const n=this._prelimContent,r=null===t?0:n.findIndex((e=>e===t))+1;if(0===r&&null!==t)throw bp("Reference item not found");n.splice(r,0,...e)}}delete(t,e=1){null!==this.doc?km(this.doc,(n=>{ov(n,this,t,e)})):this._prelimContent.splice(t,e)}toArray(){return Xm(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return tv(this,t)}slice(t=0,e=this.length){return Ym(this,t,e)}forEach(t){Jm(this,t)}_write(t){t.writeTypeRef(my)}}const Iv=t=>new Fv;class zv extends Fv{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,e){super._integrate(t,e),this._prelimAttrs.forEach(((t,e)=>{this.setAttribute(e,t)})),this._prelimAttrs=null}_copy(){return new zv(this.nodeName)}clone(){const t=new zv(this.nodeName),e=this.getAttributes();for(const n in e)t.setAttribute(n,e[n]);return t.insert(0,this.toArray().map((t=>t instanceof Km?t.clone():t))),t}toString(){const t=this.getAttributes(),e=[],n=[];for(const s in t)n.push(s);n.sort();const r=n.length;for(let s=0;s<r;s++){const r=n[s];e.push(r+'="'+t[r]+'"')}const i=this.nodeName.toLocaleLowerCase(),o=e.length>0?" "+e.join(" "):"";return`<${i}${o}>${super.toString()}</${i}>`}removeAttribute(t){null!==this.doc?km(this.doc,(e=>{sv(e,this,t)})):this._prelimAttrs.delete(t)}setAttribute(t,e){null!==this.doc?km(this.doc,(n=>{av(n,this,t,e)})):this._prelimAttrs.set(t,e)}getAttribute(t){return cv(this,t)}hasAttribute(t){return lv(this,t)}getAttributes(t){return uv(this)}toDOM(t=document,e={},n){const r=t.createElement(this.nodeName),i=this.getAttributes();for(const o in i)r.setAttribute(o,i[o]);return Jm(this,(i=>{r.appendChild(i.toDOM(t,e,n))})),void 0!==n&&n._createAssociation(r,this),r}_write(t){t.writeTypeRef(gy),t.writeKey(this.nodeName)}}const jv=t=>new zv(t.readKey());class Lv extends Im{constructor(t,e,n){super(t,n),this.childListChanged=!1,this.attributesChanged=new Set,e.forEach((t=>{null===t?this.childListChanged=!0:this.attributesChanged.add(t)}))}}class $v extends mv{constructor(t){super(),this.hookName=t}_copy(){return new $v(this.hookName)}clone(){const t=new $v(this.hookName);return this.forEach(((e,n)=>{t.set(n,e)})),t}toDOM(t=document,e={},n){const r=e[this.hookName];let i;return i=void 0!==r?r.createDom(this):document.createElement(this.hookName),i.setAttribute("data-yjs-hook",this.hookName),void 0!==n&&n._createAssociation(i,this),i}_write(t){t.writeTypeRef(vy),t.writeKey(this.hookName)}}const Hv=t=>new $v(t.readKey());class Vv extends Nv{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new Vv}clone(){const t=new Vv;return t.applyDelta(this.toDelta()),t}toDOM(t=document,e,n){const r=t.createTextNode(this.toString());return void 0!==n&&n._createAssociation(r,this),r}toString(){return this.toDelta().map((t=>{const e=[];for(const r in t.attributes){const n=[];for(const e in t.attributes[r])n.push({key:e,value:t.attributes[r][e]});n.sort(((t,e)=>t.key<e.key?-1:1)),e.push({nodeName:r,attrs:n})}e.sort(((t,e)=>t.nodeName<e.nodeName?-1:1));let n="";for(let r=0;r<e.length;r++){const t=e[r];n+=`<${t.nodeName}`;for(let e=0;e<t.attrs.length;e++){const r=t.attrs[e];n+=` ${r.key}="${r.value}"`}n+=">"}n+=t.insert;for(let r=e.length-1;r>=0;r--)n+=`</${e[r].nodeName}>`;return n})).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(yy)}}const Wv=t=>new Vv;class Uv{constructor(t,e){this.id=t,this.length=e}get deleted(){throw wp()}mergeWith(t){return!1}write(t,e,n){throw wp()}integrate(t,e){throw wp()}}const qv=0;class Gv extends Uv{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor===t.constructor&&(this.length+=t.length,!0)}integrate(t,e){e>0&&(this.id.clock+=e,this.length-=e),cm(t.doc.store,this)}write(t,e){t.writeInfo(qv),t.writeLen(this.length-e)}getMissing(t,e){return null}}class Kv{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Kv(this.content)}splice(t){throw wp()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeBuf(this.content)}getRef(){return 3}}const Yv=t=>new Kv(t.readBuf());class Xv{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Xv(this.len)}splice(t){const e=new Xv(this.len-t);return this.len=t,e}mergeWith(t){return this.len+=t.len,!0}integrate(t,e){fg(t.deleteSet,e.id.client,e.id.clock,this.len),e.markDeleted()}delete(t){}gc(t){}write(t,e){t.writeLen(this.len-e)}getRef(){return 1}}const Jv=t=>new Xv(t.readLen()),Zv=(t,e)=>new wg({guid:t,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class Qv{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const e={};this.opts=e,t.gc||(e.gc=!1),t.autoLoad&&(e.autoLoad=!0),null!==t.meta&&(e.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Qv(Zv(this.doc.guid,this.opts))}splice(t){throw wp()}mergeWith(t){return!1}integrate(t,e){this.doc._item=e,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,e){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const ty=t=>new Qv(Zv(t.readString(),t.readAny()));class ey{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new ey(this.embed)}splice(t){throw wp()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeJSON(this.embed)}getRef(){return 5}}const ny=t=>new ey(t.readJSON());class ry{constructor(t,e){this.key=t,this.value=e}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new ry(this.key,this.value)}splice(t){throw wp()}mergeWith(t){return!1}integrate(t,e){e.parent._searchMarker=null}delete(t){}gc(t){}write(t,e){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const iy=t=>new ry(t.readKey(),t.readJSON());class oy{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new oy(this.arr)}splice(t){const e=new oy(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const n=this.arr.length;t.writeLen(n-e);for(let r=e;r<n;r++){const e=this.arr[r];t.writeString(void 0===e?"undefined":JSON.stringify(e))}}getRef(){return 2}}const sy=t=>{const e=t.readLen(),n=[];for(let r=0;r<e;r++){const e=t.readString();"undefined"===e?n.push(void 0):n.push(JSON.parse(e))}return new oy(n)};class ay{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ay(this.arr)}splice(t){const e=new ay(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const n=this.arr.length;t.writeLen(n-e);for(let r=e;r<n;r++){const e=this.arr[r];t.writeAny(e)}}getRef(){return 8}}const cy=t=>{const e=t.readLen(),n=[];for(let r=0;r<e;r++)n.push(t.readAny());return new ay(n)};class uy{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new uy(this.str)}splice(t){const e=new uy(this.str.slice(t));this.str=this.str.slice(0,t);const n=this.str.charCodeAt(t-1);return n>=55296&&n<=56319&&(this.str=this.str.slice(0,t-1)+"�",e.str="�"+e.str.slice(1)),e}mergeWith(t){return this.str+=t.str,!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeString(0===e?this.str:this.str.slice(e))}getRef(){return 4}}const ly=t=>new uy(t.readString()),dy=[pv,vv,Pv,jv,Iv,Hv,Wv],hy=0,fy=1,py=2,gy=3,my=4,vy=5,yy=6;class by{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new by(this.type._copy())}splice(t){throw wp()}mergeWith(t){return!1}integrate(t,e){this.type._integrate(t.doc,e)}delete(t){let e=this.type._start;while(null!==e)e.deleted?t._mergeStructs.push(e):e.delete(t),e=e.right;this.type._map.forEach((e=>{e.deleted?t._mergeStructs.push(e):e.delete(t)})),t.changed.delete(this.type)}gc(t){let e=this.type._start;while(null!==e)e.gc(t,!0),e=e.right;this.type._start=null,this.type._map.forEach((e=>{while(null!==e)e.gc(t,!0),e=e.left})),this.type._map=new Map}write(t,e){this.type._write(t)}getRef(){return 7}}const wy=t=>new by(dy[t.readTypeRef()](t)),Ey=(t,e,n)=>{const{client:r,clock:i}=e.id,o=new Sy(Qg(r,i+n),e,Qg(r,i+n-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(n));return e.deleted&&o.markDeleted(),e.keep&&(o.keep=!0),null!==e.redone&&(o.redone=Qg(e.redone.client,e.redone.clock+n)),e.right=o,null!==o.right&&(o.right.left=o),t._mergeStructs.push(o),null!==o.parentSub&&null===o.right&&o.parent._map.set(o.parentSub,o),e.length=n,o};class Sy extends Uv{constructor(t,e,n,r,i,o,s,a){super(t,a.getLength()),this.origin=n,this.left=e,this.right=r,this.rightOrigin=i,this.parent=o,this.parentSub=s,this.redone=null,this.content=a,this.info=this.content.isCountable()?uf:0}set marker(t){(this.info&df)>0!==t&&(this.info^=df)}get marker(){return(this.info&df)>0}get keep(){return(this.info&cf)>0}set keep(t){this.keep!==t&&(this.info^=cf)}get countable(){return(this.info&uf)>0}get deleted(){return(this.info&lf)>0}set deleted(t){this.deleted!==t&&(this.info^=lf)}markDeleted(){this.info|=lf}getMissing(t,e){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=am(e,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=am(e,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Jg&&this.id.client!==this.parent.client&&this.parent.clock>=am(e,this.parent.client))return this.parent.client;if(this.origin&&(this.left=pm(t,e,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=fm(t,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===Gv||this.right&&this.right.constructor===Gv)&&(this.parent=null),this.parent){if(this.parent.constructor===Jg){const t=dm(e,this.parent);t.constructor===Gv?this.parent=null:this.parent=t.content.type}}else this.left&&this.left.constructor===Sy&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===Sy&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}integrate(t,e){if(e>0&&(this.id.clock+=e,this.left=pm(t,t.doc.store,Qg(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(e),this.length-=e),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){let e,n=this.left;if(null!==n)e=n.right;else if(null!==this.parentSub){e=this.parent._map.get(this.parentSub)||null;while(null!==e&&null!==e.left)e=e.left}else e=this.parent._start;const r=new Set,i=new Set;while(null!==e&&e!==this.right){if(i.add(e),r.add(e),Zg(this.origin,e.origin)){if(e.id.client<this.id.client)n=e,r.clear();else if(Zg(this.rightOrigin,e.rightOrigin))break}else{if(null===e.origin||!i.has(dm(t.doc.store,e.origin)))break;r.has(dm(t.doc.store,e.origin))||(n=e,r.clear())}e=e.right}this.left=n}if(null!==this.left){const t=this.left.right;this.right=t,this.left.right=this}else{let t;if(null!==this.parentSub){t=this.parent._map.get(this.parentSub)||null;while(null!==t&&null!==t.left)t=t.left}else t=this.parent._start,this.parent._start=this;this.right=t}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(t)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),cm(t.doc.store,this),this.content.integrate(t,this),bm(t,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(t)}else new Gv(this.id,this.length).integrate(t,0)}get next(){let t=this.right;while(null!==t&&t.deleted)t=t.right;return t}get prev(){let t=this.left;while(null!==t&&t.deleted)t=t.left;return t}get lastId(){return 1===this.length?this.id:Qg(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&Zg(t.origin,this.lastId)&&this.right===t&&Zg(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&null===this.redone&&null===t.redone&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const e=this.parent._searchMarker;return e&&e.forEach((e=>{e.p===t&&(e.p=this,!this.deleted&&this.countable&&(e.index-=this.length))})),t.keep&&(this.keep=!0),this.right=t.right,null!==this.right&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const e=this.parent;this.countable&&null===this.parentSub&&(e._length-=this.length),this.markDeleted(),fg(t.deleteSet,this.id.client,this.id.clock,this.length),bm(t,e,this.parentSub),this.content.delete(t)}}gc(t,e){if(!this.deleted)throw Ep();this.content.gc(t),e?gm(t,this,new Gv(this.id,this.length)):this.content=new Xv(this.length)}write(t,e){const n=e>0?Qg(this.id.client,this.id.clock+e-1):this.origin,r=this.rightOrigin,i=this.parentSub,o=this.content.getRef()&gf|(null===n?0:pf)|(null===r?0:ff)|(null===i?0:hf);if(t.writeInfo(o),null!==n&&t.writeLeftID(n),null!==r&&t.writeRightID(r),null===n&&null===r){const e=this.parent;if(void 0!==e._item){const n=e._item;if(null===n){const n=tm(e);t.writeParentInfo(!0),t.writeString(n)}else t.writeParentInfo(!1),t.writeLeftID(n.id)}else e.constructor===String?(t.writeParentInfo(!0),t.writeString(e)):e.constructor===Jg?(t.writeParentInfo(!1),t.writeLeftID(e)):Ep();null!==i&&t.writeString(i)}this.content.write(t,e)}}const Dy=(t,e)=>ky[e&gf](t),ky=[()=>{Ep()},Jv,sy,Yv,ly,ny,iy,wy,cy,ty,()=>{Ep()}],xy=10;class Cy extends Uv{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor===t.constructor&&(this.length+=t.length,!0)}integrate(t,e){Ep()}write(t,e){t.writeInfo(xy),_f(t.restEncoder,this.length-e)}getMissing(t,e){return null}}const _y="undefined"!==typeof window?window:"undefined"!==typeof global?global:{},Oy="__ $YJS$ __";var Ay,My;!0===_y[Oy]&&console.warn("Yjs was already imported. Importing different versions of Yjs often leads to issues."),_y[Oy]=!0;var Ty=function(t){return t()};function Ry(t,e){return My?My(t,e):void Ty(t)}function Ny(t,e,n){if(Ay)return Ay.apply(null,arguments);throw new Error("observable implementation not provided. Call enableReactiveBindings, enableVueBindings or enableMobxBindings.")}function Py(t){Ay=function(e,n){var r=0,i=t.reactive({data:r}),o={reportObserved:function(){return i.data},reportChanged:function(){i.data=++r}};return n&&n(),o},My=void 0}function By(t){Ay=function(e,n,r){var i=t.createAtom(e);return n&&n(),i},My=function(e,n){return t.reaction(e,n,{fireImmediately:!1})}}var Fy=new WeakSet;function Iy(t){if(Fy.has(t))return t;var e;Fy.add(t);var n=new Map;function r(){if(!e){var n=function(t){(t.changes.added.size||t.changes.deleted.size||t.changes.keys.size||t.changes.delta.length)&&e.reportChanged()};e=Ny("map",(function(){t.observe(n)}),(function(){t.unobserve(n)}))}e.reportObserved(t._implicitObserver)}function i(e){var r=n.get(e);if(!r){var i=function(t){r.reportChanged()};r=Ny(e+"",(function(){t.observe(i)}),(function(){t.unobserve(i)})),n.set(e,r)}r.reportObserved(t._implicitObserver)}var o=t.get;function s(e){var n=t[e];t[e]=function(){r();var t=Reflect.apply(n,this,arguments);return t}}function a(e){var n=t,i=Object.getOwnPropertyDescriptor(n,e);if(i||(n=Object.getPrototypeOf(n),i=Object.getOwnPropertyDescriptor(n,e)),i||(n=Object.getPrototypeOf(n),i=Object.getOwnPropertyDescriptor(n,e)),!i)throw new Error("property not found");var o=i.get;i.get=function(){this._disableTracking||r();var t=Reflect.apply(o,this,arguments);return t},Object.defineProperty(n,e,i)}function c(e,n){var r=t,i=Object.getOwnPropertyDescriptor(r,e);if(i||(r=Object.getPrototypeOf(r),i=Object.getOwnPropertyDescriptor(r,e)),i||(r=Object.getPrototypeOf(r),i=Object.getOwnPropertyDescriptor(r,e)),!i)throw new Error("property not found");Object.defineProperty(r,n,i)}t.get=function(t){if("number"!==typeof t)throw new Error("unexpected");i(t);var e=Reflect.apply(o,this,arguments);return e},s("forEach"),s("toJSON"),s("toArray"),s("slice"),s("map"),c("length","lengthUntracked"),a("length");var u=t.push;t.push=function(t){this._disableTracking=!0;var e=u.call(this,t);return this._disableTracking=!1,e};var l=t.slice;return t.slice=function(t,e){this._disableTracking=!0;var n=l.call(this,t,e);return this._disableTracking=!1,n},t}var zy=new WeakSet;function jy(t){if(zy.has(t))return t;var e;function n(){if(!e){var n=Array.from(t.share.keys()),r=function(r){var i=Array.from(t.share.keys());JSON.stringify(n)!==JSON.stringify(i)&&(n=i,e.reportChanged())};e=Ny("map",(function(){t.on("beforeObserverCalls",r)}),(function(){t.off("beforeObserverCalls",r)}))}e.reportObserved(t._implicitObserver)}zy.add(t);var r=t.get;function i(r){var i,o=t[r];t[r]=function(){var r,s=arguments;return n(),i&&i.removeObservers(),i=Ry((function(){return r=Reflect.apply(o,t,s),r}),(function(){return e.reportChanged()})),r}}return t.get=function(t){if("string"!==typeof t)throw new Error("unexpected");var e=Reflect.apply(r,this,arguments);return qy(e),e},i("toJSON"),Object.defineProperty(t,"keys",{get:function(){return n(),Object.keys(t.share)}}),t}var Ly=new WeakSet;function $y(t){if(Ly.has(t))return t;var e;Ly.add(t);var n=new Map;function r(){if(!e){var n=function(t){(t.changes.added.size||t.changes.deleted.size||t.changes.keys.size||t.changes.delta.length)&&e.reportChanged()};e=Ny("map",(function(){t.observe(n)}),(function(){t.unobserve(n)}))}e.reportObserved(t._implicitObserver)}function i(e){var r=n.get(e);if(!r){var i=function(t){t.keysChanged.has(e)&&(t.changes.added.size||t.changes.deleted.size||t.changes.keys.size||t.changes.delta.length)&&r.reportChanged()};r=Ny(e,(function(){t.observe(i)}),(function(){t.unobserve(i)})),n.set(e,r)}r.reportObserved(t._implicitObserver)}var o=t.get;function s(e){var n=t[e];t[e]=function(){r();var t=Reflect.apply(n,this,arguments);return t}}return t.get=function(t){if("string"!==typeof t)throw new Error("unexpected");i(t);var e=Reflect.apply(o,this,arguments);return e},s("values"),s("entries"),s("keys"),s("forEach"),s("toJSON"),t}var Hy=new WeakSet;function Vy(t){if(Hy.has(t))return t;var e;Hy.add(t);var n=function(t){e.reportChanged()};function r(n){var r=t[n];t[n]=function(){e.reportObserved(this._implicitObserver);var t=Reflect.apply(r,this,arguments);return t}}return e=Ny("text",(function(){t.observe(n)}),(function(){t.unobserve(n)})),r("toString"),r("toJSON"),t}var Wy=new WeakSet;function Uy(t){if(Wy.has(t))return t;var e;Wy.add(t);var n=function(t){(t.changes.added.size||t.changes.deleted.size||t.changes.keys.size||t.changes.delta.length)&&e.reportChanged()};function r(n){var r=t[n];t[n]=function(){e.reportObserved(this._implicitObserver);var t=Reflect.apply(r,this,arguments);return t}}function i(n){var r=t,i=Object.getOwnPropertyDescriptor(r,n);if(i||(r=Object.getPrototypeOf(r),i=Object.getOwnPropertyDescriptor(r,n)),i||(r=Object.getPrototypeOf(r),i=Object.getOwnPropertyDescriptor(r,n)),!i)throw new Error("property not found");var o=i.get;i.get=function(){e.reportObserved(this._implicitObserver);var t=Reflect.apply(o,this,arguments);return t},Object.defineProperty(r,n,i)}return e=Ny("xml",(function(){t.observe(n)}),(function(){t.unobserve(n)})),r("toString"),r("toDOM"),r("toArray"),r("getAttribute"),i("firstChild"),t}function qy(t){return t instanceof Vv||t instanceof Nv?Vy(t):t instanceof fv?Iy(t):t instanceof mv?$y(t):t instanceof wg||Object.prototype.hasOwnProperty.call(t,"autoLoad")?jy(t):t instanceof Fv||t instanceof zv?Uy(t):t}function Gy(t){t.share.forEach((function(t){t.constructor!==Km&&qy(t)}))}function Ky(t,e){for(var n=t.length-1;n>=e;n--){var r=t[n];if(!r.deleted){var i;if(r instanceof Gv)continue;null==(i=r.content)||i.getContent().forEach((function(t){t instanceof Km&&qy(t)}))}}}var Yy=new WeakSet;function Xy(t){Yy.has(t)||(Yy.add(t),qy(t),t.store.clients.forEach((function(t){t&&Ky(t,0)})),Gy(t),t.on("beforeObserverCalls",(function(e){Gy(t),e.afterState.forEach((function(t,n){var r=e.beforeState.get(n)||0;if(r!==t){var i=e.doc.store.clients.get(n);if(!i)return;var o=um(i,r);Ky(i,o)}}))})))}var Jy=function(t){this.value=void 0,this.value=t};function Zy(t){return new Jy(Object.freeze(t))}function Qy(t){var e=function(){var e,n=null==(e=this[Zd])?void 0:e.implicitObserver;t._implicitObserver=n;var r=t.slice.bind(t).apply(t,arguments);return r.map((function(t){var e=ob(t,n);return e}))},n=function(t){return t.map((function(t){var e=sb(t),n=db(e)||e;if(n instanceof Jy&&(n=n.value),n instanceof Km&&n.parent)throw new Error("Not supported: reassigning object that already occurs in the tree.");return n}))},r=function(){return[].findIndex.apply(e.apply(this),arguments)},i={slice:e,unshift:t.unshift.bind(t),push:function(){return t.push(n([].slice.call(arguments))),t.lengthUntracked},insert:t.insert.bind(t),toJSON:t.toJSON.bind(t),forEach:function(){return[].forEach.apply(e.apply(this),arguments)},every:function(){return[].every.apply(e.apply(this),arguments)},filter:function(){return[].filter.apply(e.apply(this),arguments)},find:function(){return[].find.apply(e.apply(this),arguments)},findIndex:r,map:function(){return[].map.apply(e.apply(this),arguments)},indexOf:function(){var t=arguments[0];return r.call(this,(function(e){return hb(e,t)}))},splice:function(){var r=arguments[0]<0?t.length-Math.abs(arguments[0]):arguments[0],i=arguments[1],o=Array.from(Array.from(arguments).slice(2)),s=e.apply(this,[r,Number.isInteger(i)?r+i:void 0]);return t.doc?t.doc.transact((function(){t.delete(r,i),t.insert(r,n(o))})):(t.delete(r,i),t.insert(r,n(o))),s}};return Object.defineProperty(i,"length",{enumerable:!1,configurable:!1,writable:!0,value:t.lengthUntracked}),i}function tb(t){if("string"===typeof t&&t.trim().length){var e=Number(t);if(Number.isInteger(e))return e}return t}function eb(t,e){if(void 0===e&&(e=new fv),e[Jd])throw new Error("unexpected");var n=Qy(e),r=new Proxy(n,{set:function(t,e,n){var r=tb(e);if("number"!==typeof r)throw new Error;throw new Error("array assignment is not implemented / supported")},get:function(t,n,r){var i=tb(n);if(i===lb)return e;if("number"===typeof i){var o,s;if(r&&r[Zd])o=null==(s=r[Zd])?void 0:s.implicitObserver,e._implicitObserver=o;var a=e.get(i);return a=ob(a,o),a}if(i===Symbol.toStringTag)return"Array";if(i===Symbol.iterator){var c=e.slice();return Reflect.get(c,i)}if("length"===i)return e.length;var u=Reflect.get(t,i,r);return u},deleteProperty:function(t,n){var r=tb(n);if("number"!==typeof r)throw new Error;return r<e.lengthUntracked&&r>=0&&(e.delete(r),!0)},has:function(t,n){var r=tb(n);return"number"!==typeof r?Reflect.has(t,r):r<e.lengthUntracked&&r>=0},getOwnPropertyDescriptor:function(t,n){var r=tb(n);return"length"===r?{enumerable:!1,configurable:!1,writable:!0}:"number"===typeof r&&r>=0&&r<e.lengthUntracked?{enumerable:!0,configurable:!0,writable:!0}:void 0},ownKeys:function(t){for(var n=[],r=0;r<e.length;r++)n.push(r+"");return n.push("length"),n}});return n.push.apply(r,t),r}function nb(t,e){if(void 0===e&&(e=new mv),e[Jd])throw new Error("unexpected");var n=new Proxy({},{set:function(t,n,r){if("string"!==typeof n)throw new Error;var i=sb(r),o=db(i)||i;if(o instanceof Jy&&(o=o.value),o instanceof Km&&o.parent)throw new Error("Not supported: reassigning object that already occurs in the tree.");return e.set(n,o),!0},get:function(t,n,r){if(n===lb)return e;if("string"!==typeof n)return Reflect.get(t,n);var i,o;r&&r[Zd]&&(i=null==(o=r[Zd])?void 0:o.implicitObserver,e._implicitObserver=i);var s=e.get(n);return s=ob(s,i),s},deleteProperty:function(t,n){if("string"!==typeof n)throw new Error;return!!e.has(n)&&(e.delete(n),!0)},has:function(t,n){return!("string"!==typeof n||!e.has(n))},getOwnPropertyDescriptor:function(t,n){if("string"===typeof n&&e.has(n))return{enumerable:!0,configurable:!0}},ownKeys:function(t){return Array.from(e.keys())}});for(var r in ib.set(e,n),t)n[r]=t[r];return n}function rb(t){return t instanceof Km}var ib=new WeakMap;function ob(t,e){if(rb(t)){if(t._implicitObserver=e,t instanceof fv||t instanceof mv){if(!ib.has(t)){var n=sb(t);ib.set(t,n)}t=ib.get(t)}else{if(!(t instanceof zv||t instanceof Fv||t instanceof Vv||t instanceof $v||t instanceof Nv))throw new Error("unknown YType");th(t),t.__v_skip=!0}return t}return null===t?null:"object"===typeof t?Zy(t):t}function sb(t){if(null===t||void 0===t)return t;if(t=db(t)||t,t instanceof fv)return eb([],t);if(t instanceof mv)return nb({},t);if("string"===typeof t)return t;if(Array.isArray(t))return eb(t);if(t instanceof zv||t instanceof Fv||t instanceof Vv||t instanceof $v)return t;if(t instanceof Nv)return t;if("object"===typeof t)return t instanceof Jy?t:nb(t);if("number"===typeof t||"boolean"===typeof t)return t;throw new Error("invalid")}function ab(t){for(var e=0,n=Object.entries(t);e<n.length;e++){var r=n[e],i=r[1];if(Array.isArray(i)){if(0!==i.length)throw new Error("Root Array initializer must always be empty array")}else if(i&&"object"===typeof i){if(0!==Object.keys(i).length||Object.getPrototypeOf(i)!==Object.prototype)throw new Error("Root Object initializer must always be {}")}else if("xml"!==i&&"text"!==i)throw new Error("unknown Root initializer")}}function cb(t,e,n){var r=e[n];if(r)return"xml"===r?t.getXmlFragment(n):"text"===r?t.getText(n):Array.isArray(r)?t.getArray(n):t.getMap(n);console.warn("property not found on root doc",n)}function ub(t,e){if(t[Jd])throw new Error("unexpected");ab(e);var n=new Proxy({},{set:function(t,e,n){if("string"!==typeof e)throw new Error;throw new Error("cannot set new elements on root doc")},get:function(n,r,i){if(r===lb)return t;if("string"!==typeof r)return Reflect.get(n,r);var o,s;i&&i[Zd]&&(o=null==(s=i[Zd])?void 0:s.implicitObserver,t._implicitObserver=o);if("toJSON"===r){for(var a=0,c=Object.keys(e);a<c.length;a++){var u=c[a];cb(t,e,u)}var l=Reflect.get(t,r);return l}var d=cb(t,e,r);return d=ob(d,o),d},deleteProperty:function(t,e){throw new Error("deleteProperty not available for doc")},has:function(e,n){return!("string"!==typeof n||!t.share.has(n))},getOwnPropertyDescriptor:function(e,n){if("string"===typeof n&&t.share.has(n)||"toJSON"===n)return{enumerable:!0,configurable:!0}},ownKeys:function(e){return Array.from(t.share.keys())}});return ib.set(t,n),n}By(i);var lb=Symbol("INTERNAL_SYMBOL");function db(t){if("object"===typeof t&&null!==t){var e=t[lb];return e&&(th(e),e.__v_skip=!0),e}}function hb(t,e){if(t===e)return!0;if("object"===typeof t&&"object"===typeof e){var n=db(t),r=db(e);return!(!n||!r)&&n===r}return!1}function fb(t,e){return void 0===e&&(e=new wg),Xy(e),ub(e,t)}const pb=1200,gb=2500,mb=3e4,vb=t=>{if(t.shouldConnect&&null===t.ws){const e=new WebSocket(t.url),n=t.binaryType;let r=null;n&&(e.binaryType=n),t.ws=e,t.connecting=!0,t.connected=!1,e.onmessage=e=>{t.lastMessageReceived=Fp();const n=e.data,i="string"===typeof n?JSON.parse(n):n;i&&"pong"===i.type&&(clearTimeout(r),r=setTimeout(o,mb/2)),t.emit("message",[i,t])};const i=e=>{null!==t.ws&&(t.ws=null,t.connecting=!1,t.connected?(t.connected=!1,t.emit("disconnect",[{type:"disconnect",error:e},t])):t.unsuccessfulReconnects++,setTimeout(vb,Dh(Sh(t.unsuccessfulReconnects+1)*pb,gb),t)),clearTimeout(r)},o=()=>{t.ws===e&&t.send({type:"ping"})};e.onclose=()=>i(null),e.onerror=t=>i(t),e.onopen=()=>{t.lastMessageReceived=Fp(),t.connecting=!1,t.connected=!0,t.unsuccessfulReconnects=0,t.emit("connect",[{type:"connect"},t]),r=setTimeout(o,mb/2)}}};class yb extends bh{constructor(t,{binaryType:e}={}){super(),this.url=t,this.ws=null,this.binaryType=e||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval((()=>{this.connected&&mb<Fp()-this.lastMessageReceived&&this.ws.close()}),mb/2),vb(this)}send(t){this.ws&&this.ws.send(JSON.stringify(t))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0,this.connected||null!==this.ws||vb(this)}}const bb=new Map;class wb{constructor(t){this.room=t,this.onmessage=null,Hh((e=>e.key===t&&null!==this.onmessage&&this.onmessage({data:sf(e.newValue||"")})))}postMessage(t){$h.setItem(this.room,of(Qh(t)))}}const Eb="undefined"===typeof BroadcastChannel?wb:BroadcastChannel,Sb=t=>hh(bb,t,(()=>{const e=new Set,n=new Eb(t);return n.onmessage=t=>e.forEach((e=>e(t.data,"broadcastchannel"))),{bc:n,subs:e}})),Db=(t,e)=>Sb(t).subs.add(e),kb=(t,e)=>Sb(t).subs.delete(e),xb=(t,e,n=null)=>{const r=Sb(t);r.bc.postMessage(e),r.subs.forEach((t=>t(e,n)))},Cb=()=>{let t=!0;return(e,n)=>{if(t){t=!1;try{e()}finally{t=!0}}else void 0!==n&&n()}};var _b=n(4743);const Ob=0,Ab=1,Mb=2,Tb=(t,e)=>{_f(t,Ob);const n=Ug(e);Tf(t,n)},Rb=(t,e,n)=>{_f(t,Ab),Tf(t,jg(e,n))},Nb=(t,e,n)=>Rb(e,n,Yf(t)),Pb=(t,e,n)=>{try{Fg(e,Yf(t),n)}catch(r){console.error("Caught error while handling a Yjs update",r)}},Bb=(t,e)=>{_f(t,Mb),Tf(t,e)},Fb=Pb,Ib=(t,e,n,r)=>{const i=Jf(t);switch(i){case Ob:Nb(t,e,n);break;case Ab:Pb(t,n,r);break;case Mb:Fb(t,n,r);break;default:throw new Error("Unknown message type")}return i},zb=3e4;class jb extends bh{constructor(t){super(),this.doc=t,this.clientID=t.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval((()=>{const t=Fp();null!==this.getLocalState()&&zb/2<=t-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const e=[];this.meta.forEach(((n,r)=>{r!==this.clientID&&zb<=t-n.lastUpdated&&this.states.has(r)&&e.push(r)})),e.length>0&&Lb(this,e,"timeout")}),wh(zb/10)),t.on("destroy",(()=>{this.destroy()})),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){const e=this.clientID,n=this.meta.get(e),r=void 0===n?0:n.clock+1,i=this.states.get(e);null===t?this.states.delete(e):this.states.set(e,t),this.meta.set(e,{clock:r,lastUpdated:Fp()});const o=[],s=[],a=[],c=[];null===t?c.push(e):null==i?null!=t&&o.push(e):(s.push(e),Mp(i,t)||a.push(e)),(o.length>0||a.length>0||c.length>0)&&this.emit("change",[{added:o,updated:a,removed:c},"local"]),this.emit("update",[{added:o,updated:s,removed:c},"local"])}setLocalStateField(t,e){const n=this.getLocalState();null!==n&&this.setLocalState({...n,[t]:e})}getStates(){return this.states}}const Lb=(t,e,n)=>{const r=[];for(let i=0;i<e.length;i++){const n=e[i];if(t.states.has(n)){if(t.states.delete(n),n===t.clientID){const e=t.meta.get(n);t.meta.set(n,{clock:e.clock+1,lastUpdated:Fp()})}r.push(n)}}r.length>0&&(t.emit("change",[{added:[],updated:[],removed:r},n]),t.emit("update",[{added:[],updated:[],removed:r},n]))},$b=(t,e,n=t.states)=>{const r=e.length,i=Ef();_f(i,r);for(let o=0;o<r;o++){const r=e[o],s=n.get(r)||null,a=t.meta.get(r).clock;_f(i,r),_f(i,a),Af(i,JSON.stringify(s))}return Df(i)},Hb=(t,e,n)=>{const r=qf(e),i=Fp(),o=[],s=[],a=[],c=[],u=Jf(r);for(let l=0;l<u;l++){const e=Jf(r);let n=Jf(r);const u=JSON.parse(Qf(r)),l=t.meta.get(e),d=t.states.get(e),h=void 0===l?0:l.clock;(h<n||h===n&&null===u&&t.states.has(e))&&(null===u?e===t.clientID&&null!=t.getLocalState()?n++:t.states.delete(e):t.states.set(e,u),t.meta.set(e,{clock:n,lastUpdated:i}),void 0===l&&null!==u?o.push(e):void 0!==l&&null===u?c.push(e):null!==u&&(Mp(u,d)||a.push(e),s.push(e)))}(o.length>0||a.length>0||c.length>0)&&t.emit("change",[{added:o,updated:a,removed:c},n]),(o.length>0||s.length>0||c.length>0)&&t.emit("update",[{added:o,updated:s,removed:c},n])},Vb=(t,e)=>{const n=Bh(t).buffer,r=Bh(e).buffer;return crypto.subtle.importKey("raw",n,"PBKDF2",!1,["deriveKey"]).then((t=>crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},t,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])))},Wb=(t,e)=>{if(!e)return yp(t);const n=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:n},e,t).then((t=>{const e=Ef();return Af(e,"AES-GCM"),Tf(e,n),Tf(e,new Uint8Array(t)),Df(e)}))},Ub=(t,e)=>{const n=Ef();return zf(n,t),Wb(Df(n),e)},qb=(t,e)=>{if(!e)return yp(t);const n=qf(t),r=Qf(n);"AES-GCM"!==r&&vp(bp("Unknown encryption algorithm"));const i=Yf(n),o=Yf(n);return crypto.subtle.decrypt({name:"AES-GCM",iv:i},e,o).then((t=>new Uint8Array(t)))},Gb=(t,e)=>qb(t,e).then((t=>op(qf(new Uint8Array(t))))),Kb=ng("y-webrtc"),Yb=0,Xb=3,Jb=1,Zb=4,Qb=new Map,tw=new Map,ew=t=>{let e=!0;t.webrtcConns.forEach((t=>{t.synced||(e=!1)})),(!e&&t.synced||e&&!t.synced)&&(t.synced=e,t.provider.emit("synced",[{synced:e}]),Kb("synced ",Ip,t.name,zp," with all peers"))},nw=(t,e,n)=>{const r=qf(e),i=Ef(),o=Jf(r);if(void 0===t)return null;const s=t.awareness,a=t.doc;let c=!1;switch(o){case Yb:{_f(i,Yb);const e=Ib(r,i,a,t);e!==Ab||t.synced||n(),e===Ob&&(c=!0);break}case Xb:_f(i,Jb),Tf(i,$b(s,Array.from(s.getStates().keys()))),c=!0;break;case Jb:Hb(s,Yf(r),t);break;case Zb:{const e=1===Xf(r),n=Qf(r);if(n!==t.peerId&&(t.bcConns.has(n)&&!e||!t.bcConns.has(n)&&e)){const r=[],i=[];e?(t.bcConns.add(n),i.push(n)):(t.bcConns.delete(n),r.push(n)),t.provider.emit("peers",[{added:i,removed:r,webrtcPeers:Array.from(t.webrtcConns.keys()),bcPeers:Array.from(t.bcConns)}]),lw(t)}break}default:return console.error("Unable to compute message"),i}return c?i:null},rw=(t,e)=>{const n=t.room;return Kb("received message from ",Ip,t.remotePeerId,Lp," (",n.name,")",zp,Up),nw(n,e,(()=>{t.synced=!0,Kb("synced ",Ip,n.name,zp," with ",Ip,t.remotePeerId),ew(n)}))},iw=(t,e)=>{Kb("send message to ",Ip,t.remotePeerId,zp,Lp," (",t.room.name,")",Up);try{t.peer.send(Df(e))}catch(Xw){}},ow=(t,e)=>{Kb("broadcast message in ",Ip,t.name,zp),t.webrtcConns.forEach((t=>{try{t.peer.send(e)}catch(Xw){}}))};class sw{constructor(t,e,n,r){Kb("establishing connection to ",Ip,n),this.room=r,this.remotePeerId=n,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new _b({initiator:e,...r.provider.peerOpts}),this.peer.on("signal",(e=>{fw(t,r,{to:n,from:r.peerId,type:"signal",signal:e})})),this.peer.on("connect",(()=>{Kb("connected to ",Ip,n),this.connected=!0;const t=r.provider,e=t.doc,i=r.awareness,o=Ef();_f(o,Yb),Tb(o,e),iw(this,o);const s=i.getStates();if(s.size>0){const t=Ef();_f(t,Jb),Tf(t,$b(i,Array.from(s.keys()))),iw(this,t)}})),this.peer.on("close",(()=>{this.connected=!1,this.closed=!0,r.webrtcConns.has(this.remotePeerId)&&(r.webrtcConns.delete(this.remotePeerId),r.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(r.webrtcConns.keys()),bcPeers:Array.from(r.bcConns)}])),ew(r),this.peer.destroy(),Kb("closed connection to ",Ip,n),uw(r)})),this.peer.on("error",(t=>{Kb("Error in connection to ",Ip,n,": ",t),uw(r)})),this.peer.on("data",(t=>{const e=rw(this,t);null!==e&&iw(this,e)}))}destroy(){this.peer.destroy()}}const aw=(t,e)=>Wb(e,t.key).then((e=>t.mux((()=>xb(t.name,e))))),cw=(t,e)=>{t.bcconnected&&aw(t,e),ow(t,e)},uw=t=>{Qb.forEach((e=>{e.connected&&(e.send({type:"subscribe",topics:[t.name]}),t.webrtcConns.size<t.provider.maxConns&&fw(e,t,{type:"announce",from:t.peerId}))}))},lw=t=>{if(t.provider.filterBcConns){const e=Ef();_f(e,Zb),Cf(e,1),Af(e,t.peerId),aw(t,Df(e))}};class dw{constructor(t,e,n,r){this.peerId=gp(),this.doc=t,this.awareness=e.awareness,this.provider=e,this.synced=!1,this.name=n,this.key=r,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=Cb(),this.bcconnected=!1,this._bcSubscriber=t=>qb(new Uint8Array(t),r).then((t=>this.mux((()=>{const e=nw(this,t,(()=>{}));e&&aw(this,Df(e))})))),this._docUpdateHandler=(t,e)=>{const n=Ef();_f(n,Yb),Bb(n,t),cw(this,Df(n))},this._awarenessUpdateHandler=({added:t,updated:e,removed:n},r)=>{const i=t.concat(e).concat(n),o=Ef();_f(o,Jb),Tf(o,$b(this.awareness,i)),cw(this,Df(o))},this._beforeUnloadHandler=()=>{Lb(this.awareness,[t.clientID],"window unload"),tw.forEach((t=>{t.disconnect()}))},"undefined"!==typeof window?window.addEventListener("beforeunload",this._beforeUnloadHandler):"undefined"!==typeof process&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),uw(this);const t=this.name;Db(t,this._bcSubscriber),this.bcconnected=!0,lw(this);const e=Ef();_f(e,Yb),Tb(e,this.doc),aw(this,Df(e));const n=Ef();_f(n,Yb),Rb(n,this.doc),aw(this,Df(n));const r=Ef();_f(r,Xb),aw(this,Df(r));const i=Ef();_f(i,Jb),Tf(i,$b(this.awareness,[this.doc.clientID])),aw(this,Df(i))}disconnect(){Qb.forEach((t=>{t.connected&&t.send({type:"unsubscribe",topics:[this.name]})})),Lb(this.awareness,[this.doc.clientID],"disconnect");const t=Ef();_f(t,Zb),Cf(t,0),Af(t,this.peerId),aw(this,Df(t)),kb(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach((t=>t.destroy()))}destroy(){this.disconnect(),"undefined"!==typeof window?window.removeEventListener("beforeunload",this._beforeUnloadHandler):"undefined"!==typeof process&&process.off("exit",this._beforeUnloadHandler)}}const hw=(t,e,n,r)=>{if(tw.has(n))throw bp(`A Yjs Doc connected to room "${n}" already exists!`);const i=new dw(t,e,n,r);return tw.set(n,i),i},fw=(t,e,n)=>{e.key?Ub(n,e.key).then((n=>{t.send({type:"publish",topic:e.name,data:of(n)})})):t.send({type:"publish",topic:e.name,data:n})};class pw extends yb{constructor(t){super(t),this.providers=new Set,this.on("connect",(()=>{Kb(`connected (${t})`);const e=Array.from(tw.keys());this.send({type:"subscribe",topics:e}),tw.forEach((t=>fw(this,t,{type:"announce",from:t.peerId})))})),this.on("message",(t=>{switch(t.type){case"publish":{const e=t.topic,n=tw.get(e);if(null==n||"string"!==typeof e)return;const r=t=>{const e=n.webrtcConns,r=n.peerId;if(null==t||t.from===r||void 0!==t.to&&t.to!==r||n.bcConns.has(t.from))return;const i=e.has(t.from)?()=>{}:()=>n.provider.emit("peers",[{removed:[],added:[t.from],webrtcPeers:Array.from(n.webrtcConns.keys()),bcPeers:Array.from(n.bcConns)}]);switch(t.type){case"announce":e.size<n.provider.maxConns&&(hh(e,t.from,(()=>new sw(this,!0,t.from,n))),i());break;case"signal":t.to===r&&(hh(e,t.from,(()=>new sw(this,!1,t.from,n))).peer.signal(t.signal),i());break}};n.key?"string"===typeof t.data&&Gb(sf(t.data),n.key).then(r):r(t.data)}}})),this.on("disconnect",(()=>Kb(`disconnect (${t})`)))}}class gw extends bh{constructor(t,e,{signaling:n=["wss://signaling.yjs.dev","wss://y-webrtc-signaling-eu.herokuapp.com","wss://y-webrtc-signaling-us.herokuapp.com"],password:r=null,awareness:i=new jb(e),maxConns:o=20+wh(15*hp()),filterBcConns:s=!0,peerOpts:a={}}={}){super(),this.roomName=t,this.doc=e,this.filterBcConns=s,this.awareness=i,this.shouldConnect=!1,this.signalingUrls=n,this.signalingConns=[],this.maxConns=o,this.peerOpts=a,this.key=r?Vb(r,t):yp(null),this.room=null,this.key.then((n=>{this.room=hw(e,this,t,n),this.shouldConnect?this.room.connect():this.room.disconnect()})),this.connect(),this.destroy=this.destroy.bind(this),e.on("destroy",this.destroy)}get connected(){return null!==this.room&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach((t=>{const e=hh(Qb,t,(()=>new pw(t)));this.signalingConns.push(e),e.providers.add(this)})),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach((t=>{t.providers.delete(this),0===t.providers.size&&(t.destroy(),Qb.delete(t.url))})),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then((()=>{this.room.destroy(),tw.delete(this.roomName)})),super.destroy()}}const mw=t=>mp(((e,n)=>{t.onerror=t=>n(new Error(t.target.error)),t.onblocked=()=>location.reload(),t.onsuccess=t=>e(t.target.result)})),vw=(t,e)=>mp(((n,r)=>{const i=indexedDB.open(t);i.onupgradeneeded=t=>e(t.target.result),i.onerror=t=>r(bp(t.target.error)),i.onblocked=()=>location.reload(),i.onsuccess=t=>{const e=t.target.result;e.onversionchange=()=>{e.close()},"undefined"!==typeof addEventListener&&addEventListener("unload",(()=>e.close())),n(e)}})),yw=t=>mw(indexedDB.deleteDatabase(t)),bw=(t,e)=>e.forEach((e=>t.createObjectStore.apply(t,e))),ww=(t,e,n="readwrite")=>{const r=t.transaction(e,n);return e.map((t=>Tw(r,t)))},Ew=(t,e)=>mw(t.count(e)),Sw=(t,e)=>mw(t.get(e)),Dw=(t,e)=>mw(t.delete(e)),kw=(t,e,n)=>mw(t.put(e,n)),xw=(t,e)=>mw(t.add(e)),Cw=(t,e)=>mw(t.getAll(e)),_w=(t,e,n)=>{let r=null;return Mw(t,e,(t=>(r=t,!1)),n).then((()=>r))},Ow=(t,e=null)=>_w(t,e,"prev"),Aw=(t,e)=>mp(((n,r)=>{t.onerror=r,t.onsuccess=t=>{const r=t.target.result;if(null===r||!1===e(r))return n();r.continue()}})),Mw=(t,e,n,r="next")=>Aw(t.openKeyCursor(e,r),(t=>n(t.key))),Tw=(t,e)=>t.objectStore(e),Rw=(t,e)=>IDBKeyRange.upperBound(t,e),Nw=(t,e)=>IDBKeyRange.lowerBound(t,e),Pw="custom",Bw="updates",Fw=500,Iw=t=>{const[e]=ww(t.db,[Bw]);return Cw(e,Nw(t._dbref,!1)).then((e=>t._mux((()=>km(t.doc,(()=>{e.forEach((e=>Fg(t.doc,e)))}),t,!1))))).then((()=>Ow(e).then((e=>{t._dbref=e+1})))).then((()=>Ew(e).then((e=>{t._dbsize=e})))).then((()=>e))},zw=(t,e=!0)=>Iw(t).then((n=>{(e||t._dbsize>=Fw)&&xw(n,jg(t.doc)).then((()=>Dw(n,Rw(t._dbref,!0)))).then((()=>Ew(n).then((e=>{t._dbsize=e}))))}));class jw extends bh{constructor(t,e){super(),this.doc=e,this.name=t,this._mux=Cb(),this._dbref=0,this._dbsize=0,this.db=null,this.synced=!1,this._db=vw(t,(t=>bw(t,[["updates",{autoIncrement:!0}],["custom"]]))),this.whenSynced=this._db.then((t=>{this.db=t;const n=jg(e);return Iw(this).then((t=>xw(t,n))).then((()=>(this.emit("synced",[this]),this.synced=!0,this)))})),this._storeTimeout=1e3,this._storeTimeoutId=null,this._storeUpdate=t=>this._mux((()=>{if(this.db){const[e]=ww(this.db,[Bw]);xw(e,t),++this._dbsize>=Fw&&(null!==this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this._storeTimeoutId=setTimeout((()=>{zw(this,!1),this._storeTimeoutId=null}),this._storeTimeout))}})),e.on("update",this._storeUpdate),this.destroy=this.destroy.bind(this),e.on("destroy",this.destroy)}destroy(){return this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this.doc.off("update",this._storeUpdate),this.doc.off("destroy",this.destroy),this._db.then((t=>{t.close()}))}clearData(){return this.destroy().then((()=>{yw(this.name)}))}get(t){return this._db.then((e=>{const[n]=ww(e,[Pw],"readonly");return Sw(n,t)}))}set(t,e){return this._db.then((n=>{const[r]=ww(n,[Pw]);return kw(r,e,t)}))}del(t){return this._db.then((e=>{const[n]=ww(e,[Pw]);return Dw(n,t)}))}}let Lw=()=>({events:{},emit(t,...e){(this.events[t]||[]).forEach((t=>t(...e)))},on(t,e){return(this.events[t]=this.events[t]||[]).push(e),()=>this.events[t]=(this.events[t]||[]).filter((t=>t!==e))}});class $w{constructor(){this.emitter=Lw()}on(t,e){return this.emitter.on(t,e)}emit(t,e){this.emitter.emit(t,e)}}Py(r);class Hw extends $w{constructor(t,e){super(),this.users=(0,xd.qj)({}),this.id=e||(0,Dd.x0)(),this.store=fb(t);const n=db(this.store);this.syncProvider=new gw(this.id,n),this.saveProvider=new jw(this.id,n),this.syncProvider.awareness.on("change",this.__handleChanges.bind(this)),this.saveProvider.on("synced",(()=>{console.log("Save provider synced.",this.store.metadata.name),this.userId=(0,Dd.x0)(),this.syncProvider.awareness.setLocalStateField("id",this.userId),this.store.metadata.id||(this.store.metadata.id=this.id),this.store.metadata.name||(this.store.metadata.name="Untitled"),this.localUser=(0,xd.qj)(this.users[this.userId]),this.emit("synced")})),console.warn=()=>{}}close(){this.syncProvider.destroy()}updateAwareness(t,e){this.syncProvider.awareness.setLocalStateField(t,e)}registerAwarenessCallback(t,e){this.syncProvider.awareness.on(t,e)}__handleChanges(){const t=this.syncProvider.awareness.getStates().values(),e=new Set,n=new Set(Object.keys(this.users));for(const r of t){e.add(r.id),n.delete(r.id),this.users[r.id]||(this.users[r.id]={});for(const[t,e]of Object.entries(r))this.users[r.id][t]=e}for(const r of n)delete this.users[r]}}class Vw extends Hw{constructor(t,e){super(t,e),this.inverses={},this.undoStack=[],this.redoStack=[]}registerInverses(t,e){this.inverses[t]=e,this.inverses[e]=t}commit(t,e){let n=null;const r=this[t].bind(this);void 0!==r?(n=r(e),n&&(this.undoStack.push({action:t,inverseParams:n}),console.log({action:t,inverseParams:n}),this.redoStack=[])):console.error(`There is no method called ${t}() on this object:`,this)}popStackItem(t,e){if(t.length<=0)return;const n=t.pop();if(!n)return;const r=this.inverses[n.action];if(!r)return void console.error(`There is no registered inverse for ${n.action}().`);let i;const o=this[r].bind(this);void 0!==o?(i=o(n.inverseParams),e.push({action:r,inverseParams:i})):console.error(`There is no method called ${r}() on this object:`,this)}undo(){this.popStackItem(this.undoStack,this.redoStack)}redo(){this.popStackItem(this.redoStack,this.undoStack)}}function Ww(t,e,n){const r=e.split("."),i=r.length-1;for(let s=0;s<i;++s){const e=r[s];t=t[e]??(t[e]={})}const o=r[i];return void 0!==n&&(t[o]=n),t[o]}class Uw{}kd(Uw,"Note","note"),kd(Uw,"Reference","reference"),kd(Uw,"Area","area");class qw extends Vw{constructor(t){super({metadata:{},nodes:{},links:{},fragment:"xml"},t),this.remoteSelection=(0,xd.qj)(new Set),this.registerInverses("createNode","deleteNode"),this.registerInverses("createNodes","deleteNodes"),this.registerInverses("updateNode","updateNode"),this.registerInverses("updateNodes","updateNodes"),this.registerInverses("snapNode","unsnapNode"),this.registerInverses("createLink","removeLink")}createNode(t){const e=t.id?t.id:(0,Dd.x0)(),n={id:e,type:t.type,content:t.content,links:[],parent:null,children:[],identifier:null,literature:null,x:t.x?t.x:0,y:t.y?t.y:0,w:t.w?t.w:200,currentX:t.x?t.x:0,currentY:t.y?t.y:0,currentWidth:t.w?t.w:200};if(t.links)for(const r of t.links)this.createLink(r);if(t.children)for(const r of t.children)this.snapNode(r);return this.store.nodes[e]=n,e}createNodes(t){const e=[],n=[],r=[];for(const i of t){if(i.links){for(const t of i.links)n.push(t);delete i.links}if(i.children){for(const t of i.children)r.push(t);delete i.children}const t=this.createNode(i);e.push(t)}for(const i of n)this.createLink(i);for(const i of r)this.snapNode(i);return e}deleteNode(t){const e={...this.store.nodes[t]},n=[],r=[];for(const i of e.links)n.push(this.removeLink(i));for(const i of e.children)r.push(this.unsnapNode({source:e.id,target:i}));return e.links=n,e.children=r,delete this.store.nodes[t],e}deleteNodes(t){const e=[];for(const n of t){const t=this.deleteNode(n);e.push(t)}return e}updateNode(t){const e=this.store.nodes[t.id],n={id:t.id};if(t.by){n.by={};for(const[r,i]of Object.entries(t.by)){const t=Ww(e,r);"number"===typeof t?(Ww(e,r,t+i),n.by[r]=-t):console.error("Only number properties can be updated by a number!")}}if(t.set){n.set={};for(const[r,i]of Object.entries(t.set)){const t=Ww(e,r);Ww(e,r,i),n.set[r]=t}}return n}updateNodes(t){const e={id:[...t.id]};if(t.by){e.by={};for(const[n,r]of Object.entries(t.by))e.by[n]=-r;for(const e of t.id)this.updateNode({id:e,by:t.by})}if(t.set){e.set={};for(const n of t.id){e.set[n]={};const r=this.store.nodes[n];for(const i of Object.keys(t.set[n]))e.set[n][i]=Ww(r,i);this.updateNode({id:n,set:t.set[n]})}}return e}snapNode(t){const e={};if(!t.source||!t.target)return!1;const n=this.store.nodes[t.source],r=this.store.nodes[t.target];return(n.type===Uw.Area||0===n.children.length)&&(n.children.push(t.target),n.children.filter(((t,e)=>n.children.indexOf(t)===e)),r.parent=n.id,e.source=t.source,e.target=t.target),!!e.source&&e}unsnapNode(t){const e={};if(!t.source||!t.target)return!1;const n=this.store.nodes[t.source],r=this.store.nodes[t.target],i=n.children.indexOf(t.target);return i>-1&&(n.children.splice(i,1),r.parent=null,e.source=t.source,e.target=t.target),!!e.source&&e}createLink(t){const e=this.store.nodes[t.source],n=this.store.nodes[t.target],r=t.id?t.id:(0,Dd.x0)(),i={id:r,source:t.source,target:t.target};return this.store.links[r]=i,e.links.push(r),e.links.filter(((t,n)=>e.links.indexOf(t)===n)),n.links.push(r),n.links.filter(((t,e)=>n.links.indexOf(t)===e)),r}removeLink(t){const e={...this.store.links[t]},n=this.store.nodes[e.source],r=this.store.nodes[e.target];return n.links.splice(n.links.indexOf(t),1),r.links.splice(r.links.indexOf(t),1),delete this.store.links[t],e}}const Gw=qw,Kw=Uw;Symbol("document");var Yw=["Shift","Meta","Alt","Control"],Xw="object"==typeof navigator&&/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"Meta":"Control";function Jw(t,e){return"function"==typeof t.getModifierState&&t.getModifierState(e)}function Zw(t){return t.trim().split(" ").map((function(t){var e=t.split(/\b\+/),n=e.pop();return[e=e.map((function(t){return"$mod"===t?Xw:t})),n]}))}function Qw(t,e){var n;void 0===e&&(e={});var r=null!=(n=e.timeout)?n:1e3,i=Object.keys(t).map((function(e){return[Zw(e),t[e]]})),o=new Map,s=null;return function(t){t instanceof KeyboardEvent&&(i.forEach((function(e){var n=e[0],r=e[1],i=o.get(n)||n;!function(t,e){return!(e[1].toUpperCase()!==t.key.toUpperCase()&&e[1]!==t.code||e[0].find((function(e){return!Jw(t,e)}))||Yw.find((function(n){return!e[0].includes(n)&&e[1]!==n&&Jw(t,n)})))}(t,i[0])?Jw(t,t.key)||o.delete(n):i.length>1?o.set(n,i.slice(1)):(o.delete(n),r(t))})),s&&clearTimeout(s),s=setTimeout(o.clear.bind(o),r))}}class tE{constructor(){this.handlers=[]}on(t,e,n){const r={};r[e]=n;const i=Qw(r);window.addEventListener(t,i),this.handlers.push({event:t,handler:i})}removeListeners(){for(let t of this.handlers)window.removeEventListener(t.event,t.handler)}}function eE(t,e,n,r,i,a){const c=(0,o.up)("note-editor"),u=(0,o.up)("va-card-content"),l=(0,o.up)("va-card");return(0,o.wg)(),(0,o.j4)(l,{class:(0,s.C_)(["node",{selected:t.selection.value.includes(t.node.id),dropping:t.dropping.value===t.node.id,noselect:t.editing.value!==t.node.id,clickthrough:t.dragging.value&&t.selection.value.includes(t.node.id),selectable:!t.selectedByRemoteUsers,"remote-selected":t.selectedByRemoteUsers,"snap-top":!t.node.parent&&t.node.children.length>0,"snap-middle":t.node.parent&&t.node.children.length>0,"snap-bottom":t.node.parent&&0===t.node.children.length,reference:t.isReference}]),ref:"node",id:t.node.id,style:(0,s.j5)(t.styles),color:t.isReference?"#88b0e0":"white",gradient:t.isReference,onMouseenter:t.onMouseEnter,onMouseleave:t.onMouseLeave},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"content"},{default:(0,o.w5)((()=>[t.isNote?((0,o.wg)(),(0,o.j4)(c,{key:0,id:t.node.id,content:t.node.content,editing:t.editing.value===t.node.id,onChange:t.parseNoteContent},null,8,["id","content","editing","onChange"])):(0,o.kq)("",!0),(0,o.Uk)(" "+(0,s.zw)(t.node.identifier),1)])),_:1})])),_:1},8,["id","class","style","color","gradient","onMouseenter","onMouseleave"])}var nE=n(3643);const rE={class:"note",ref:"note"};function iE(t,e,n,r,i,s){const a=(0,o.up)("editor-content");return(0,o.wg)(),(0,o.iD)("div",rE,[(0,o.Wm)(a,{editor:t.editor},null,8,["editor"])],512)}function oE(t){this.content=t}oE.prototype={constructor:oE,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return-1==e?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),o=r.content.slice();return-1==i?o.push(n||t,e):(o[i+1]=e,n&&(o[i]=n)),new oE(o)},remove:function(t){var e=this.find(t);if(-1==e)return this;var n=this.content.slice();return n.splice(e,2),new oE(n)},addToStart:function(t,e){return new oE([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new oE(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),o=r.find(t);return i.splice(-1==o?i.length:o,0,e,n),new oE(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=oE.from(t),t.size?new oE(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=oE.from(t),t.size?new oE(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=oE.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},get size(){return this.content.length>>1}},oE.from=function(t){if(t instanceof oE)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new oE(e)};var sE=oE,aE=sE;function cE(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var i=t.child(r),o=e.child(r);if(i!=o){if(!i.sameMarkup(o))return n;if(i.isText&&i.text!=o.text){for(var s=0;i.text[s]==o.text[s];s++)n++;return n}if(i.content.size||o.content.size){var a=cE(i.content,o.content,n+1);if(null!=a)return a}n+=i.nodeSize}else n+=i.nodeSize}}function uE(t,e,n,r){for(var i=t.childCount,o=e.childCount;;){if(0==i||0==o)return i==o?null:{a:n,b:r};var s=t.child(--i),a=e.child(--o),c=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){var u=0,l=Math.min(s.text.length,a.text.length);while(u<l&&s.text[s.text.length-u-1]==a.text[a.text.length-u-1])u++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var d=uE(s.content,a.content,n-1,r-1);if(d)return d}n-=c,r-=c}else n-=c,r-=c}}var lE=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},dE={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};lE.prototype.nodesBetween=function(t,e,n,r,i){void 0===r&&(r=0);for(var o=0,s=0;s<e;o++){var a=this.content[o],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,i,o)&&a.content.size){var u=s+1;a.nodesBetween(Math.max(0,t-u),Math.min(a.content.size,e-u),n,r+u)}s=c}},lE.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},lE.prototype.textBetween=function(t,e,n,r){var i="",o=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(i+=s.text.slice(Math.max(t,a)-a,e-a),o=!n):s.isLeaf&&r?(i+="function"===typeof r?r(s):r,o=!n):!o&&s.isBlock&&(i+=n,o=!0)}),0),i},lE.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),i=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),i=1);i<t.content.length;i++)r.push(t.content[i]);return new lE(r,this.size+t.size)},lE.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var i=0,o=0;o<e;i++){var s=this.content[i],a=o+s.nodeSize;a>t&&((o<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-o),Math.min(s.text.length,e-o)):s.cut(Math.max(0,t-o-1),Math.min(s.content.size,e-o-1))),n.push(s),r+=s.nodeSize),o=a}return new lE(n,r)},lE.prototype.cutByIndex=function(t,e){return t==e?lE.empty:0==t&&e==this.content.length?this:new lE(this.content.slice(t,e))},lE.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),i=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new lE(r,i)},lE.prototype.addToStart=function(t){return new lE([t].concat(this.content),this.size+t.nodeSize)},lE.prototype.addToEnd=function(t){return new lE(this.content.concat(t),this.size+t.nodeSize)},lE.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},dE.firstChild.get=function(){return this.content.length?this.content[0]:null},dE.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},dE.childCount.get=function(){return this.content.length},lE.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},lE.prototype.maybeChild=function(t){return this.content[t]},lE.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},lE.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),cE(this,t,e)},lE.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),uE(this,t,e,n)},lE.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return fE(0,t);if(t==this.size)return fE(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var i=this.child(n),o=r+i.nodeSize;if(o>=t)return o==t||e>0?fE(n+1,o):fE(n,r);r=o}},lE.prototype.toString=function(){return"<"+this.toStringInner()+">"},lE.prototype.toStringInner=function(){return this.content.join(", ")},lE.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},lE.fromJSON=function(t,e){if(!e)return lE.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new lE(e.map(t.nodeFromJSON))},lE.fromArray=function(t){if(!t.length)return lE.empty;for(var e,n=0,r=0;r<t.length;r++){var i=t[r];n+=i.nodeSize,r&&i.isText&&t[r-1].sameMarkup(i)?(e||(e=t.slice(0,r)),e[e.length-1]=i.withText(e[e.length-1].text+i.text)):e&&e.push(i)}return new lE(e||t,n)},lE.from=function(t){if(!t)return lE.empty;if(t instanceof lE)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new lE([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(lE.prototype,dE);var hE={index:0,offset:0};function fE(t,e){return hE.index=t,hE.offset=e,hE}function pE(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!pE(t[r],e[r]))return!1}else{for(var i in t)if(!(i in e)||!pE(t[i],e[i]))return!1;for(var o in e)if(!(o in t))return!1}return!0}lE.empty=new lE([],0);var gE=function(t,e){this.type=t,this.attrs=e};function mE(t){var e=Error.call(this,t);return e.__proto__=mE.prototype,e}gE.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var i=t[r];if(this.eq(i))return t;if(this.type.excludes(i.type))e||(e=t.slice(0,r));else{if(i.type.excludes(this.type))return t;!n&&i.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(i)}}return e||(e=t.slice()),n||e.push(this),e},gE.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},gE.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},gE.prototype.eq=function(t){return this==t||this.type==t.type&&pE(this.attrs,t.attrs)},gE.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},gE.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},gE.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},gE.setFrom=function(t){if(!t||0==t.length)return gE.none;if(t instanceof gE)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},gE.none=[],mE.prototype=Object.create(Error.prototype),mE.prototype.constructor=mE,mE.prototype.name="ReplaceError";var vE=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},yE={size:{configurable:!0}};function bE(t,e,n){var r=t.findIndex(e),i=r.index,o=r.offset,s=t.maybeChild(i),a=t.findIndex(n),c=a.index,u=a.offset;if(o==e||s.isText){if(u!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(i!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(i,s.copy(bE(s.content,e-o-1,n-o-1)))}function wE(t,e,n,r){var i=t.findIndex(e),o=i.index,s=i.offset,a=t.maybeChild(o);if(s==e||a.isText)return r&&!r.canReplace(o,o,n)?null:t.cut(0,e).append(n).append(t.cut(e));var c=wE(a.content,e-s-1,n);return c&&t.replaceChild(o,a.copy(c))}function EE(t,e,n){if(n.openStart>t.depth)throw new mE("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new mE("Inconsistent open depths");return SE(t,e,n,0)}function SE(t,e,n,r){var i=t.index(r),o=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){var s=SE(t,e,n,r+1);return o.copy(o.content.replaceChild(i,s))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var a=ME(n,t),c=a.start,u=a.end;return _E(o,OE(t,c,u,e,r))}var l=t.parent,d=l.content;return _E(l,d.cut(0,t.parentOffset).append(n.content).append(d.cut(e.parentOffset)))}return _E(o,AE(t,e,r))}function DE(t,e){if(!e.type.compatibleContent(t.type))throw new mE("Cannot join "+e.type.name+" onto "+t.type.name)}function kE(t,e,n){var r=t.node(n);return DE(r,e.node(n)),r}function xE(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function CE(t,e,n,r){var i=(e||t).node(n),o=0,s=e?e.index(n):i.childCount;t&&(o=t.index(n),t.depth>n?o++:t.textOffset&&(xE(t.nodeAfter,r),o++));for(var a=o;a<s;a++)xE(i.child(a),r);e&&e.depth==n&&e.textOffset&&xE(e.nodeBefore,r)}function _E(t,e){if(!t.type.validContent(e))throw new mE("Invalid content for node "+t.type.name);return t.copy(e)}function OE(t,e,n,r,i){var o=t.depth>i&&kE(t,e,i+1),s=r.depth>i&&kE(n,r,i+1),a=[];return CE(null,t,i,a),o&&s&&e.index(i)==n.index(i)?(DE(o,s),xE(_E(o,OE(t,e,n,r,i+1)),a)):(o&&xE(_E(o,AE(t,e,i+1)),a),CE(e,n,i,a),s&&xE(_E(s,AE(n,r,i+1)),a)),CE(r,null,i,a),new lE(a)}function AE(t,e,n){var r=[];if(CE(null,t,n,r),t.depth>n){var i=kE(t,e,n+1);xE(_E(i,AE(t,e,n+1)),r)}return CE(e,null,n,r),new lE(r)}function ME(t,e){for(var n=e.depth-t.openStart,r=e.node(n),i=r.copy(t.content),o=n-1;o>=0;o--)i=e.node(o).copy(lE.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}yE.size.get=function(){return this.content.size-this.openStart-this.openEnd},vE.prototype.insertAt=function(t,e){var n=wE(this.content,t+this.openStart,e,null);return n&&new vE(n,this.openStart,this.openEnd)},vE.prototype.removeBetween=function(t,e){return new vE(bE(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},vE.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},vE.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},vE.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},vE.fromJSON=function(t,e){if(!e)return vE.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new vE(lE.fromJSON(t,e.content),n,r)},vE.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,i=t.firstChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.firstChild)n++;for(var o=t.lastChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.lastChild)r++;return new vE(t,n,r)},Object.defineProperties(vE.prototype,yE),vE.empty=new vE(lE.empty,0,0);var TE=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},RE={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};TE.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},RE.parent.get=function(){return this.node(this.depth)},RE.doc.get=function(){return this.node(0)},TE.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},TE.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},TE.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},TE.prototype.start=function(t){return t=this.resolveDepth(t),0==t?0:this.path[3*t-1]+1},TE.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},TE.prototype.before=function(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},TE.prototype.after=function(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},RE.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},RE.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},RE.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},TE.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,i=0;i<t;i++)r+=n.child(i).nodeSize;return r},TE.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return gE.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var i=n;n=r,r=i}for(var o=n.marks,s=0;s<o.length;s++)!1!==o[s].type.spec.inclusive||r&&o[s].isInSet(r.marks)||(o=o[s--].removeFromSet(o));return o},TE.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),i=0;i<n.length;i++)!1!==n[i].type.spec.inclusive||r&&n[i].isInSet(r.marks)||(n=n[i--].removeFromSet(n));return n},TE.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},TE.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new FE(this,t,n)},TE.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},TE.prototype.max=function(t){return t.pos>this.pos?t:this},TE.prototype.min=function(t){return t.pos<this.pos?t:this},TE.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},TE.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,i=e,o=t;;){var s=o.content.findIndex(i),a=s.index,c=s.offset,u=i-c;if(n.push(o,a,r+c),!u)break;if(o=o.child(a),o.isText)break;i=u-1,r+=c+1}return new TE(e,n,i)},TE.resolveCached=function(t,e){for(var n=0;n<NE.length;n++){var r=NE[n];if(r.pos==e&&r.doc==t)return r}var i=NE[PE]=TE.resolve(t,e);return PE=(PE+1)%BE,i},Object.defineProperties(TE.prototype,RE);var NE=[],PE=0,BE=12,FE=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},IE={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};IE.start.get=function(){return this.$from.before(this.depth+1)},IE.end.get=function(){return this.$to.after(this.depth+1)},IE.parent.get=function(){return this.$from.node(this.depth)},IE.startIndex.get=function(){return this.$from.index(this.depth)},IE.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(FE.prototype,IE);var zE=Object.create(null),jE=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||lE.empty,this.marks=r||gE.none},LE={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};LE.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},LE.childCount.get=function(){return this.content.childCount},jE.prototype.child=function(t){return this.content.child(t)},jE.prototype.maybeChild=function(t){return this.content.maybeChild(t)},jE.prototype.forEach=function(t){this.content.forEach(t)},jE.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},jE.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},LE.textContent.get=function(){return this.textBetween(0,this.content.size,"")},jE.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},LE.firstChild.get=function(){return this.content.firstChild},LE.lastChild.get=function(){return this.content.lastChild},jE.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},jE.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},jE.prototype.hasMarkup=function(t,e,n){return this.type==t&&pE(this.attrs,e||t.defaultAttrs||zE)&&gE.sameSet(this.marks,n||gE.none)},jE.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},jE.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},jE.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},jE.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return vE.empty;var r=this.resolve(t),i=this.resolve(e),o=n?0:r.sharedDepth(e),s=r.start(o),a=r.node(o),c=a.content.cut(r.pos-s,i.pos-s);return new vE(c,r.depth-o,i.depth-o)},jE.prototype.replace=function(t,e,n){return EE(this.resolve(t),this.resolve(e),n)},jE.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,i=n.offset;if(e=e.maybeChild(r),!e)return null;if(i==t||e.isText)return e;t-=i+1}},jE.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},jE.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}},jE.prototype.resolve=function(t){return TE.resolveCached(this,t)},jE.prototype.resolveNoCache=function(t){return TE.resolve(this,t)},jE.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},LE.isBlock.get=function(){return this.type.isBlock},LE.isTextblock.get=function(){return this.type.isTextblock},LE.inlineContent.get=function(){return this.type.inlineContent},LE.isInline.get=function(){return this.type.isInline},LE.isText.get=function(){return this.type.isText},LE.isLeaf.get=function(){return this.type.isLeaf},LE.isAtom.get=function(){return this.type.isAtom},jE.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),HE(this.marks,t)},jE.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},jE.prototype.canReplace=function(t,e,n,r,i){void 0===n&&(n=lE.empty),void 0===r&&(r=0),void 0===i&&(i=n.childCount);var o=this.contentMatchAt(t).matchFragment(n,r,i),s=o&&o.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(var a=r;a<i;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},jE.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var i=this.contentMatchAt(t).matchType(n),o=i&&i.matchFragment(this.content,e);return!!o&&o.validEnd},jE.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},jE.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));for(var t=gE.none,e=0;e<this.marks.length;e++)t=this.marks[e].addToSet(t);if(!gE.sameSet(t,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map((function(t){return t.type.name})));this.content.forEach((function(t){return t.check()}))},jE.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},jE.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=lE.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(jE.prototype,LE);var $E=function(t){function e(e,n,r,i){if(t.call(this,e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):HE(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(jE);function HE(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var VE=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},WE={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};VE.parse=function(t,e){var n=new UE(t,e);if(null==n.next)return VE.empty;var r=GE(n);n.next&&n.err("Unexpected trailing text");var i=rS(tS(r));return iS(i,n),i},VE.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},VE.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,i=e;r&&i<n;i++)r=r.matchType(t.child(i).type);return r},WE.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},WE.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},VE.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},VE.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];function i(o,s){var a=o.matchFragment(t,n);if(a&&(!e||a.validEnd))return lE.from(s.map((function(t){return t.createAndFill()})));for(var c=0;c<o.next.length;c+=2){var u=o.next[c],l=o.next[c+1];if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(l)){r.push(l);var d=i(l,s.concat(u));if(d)return d}}}return i(this,[])},VE.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},VE.prototype.computeWrapping=function(t){var e=Object.create(null),n=[{match:this,type:null,via:null}];while(n.length){var r=n.shift(),i=r.match;if(i.matchType(t)){for(var o=[],s=r;s.type;s=s.via)o.push(s.type);return o.reverse()}for(var a=0;a<i.next.length;a+=2){var c=i.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!i.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},WE.edgeCount.get=function(){return this.next.length>>1},VE.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},VE.prototype.toString=function(){var t=[];function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}return e(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",i=0;i<e.next.length;i+=2)r+=(i?", ":"")+e.next[i].name+"->"+t.indexOf(e.next[i+1]);return r})).join("\n")},Object.defineProperties(VE.prototype,WE),VE.empty=new VE(!0);var UE=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},qE={next:{configurable:!0}};function GE(t){var e=[];do{e.push(KE(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function KE(t){var e=[];do{e.push(YE(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function YE(t){for(var e=QE(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=JE(t,e)}return e}function XE(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function JE(t,e){var n=XE(t),r=n;return t.eat(",")&&(r="}"!=t.next?XE(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function ZE(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var i=[];for(var o in n){var s=n[o];s.groups.indexOf(e)>-1&&i.push(s)}return 0==i.length&&t.err("No node type or group '"+e+"' found"),i}function QE(t){if(t.eat("(")){var e=GE(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=ZE(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}function tS(t){var e=[[]];return i(o(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var i={term:r,to:n};return e[t].push(i),i}function i(t,e){t.forEach((function(t){return t.to=e}))}function o(t,e){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(o(n,e))}),[]);if("seq"==t.type)for(var s=0;;s++){var a=o(t.exprs[s],e);if(s==t.exprs.length-1)return a;i(a,e=n())}else{if("star"==t.type){var c=n();return r(e,c),i(o(t.expr,c),c),[r(c)]}if("plus"==t.type){var u=n();return i(o(t.expr,e),u),i(o(t.expr,u),u),[r(u)]}if("opt"==t.type)return[r(e)].concat(o(t.expr,e));if("range"==t.type){for(var l=e,d=0;d<t.min;d++){var h=n();i(o(t.expr,l),h),l=h}if(-1==t.max)i(o(t.expr,l),l);else for(var f=t.min;f<t.max;f++){var p=n();r(l,p),i(o(t.expr,l),p),l=p}return[r(l)]}if("name"==t.type)return[r(e,null,t.value)]}}}function eS(t,e){return e-t}function nS(t,e){var n=[];return r(e),n.sort(eS);function r(e){var i=t[e];if(1==i.length&&!i[0].term)return r(i[0].to);n.push(e);for(var o=0;o<i.length;o++){var s=i[o],a=s.term,c=s.to;a||-1!=n.indexOf(c)||r(c)}}}function rS(t){var e=Object.create(null);return n(nS(t,0));function n(r){var i=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var o=i.indexOf(n),s=o>-1&&i[o+1];nS(t,r).forEach((function(t){s||i.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var o=e[r.join(",")]=new VE(r.indexOf(t.length-1)>-1),s=0;s<i.length;s+=2){var a=i[s+1].sort(eS);o.next.push(i[s],e[a.join(",")]||n(a))}return o}}function iS(t,e){for(var n=0,r=[t];n<r.length;n++){for(var i=r[n],o=!i.validEnd,s=[],a=0;a<i.next.length;a+=2){var c=i.next[a],u=i.next[a+1];s.push(c.name),!o||c.isText||c.hasRequiredAttrs()||(o=!1),-1==r.indexOf(u)&&r.push(u)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function oS(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function sS(t,e){var n=Object.create(null);for(var r in t){var i=e&&e[r];if(void 0===i){var o=t[r];if(!o.hasDefault)throw new RangeError("No value supplied for attribute "+r);i=o.default}n[r]=i}return n}function aS(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new lS(t[n]);return e}qE.next.get=function(){return this.tokens[this.pos]},UE.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},UE.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(UE.prototype,qE);var cS=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=aS(n.attrs),this.defaultAttrs=oS(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},uS={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0},whitespace:{configurable:!0}};uS.isInline.get=function(){return!this.isBlock},uS.isTextblock.get=function(){return this.isBlock&&this.inlineContent},uS.isLeaf.get=function(){return this.contentMatch==VE.empty},uS.isAtom.get=function(){return this.isLeaf||this.spec.atom},uS.whitespace.get=function(){return this.spec.whitespace||(this.spec.code?"pre":"normal")},cS.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},cS.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},cS.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:sS(this.attrs,t)},cS.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new jE(this,this.computeAttrs(t),lE.from(e),gE.setFrom(n))},cS.prototype.createChecked=function(t,e,n){if(e=lE.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new jE(this,this.computeAttrs(t),e,gE.setFrom(n))},cS.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),e=lE.from(e),e.size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var i=this.contentMatch.matchFragment(e).fillBefore(lE.empty,!0);return i?new jE(this,t,e.append(i),gE.setFrom(n)):null},cS.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},cS.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},cS.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},cS.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:gE.empty:t},cS.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new cS(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var i in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(cS.prototype,uS);var lS=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},dS={isRequired:{configurable:!0}};dS.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(lS.prototype,dS);var hS=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=aS(r.attrs),this.rank=e,this.excluded=null;var i=oS(this.attrs);this.instance=i&&new gE(this,i)};hS.prototype.create=function(t){return!t&&this.instance?this.instance:new gE(this,sS(this.attrs,t))},hS.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,i){return n[t]=new hS(t,r++,e,i)})),n},hS.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t},hS.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},hS.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var fS=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=aE.from(t.nodes),this.spec.marks=aE.from(t.marks),this.nodes=cS.compile(this.spec.nodes,this),this.marks=hS.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var i=this.nodes[r],o=i.spec.content||"",s=i.spec.marks;i.contentMatch=n[o]||(n[o]=VE.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.markSet="_"==s?null:s?pS(this,s.split(" ")):""!=s&&i.inlineContent?null:[]}for(var a in this.marks){var c=this.marks[a],u=c.spec.excludes;c.excluded=null==u?[c]:""==u?[]:pS(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function pS(t,e){for(var n=[],r=0;r<e.length;r++){var i=e[r],o=t.marks[i],s=o;if(o)n.push(o);else for(var a in t.marks){var c=t.marks[a];("_"==i||c.spec.group&&c.spec.group.split(" ").indexOf(i)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}fS.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof cS))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},fS.prototype.text=function(t,e){var n=this.nodes.text;return new $E(n,n.defaultAttrs,t,gE.setFrom(e))},fS.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},fS.prototype.nodeFromJSON=function(t){return jE.fromJSON(this,t)},fS.prototype.markFromJSON=function(t){return gE.fromJSON(this,t)},fS.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var gS=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};gS.prototype.parse=function(t,e){void 0===e&&(e={});var n=new kS(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},gS.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new kS(this,e,!0);return n.addAll(t,null,e.from,e.to),vE.maxOpen(n.finish())},gS.prototype.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var i=this.tags[r];if(_S(t,i.tag)&&(void 0===i.namespace||t.namespaceURI==i.namespace)&&(!i.context||e.matchesContext(i.context))){if(i.getAttrs){var o=i.getAttrs(t);if(!1===o)continue;i.attrs=o}return i}}},gS.prototype.matchStyle=function(t,e,n,r){for(var i=r?this.styles.indexOf(r)+1:0;i<this.styles.length;i++){var o=this.styles[i];if(!(0!=o.style.indexOf(t)||o.context&&!n.matchesContext(o.context)||o.style.length>t.length&&(61!=o.style.charCodeAt(t.length)||o.style.slice(t.length+1)!=e))){if(o.getAttrs){var s=o.getAttrs(e);if(!1===s)continue;o.attrs=s}return o}}},gS.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var i=e[r],o=null==i.priority?50:i.priority;if(o<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=AS(t)),t.mark=e}))};for(var i in t.marks)r(i);var o=function(e){var r=t.nodes[s].spec.parseDOM;r&&r.forEach((function(t){n(t=AS(t)),t.node=s}))};for(var s in t.nodes)o();return e},gS.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new gS(t,gS.schemaRules(t)))};var mS={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},vS={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},yS={ol:!0,ul:!0},bS=1,wS=2,ES=4;function SS(t,e,n){return null!=e?(e?bS:0)|("full"===e?wS:0):t&&"pre"==t.whitespace?bS|wS:n&~ES}var DS=function(t,e,n,r,i,o,s){this.type=t,this.attrs=e,this.solid=i,this.match=o||(s&ES?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=gE.none,this.pendingMarks=r,this.stashMarks=[]};DS.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(lE.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},DS.prototype.finish=function(t){if(!(this.options&bS)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=lE.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(lE.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},DS.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},DS.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):MS(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}},DS.prototype.inlineContext=function(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!mS.hasOwnProperty(t.parentNode.nodeName.toLowerCase())};var kS=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,i=e.topNode,o=SS(null,e.preserveWhitespace,0)|(n?ES:0);r=i?new DS(i.type,i.attrs,gE.none,gE.none,!0,e.topMatch||i.type.contentMatch,o):new DS(n?null:t.schema.topNodeType,null,gE.none,gE.none,!0,null,o),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},xS={top:{configurable:!0},currentPos:{configurable:!0}};function CS(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&yS.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}function _S(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function OS(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];while(e=n.exec(t))r.push(e[1],e[2].trim());return r}function AS(t){var e={};for(var n in t)e[n]=t[n];return e}function MS(t,e){var n=e.schema.nodes,r=function(r){var i=n[r];if(i.allowsMarkType(t)){var o=[],s=function(t){o.push(t);for(var n=0;n<t.edgeCount;n++){var r=t.edge(n),i=r.type,a=r.next;if(i==e)return!0;if(o.indexOf(a)<0&&s(a))return!0}};return s(i.contentMatch)?{v:!0}:void 0}};for(var i in n){var o=r(i);if(o)return o.v}}function TS(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}xS.top.get=function(){return this.nodes[this.open]},kS.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(OS(e)):null,r=this.top;if(null!=n)for(var i=0;i<n.length;i++)this.addPendingMark(n[i]);if(this.addElement(t),null!=n)for(var o=0;o<n.length;o++)this.removePendingMark(n[o],r)}},kS.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if(n.options&wS||n.inlineContext(t)||/[^ \t\r\n\u000c]/.test(e)){if(n.options&bS)e=n.options&wS?e.replace(/\r\n?/g,"\n"):e.replace(/\r?\n|\r/g," ");else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],i=t.previousSibling;(!r||i&&"BR"==i.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},kS.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();yS.hasOwnProperty(r)&&this.parser.normalizeLists&&CS(t);var i=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(i?i.ignore:vS.hasOwnProperty(r))this.findInside(t),this.ignoreFallback(t);else if(!i||i.skip||i.closeParent){i&&i.closeParent?this.open=Math.max(0,this.open-1):i&&i.skip.nodeType&&(t=i.skip);var o,s=this.top,a=this.needsBlock;if(mS.hasOwnProperty(r))o=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),o&&this.sync(s),this.needsBlock=a}else this.addElementByRule(t,i,!1===i.consuming?n:null)},kS.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},kS.prototype.ignoreFallback=function(t){"BR"!=t.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))},kS.prototype.readStyles=function(t){var e=gE.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var i=this.parser.matchStyle(t[n],t[n+1],this,r);if(!i)continue t;if(i.ignore)return null;if(e=this.parser.schema.marks[i.mark].create(i.attrs).addToSet(e),!1!==i.consuming)break;r=i}return e},kS.prototype.addElementByRule=function(t,e,n){var r,i,o,s,a=this;e.node?(i=this.parser.schema.nodes[e.node],i.isLeaf?this.insertNode(i.create(e.attrs))||this.leafFallback(t):r=this.enter(i,e.attrs,e.preserveWhitespace)):(o=this.parser.schema.marks[e.mark],s=o.create(e.attrs),this.addPendingMark(s));var c=this.top;if(i&&i.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return a.insertNode(t)}));else{var u=e.contentElement;"string"==typeof u?u=t.querySelector(u):"function"==typeof u&&(u=u(t)),u||(u=t),this.findAround(t,u,!0),this.addAll(u,r)}r&&(this.sync(c),this.open--),s&&this.removePendingMark(s,c)},kS.prototype.addAll=function(t,e,n,r){for(var i=n||0,o=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];o!=s;o=o.nextSibling,++i)this.findAtPoint(t,i),this.addDOM(o),e&&mS.hasOwnProperty(o.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,i)},kS.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var i=this.nodes[r],o=i.findWrapping(t);if(o&&(!e||e.length>o.length)&&(e=o,n=i,!o.length))break;if(i.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},kS.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,i=0;i<t.marks.length;i++)n.type&&!n.type.allowsMarkType(t.marks[i].type)||(r=t.marks[i].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},kS.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},kS.prototype.enterInner=function(t,e,n,r){this.closeExtra();var i=this.top;i.applyPending(t),i.match=i.match&&i.match.matchType(t,e);var o=SS(t,r,i.options);i.options&ES&&0==i.content.length&&(o|=ES),this.nodes.push(new DS(t,e,i.activeMarks,i.pendingMarks,n,null,o)),this.open++},kS.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},kS.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},kS.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},xS.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},kS.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},kS.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},kS.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++)if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node)){var i=e.compareDocumentPosition(this.find[r].node);i&(n?2:4)&&(this.find[r].pos=this.currentPos)}},kS.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},kS.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=function(t,a){for(;t>=0;t--){var c=n[t];if(""==c){if(t==n.length-1||0==t)continue;for(;a>=o;a--)if(s(t-1,a))return!0;return!1}var u=a>0||0==a&&i?e.nodes[a].type:r&&a>=o?r.node(a-o).type:null;if(!u||u.name!=c&&-1==u.groups.indexOf(c))return!1;a--}return!0};return s(n.length-1,this.open)},kS.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var i=this.parser.schema.nodes[r];if(i.isTextblock&&i.defaultAttrs)return i}},kS.prototype.addPendingMark=function(t){var e=TS(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},kS.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n],i=r.pendingMarks.lastIndexOf(t);if(i>-1)r.pendingMarks=t.removeFromSet(r.pendingMarks);else{r.activeMarks=t.removeFromSet(r.activeMarks);var o=r.popFromStashMark(t);o&&r.type&&r.type.allowsMarkType(o.type)&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==e)break}},Object.defineProperties(kS.prototype,xS);var RS=function(t,e){this.nodes=t||{},this.marks=e||{}};function NS(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function PS(t){return t.document||window.document}RS.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=PS(e).createDocumentFragment());var i=n,o=null;return t.forEach((function(t){if(o||t.marks.length){o||(o=[]);var n=0,s=0;while(n<o.length&&s<t.marks.length){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(o[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}while(n<o.length)i=o.pop(),o.pop();while(s<t.marks.length){var c=t.marks[s++],u=r.serializeMark(c,t.isInline,e);u&&(o.push(c,i),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(r.serializeNodeInner(t,e))})),n},RS.prototype.serializeNodeInner=function(t,e){void 0===e&&(e={});var n=RS.renderSpec(PS(e),this.nodes[t.type.name](t)),r=n.dom,i=n.contentDOM;if(i){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,i,e):this.serializeFragment(t.content,e,i)}return r},RS.prototype.serializeNode=function(t,e){void 0===e&&(e={});for(var n=this.serializeNodeInner(t,e),r=t.marks.length-1;r>=0;r--){var i=this.serializeMark(t.marks[r],t.isInline,e);i&&((i.contentDOM||i.dom).appendChild(n),n=i.dom)}return n},RS.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&RS.renderSpec(PS(n),r(t,e))},RS.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],i=r.indexOf(" ");i>0&&(n=r.slice(0,i),r=r.slice(i+1));var o=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var u in c=2,a)if(null!=a[u]){var l=u.indexOf(" ");l>0?s.setAttributeNS(u.slice(0,l),u.slice(l+1),a[u]):s.setAttribute(u,a[u])}for(var d=c;d<e.length;d++){var h=e[d];if(0===h){if(d<e.length-1||d>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var f=RS.renderSpec(t,h,n),p=f.dom,g=f.contentDOM;if(s.appendChild(p),g){if(o)throw new RangeError("Multiple content holes");o=g}}return{dom:s,contentDOM:o}},RS.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new RS(this.nodesFromSchema(t),this.marksFromSchema(t)))},RS.nodesFromSchema=function(t){var e=NS(t.nodes);return e.text||(e.text=function(t){return t.text}),e},RS.marksFromSchema=function(t){return NS(t.marks)};var BS=65535,FS=Math.pow(2,16);function IS(t,e){return t+e*FS}function zS(t){return t&BS}function jS(t){return(t-(t&BS))/FS}var LS=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=null),this.pos=t,this.deleted=e,this.recover=n},$S=function t(e,n){if(void 0===n&&(n=!1),!e.length&&t.empty)return t.empty;this.ranges=e,this.inverted=n};$S.prototype.recover=function(t){var e=0,n=zS(t);if(!this.inverted)for(var r=0;r<n;r++)e+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+e+jS(t)},$S.prototype.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},$S.prototype.map=function(t,e){return void 0===e&&(e=1),this._map(t,e,!0)},$S.prototype._map=function(t,e,n){for(var r=0,i=this.inverted?2:1,o=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?r:0);if(a>t)break;var c=this.ranges[s+i],u=this.ranges[s+o],l=a+c;if(t<=l){var d=c?t==a?-1:t==l?1:e:e,h=a+r+(d<0?0:u);if(n)return h;var f=t==(e<0?a:l)?null:IS(s/3,t-a);return new LS(h,e<0?t!=a:t!=l,f)}r+=u-c}return n?t+r:new LS(t+r)},$S.prototype.touches=function(t,e){for(var n=0,r=zS(e),i=this.inverted?2:1,o=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?n:0);if(a>t)break;var c=this.ranges[s+i],u=a+c;if(t<=u&&s==3*r)return!0;n+=this.ranges[s+o]-c}return!1},$S.prototype.forEach=function(t){for(var e=this.inverted?2:1,n=this.inverted?1:2,r=0,i=0;r<this.ranges.length;r+=3){var o=this.ranges[r],s=o-(this.inverted?i:0),a=o+(this.inverted?0:i),c=this.ranges[r+e],u=this.ranges[r+n];t(s,s+c,a,a+u),i+=u-c}},$S.prototype.invert=function(){return new $S(this.ranges,!this.inverted)},$S.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},$S.offset=function(t){return 0==t?$S.empty:new $S(t<0?[0,-t,0]:[0,0,t])},$S.empty=new $S([]);var HS=function(t,e,n,r){this.maps=t||[],this.from=n||0,this.to=null==r?this.maps.length:r,this.mirror=e};function VS(t){var e=Error.call(this,t);return e.__proto__=VS.prototype,e}HS.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.maps.length),new HS(this.maps,this.mirror,t,e)},HS.prototype.copy=function(){return new HS(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},HS.prototype.appendMap=function(t,e){this.to=this.maps.push(t),null!=e&&this.setMirror(this.maps.length-1,e)},HS.prototype.appendMapping=function(t){for(var e=0,n=this.maps.length;e<t.maps.length;e++){var r=t.getMirror(e);this.appendMap(t.maps[e],null!=r&&r<e?n+r:null)}},HS.prototype.getMirror=function(t){if(this.mirror)for(var e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]},HS.prototype.setMirror=function(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)},HS.prototype.appendMappingInverted=function(t){for(var e=t.maps.length-1,n=this.maps.length+t.maps.length;e>=0;e--){var r=t.getMirror(e);this.appendMap(t.maps[e].invert(),null!=r&&r>e?n-r-1:null)}},HS.prototype.invert=function(){var t=new HS;return t.appendMappingInverted(this),t},HS.prototype.map=function(t,e){if(void 0===e&&(e=1),this.mirror)return this._map(t,e,!0);for(var n=this.from;n<this.to;n++)t=this.maps[n].map(t,e);return t},HS.prototype.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},HS.prototype._map=function(t,e,n){for(var r=!1,i=this.from;i<this.to;i++){var o=this.maps[i],s=o.mapResult(t,e);if(null!=s.recover){var a=this.getMirror(i);if(null!=a&&a>i&&a<this.to){i=a,t=this.maps[a].recover(s.recover);continue}}s.deleted&&(r=!0),t=s.pos}return n?t:new LS(t,r)},VS.prototype=Object.create(Error.prototype),VS.prototype.constructor=VS,VS.prototype.name="TransformError";var WS=function(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new HS},US={before:{configurable:!0},docChanged:{configurable:!0}};function qS(){throw new Error("Override me")}US.before.get=function(){return this.docs.length?this.docs[0]:this.doc},WS.prototype.step=function(t){var e=this.maybeStep(t);if(e.failed)throw new VS(e.failed);return this},WS.prototype.maybeStep=function(t){var e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e},US.docChanged.get=function(){return this.steps.length>0},WS.prototype.addStep=function(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e},Object.defineProperties(WS.prototype,US);var GS=Object.create(null),KS=function(){};KS.prototype.apply=function(t){return qS()},KS.prototype.getMap=function(){return $S.empty},KS.prototype.invert=function(t){return qS()},KS.prototype.map=function(t){return qS()},KS.prototype.merge=function(t){return null},KS.prototype.toJSON=function(){return qS()},KS.fromJSON=function(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");var n=GS[e.stepType];if(!n)throw new RangeError("No step type "+e.stepType+" defined");return n.fromJSON(t,e)},KS.jsonID=function(t,e){if(t in GS)throw new RangeError("Duplicate use of step JSON ID "+t);return GS[t]=e,e.prototype.jsonID=t,e};var YS=function(t,e){this.doc=t,this.failed=e};YS.ok=function(t){return new YS(t,null)},YS.fail=function(t){return new YS(null,t)},YS.fromReplace=function(t,e,n,r){try{return YS.ok(t.replace(e,n,r))}catch(Xw){if(Xw instanceof mE)return YS.fail(Xw.message);throw Xw}};var XS=function(t){function e(e,n,r,i){t.call(this),this.from=e,this.to=n,this.slice=r,this.structure=!!i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){return this.structure&&ZS(t,this.from,this.to)?YS.fail("Structure replace would overwrite content"):YS.fromReplace(t,this.from,this.to,this.slice)},e.prototype.getMap=function(){return new $S([this.from,this.to-this.from,this.slice.size])},e.prototype.invert=function(t){return new e(this.from,this.from+this.slice.size,t.slice(this.from,this.to))},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted?null:new e(n.pos,Math.max(n.pos,r.pos),this.slice)},e.prototype.merge=function(t){if(!(t instanceof e)||t.structure||this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;var n=this.slice.size+t.slice.size==0?vE.empty:new vE(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new e(t.from,this.to,n,this.structure)}var r=this.slice.size+t.slice.size==0?vE.empty:new vE(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new e(this.from,this.to+(t.to-t.from),r,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new e(n.from,n.to,vE.fromJSON(t,n.slice),!!n.structure)},e}(KS);KS.jsonID("replace",XS);var JS=function(t){function e(e,n,r,i,o,s,a){t.call(this),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=!!a}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){if(this.structure&&(ZS(t,this.from,this.gapFrom)||ZS(t,this.gapTo,this.to)))return YS.fail("Structure gap-replace would overwrite content");var e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return YS.fail("Gap is not a flat range");var n=this.slice.insertAt(this.insert,e.content);return n?YS.fromReplace(t,this.from,this.to,n):YS.fail("Content does not fit in gap")},e.prototype.getMap=function(){return new $S([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},e.prototype.invert=function(t){var n=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),i=t.map(this.gapFrom,-1),o=t.map(this.gapTo,1);return n.deleted&&r.deleted||i<n.pos||o>r.pos?null:new e(n.pos,r.pos,i,o,this.slice,this.insert,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to||"number"!=typeof n.gapFrom||"number"!=typeof n.gapTo||"number"!=typeof n.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new e(n.from,n.to,n.gapFrom,n.gapTo,vE.fromJSON(t,n.slice),n.insert,!!n.structure)},e}(KS);function ZS(t,e,n){var r=t.resolve(e),i=n-e,o=r.depth;while(i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount)o--,i--;if(i>0){var s=r.node(o).maybeChild(r.indexAfter(o));while(i>0){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function QS(t,e,n){return(0==e||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function tD(t){for(var e=t.parent,n=e.content.cutByIndex(t.startIndex,t.endIndex),r=t.depth;;--r){var i=t.$from.node(r),o=t.$from.index(r),s=t.$to.indexAfter(r);if(r<t.depth&&i.canReplace(o,s,n))return r;if(0==r||i.type.spec.isolating||!QS(i,o,s))break}}function eD(t,e,n,r){void 0===r&&(r=t);var i=rD(t,e),o=i&&iD(r,e);return o?i.map(nD).concat({type:e,attrs:n}).concat(o.map(nD)):null}function nD(t){return{type:t,attrs:null}}function rD(t,e){var n=t.parent,r=t.startIndex,i=t.endIndex,o=n.contentMatchAt(r).findWrapping(e);if(!o)return null;var s=o.length?o[0]:e;return n.canReplaceWith(r,i,s)?o:null}function iD(t,e){var n=t.parent,r=t.startIndex,i=t.endIndex,o=n.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;for(var a=s.length?s[s.length-1]:e,c=a.contentMatch,u=r;c&&u<i;u++)c=c.matchType(n.child(u).type);return c&&c.validEnd?s:null}function oD(t,e,n){var r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function sD(t,e,n,r){void 0===n&&(n=1);var i=t.resolve(e),o=i.depth-n,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(var a=i.depth-1,c=n-2;a>o;a--,c--){var u=i.node(a),l=i.index(a);if(u.type.spec.isolating)return!1;var d=u.content.cutByIndex(l,u.childCount),h=r&&r[c]||u;if(h!=u&&(d=d.replaceChild(0,h.type.create(h.attrs))),!u.canReplace(l+1,u.childCount)||!h.type.validContent(d))return!1}var f=i.indexAfter(o),p=r&&r[0];return i.node(o).canReplaceWith(f,f,p?p.type:i.node(o+1).type)}function aD(t,e){var n=t.resolve(e),r=n.index();return cD(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function cD(t,e){return t&&e&&!t.isLeaf&&t.canAppend(e)}function uD(t,e,n){var r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(0==r.parentOffset)for(var i=r.depth-1;i>=0;i--){var o=r.index(i);if(r.node(i).canReplaceWith(o,o,n))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(var s=r.depth-1;s>=0;s--){var a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}}function lD(t,e,n){var r=t.resolve(e);if(!n.content.size)return e;for(var i=n.content,o=0;o<n.openStart;o++)i=i.firstChild.content;for(var s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(var a=r.depth;a>=0;a--){var c=a==r.depth?0:r.pos<=(r.start(a+1)+r.end(a+1))/2?-1:1,u=r.index(a)+(c>0?1:0),l=r.node(a),d=!1;if(1==s)d=l.canReplace(u,u,i);else{var h=l.contentMatchAt(u).findWrapping(i.firstChild.type);d=h&&l.canReplaceWith(u,u,h[0])}if(d)return 0==c?r.pos:c<0?r.before(a+1):r.after(a+1)}return null}function dD(t,e,n){for(var r=[],i=0;i<t.childCount;i++){var o=t.child(i);o.content.size&&(o=o.copy(dD(o.content,e,o))),o.isInline&&(o=e(o,n,i)),r.push(o)}return lE.fromArray(r)}KS.jsonID("replaceAround",JS),WS.prototype.lift=function(t,e){for(var n=t.$from,r=t.$to,i=t.depth,o=n.before(i+1),s=r.after(i+1),a=o,c=s,u=lE.empty,l=0,d=i,h=!1;d>e;d--)h||n.index(d)>0?(h=!0,u=lE.from(n.node(d).copy(u)),l++):a--;for(var f=lE.empty,p=0,g=i,m=!1;g>e;g--)m||r.after(g+1)<r.end(g)?(m=!0,f=lE.from(r.node(g).copy(f)),p++):c++;return this.step(new JS(a,c,o,s,new vE(u.append(f),l,p),u.size-l,!0))},WS.prototype.wrap=function(t,e){for(var n=lE.empty,r=e.length-1;r>=0;r--){if(n.size){var i=e[r].type.contentMatch.matchFragment(n);if(!i||!i.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=lE.from(e[r].type.create(e[r].attrs,n))}var o=t.start,s=t.end;return this.step(new JS(o,s,o,s,new vE(n,0,0),e.length,!0))},WS.prototype.setBlockType=function(t,e,n,r){var i=this;if(void 0===e&&(e=t),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var o=this.steps.length;return this.doc.nodesBetween(t,e,(function(t,e){if(t.isTextblock&&!t.hasMarkup(n,r)&&oD(i.doc,i.mapping.slice(o).map(e),n)){i.clearIncompatible(i.mapping.slice(o).map(e,1),n);var s=i.mapping.slice(o),a=s.map(e,1),c=s.map(e+t.nodeSize,1);return i.step(new JS(a,c,a+1,c-1,new vE(lE.from(n.create(r,null,t.marks)),0,0),1,!0)),!1}})),this},WS.prototype.setNodeMarkup=function(t,e,n,r){var i=this.doc.nodeAt(t);if(!i)throw new RangeError("No node at given position");e||(e=i.type);var o=e.create(n,null,r||i.marks);if(i.isLeaf)return this.replaceWith(t,t+i.nodeSize,o);if(!e.validContent(i.content))throw new RangeError("Invalid content for node type "+e.name);return this.step(new JS(t,t+i.nodeSize,t+1,t+i.nodeSize-1,new vE(lE.from(o),0,0),1,!0))},WS.prototype.split=function(t,e,n){void 0===e&&(e=1);for(var r=this.doc.resolve(t),i=lE.empty,o=lE.empty,s=r.depth,a=r.depth-e,c=e-1;s>a;s--,c--){i=lE.from(r.node(s).copy(i));var u=n&&n[c];o=lE.from(u?u.type.create(u.attrs,o):r.node(s).copy(o))}return this.step(new XS(t,t,new vE(i.append(o),e,e),!0))},WS.prototype.join=function(t,e){void 0===e&&(e=1);var n=new XS(t-e,t+e,vE.empty,!0);return this.step(n)};var hD=function(t){function e(e,n,r){t.call(this),this.from=e,this.to=n,this.mark=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){var e=this,n=t.slice(this.from,this.to),r=t.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new vE(dD(n.content,(function(t,n){return t.isAtom&&n.type.allowsMarkType(e.mark.type)?t.mark(e.mark.addToSet(t.marks)):t}),i),n.openStart,n.openEnd);return YS.fromReplace(t,this.from,this.to,o)},e.prototype.invert=function(){return new fD(this.from,this.to,this.mark)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new e(n.pos,r.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(KS);KS.jsonID("addMark",hD);var fD=function(t){function e(e,n,r){t.call(this),this.from=e,this.to=n,this.mark=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){var e=this,n=t.slice(this.from,this.to),r=new vE(dD(n.content,(function(t){return t.mark(e.mark.removeFromSet(t.marks))})),n.openStart,n.openEnd);return YS.fromReplace(t,this.from,this.to,r)},e.prototype.invert=function(){return new hD(this.from,this.to,this.mark)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new e(n.pos,r.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(KS);function pD(t,e,n,r){if(void 0===n&&(n=e),void 0===r&&(r=vE.empty),e==n&&!r.size)return null;var i=t.resolve(e),o=t.resolve(n);return gD(i,o,r)?new XS(e,n,r):new mD(i,o,r).fit()}function gD(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}KS.jsonID("removeMark",fD),WS.prototype.addMark=function(t,e,n){var r=this,i=[],o=[],s=null,a=null;return this.doc.nodesBetween(t,e,(function(r,c,u){if(r.isInline){var l=r.marks;if(!n.isInSet(l)&&u.type.allowsMarkType(n.type)){for(var d=Math.max(c,t),h=Math.min(c+r.nodeSize,e),f=n.addToSet(l),p=0;p<l.length;p++)l[p].isInSet(f)||(s&&s.to==d&&s.mark.eq(l[p])?s.to=h:i.push(s=new fD(d,h,l[p])));a&&a.to==d?a.to=h:o.push(a=new hD(d,h,n))}}})),i.forEach((function(t){return r.step(t)})),o.forEach((function(t){return r.step(t)})),this},WS.prototype.removeMark=function(t,e,n){var r=this;void 0===n&&(n=null);var i=[],o=0;return this.doc.nodesBetween(t,e,(function(r,s){if(r.isInline){o++;var a=null;if(n instanceof hS){var c,u=r.marks;while(c=n.isInSet(u))(a||(a=[])).push(c),u=c.removeFromSet(u)}else n?n.isInSet(r.marks)&&(a=[n]):a=r.marks;if(a&&a.length)for(var l=Math.min(s+r.nodeSize,e),d=0;d<a.length;d++){for(var h=a[d],f=void 0,p=0;p<i.length;p++){var g=i[p];g.step==o-1&&h.eq(i[p].style)&&(f=g)}f?(f.to=l,f.step=o):i.push({style:h,from:Math.max(s,t),to:l,step:o})}}})),i.forEach((function(t){return r.step(new fD(t.from,t.to,t.style))})),this},WS.prototype.clearIncompatible=function(t,e,n){void 0===n&&(n=e.contentMatch);for(var r=this.doc.nodeAt(t),i=[],o=t+1,s=0;s<r.childCount;s++){var a=r.child(s),c=o+a.nodeSize,u=n.matchType(a.type,a.attrs);if(u){n=u;for(var l=0;l<a.marks.length;l++)e.allowsMarkType(a.marks[l].type)||this.step(new fD(o,c,a.marks[l]))}else i.push(new XS(o,c,vE.empty));o=c}if(!n.validEnd){var d=n.fillBefore(lE.empty,!0);this.replace(o,o,new vE(d,0,0))}for(var h=i.length-1;h>=0;h--)this.step(i[h]);return this},WS.prototype.replace=function(t,e,n){void 0===e&&(e=t),void 0===n&&(n=vE.empty);var r=pD(this.doc,t,e,n);return r&&this.step(r),this},WS.prototype.replaceWith=function(t,e,n){return this.replace(t,e,new vE(lE.from(n),0,0))},WS.prototype.delete=function(t,e){return this.replace(t,e,vE.empty)},WS.prototype.insert=function(t,e){return this.replaceWith(t,t,e)};var mD=function(t,e,n){this.$to=e,this.$from=t,this.unplaced=n,this.frontier=[];for(var r=0;r<=t.depth;r++){var i=t.node(r);this.frontier.push({type:i.type,match:i.contentMatchAt(t.indexAfter(r))})}this.placed=lE.empty;for(var o=t.depth;o>0;o--)this.placed=lE.from(t.node(o).copy(this.placed))},vD={depth:{configurable:!0}};function yD(t,e,n){return 0==e?t.cutByIndex(n):t.replaceChild(0,t.firstChild.copy(yD(t.firstChild.content,e-1,n)))}function bD(t,e,n){return 0==e?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(bD(t.lastChild.content,e-1,n)))}function wD(t,e){for(var n=0;n<e;n++)t=t.firstChild.content;return t}function ED(t,e,n){if(e<=0)return t;var r=t.content;return e>1&&(r=r.replaceChild(0,ED(r.firstChild,e-1,1==r.childCount?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(lE.empty,!0)))),t.copy(r)}function SD(t,e,n,r,i){var o=t.node(e),s=i?t.indexAfter(e):t.index(e);if(s==o.childCount&&!n.compatibleContent(o.type))return null;var a=r.fillBefore(o.content,!0,s);return a&&!DD(n,o.content,s)?a:null}function DD(t,e,n){for(var r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function kD(t){return t.spec.defining||t.spec.definingForContent}function xD(t,e,n,r,i){if(e<n){var o=t.firstChild;t=t.replaceChild(0,o.copy(xD(o.content,e+1,n,r,o)))}if(e>r){var s=i.contentMatchAt(0),a=s.fillBefore(t).append(t);t=a.append(s.matchFragment(a).fillBefore(lE.empty,!0))}return t}function CD(t,e){for(var n=[],r=Math.min(t.depth,e.depth),i=r;i>=0;i--){var o=t.start(i);if(o<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&n.push(i)}return n}vD.depth.get=function(){return this.frontier.length-1},mD.prototype.fit=function(){while(this.unplaced.size){var t=this.findFittable();t?this.placeNodes(t):this.openMore()||this.dropNode()}var e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;var o=this.placed,s=r.depth,a=i.depth;while(s&&a&&1==o.childCount)o=o.firstChild.content,s--,a--;var c=new vE(o,s,a);return e>-1?new JS(r.pos,e,this.$to.pos,this.$to.end(),c,n):c.size||r.pos!=this.$to.pos?new XS(r.pos,i.pos,c):void 0},mD.prototype.findFittable=function(){for(var t=1;t<=2;t++)for(var e=this.unplaced.openStart;e>=0;e--){var n=void 0,r=void 0;e?(r=wD(this.unplaced.content,e-1).firstChild,n=r.content):n=this.unplaced.content;for(var i=n.firstChild,o=this.depth;o>=0;o--){var s=this.frontier[o],a=s.type,c=s.match,u=void 0,l=void 0;if(1==t&&(i?c.matchType(i.type)||(l=c.fillBefore(lE.from(i),!1)):a.compatibleContent(r.type)))return{sliceDepth:e,frontierDepth:o,parent:r,inject:l};if(2==t&&i&&(u=c.findWrapping(i.type)))return{sliceDepth:e,frontierDepth:o,parent:r,wrap:u};if(r&&c.matchType(r.type))break}}},mD.prototype.openMore=function(){var t=this.unplaced,e=t.content,n=t.openStart,r=t.openEnd,i=wD(e,n);return!(!i.childCount||i.firstChild.isLeaf)&&(this.unplaced=new vE(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)},mD.prototype.dropNode=function(){var t=this.unplaced,e=t.content,n=t.openStart,r=t.openEnd,i=wD(e,n);if(i.childCount<=1&&n>0){var o=e.size-n<=n+i.size;this.unplaced=new vE(yD(e,n-1,1),n-1,o?n-1:r)}else this.unplaced=new vE(yD(e,n,1),n,r)},mD.prototype.placeNodes=function(t){var e=t.sliceDepth,n=t.frontierDepth,r=t.parent,i=t.inject,o=t.wrap;while(this.depth>n)this.closeFrontierNode();if(o)for(var s=0;s<o.length;s++)this.openFrontierNode(o[s]);var a=this.unplaced,c=r?r.content:a.content,u=a.openStart-e,l=0,d=[],h=this.frontier[n],f=h.match,p=h.type;if(i){for(var g=0;g<i.childCount;g++)d.push(i.child(g));f=f.matchFragment(i)}var m=c.size+e-(a.content.size-a.openEnd);while(l<c.childCount){var v=c.child(l),y=f.matchType(v.type);if(!y)break;l++,(l>1||0==u||v.content.size)&&(f=y,d.push(ED(v.mark(p.allowedMarks(v.marks)),1==l?u:0,l==c.childCount?m:-1)))}var b=l==c.childCount;b||(m=-1),this.placed=bD(this.placed,n,lE.from(d)),this.frontier[n].match=f,b&&m<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var w=0,E=c;w<m;w++){var S=E.lastChild;this.frontier.push({type:S.type,match:S.contentMatchAt(S.childCount)}),E=S.content}this.unplaced=b?0==e?vE.empty:new vE(yD(a.content,e-1,1),e-1,m<0?a.openEnd:e-1):new vE(yD(a.content,e,l),a.openStart,a.openEnd)},mD.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock)return-1;var t,e=this.frontier[this.depth];if(!e.type.isTextblock||!SD(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;var n=this.$to,r=n.depth,i=this.$to.after(r);while(r>1&&i==this.$to.end(--r))++i;return i},mD.prototype.findCloseLevel=function(t){t:for(var e=Math.min(this.depth,t.depth);e>=0;e--){var n=this.frontier[e],r=n.match,i=n.type,o=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),s=SD(t,e,i,r,o);if(s){for(var a=e-1;a>=0;a--){var c=this.frontier[a],u=c.match,l=c.type,d=SD(t,a,l,u,!0);if(!d||d.childCount)continue t}return{depth:e,fit:s,move:o?t.doc.resolve(t.after(e+1)):t}}}},mD.prototype.close=function(t){var e=this.findCloseLevel(t);if(!e)return null;while(this.depth>e.depth)this.closeFrontierNode();e.fit.childCount&&(this.placed=bD(this.placed,e.depth,e.fit)),t=e.move;for(var n=e.depth+1;n<=t.depth;n++){var r=t.node(n),i=r.type.contentMatch.fillBefore(r.content,!0,t.index(n));this.openFrontierNode(r.type,r.attrs,i)}return t},mD.prototype.openFrontierNode=function(t,e,n){var r=this.frontier[this.depth];r.match=r.match.matchType(t),this.placed=bD(this.placed,this.depth,lE.from(t.create(e,n))),this.frontier.push({type:t,match:t.contentMatch})},mD.prototype.closeFrontierNode=function(){var t=this.frontier.pop(),e=t.match.fillBefore(lE.empty,!0);e.childCount&&(this.placed=bD(this.placed,this.frontier.length,e))},Object.defineProperties(mD.prototype,vD),WS.prototype.replaceRange=function(t,e,n){if(!n.size)return this.deleteRange(t,e);var r=this.doc.resolve(t),i=this.doc.resolve(e);if(gD(r,i,n))return this.step(new XS(t,e,n));var o=CD(r,this.doc.resolve(e));0==o[o.length-1]&&o.pop();var s=-(r.depth+1);o.unshift(s);for(var a=r.depth,c=r.pos-1;a>0;a--,c--){var u=r.node(a).type.spec;if(u.defining||u.definingAsContext||u.isolating)break;o.indexOf(a)>-1?s=a:r.before(a)==c&&o.splice(1,0,-a)}for(var l=o.indexOf(s),d=[],h=n.openStart,f=n.content,p=0;;p++){var g=f.firstChild;if(d.push(g),p==n.openStart)break;f=g.content}for(var m=h-1;m>=0;m--){var v=d[m].type,y=kD(v);if(y&&r.node(l).type!=v)h=m;else if(y||!v.isTextblock)break}for(var b=n.openStart;b>=0;b--){var w=(b+h+1)%(n.openStart+1),E=d[w];if(E)for(var S=0;S<o.length;S++){var D=o[(S+l)%o.length],k=!0;D<0&&(k=!1,D=-D);var x=r.node(D-1),C=r.index(D-1);if(x.canReplaceWith(C,C,E.type,E.marks))return this.replace(r.before(D),k?i.after(D):e,new vE(xD(n.content,0,n.openStart,w),w,n.openEnd))}}for(var _=this.steps.length,O=o.length-1;O>=0;O--){if(this.replace(t,e,n),this.steps.length>_)break;var A=o[O];A<0||(t=r.before(A),e=i.after(A))}return this},WS.prototype.replaceRangeWith=function(t,e,n){if(!n.isInline&&t==e&&this.doc.resolve(t).parent.content.size){var r=uD(this.doc,t,n.type);null!=r&&(t=e=r)}return this.replaceRange(t,e,new vE(lE.from(n),0,0))},WS.prototype.deleteRange=function(t,e){for(var n=this.doc.resolve(t),r=this.doc.resolve(e),i=CD(n,r),o=0;o<i.length;o++){var s=i[o],a=o==i.length-1;if(a&&0==s||n.node(s).type.contentMatch.validEnd)return this.delete(n.start(s),r.end(s));if(s>0&&(a||n.node(s-1).canReplace(n.index(s-1),r.indexAfter(s-1))))return this.delete(n.before(s),r.after(s))}for(var c=1;c<=n.depth&&c<=r.depth;c++)if(t-n.start(c)==n.depth-c&&e>n.end(c)&&r.end(c)-e!=r.depth-c)return this.delete(n.before(c),e);return this.delete(t,e)};var _D=Object.create(null),OD=function(t,e,n){this.ranges=n||[new MD(t.min(e),t.max(e))],this.$anchor=t,this.$head=e},AD={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};AD.anchor.get=function(){return this.$anchor.pos},AD.head.get=function(){return this.$head.pos},AD.from.get=function(){return this.$from.pos},AD.to.get=function(){return this.$to.pos},AD.$from.get=function(){return this.ranges[0].$from},AD.$to.get=function(){return this.ranges[0].$to},AD.empty.get=function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0},OD.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},OD.prototype.replace=function(t,e){void 0===e&&(e=vE.empty);for(var n=e.content.lastChild,r=null,i=0;i<e.openEnd;i++)r=n,n=n.lastChild;for(var o=t.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],u=c.$from,l=c.$to,d=t.mapping.slice(o);t.replaceRange(d.map(u.pos),d.map(l.pos),a?vE.empty:e),0==a&&zD(t,o,(n?n.isInline:r&&r.isTextblock)?-1:1)}},OD.prototype.replaceWith=function(t,e){for(var n=t.steps.length,r=this.ranges,i=0;i<r.length;i++){var o=r[i],s=o.$from,a=o.$to,c=t.mapping.slice(n),u=c.map(s.pos),l=c.map(a.pos);i?t.deleteRange(u,l):(t.replaceRangeWith(u,l,e),zD(t,n,e.isInline?-1:1))}},OD.findFrom=function(t,e,n){var r=t.parent.inlineContent?new TD(t):ID(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(var i=t.depth-1;i>=0;i--){var o=e<0?ID(t.node(0),t.node(i),t.before(i+1),t.index(i),e,n):ID(t.node(0),t.node(i),t.after(i+1),t.index(i)+1,e,n);if(o)return o}},OD.near=function(t,e){return void 0===e&&(e=1),this.findFrom(t,e)||this.findFrom(t,-e)||new BD(t.node(0))},OD.atStart=function(t){return ID(t,t,0,0,1)||new BD(t)},OD.atEnd=function(t){return ID(t,t,t.content.size,t.childCount,-1)||new BD(t)},OD.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=_D[e.type];if(!n)throw new RangeError("No selection type "+e.type+" defined");return n.fromJSON(t,e)},OD.jsonID=function(t,e){if(t in _D)throw new RangeError("Duplicate use of selection JSON ID "+t);return _D[t]=e,e.prototype.jsonID=t,e},OD.prototype.getBookmark=function(){return TD.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(OD.prototype,AD),OD.prototype.visible=!0;var MD=function(t,e){this.$from=t,this.$to=e},TD=function(t){function e(e,n){void 0===n&&(n=e),t.call(this,e,n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(n,r){var i=n.resolve(r.map(this.head));if(!i.parent.inlineContent)return t.near(i);var o=n.resolve(r.map(this.anchor));return new e(o.parent.inlineContent?o:i,i)},e.prototype.replace=function(e,n){if(void 0===n&&(n=vE.empty),t.prototype.replace.call(this,e,n),n==vE.empty){var r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},e.prototype.getBookmark=function(){return new RD(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,e,n){void 0===n&&(n=e);var r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))},e.between=function(n,r,i){var o=n.pos-r.pos;if(i&&!o||(i=o>=0?1:-1),!r.parent.inlineContent){var s=t.findFrom(r,i,!0)||t.findFrom(r,-i,!0);if(!s)return t.near(r,i);r=s.$head}return n.parent.inlineContent||(0==o?n=r:(n=(t.findFrom(n,-i,!0)||t.findFrom(n,i,!0)).$anchor,n.pos<r.pos!=o<0&&(n=r))),new e(n,r)},Object.defineProperties(e.prototype,n),e}(OD);OD.jsonID("text",TD);var RD=function(t,e){this.anchor=t,this.head=e};RD.prototype.map=function(t){return new RD(t.map(this.anchor),t.map(this.head))},RD.prototype.resolve=function(t){return TD.between(t.resolve(this.anchor),t.resolve(this.head))};var ND=function(t){function e(e){var n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);t.call(this,e,r),this.node=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var i=r.mapResult(this.anchor),o=i.deleted,s=i.pos,a=n.resolve(s);return o?t.near(a):new e(a)},e.prototype.content=function(){return new vE(lE.from(this.node),0,0)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new PD(this.anchor)},e.fromJSON=function(t,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(n.anchor))},e.create=function(t,e){return new this(t.resolve(e))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(OD);ND.prototype.visible=!1,OD.jsonID("node",ND);var PD=function(t){this.anchor=t};PD.prototype.map=function(t){var e=t.mapResult(this.anchor),n=e.deleted,r=e.pos;return n?new RD(r,r):new PD(r)},PD.prototype.resolve=function(t){var e=t.resolve(this.anchor),n=e.nodeAfter;return n&&ND.isSelectable(n)?new ND(e):OD.near(e)};var BD=function(t){function e(e){t.call(this,e.resolve(0),e.resolve(e.content.size))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replace=function(e,n){if(void 0===n&&(n=vE.empty),n==vE.empty){e.delete(0,e.doc.content.size);var r=t.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else t.prototype.replace.call(this,e,n)},e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},e.prototype.map=function(t){return new e(t)},e.prototype.eq=function(t){return t instanceof e},e.prototype.getBookmark=function(){return FD},e}(OD);OD.jsonID("all",BD);var FD={map:function(){return this},resolve:function(t){return new BD(t)}};function ID(t,e,n,r,i,o){if(e.inlineContent)return TD.create(t,n);for(var s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){var a=e.child(s);if(a.isAtom){if(!o&&ND.isSelectable(a))return ND.create(t,n-(i<0?a.nodeSize:0))}else{var c=ID(t,a,n+i,i<0?a.childCount:0,i,o);if(c)return c}n+=a.nodeSize*i}}function zD(t,e,n){var r=t.steps.length-1;if(!(r<e)){var i=t.steps[r];if(i instanceof XS||i instanceof JS){var o,s=t.mapping.maps[r];s.forEach((function(t,e,n,r){null==o&&(o=r)})),t.setSelection(OD.near(t.doc.resolve(o),n))}}}var jD=1,LD=2,$D=4,HD=function(t){function e(e){t.call(this,e.doc),this.time=Date.now(),this.curSelection=e.selection,this.curSelectionFor=0,this.storedMarks=e.storedMarks,this.updated=0,this.meta=Object.create(null)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|jD)&~LD,this.storedMarks=null,this},n.selectionSet.get=function(){return(this.updated&jD)>0},e.prototype.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=LD,this},e.prototype.ensureMarks=function(t){return gE.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},e.prototype.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(this.updated&LD)>0},e.prototype.addStep=function(e,n){t.prototype.addStep.call(this,e,n),this.updated=this.updated&~LD,this.storedMarks=null},e.prototype.setTime=function(t){return this.time=t,this},e.prototype.replaceSelection=function(t){return this.selection.replace(this,t),this},e.prototype.replaceSelectionWith=function(t,e){var n=this.selection;return!1!==e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||gE.none))),n.replaceWith(this,t),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(t,e,n){void 0===n&&(n=e);var r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();if(!t)return this.deleteRange(e,n);var i=this.storedMarks;if(!i){var o=this.doc.resolve(e);i=n==e?o.marks():o.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,i)),this.selection.empty||this.setSelection(OD.near(this.selection.$to)),this},e.prototype.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},e.prototype.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},n.isGeneric.get=function(){for(var t in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=$D,this},n.scrolledIntoView.get=function(){return(this.updated&$D)>0},Object.defineProperties(e.prototype,n),e}(WS);function VD(t,e){return e&&t?t.bind(e):t}var WD=function(t,e,n){this.name=t,this.init=VD(e.init,n),this.apply=VD(e.apply,n)},UD=[new WD("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new WD("selection",{init:function(t,e){return t.selection||OD.atStart(e.doc)},apply:function(t){return t.selection}}),new WD("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new WD("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})],qD=function(t,e){var n=this;this.schema=t,this.fields=UD.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),e&&e.forEach((function(t){if(n.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");n.plugins.push(t),n.pluginsByKey[t.key]=t,t.spec.state&&n.fields.push(new WD(t.key,t.spec.state,t))}))},GD=function(t){this.config=t},KD={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};KD.schema.get=function(){return this.config.schema},KD.plugins.get=function(){return this.config.plugins},GD.prototype.apply=function(t){return this.applyTransaction(t).state},GD.prototype.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=e){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0},GD.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],n=this.applyInner(t),r=null;;){for(var i=!1,o=0;o<this.config.plugins.length;o++){var s=this.config.plugins[o];if(s.spec.appendTransaction){var a=r?r[o].n:0,c=r?r[o].state:this,u=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,c,n);if(u&&n.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",t),!r){r=[];for(var l=0;l<this.config.plugins.length;l++)r.push(l<o?{state:n,n:e.length}:{state:this,n:0})}e.push(u),n=n.applyInner(u),i=!0}r&&(r[o]={state:n,n:e.length})}}if(!i)return{state:n,transactions:e}}},GD.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var e=new GD(this.config),n=this.config.fields,r=0;r<n.length;r++){var i=n[r];e[i.name]=i.apply(t,this[i.name],this,e)}for(var o=0;o<YD.length;o++)YD[o](this,t,e);return e},KD.tr.get=function(){return new HD(this)},GD.create=function(t){for(var e=new qD(t.doc?t.doc.type.schema:t.schema,t.plugins),n=new GD(e),r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n},GD.prototype.reconfigure=function(t){for(var e=new qD(this.schema,t.plugins),n=e.fields,r=new GD(e),i=0;i<n.length;i++){var o=n[i].name;r[o]=this.hasOwnProperty(o)?this[o]:n[i].init(t,r)}return r},GD.prototype.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((function(t){return t.toJSON()}))),t&&"object"==typeof t)for(var n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=t[n],i=r.spec.state;i&&i.toJSON&&(e[n]=i.toJSON.call(r,this[r.key]))}return e},GD.fromJSON=function(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var r=new qD(t.schema,t.plugins),i=new GD(r);return r.fields.forEach((function(r){if("doc"==r.name)i.doc=jE.fromJSON(t.schema,e.doc);else if("selection"==r.name)i.selection=OD.fromJSON(i.doc,e.selection);else if("storedMarks"==r.name)e.storedMarks&&(i.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(var o in n){var s=n[o],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,o))return void(i[r.name]=a.fromJSON.call(s,t,e[o],i))}i[r.name]=r.init(t,i)}})),i},GD.addApplyListener=function(t){YD.push(t)},GD.removeApplyListener=function(t){var e=YD.indexOf(t);e>-1&&YD.splice(e,1)},Object.defineProperties(GD.prototype,KD);var YD=[];function XD(t,e,n){for(var r in t){var i=t[r];i instanceof Function?i=i.bind(e):"handleDOMEvents"==r&&(i=XD(i,e,{})),n[r]=i}return n}var JD=function(t){this.props={},t.props&&XD(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:QD("plugin")};JD.prototype.getState=function(t){return t[this.key]};var ZD=Object.create(null);function QD(t){return t in ZD?t+"$"+ ++ZD[t]:(ZD[t]=0,t+"$")}var tk=function(t){void 0===t&&(t="key"),this.key=QD(t)};function ek(t,e){return!t.selection.empty&&(e&&e(t.tr.deleteSelection().scrollIntoView()),!0)}function nk(t,e,n){var r=t.selection,i=r.$cursor;if(!i||(n?!n.endOfTextblock("backward",t):i.parentOffset>0))return!1;var o=ok(i);if(!o){var s=i.blockRange(),a=s&&tD(s);return null!=a&&(e&&e(t.tr.lift(s,a).scrollIntoView()),!0)}var c=o.nodeBefore;if(!c.type.spec.isolating&&bk(t,o,e))return!0;if(0==i.parent.content.size&&(rk(c,"end")||ND.isSelectable(c))){var u=pD(t.doc,i.before(),i.after(),vE.empty);if(u.slice.size<u.to-u.from){if(e){var l=t.tr.step(u);l.setSelection(rk(c,"end")?OD.findFrom(l.doc.resolve(l.mapping.map(o.pos,-1)),-1):ND.create(l.doc,o.pos-c.nodeSize)),e(l.scrollIntoView())}return!0}}return!(!c.isAtom||o.depth!=i.depth-1)&&(e&&e(t.tr.delete(o.pos-c.nodeSize,o.pos).scrollIntoView()),!0)}function rk(t,e,n){for(;t;t="start"==e?t.firstChild:t.lastChild){if(t.isTextblock)return!0;if(n&&1!=t.childCount)return!1}return!1}function ik(t,e,n){var r=t.selection,i=r.$head,o=r.empty,s=i;if(!o)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):i.parentOffset>0)return!1;s=ok(i)}var a=s&&s.nodeBefore;return!(!a||!ND.isSelectable(a))&&(e&&e(t.tr.setSelection(ND.create(t.doc,s.pos-a.nodeSize)).scrollIntoView()),!0)}function ok(t){if(!t.parent.type.spec.isolating)for(var e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function sk(t,e,n){var r=t.selection,i=r.$cursor;if(!i||(n?!n.endOfTextblock("forward",t):i.parentOffset<i.parent.content.size))return!1;var o=ck(i);if(!o)return!1;var s=o.nodeAfter;if(bk(t,o,e))return!0;if(0==i.parent.content.size&&(rk(s,"start")||ND.isSelectable(s))){var a=pD(t.doc,i.before(),i.after(),vE.empty);if(a.slice.size<a.to-a.from){if(e){var c=t.tr.step(a);c.setSelection(rk(s,"start")?OD.findFrom(c.doc.resolve(c.mapping.map(o.pos)),1):ND.create(c.doc,c.mapping.map(o.pos))),e(c.scrollIntoView())}return!0}}return!(!s.isAtom||o.depth!=i.depth-1)&&(e&&e(t.tr.delete(o.pos,o.pos+s.nodeSize).scrollIntoView()),!0)}function ak(t,e,n){var r=t.selection,i=r.$head,o=r.empty,s=i;if(!o)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):i.parentOffset<i.parent.content.size)return!1;s=ck(i)}var a=s&&s.nodeAfter;return!(!a||!ND.isSelectable(a))&&(e&&e(t.tr.setSelection(ND.create(t.doc,s.pos)).scrollIntoView()),!0)}function ck(t){if(!t.parent.type.spec.isolating)for(var e=t.depth-1;e>=0;e--){var n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}function uk(t,e){var n=t.selection,r=n.$from,i=n.$to,o=r.blockRange(i),s=o&&tD(o);return null!=s&&(e&&e(t.tr.lift(o,s).scrollIntoView()),!0)}function lk(t,e){var n=t.selection,r=n.$head,i=n.$anchor;return!(!r.parent.type.spec.code||!r.sameParent(i))&&(e&&e(t.tr.insertText("\n").scrollIntoView()),!0)}function dk(t){for(var e=0;e<t.edgeCount;e++){var n=t.edge(e),r=n.type;if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function hk(t,e){var n=t.selection,r=n.$head,i=n.$anchor;if(!r.parent.type.spec.code||!r.sameParent(i))return!1;var o=r.node(-1),s=r.indexAfter(-1),a=dk(o.contentMatchAt(s));if(!o.canReplaceWith(s,s,a))return!1;if(e){var c=r.after(),u=t.tr.replaceWith(c,c,a.createAndFill());u.setSelection(OD.near(u.doc.resolve(c),1)),e(u.scrollIntoView())}return!0}function fk(t,e){var n=t.selection,r=n.$from,i=n.$to;if(n instanceof BD||r.parent.inlineContent||i.parent.inlineContent)return!1;var o=dk(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){var s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=t.tr.insert(s,o.createAndFill());a.setSelection(TD.create(a.doc,s+1)),e(a.scrollIntoView())}return!0}function pk(t,e){var n=t.selection,r=n.$cursor;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){var i=r.before();if(sD(t.doc,i))return e&&e(t.tr.split(i).scrollIntoView()),!0}var o=r.blockRange(),s=o&&tD(o);return null!=s&&(e&&e(t.tr.lift(o,s).scrollIntoView()),!0)}function gk(t,e){var n=t.selection,r=n.$from,i=n.$to;if(t.selection instanceof ND&&t.selection.node.isBlock)return!(!r.parentOffset||!sD(t.doc,r.pos))&&(e&&e(t.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(e){var o=i.parentOffset==i.parent.content.size,s=t.tr;(t.selection instanceof TD||t.selection instanceof BD)&&s.deleteSelection();var a=0==r.depth?null:dk(r.node(-1).contentMatchAt(r.indexAfter(-1))),c=o&&a?[{type:a}]:null,u=sD(s.doc,s.mapping.map(r.pos),1,c);if(c||u||!sD(s.doc,s.mapping.map(r.pos),1,a&&[{type:a}])||(c=[{type:a}],u=!0),u&&(s.split(s.mapping.map(r.pos),1,c),!o&&!r.parentOffset&&r.parent.type!=a)){var l=s.mapping.map(r.before()),d=s.doc.resolve(l);r.node(-1).canReplaceWith(d.index(),d.index()+1,a)&&s.setNodeMarkup(s.mapping.map(r.before()),a)}e(s.scrollIntoView())}return!0}function mk(t,e){var n,r=t.selection,i=r.$from,o=r.to,s=i.sharedDepth(o);return 0!=s&&(n=i.before(s),e&&e(t.tr.setSelection(ND.create(t.doc,n))),!0)}function vk(t,e){return e&&e(t.tr.setSelection(new BD(t.doc))),!0}function yk(t,e,n){var r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!!(r&&i&&r.type.compatibleContent(i.type))&&(!r.content.size&&e.parent.canReplace(o-1,o)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!(!e.parent.canReplace(o,o+1)||!i.isTextblock&&!aD(t.doc,e.pos))&&(n&&n(t.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0))}function bk(t,e,n){var r,i,o=e.nodeBefore,s=e.nodeAfter;if(o.type.spec.isolating||s.type.spec.isolating)return!1;if(yk(t,e,n))return!0;var a=e.parent.canReplace(e.index(),e.index()+1);if(a&&(r=(i=o.contentMatchAt(o.childCount)).findWrapping(s.type))&&i.matchType(r[0]||s.type).validEnd){if(n){for(var c=e.pos+s.nodeSize,u=lE.empty,l=r.length-1;l>=0;l--)u=lE.from(r[l].create(null,u));u=lE.from(o.copy(u));var d=t.tr.step(new JS(e.pos-1,c,e.pos,c,new vE(u,1,0),r.length,!0)),h=c+2*r.length;aD(d.doc,h)&&d.join(h),n(d.scrollIntoView())}return!0}var f=OD.findFrom(e,1),p=f&&f.$from.blockRange(f.$to),g=p&&tD(p);if(null!=g&&g>=e.depth)return n&&n(t.tr.lift(p,g).scrollIntoView()),!0;if(a&&rk(s,"start",!0)&&rk(o,"end")){for(var m=o,v=[];;){if(v.push(m),m.isTextblock)break;m=m.lastChild}for(var y=s,b=1;!y.isTextblock;y=y.firstChild)b++;if(m.canReplace(m.childCount,m.childCount,y.content)){if(n){for(var w=lE.empty,E=v.length-1;E>=0;E--)w=lE.from(v[E].copy(w));var S=t.tr.step(new JS(e.pos-v.length,e.pos+s.nodeSize,e.pos+b,e.pos+s.nodeSize-b,new vE(w,v.length,0),0,!0));n(S.scrollIntoView())}return!0}}return!1}function wk(t){return function(e,n){var r=e.selection,i=t<0?r.$from:r.$to,o=i.depth;while(i.node(o).isInline){if(!o)return!1;o--}return!!i.node(o).isTextblock&&(n&&n(e.tr.setSelection(TD.create(e.doc,t<0?i.start(o):i.end(o)))),!0)}}tk.prototype.get=function(t){return t.config.pluginsByKey[this.key]},tk.prototype.getState=function(t){return t[this.key]};var Ek=wk(-1),Sk=wk(1);function Dk(t,e){return function(n,r){var i=n.selection,o=i.$from,s=i.$to,a=o.blockRange(s),c=a&&eD(a,t,e);return!!c&&(r&&r(n.tr.wrap(a,c).scrollIntoView()),!0)}}function kk(t,e){return function(n,r){var i=n.selection,o=i.from,s=i.to,a=!1;return n.doc.nodesBetween(o,s,(function(r,i){if(a)return!1;if(r.isTextblock&&!r.hasMarkup(t,e))if(r.type==t)a=!0;else{var o=n.doc.resolve(i),s=o.index();a=o.parent.canReplaceWith(s,s+1,t)}})),!!a&&(r&&r(n.tr.setBlockType(o,s,t,e).scrollIntoView()),!0)}}function xk(){var t=[],e=arguments.length;while(e--)t[e]=arguments[e];return function(e,n,r){for(var i=0;i<t.length;i++)if(t[i](e,n,r))return!0;return!1}}var Ck=xk(ek,nk,ik),_k=xk(ek,sk,ak),Ok={Enter:xk(lk,fk,pk,gk),"Mod-Enter":hk,Backspace:Ck,"Mod-Backspace":Ck,"Shift-Backspace":Ck,Delete:_k,"Mod-Delete":_k,"Mod-a":vk},Ak={"Ctrl-h":Ok["Backspace"],"Alt-Backspace":Ok["Mod-Backspace"],"Ctrl-d":Ok["Delete"],"Ctrl-Alt-Backspace":Ok["Mod-Delete"],"Alt-Delete":Ok["Mod-Delete"],"Alt-d":Ok["Mod-Delete"],"Ctrl-a":Ek,"Ctrl-e":Sk};for(var Mk in Ok)Ak[Mk]=Ok[Mk];"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform();function Tk(t,e){return function(n,r){var i=n.selection,o=i.$from,s=i.$to,a=o.blockRange(s),c=!1,u=a;if(!a)return!1;if(a.depth>=2&&o.node(a.depth-1).type.compatibleContent(t)&&0==a.startIndex){if(0==o.index(a.depth-1))return!1;var l=n.doc.resolve(a.start-2);u=new FE(l,l,a.depth),a.endIndex<a.parent.childCount&&(a=new FE(o,n.doc.resolve(s.end(a.depth)),a.depth)),c=!0}var d=eD(u,t,e,a);return!!d&&(r&&r(Rk(n.tr,a,d,c,t).scrollIntoView()),!0)}}function Rk(t,e,n,r,i){for(var o=lE.empty,s=n.length-1;s>=0;s--)o=lE.from(n[s].type.create(n[s].attrs,o));t.step(new JS(e.start-(r?2:0),e.end,e.start,e.end,new vE(o,0,0),n.length,!0));for(var a=0,c=0;c<n.length;c++)n[c].type==i&&(a=c+1);for(var u=n.length-a,l=e.start+n.length-(r?2:0),d=e.parent,h=e.startIndex,f=e.endIndex,p=!0;h<f;h++,p=!1)!p&&sD(t.doc,l,u)&&(t.split(l,u),l+=2*u),l+=d.child(h).nodeSize;return t}function Nk(t){return function(e,n){var r=e.selection,i=r.$from,o=r.$to,s=i.blockRange(o,(function(e){return e.childCount&&e.firstChild.type==t}));return!!s&&(!n||(i.node(s.depth-1).type==t?Pk(e,n,t,s):Bk(e,n,s)))}}function Pk(t,e,n,r){var i=t.tr,o=r.end,s=r.$to.end(r.depth);return o<s&&(i.step(new JS(o-1,s,o,s,new vE(lE.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new FE(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth)),e(i.lift(r,tD(r)).scrollIntoView()),!0}function Bk(t,e,n){for(var r=t.tr,i=n.parent,o=n.end,s=n.endIndex-1,a=n.startIndex;s>a;s--)o-=i.child(s).nodeSize,r.delete(o-1,o+1);var c=r.doc.resolve(n.start),u=c.nodeAfter;if(r.mapping.map(n.end)!=n.start+c.nodeAfter.nodeSize)return!1;var l=0==n.startIndex,d=n.endIndex==i.childCount,h=c.node(-1),f=c.index(-1);if(!h.canReplace(f+(l?0:1),f+1,u.content.append(d?lE.empty:lE.from(i))))return!1;var p=c.pos,g=p+u.nodeSize;return r.step(new JS(p-(l?1:0),g+(d?1:0),p+1,g-1,new vE((l?lE.empty:lE.from(i.copy(lE.empty))).append(d?lE.empty:lE.from(i.copy(lE.empty))),l?0:1,d?0:1),l?0:1)),e(r.scrollIntoView()),!0}function Fk(t){return function(e,n){var r=e.selection,i=r.$from,o=r.$to,s=i.blockRange(o,(function(e){return e.childCount&&e.firstChild.type==t}));if(!s)return!1;var a=s.startIndex;if(0==a)return!1;var c=s.parent,u=c.child(a-1);if(u.type!=t)return!1;if(n){var l=u.lastChild&&u.lastChild.type==c.type,d=lE.from(l?t.create():null),h=new vE(lE.from(t.create(null,lE.from(c.type.create(null,d)))),l?3:1,0),f=s.start,p=s.end;n(e.tr.step(new JS(f-(l?3:1),p,f,p,h,1,!0)).scrollIntoView())}return!0}}var Ik={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var zk=/Edge\/(\d+)/.exec(navigator.userAgent),jk=/MSIE \d/.test(navigator.userAgent),Lk=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),$k=Ik.ie=!!(jk||Lk||zk);Ik.ie_version=jk?document.documentMode||6:Lk?+Lk[1]:zk?+zk[1]:null,Ik.gecko=!$k&&/gecko\/(\d+)/i.test(navigator.userAgent),Ik.gecko_version=Ik.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var Hk=!$k&&/Chrome\/(\d+)/.exec(navigator.userAgent);Ik.chrome=!!Hk,Ik.chrome_version=Hk&&+Hk[1],Ik.safari=!$k&&/Apple Computer/.test(navigator.vendor),Ik.ios=Ik.safari&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),Ik.mac=Ik.ios||/Mac/.test(navigator.platform),Ik.android=/Android \d/.test(navigator.userAgent),Ik.webkit="webkitFontSmoothing"in document.documentElement.style,Ik.webkit_version=Ik.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var Vk=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Wk=function(t){var e=t.assignedSlot||t.parentNode;return e&&11==e.nodeType?e.host:e},Uk=null,qk=function(t,e,n){var r=Uk||(Uk=document.createRange());return r.setEnd(t,null==n?t.nodeValue.length:n),r.setStart(t,e||0),r},Gk=function(t,e,n,r){return n&&(Yk(t,e,n,r,-1)||Yk(t,e,n,r,1))},Kk=/^(img|br|input|textarea|hr)$/i;function Yk(t,e,n,r,i){for(;;){if(t==n&&e==r)return!0;if(e==(i<0?0:Xk(t))){var o=t.parentNode;if(!o||1!=o.nodeType||Zk(t)||Kk.test(t.nodeName)||"false"==t.contentEditable)return!1;e=Vk(t)+(i<0?0:1),t=o}else{if(1!=t.nodeType)return!1;if(t=t.childNodes[e+(i<0?-1:0)],"false"==t.contentEditable)return!1;e=i<0?Xk(t):0}}}function Xk(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Jk(t,e,n){for(var r=0==e,i=e==Xk(t);r||i;){if(t==n)return!0;var o=Vk(t);if(t=t.parentNode,!t)return!1;r=r&&0==o,i=i&&o==Xk(t)}}function Zk(t){for(var e,n=t;n;n=n.parentNode)if(e=n.pmViewDesc)break;return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}var Qk=function(t){var e=t.isCollapsed;return e&&Ik.chrome&&t.rangeCount&&!t.getRangeAt(0).collapsed&&(e=!1),e};function tx(t,e){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function ex(t){return{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function nx(t,e){return"number"==typeof t?t:t[e]}function rx(t){var e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function ix(t,e,n){for(var r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,o=t.dom.ownerDocument,s=n||t.dom;;s=Wk(s)){if(!s)break;if(1==s.nodeType){var a=s==o.body||1!=s.nodeType,c=a?ex(o):rx(s),u=0,l=0;if(e.top<c.top+nx(r,"top")?l=-(c.top-e.top+nx(i,"top")):e.bottom>c.bottom-nx(r,"bottom")&&(l=e.bottom-c.bottom+nx(i,"bottom")),e.left<c.left+nx(r,"left")?u=-(c.left-e.left+nx(i,"left")):e.right>c.right-nx(r,"right")&&(u=e.right-c.right+nx(i,"right")),u||l)if(a)o.defaultView.scrollBy(u,l);else{var d=s.scrollLeft,h=s.scrollTop;l&&(s.scrollTop+=l),u&&(s.scrollLeft+=u);var f=s.scrollLeft-d,p=s.scrollTop-h;e={left:e.left-f,top:e.top-p,right:e.right-f,bottom:e.bottom-p}}if(a)break}}}function ox(t){for(var e,n,r=t.dom.getBoundingClientRect(),i=Math.max(0,r.top),o=(r.left+r.right)/2,s=i+1;s<Math.min(innerHeight,r.bottom);s+=5){var a=t.root.elementFromPoint(o,s);if(a!=t.dom&&t.dom.contains(a)){var c=a.getBoundingClientRect();if(c.top>=i-20){e=a,n=c.top;break}}}return{refDOM:e,refTop:n,stack:sx(t.dom)}}function sx(t){for(var e=[],n=t.ownerDocument;t;t=Wk(t))if(e.push({dom:t,top:t.scrollTop,left:t.scrollLeft}),t==n)break;return e}function ax(t){var e=t.refDOM,n=t.refTop,r=t.stack,i=e?e.getBoundingClientRect().top:0;cx(r,0==i?0:i-n)}function cx(t,e){for(var n=0;n<t.length;n++){var r=t[n],i=r.dom,o=r.top,s=r.left;i.scrollTop!=o+e&&(i.scrollTop=o+e),i.scrollLeft!=s&&(i.scrollLeft=s)}}var ux=null;function lx(t){if(t.setActive)return t.setActive();if(ux)return t.focus(ux);var e=sx(t);t.focus(null==ux?{get preventScroll(){return ux={preventScroll:!0},!0}}:void 0),ux||(ux=!1,cx(e,0))}function dx(t,e){for(var n,r,i=2e8,o=0,s=e.top,a=e.top,c=t.firstChild,u=0;c;c=c.nextSibling,u++){var l=void 0;if(1==c.nodeType)l=c.getClientRects();else{if(3!=c.nodeType)continue;l=qk(c).getClientRects()}for(var d=0;d<l.length;d++){var h=l[d];if(h.top<=s&&h.bottom>=a){s=Math.max(h.bottom,s),a=Math.min(h.top,a);var f=h.left>e.left?h.left-e.left:h.right<e.left?e.left-h.right:0;if(f<i){n=c,i=f,r=f&&3==n.nodeType?{left:h.right<e.left?h.right:h.left,top:e.top}:e,1==c.nodeType&&f&&(o=u+(e.left>=(h.left+h.right)/2?1:0));continue}}!n&&(e.left>=h.right&&e.top>=h.top||e.left>=h.left&&e.top>=h.bottom)&&(o=u+1)}}return n&&3==n.nodeType?hx(n,r):!n||i&&1==n.nodeType?{node:t,offset:o}:dx(n,r)}function hx(t,e){for(var n=t.nodeValue.length,r=document.createRange(),i=0;i<n;i++){r.setEnd(t,i+1),r.setStart(t,i);var o=bx(r,1);if(o.top!=o.bottom&&fx(e,o))return{node:t,offset:i+(e.left>=(o.left+o.right)/2?1:0)}}return{node:t,offset:0}}function fx(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function px(t,e){var n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function gx(t,e,n){var r=dx(e,n),i=r.node,o=r.offset,s=-1;if(1==i.nodeType&&!i.firstChild){var a=i.getBoundingClientRect();s=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return t.docView.posFromDOM(i,o,s)}function mx(t,e,n,r){for(var i=-1,o=e;;){if(o==t.dom)break;var s=t.docView.nearestDesc(o,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var a=s.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)i=s.posBefore;else{if(!(a.right<r.left||a.bottom<r.top))break;i=s.posAfter}}o=s.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n)}function vx(t,e,n){var r=t.childNodes.length;if(r&&n.top<n.bottom)for(var i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),o=i;;){var s=t.childNodes[o];if(1==s.nodeType)for(var a=s.getClientRects(),c=0;c<a.length;c++){var u=a[c];if(fx(e,u))return vx(s,e,u)}if((o=(o+1)%r)==i)break}return t}function yx(t,e){var n,r,i,o,s=t.dom.ownerDocument;if(s.caretPositionFromPoint)try{var a=s.caretPositionFromPoint(e.left,e.top);a&&(n=a,i=n.offsetNode,o=n.offset)}catch(m){}if(!i&&s.caretRangeFromPoint){var c=s.caretRangeFromPoint(e.left,e.top);c&&(r=c,i=r.startContainer,o=r.startOffset)}var u,l=(t.root.elementFromPoint?t.root:s).elementFromPoint(e.left,e.top+1);if(!l||!t.dom.contains(1!=l.nodeType?l.parentNode:l)){var d=t.dom.getBoundingClientRect();if(!fx(e,d))return null;if(l=vx(t.dom,e,d),!l)return null}if(Ik.safari)for(var h=l;i&&h;h=Wk(h))h.draggable&&(i=o=null);if(l=px(l,e),i){if(Ik.gecko&&1==i.nodeType&&(o=Math.min(o,i.childNodes.length),o<i.childNodes.length)){var f,p=i.childNodes[o];"IMG"==p.nodeName&&(f=p.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&o++}i==t.dom&&o==i.childNodes.length-1&&1==i.lastChild.nodeType&&e.top>i.lastChild.getBoundingClientRect().bottom?u=t.state.doc.content.size:0!=o&&1==i.nodeType&&"BR"==i.childNodes[o-1].nodeName||(u=mx(t,i,o,e))}null==u&&(u=gx(t,l,e));var g=t.docView.nearestDesc(l,!0);return{pos:u,inside:g?g.posAtStart-g.border:-1}}function bx(t,e){var n=t.getClientRects();return n.length?n[e<0?0:n.length-1]:t.getBoundingClientRect()}var wx=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Ex(t,e,n){var r=t.docView.domFromPos(e,n<0?-1:1),i=r.node,o=r.offset,s=Ik.webkit||Ik.gecko;if(3==i.nodeType){if(!s||!wx.test(i.nodeValue)&&(n<0?o:o!=i.nodeValue.length)){var a=o,c=o,u=n<0?1:-1;return n<0&&!o?(c++,u=-1):n>=0&&o==i.nodeValue.length?(a--,u=1):n<0?a--:c++,Sx(bx(qk(i,a,c),u),u<0)}var l=bx(qk(i,o,o),n);if(Ik.gecko&&o&&/\s/.test(i.nodeValue[o-1])&&o<i.nodeValue.length){var d=bx(qk(i,o-1,o-1),-1);if(d.top==l.top){var h=bx(qk(i,o,o+1),-1);if(h.top!=l.top)return Sx(h,h.left<d.left)}}return l}if(!t.state.doc.resolve(e).parent.inlineContent){if(o&&(n<0||o==Xk(i))){var f=i.childNodes[o-1];if(1==f.nodeType)return Dx(f.getBoundingClientRect(),!1)}if(o<Xk(i)){var p=i.childNodes[o];if(1==p.nodeType)return Dx(p.getBoundingClientRect(),!0)}return Dx(i.getBoundingClientRect(),n>=0)}if(o&&(n<0||o==Xk(i))){var g=i.childNodes[o-1],m=3==g.nodeType?qk(g,Xk(g)-(s?0:1)):1!=g.nodeType||"BR"==g.nodeName&&g.nextSibling?null:g;if(m)return Sx(bx(m,1),!1)}if(o<Xk(i)){var v=i.childNodes[o];while(v.pmViewDesc&&v.pmViewDesc.ignoreForCoords)v=v.nextSibling;var y=v?3==v.nodeType?qk(v,0,s?0:1):1==v.nodeType?v:null:null;if(y)return Sx(bx(y,-1),!0)}return Sx(bx(3==i.nodeType?qk(i):i,-n),n>=0)}function Sx(t,e){if(0==t.width)return t;var n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Dx(t,e){if(0==t.height)return t;var n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function kx(t,e,n){var r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}function xx(t,e,n){var r=e.selection,i="up"==n?r.$from:r.$to;return kx(t,e,(function(){for(var e=t.docView.domFromPos(i.pos,"up"==n?-1:1),r=e.node;;){var o=t.docView.nearestDesc(r,!0);if(!o)break;if(o.node.isBlock){r=o.dom;break}r=o.dom.parentNode}for(var s=Ex(t,i.pos,1),a=r.firstChild;a;a=a.nextSibling){var c=void 0;if(1==a.nodeType)c=a.getClientRects();else{if(3!=a.nodeType)continue;c=qk(a,0,a.nodeValue.length).getClientRects()}for(var u=0;u<c.length;u++){var l=c[u];if(l.bottom>l.top+1&&("up"==n?s.top-l.top>2*(l.bottom-s.top):l.bottom-s.bottom>2*(s.bottom-l.top)))return!1}}return!0}))}var Cx=/[\u0590-\u08ac]/;function _x(t,e,n){var r=e.selection,i=r.$head;if(!i.parent.isTextblock)return!1;var o=i.parentOffset,s=!o,a=o==i.parent.content.size,c=t.root.getSelection();return Cx.test(i.parent.textContent)&&c.modify?kx(t,e,(function(){var e=c.getRangeAt(0),r=c.focusNode,o=c.focusOffset,s=c.caretBidiLevel;c.modify("move",n,"character");var a=i.depth?t.docView.domAfterPos(i.before()):t.dom,u=!a.contains(1==c.focusNode.nodeType?c.focusNode:c.focusNode.parentNode)||r==c.focusNode&&o==c.focusOffset;return c.removeAllRanges(),c.addRange(e),null!=s&&(c.caretBidiLevel=s),u})):"left"==n||"backward"==n?s:a}var Ox=null,Ax=null,Mx=!1;function Tx(t,e,n){return Ox==e&&Ax==n?Mx:(Ox=e,Ax=n,Mx="up"==n||"down"==n?xx(t,e,n):_x(t,e,n))}var Rx=0,Nx=1,Px=2,Bx=3,Fx=function(t,e,n,r){this.parent=t,this.children=e,this.dom=n,n.pmViewDesc=this,this.contentDOM=r,this.dirty=Rx},Ix={size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0},domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};Fx.prototype.matchesWidget=function(){return!1},Fx.prototype.matchesMark=function(){return!1},Fx.prototype.matchesNode=function(){return!1},Fx.prototype.matchesHack=function(t){return!1},Fx.prototype.parseRule=function(){return null},Fx.prototype.stopEvent=function(){return!1},Ix.size.get=function(){for(var t=0,e=0;e<this.children.length;e++)t+=this.children[e].size;return t},Ix.border.get=function(){return 0},Fx.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var t=0;t<this.children.length;t++)this.children[t].destroy()},Fx.prototype.posBeforeChild=function(t){for(var e=0,n=this.posAtStart;e<this.children.length;e++){var r=this.children[e];if(r==t)return n;n+=r.size}},Ix.posBefore.get=function(){return this.parent.posBeforeChild(this)},Ix.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},Ix.posAfter.get=function(){return this.posBefore+this.size},Ix.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},Fx.prototype.localPosFromDOM=function(t,e,n){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(n<0){var r,i;if(t==this.contentDOM)r=t.childNodes[e-1];else{while(t.parentNode!=this.contentDOM)t=t.parentNode;r=t.previousSibling}while(r&&(!(i=r.pmViewDesc)||i.parent!=this))r=r.previousSibling;return r?this.posBeforeChild(i)+i.size:this.posAtStart}var o,s;if(t==this.contentDOM)o=t.childNodes[e];else{while(t.parentNode!=this.contentDOM)t=t.parentNode;o=t.nextSibling}while(o&&(!(s=o.pmViewDesc)||s.parent!=this))o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}var a;if(t==this.dom&&this.contentDOM)a=e>Vk(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))a=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(var c=t;;c=c.parentNode){if(c==this.dom){a=!1;break}if(c.parentNode.firstChild!=c)break}if(null==a&&e==t.childNodes.length)for(var u=t;;u=u.parentNode){if(u==this.dom){a=!0;break}if(u.parentNode.lastChild!=u)break}}return(null==a?n>0:a)?this.posAtEnd:this.posAtStart},Fx.prototype.nearestDesc=function(t,e){for(var n=!0,r=t;r;r=r.parentNode){var i=this.getDesc(r);if(i&&(!e||i.node)){if(!n||!i.nodeDOM||(1==i.nodeDOM.nodeType?i.nodeDOM.contains(1==t.nodeType?t:t.parentNode):i.nodeDOM==t))return i;n=!1}}},Fx.prototype.getDesc=function(t){for(var e=t.pmViewDesc,n=e;n;n=n.parent)if(n==this)return e},Fx.prototype.posFromDOM=function(t,e,n){for(var r=t;r;r=r.parentNode){var i=this.getDesc(r);if(i)return i.localPosFromDOM(t,e,n)}return-1},Fx.prototype.descAt=function(t){for(var e=0,n=0;e<this.children.length;e++){var r=this.children[e],i=n+r.size;if(n==t&&i!=n){while(!r.border&&r.children.length)r=r.children[0];return r}if(t<i)return r.descAt(t-n-r.border);n=i}},Fx.prototype.domFromPos=function(t,e){if(!this.contentDOM)return{node:this.dom,offset:0};for(var n=0,r=0,i=0;n<this.children.length;n++){var o=this.children[n],s=i+o.size;if(s>t||o instanceof Ux){r=t-i;break}i=s}if(r)return this.children[n].domFromPos(r-this.children[n].border,e);for(var a=void 0;n&&!(a=this.children[n-1]).size&&a instanceof jx&&a.widget.type.side>=0;n--);if(e<=0){for(var c,u=!0;;n--,u=!1)if(c=n?this.children[n-1]:null,!c||c.dom.parentNode==this.contentDOM)break;return c&&e&&u&&!c.border&&!c.domAtom?c.domFromPos(c.size,e):{node:this.contentDOM,offset:c?Vk(c.dom)+1:0}}for(var l,d=!0;;n++,d=!1)if(l=n<this.children.length?this.children[n]:null,!l||l.dom.parentNode==this.contentDOM)break;return l&&d&&!l.border&&!l.domAtom?l.domFromPos(0,e):{node:this.contentDOM,offset:l?Vk(l.dom):this.contentDOM.childNodes.length}},Fx.prototype.parseRange=function(t,e,n){if(void 0===n&&(n=0),0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var r=-1,i=-1,o=n,s=0;;s++){var a=this.children[s],c=o+a.size;if(-1==r&&t<=c){var u=o+a.border;if(t>=u&&e<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(t,e,u);t=o;for(var l=s;l>0;l--){var d=this.children[l-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){r=Vk(d.dom)+1;break}t-=d.size}-1==r&&(r=0)}if(r>-1&&(c>e||s==this.children.length-1)){e=c;for(var h=s+1;h<this.children.length;h++){var f=this.children[h];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){i=Vk(f.dom);break}e+=f.size}-1==i&&(i=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:t,to:e,fromOffset:r,toOffset:i}},Fx.prototype.emptyChildAt=function(t){if(this.border||!this.contentDOM||!this.children.length)return!1;var e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)},Fx.prototype.domAfterPos=function(t){var e=this.domFromPos(t,0),n=e.node,r=e.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+t);return n.childNodes[r]},Fx.prototype.setSelection=function(t,e,n,r){for(var i=Math.min(t,e),o=Math.max(t,e),s=0,a=0;s<this.children.length;s++){var c=this.children[s],u=a+c.size;if(i>a&&o<u)return c.setSelection(t-a-c.border,e-a-c.border,n,r);a=u}var l=this.domFromPos(t,t?-1:1),d=e==t?l:this.domFromPos(e,e?-1:1),h=n.getSelection(),f=!1;if((Ik.gecko||Ik.safari)&&t==e){var p=l.node,g=l.offset;if(3==p.nodeType){if(f=g&&"\n"==p.nodeValue[g-1],f&&g==p.nodeValue.length)for(var m=p,v=void 0;m;m=m.parentNode){if(v=m.nextSibling){"BR"==v.nodeName&&(l=d={node:v.parentNode,offset:Vk(v)+1});break}var y=m.pmViewDesc;if(y&&y.node&&y.node.isBlock)break}}else{var b=p.childNodes[g-1];f=b&&("BR"==b.nodeName||"false"==b.contentEditable)}}if(Ik.gecko&&h.focusNode&&h.focusNode!=d.node&&1==h.focusNode.nodeType){var w=h.focusNode.childNodes[h.focusOffset];w&&"false"==w.contentEditable&&(r=!0)}if(r||f&&Ik.safari||!Gk(l.node,l.offset,h.anchorNode,h.anchorOffset)||!Gk(d.node,d.offset,h.focusNode,h.focusOffset)){var E=!1;if((h.extend||t==e)&&!f){h.collapse(l.node,l.offset);try{t!=e&&h.extend(d.node,d.offset),E=!0}catch(k){if(!(k instanceof DOMException))throw k}}if(!E){if(t>e){var S=l;l=d,d=S}var D=document.createRange();D.setEnd(d.node,d.offset),D.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(D)}}},Fx.prototype.ignoreMutation=function(t){return!this.contentDOM&&"selection"!=t.type},Ix.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},Fx.prototype.markDirty=function(t,e){for(var n=0,r=0;r<this.children.length;r++){var i=this.children[r],o=n+i.size;if(n==o?t<=o&&e>=n:t<o&&e>n){var s=n+i.border,a=o-i.border;if(t>=s&&e<=a)return this.dirty=t==n||e==o?Px:Nx,void(t!=s||e!=a||!i.contentLost&&i.dom.parentNode==this.contentDOM?i.markDirty(t-s,e-s):i.dirty=Bx);i.dirty=i.dom!=i.contentDOM||i.dom.parentNode!=this.contentDOM||i.children.length?Bx:Px}n=o}this.dirty=Px},Fx.prototype.markParentsDirty=function(){for(var t=1,e=this.parent;e;e=e.parent,t++){var n=1==t?Px:Nx;e.dirty<n&&(e.dirty=n)}},Ix.domAtom.get=function(){return!1},Ix.ignoreForCoords.get=function(){return!1},Object.defineProperties(Fx.prototype,Ix);var zx=[],jx=function(t){function e(e,n,r,i){var o,s=n.type.toDOM;if("function"==typeof s&&(s=s(r,(function(){return o?o.parent?o.parent.posBeforeChild(o):void 0:i}))),!n.type.spec.raw){if(1!=s.nodeType){var a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable=!1,s.classList.add("ProseMirror-widget")}t.call(this,e,zx,s,null),this.widget=n,o=this}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={domAtom:{configurable:!0}};return e.prototype.matchesWidget=function(t){return this.dirty==Rx&&t.type.eq(this.widget.type)},e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.stopEvent=function(t){var e=this.widget.spec.stopEvent;return!!e&&e(t)},e.prototype.ignoreMutation=function(t){return"selection"!=t.type||this.widget.spec.ignoreSelection},e.prototype.destroy=function(){this.widget.type.destroy(this.dom),t.prototype.destroy.call(this)},n.domAtom.get=function(){return!0},Object.defineProperties(e.prototype,n),e}(Fx),Lx=function(t){function e(e,n,r,i){t.call(this,e,zx,n,null),this.textDOM=r,this.text=i}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},e.prototype.localPosFromDOM=function(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e},e.prototype.domFromPos=function(t){return{node:this.textDOM,offset:t}},e.prototype.ignoreMutation=function(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue},Object.defineProperties(e.prototype,n),e}(Fx),$x=function(t){function e(e,n,r,i){t.call(this,e,[],r,i),this.mark=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.create=function(t,n,r,i){var o=i.nodeViews[n.type.name],s=o&&o(n,i,r);return s&&s.dom||(s=RS.renderSpec(document,n.type.spec.toDOM(n,r))),new e(t,n,s.dom,s.contentDOM||s.dom)},e.prototype.parseRule=function(){return this.dirty&Bx||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},e.prototype.matchesMark=function(t){return this.dirty!=Bx&&this.mark.eq(t)},e.prototype.markDirty=function(e,n){if(t.prototype.markDirty.call(this,e,n),this.dirty!=Rx){var r=this.parent;while(!r.node)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Rx}},e.prototype.slice=function(t,n,r){var i=e.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;n<s&&(o=uC(o,n,s,r)),t>0&&(o=uC(o,0,t,r));for(var a=0;a<o.length;a++)o[a].parent=i;return i.children=o,i},e}(Fx),Hx=function(t){function e(e,n,r,i,o,s,a,c,u){t.call(this,e,n.isLeaf?zx:[],o,s),this.nodeDOM=a,this.node=n,this.outerDeco=r,this.innerDeco=i,s&&this.updateChildren(c,u)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0},border:{configurable:!0},domAtom:{configurable:!0}};return e.create=function(t,n,r,i,o,s){var a,c,u=o.nodeViews[n.type.name],l=u&&u(n,o,(function(){return c?c.parent?c.parent.posBeforeChild(c):void 0:s}),r,i),d=l&&l.dom,h=l&&l.contentDOM;if(n.isText)if(d){if(3!=d.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else d=document.createTextNode(n.text);else d||(a=RS.renderSpec(document,n.type.spec.toDOM(n)),d=a.dom,h=a.contentDOM);h||n.isText||"BR"==d.nodeName||(d.hasAttribute("contenteditable")||(d.contentEditable=!1),n.type.spec.draggable&&(d.draggable=!0));var f=d;return d=Qx(d,r,n),l?c=new qx(t,n,r,i,d,h,f,l,o,s+1):n.isText?new Wx(t,n,r,i,d,f,o):new e(t,n,r,i,d,h,f,o,s+1)},e.prototype.parseRule=function(){var t=this;if(this.node.type.spec.reparseInView)return null;var e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(var n=this.children.length-1;n>=0;n--){var r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=function(){return lE.empty})}else e.contentElement=this.contentDOM;else e.getContent=function(){return t.node.content};return e},e.prototype.matchesNode=function(t,e,n){return this.dirty==Rx&&t.eq(this.node)&&tC(e,this.outerDeco)&&n.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},e.prototype.updateChildren=function(t,e){var n=this,r=this.node.inlineContent,i=e,o=t.composing&&this.localCompositionInfo(t,e),s=o&&o.pos>-1?o:null,a=o&&o.pos<0,c=new nC(this,s&&s.node);oC(this.node,this.innerDeco,(function(e,o,s){e.spec.marks?c.syncToMarks(e.spec.marks,r,t):e.type.side>=0&&!s&&c.syncToMarks(o==n.node.childCount?gE.none:n.node.child(o).marks,r,t),c.placeWidget(e,t,i)}),(function(e,n,s,u){var l;c.syncToMarks(e.marks,r,t),c.findNodeMatch(e,n,s,u)||a&&t.state.selection.from>i&&t.state.selection.to<i+e.nodeSize&&(l=c.findIndexWithChild(o.node))>-1&&c.updateNodeAt(e,n,s,l,t)||c.updateNextNode(e,n,s,t,u)||c.addNode(e,n,s,t,i),i+=e.nodeSize})),c.syncToMarks(zx,r,t),this.node.isTextblock&&c.addTextblockHacks(),c.destroyRest(),(c.changed||this.dirty==Px)&&(s&&this.protectLocalComposition(t,s),Gx(this.contentDOM,this.children,t),Ik.ios&&sC(this.dom))},e.prototype.localCompositionInfo=function(t,e){var n=t.state.selection,r=n.from,i=n.to;if(!(!(t.state.selection instanceof TD)||r<e||i>e+this.node.content.size)){var o=t.root.getSelection(),s=aC(o.focusNode,o.focusOffset);if(s&&this.dom.contains(s.parentNode)){if(this.node.inlineContent){var a=s.nodeValue,c=cC(this.node.content,a,r-e,i-e);return c<0?null:{node:s,pos:c,text:a}}return{node:s,pos:-1}}}},e.prototype.protectLocalComposition=function(t,e){var n=e.node,r=e.pos,i=e.text;if(!this.getDesc(n)){for(var o=n;;o=o.parentNode){if(o.parentNode==this.contentDOM)break;while(o.previousSibling)o.parentNode.removeChild(o.previousSibling);while(o.nextSibling)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=null)}var s=new Lx(this,o,n,i);t.compositionNodes.push(s),this.children=uC(this.children,r,r+i.length,t,s)}},e.prototype.update=function(t,e,n,r){return!(this.dirty==Bx||!t.sameMarkup(this.node))&&(this.updateInner(t,e,n,r),!0)},e.prototype.updateInner=function(t,e,n,r){this.updateOuterDeco(e),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=Rx},e.prototype.updateOuterDeco=function(t){if(!tC(t,this.outerDeco)){var e=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=Jx(this.dom,this.nodeDOM,Xx(this.outerDeco,this.node,e),Xx(t,this.node,e)),this.dom!=n&&(n.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=t}},e.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},e.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")},n.domAtom.get=function(){return this.node.isAtom},Object.defineProperties(e.prototype,n),e}(Fx);function Vx(t,e,n,r,i){return Qx(r,e,t),new Hx(null,t,e,n,r,r,r,i,0)}var Wx=function(t){function e(e,n,r,i,o,s,a){t.call(this,e,n,r,i,o,null,s,a)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={domAtom:{configurable:!0}};return e.prototype.parseRule=function(){var t=this.nodeDOM.parentNode;while(t&&t!=this.dom&&!t.pmIsDeco)t=t.parentNode;return{skip:t||!0}},e.prototype.update=function(t,e,n,r){return!(this.dirty==Bx||this.dirty!=Rx&&!this.inParent()||!t.sameMarkup(this.node))&&(this.updateOuterDeco(e),this.dirty==Rx&&t.text==this.node.text||t.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=t.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=t,this.dirty=Rx,!0)},e.prototype.inParent=function(){for(var t=this.parent.contentDOM,e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1},e.prototype.domFromPos=function(t){return{node:this.nodeDOM,offset:t}},e.prototype.localPosFromDOM=function(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):t.prototype.localPosFromDOM.call(this,e,n,r)},e.prototype.ignoreMutation=function(t){return"characterData"!=t.type&&"selection"!=t.type},e.prototype.slice=function(t,n,r){var i=this.node.cut(t,n),o=document.createTextNode(i.text);return new e(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)},e.prototype.markDirty=function(e,n){t.prototype.markDirty.call(this,e,n),this.dom==this.nodeDOM||0!=e&&n!=this.nodeDOM.nodeValue.length||(this.dirty=Bx)},n.domAtom.get=function(){return!1},Object.defineProperties(e.prototype,n),e}(Hx),Ux=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};return e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.matchesHack=function(t){return this.dirty==Rx&&this.dom.nodeName==t},n.domAtom.get=function(){return!0},n.ignoreForCoords.get=function(){return"IMG"==this.dom.nodeName},Object.defineProperties(e.prototype,n),e}(Fx),qx=function(t){function e(e,n,r,i,o,s,a,c,u,l){t.call(this,e,n,r,i,o,s,a,u,l),this.spec=c}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(e,n,r,i){if(this.dirty==Bx)return!1;if(this.spec.update){var o=this.spec.update(e,n,r);return o&&this.updateInner(e,n,r,i),o}return!(!this.contentDOM&&!e.isLeaf)&&t.prototype.update.call(this,e,n,r,i)},e.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():t.prototype.selectNode.call(this)},e.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():t.prototype.deselectNode.call(this)},e.prototype.setSelection=function(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r):t.prototype.setSelection.call(this,e,n,r,i)},e.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),t.prototype.destroy.call(this)},e.prototype.stopEvent=function(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)},e.prototype.ignoreMutation=function(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):t.prototype.ignoreMutation.call(this,e)},e}(Hx);function Gx(t,e,n){for(var r=t.firstChild,i=!1,o=0;o<e.length;o++){var s=e[o],a=s.dom;if(a.parentNode==t){while(a!=r)r=eC(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(a,r);if(s instanceof $x){var c=r?r.previousSibling:t.lastChild;Gx(s.contentDOM,s.children,n),r=c?c.nextSibling:t.firstChild}}while(r)r=eC(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}function Kx(t){t&&(this.nodeName=t)}Kx.prototype=Object.create(null);var Yx=[new Kx];function Xx(t,e,n){if(0==t.length)return Yx;for(var r=n?Yx[0]:new Kx,i=[r],o=0;o<t.length;o++){var s=t[o].type.attrs;if(s)for(var a in s.nodeName&&i.push(r=new Kx(s.nodeName)),s){var c=s[a];null!=c&&(n&&1==i.length&&i.push(r=new Kx(e.isInline?"span":"div")),"class"==a?r.class=(r.class?r.class+" ":"")+c:"style"==a?r.style=(r.style?r.style+";":"")+c:"nodeName"!=a&&(r[a]=c))}}return i}function Jx(t,e,n,r){if(n==Yx&&r==Yx)return e;for(var i=e,o=0;o<r.length;o++){var s=r[o],a=n[o];if(o){var c=void 0;a&&a.nodeName==s.nodeName&&i!=t&&(c=i.parentNode)&&c.tagName.toLowerCase()==s.nodeName||(c=document.createElement(s.nodeName),c.pmIsDeco=!0,c.appendChild(i),a=Yx[0]),i=c}Zx(i,a||Yx[0],s)}return i}function Zx(t,e,n){for(var r in e)"class"==r||"style"==r||"nodeName"==r||r in n||t.removeAttribute(r);for(var i in n)"class"!=i&&"style"!=i&&"nodeName"!=i&&n[i]!=e[i]&&t.setAttribute(i,n[i]);if(e.class!=n.class){for(var o=e.class?e.class.split(" ").filter(Boolean):zx,s=n.class?n.class.split(" ").filter(Boolean):zx,a=0;a<o.length;a++)-1==s.indexOf(o[a])&&t.classList.remove(o[a]);for(var c=0;c<s.length;c++)-1==o.indexOf(s[c])&&t.classList.add(s[c]);0==t.classList.length&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){var u,l=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;while(u=l.exec(e.style))t.style.removeProperty(u[1])}n.style&&(t.style.cssText+=n.style)}}function Qx(t,e,n){return Jx(t,t,Yx,Xx(e,n,1!=t.nodeType))}function tC(t,e){if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function eC(t){var e=t.nextSibling;return t.parentNode.removeChild(t),e}var nC=function(t,e){this.top=t,this.lock=e,this.index=0,this.stack=[],this.changed=!1,this.preMatch=rC(t.node.content,t)};function rC(t,e){var n=e,r=n.children.length,i=t.childCount,o=new Map,s=[];t:while(i>0){for(var a=void 0;;)if(r){var c=n.children[r-1];if(!(c instanceof $x)){a=c,r--;break}n=c,r=c.children.length}else{if(n==e)break t;r=n.parent.children.indexOf(n),n=n.parent}var u=a.node;if(u){if(u!=t.child(i-1))break;--i,o.set(a,i),s.push(a)}}return{index:i,matched:o,matches:s.reverse()}}function iC(t,e){return t.type.side-e.type.side}function oC(t,e,n,r){var i=e.locals(t),o=0;if(0!=i.length)for(var s=0,a=[],c=null,u=0;;){if(s<i.length&&i[s].to==o){var l=i[s++],d=void 0;while(s<i.length&&i[s].to==o)(d||(d=[l])).push(i[s++]);if(d){d.sort(iC);for(var h=0;h<d.length;h++)n(d[h],u,!!c)}else n(l,u,!!c)}var f=void 0,p=void 0;if(c)p=-1,f=c,c=null;else{if(!(u<t.childCount))break;p=u,f=t.child(u++)}for(var g=0;g<a.length;g++)a[g].to<=o&&a.splice(g--,1);while(s<i.length&&i[s].from<=o&&i[s].to>o)a.push(i[s++]);var m=o+f.nodeSize;if(f.isText){var v=m;s<i.length&&i[s].from<v&&(v=i[s].from);for(var y=0;y<a.length;y++)a[y].to<v&&(v=a[y].to);v<m&&(c=f.cut(v-o),f=f.cut(0,v-o),m=v,p=-1)}var b=a.length?f.isInline&&!f.isLeaf?a.filter((function(t){return!t.inline})):a.slice():zx;r(f,b,e.forChild(o,f),p),o=m}else for(var w=0;w<t.childCount;w++){var E=t.child(w);r(E,i,e.forChild(o,E),w),o+=E.nodeSize}}function sC(t){if("UL"==t.nodeName||"OL"==t.nodeName){var e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function aC(t,e){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0){if(t.childNodes.length>e&&3==t.childNodes[e].nodeType)return t.childNodes[e];t=t.childNodes[e-1],e=Xk(t)}else{if(!(1==t.nodeType&&e<t.childNodes.length))return null;t=t.childNodes[e],e=0}}}function cC(t,e,n,r){for(var i=0,o=0;i<t.childCount&&o<=r;){var s=t.child(i++),a=o;if(o+=s.nodeSize,s.isText){var c=s.text;while(i<t.childCount){var u=t.child(i++);if(o+=u.nodeSize,!u.isText)break;c+=u.text}if(o>=n){var l=a<r?c.lastIndexOf(e,r-a-1):-1;if(l>=0&&l+e.length+a>=n)return a+l;if(n==r&&c.length>=r+e.length-a&&c.slice(r-a,r-a+e.length)==e)return r}}}return-1}function uC(t,e,n,r,i){for(var o=[],s=0,a=0;s<t.length;s++){var c=t[s],u=a,l=a+=c.size;u>=n||l<=e?o.push(c):(u<e&&o.push(c.slice(0,e-u,r)),i&&(o.push(i),i=null),l>n&&o.push(c.slice(n-u,c.size,r)))}return o}function lC(t,e){var n=t.root.getSelection(),r=t.state.doc;if(!n.focusNode)return null;var i=t.docView.nearestDesc(n.focusNode),o=i&&0==i.size,s=t.docView.posFromDOM(n.focusNode,n.focusOffset);if(s<0)return null;var a,c,u=r.resolve(s);if(Qk(n)){a=u;while(i&&!i.node)i=i.parent;if(i&&i.node.isAtom&&ND.isSelectable(i.node)&&i.parent&&(!i.node.isInline||!Jk(n.focusNode,n.focusOffset,i.dom))){var l=i.posBefore;c=new ND(s==l?u:r.resolve(l))}}else{var d=t.docView.posFromDOM(n.anchorNode,n.anchorOffset);if(d<0)return null;a=r.resolve(d)}if(!c){var h="pointer"==e||t.state.selection.head<u.pos&&!o?1:-1;c=EC(t,a,u,h)}return c}function dC(t){return t.editable?t.hasFocus():DC(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function hC(t,e){var n=t.state.selection;if(bC(t,n),dC(t)){if(!e&&t.mouseDown&&t.mouseDown.allowDefault&&Ik.chrome){var r=t.root.getSelection(),i=t.domObserver.currentSelection;if(r.anchorNode&&Gk(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset))return t.mouseDown.delayedSelectionSync=!0,void t.domObserver.setCurSelection()}if(t.domObserver.disconnectSelection(),t.cursorWrapper)yC(t);else{var o,s,a=n.anchor,c=n.head;!fC||n instanceof TD||(n.$from.parent.inlineContent||(o=pC(t,n.from)),n.empty||n.$from.parent.inlineContent||(s=pC(t,n.to))),t.docView.setSelection(a,c,t.root,e),fC&&(o&&mC(o),s&&mC(s)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&vC(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}nC.prototype.destroyBetween=function(t,e){if(t!=e){for(var n=t;n<e;n++)this.top.children[n].destroy();this.top.children.splice(t,e-t),this.changed=!0}},nC.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},nC.prototype.syncToMarks=function(t,e,n){var r=0,i=this.stack.length>>1,o=Math.min(i,t.length);while(r<o&&(r==i-1?this.top:this.stack[r+1<<1]).matchesMark(t[r])&&!1!==t[r].type.spec.spanning)r++;while(r<i)this.destroyRest(),this.top.dirty=Rx,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;while(i<t.length){this.stack.push(this.top,this.index+1);for(var s=-1,a=this.index;a<Math.min(this.index+3,this.top.children.length);a++)if(this.top.children[a].matchesMark(t[i])){s=a;break}if(s>-1)s>this.index&&(this.changed=!0,this.destroyBetween(this.index,s)),this.top=this.top.children[this.index];else{var c=$x.create(this.top,t[i],e,n);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,i++}},nC.prototype.findNodeMatch=function(t,e,n,r){var i,o=-1;if(r>=this.preMatch.index&&(i=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&i.matchesNode(t,e,n))o=this.top.children.indexOf(i,this.index);else for(var s=this.index,a=Math.min(this.top.children.length,s+5);s<a;s++){var c=this.top.children[s];if(c.matchesNode(t,e,n)&&!this.preMatch.matched.has(c)){o=s;break}}return!(o<0)&&(this.destroyBetween(this.index,o),this.index++,!0)},nC.prototype.updateNodeAt=function(t,e,n,r,i){var o=this.top.children[r];return!!o.update(t,e,n,i)&&(this.destroyBetween(this.index,r),this.index=r+1,!0)},nC.prototype.findIndexWithChild=function(t){for(;;){var e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){var n=t.pmViewDesc;if(n)for(var r=this.index;r<this.top.children.length;r++)if(this.top.children[r]==n)return r;return-1}t=e}},nC.prototype.updateNextNode=function(t,e,n,r,i){for(var o=this.index;o<this.top.children.length;o++){var s=this.top.children[o];if(s instanceof Hx){var a=this.preMatch.matched.get(s);if(null!=a&&a!=i)return!1;var c=s.dom,u=this.lock&&(c==this.lock||1==c.nodeType&&c.contains(this.lock.parentNode))&&!(t.isText&&s.node&&s.node.isText&&s.nodeDOM.nodeValue==t.text&&s.dirty!=Bx&&tC(e,s.outerDeco));if(!u&&s.update(t,e,n,r))return this.destroyBetween(this.index,o),s.dom!=c&&(this.changed=!0),this.index++,!0;break}}return!1},nC.prototype.addNode=function(t,e,n,r,i){this.top.children.splice(this.index++,0,Hx.create(this.top,t,e,n,r,i)),this.changed=!0},nC.prototype.placeWidget=function(t,e,n){var r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(t)||t!=r.widget&&r.widget.type.toDOM.parentNode){var i=new jx(this.top,t,e,n);this.top.children.splice(this.index++,0,i),this.changed=!0}else this.index++},nC.prototype.addTextblockHacks=function(){var t=this.top.children[this.index-1],e=this.top;while(t instanceof $x)e=t,t=e.children[e.children.length-1];t&&t instanceof Wx&&!/\n$/.test(t.node.text)||((Ik.safari||Ik.chrome)&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))},nC.prototype.addHackNode=function(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{var n=document.createElement(t);"IMG"==t&&(n.className="ProseMirror-separator",n.alt=""),"BR"==t&&(n.className="ProseMirror-trailingBreak");var r=new Ux(this.top,zx,n,null);e!=this.top?e.children.push(r):e.children.splice(this.index++,0,r),this.changed=!0}};var fC=Ik.safari||Ik.chrome&&Ik.chrome_version<63;function pC(t,e){var n=t.docView.domFromPos(e,0),r=n.node,i=n.offset,o=i<r.childNodes.length?r.childNodes[i]:null,s=i?r.childNodes[i-1]:null;if(Ik.safari&&o&&"false"==o.contentEditable)return gC(o);if((!o||"false"==o.contentEditable)&&(!s||"false"==s.contentEditable)){if(o)return gC(o);if(s)return gC(s)}}function gC(t){return t.contentEditable="true",Ik.safari&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function mC(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function vC(t){var e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.hideSelectionGuard);var n=t.root.getSelection(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.hideSelectionGuard=function(){n.anchorNode==r&&n.anchorOffset==i||(e.removeEventListener("selectionchange",t.hideSelectionGuard),setTimeout((function(){dC(t)&&!t.state.selection.visible||t.dom.classList.remove("ProseMirror-hideselection")}),20))})}function yC(t){var e=t.root.getSelection(),n=document.createRange(),r=t.cursorWrapper.dom,i="IMG"==r.nodeName;i?n.setEnd(r.parentNode,Vk(r)+1):n.setEnd(r,0),n.collapse(!1),e.removeAllRanges(),e.addRange(n),!i&&!t.state.selection.visible&&Ik.ie&&Ik.ie_version<=11&&(r.disabled=!0,r.disabled=!1)}function bC(t,e){if(e instanceof ND){var n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(wC(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else wC(t)}function wC(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=null)}function EC(t,e,n,r){return t.someProp("createSelectionBetween",(function(r){return r(t,e,n)}))||TD.between(e,n,r)}function SC(t){return(!t.editable||t.root.activeElement==t.dom)&&DC(t)}function DC(t){var e=t.root.getSelection();if(!e.anchorNode)return!1;try{return t.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch(n){return!1}}function kC(t){var e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.root.getSelection();return Gk(e.node,e.offset,n.anchorNode,n.anchorOffset)}function xC(t,e){var n=t.selection,r=n.$anchor,i=n.$head,o=e>0?r.max(i):r.min(i),s=o.parent.inlineContent?o.depth?t.doc.resolve(e>0?o.after():o.before()):null:o;return s&&OD.findFrom(s,e)}function CC(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function _C(t,e,n){var r=t.state.selection;if(!(r instanceof TD)){if(r instanceof ND&&r.node.isInline)return CC(t,new TD(e>0?r.$to:r.$from));var i=xC(t.state,e);return!!i&&CC(t,i)}if(!r.empty||n.indexOf("s")>-1)return!1;if(t.endOfTextblock(e>0?"right":"left")){var o=xC(t.state,e);return!!(o&&o instanceof ND)&&CC(t,o)}if(!(Ik.mac&&n.indexOf("m")>-1)){var s,a=r.$head,c=a.textOffset?null:e<0?a.nodeBefore:a.nodeAfter;if(!c||c.isText)return!1;var u=e<0?a.pos-c.nodeSize:a.pos;return!!(c.isAtom||(s=t.docView.descAt(u))&&!s.contentDOM)&&(ND.isSelectable(c)?CC(t,new ND(e<0?t.state.doc.resolve(a.pos-c.nodeSize):a)):!!Ik.webkit&&CC(t,new TD(t.state.doc.resolve(e<0?u:u+c.nodeSize))))}}function OC(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function AC(t){var e=t.pmViewDesc;return e&&0==e.size&&(t.nextSibling||"BR"!=t.nodeName)}function MC(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){var i,o,s=!1;for(Ik.gecko&&1==n.nodeType&&r<OC(n)&&AC(n.childNodes[r])&&(s=!0);;)if(r>0){if(1!=n.nodeType)break;var a=n.childNodes[r-1];if(AC(a))i=n,o=--r;else{if(3!=a.nodeType)break;n=a,r=n.nodeValue.length}}else{if(RC(n))break;var c=n.previousSibling;while(c&&AC(c))i=n.parentNode,o=Vk(c),c=c.previousSibling;if(c)n=c,r=OC(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}s?NC(t,e,n,r):i&&NC(t,e,i,o)}}function TC(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){for(var i,o,s=OC(n);;)if(r<s){if(1!=n.nodeType)break;var a=n.childNodes[r];if(!AC(a))break;i=n,o=++r}else{if(RC(n))break;var c=n.nextSibling;while(c&&AC(c))i=c.parentNode,o=Vk(c)+1,c=c.nextSibling;if(c)n=c,r=0,s=OC(n);else{if(n=n.parentNode,n==t.dom)break;r=s=0}}i&&NC(t,e,i,o)}}function RC(t){var e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function NC(t,e,n,r){if(Qk(e)){var i=document.createRange();i.setEnd(n,r),i.setStart(n,r),e.removeAllRanges(),e.addRange(i)}else e.extend&&e.extend(n,r);t.domObserver.setCurSelection();var o=t.state;setTimeout((function(){t.state==o&&hC(t)}),50)}function PC(t,e,n){var r=t.state.selection;if(r instanceof TD&&!r.empty||n.indexOf("s")>-1)return!1;if(Ik.mac&&n.indexOf("m")>-1)return!1;var i=r.$from,o=r.$to;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){var s=xC(t.state,e);if(s&&s instanceof ND)return CC(t,s)}if(!i.parent.inlineContent){var a=e<0?i:o,c=r instanceof BD?OD.near(a,e):OD.findFrom(a,e);return!!c&&CC(t,c)}return!1}function BC(t,e){if(!(t.state.selection instanceof TD))return!0;var n=t.state.selection,r=n.$head,i=n.$anchor,o=n.empty;if(!r.sameParent(i))return!0;if(!o)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;var s=!r.textOffset&&(e<0?r.nodeBefore:r.nodeAfter);if(s&&!s.isText){var a=t.state.tr;return e<0?a.delete(r.pos-s.nodeSize,r.pos):a.delete(r.pos,r.pos+s.nodeSize),t.dispatch(a),!0}return!1}function FC(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function IC(t){if(Ik.safari&&!(t.state.selection.$head.parentOffset>0)){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n&&1==n.nodeType&&0==r&&n.firstChild&&"false"==n.firstChild.contentEditable){var i=n.firstChild;FC(t,i,!0),setTimeout((function(){return FC(t,i,!1)}),20)}}}function zC(t){var e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function jC(t,e){var n=e.keyCode,r=zC(e);return 8==n||Ik.mac&&72==n&&"c"==r?BC(t,-1)||MC(t):46==n||Ik.mac&&68==n&&"c"==r?BC(t,1)||TC(t):13==n||27==n||(37==n?_C(t,-1,r)||MC(t):39==n?_C(t,1,r)||TC(t):38==n?PC(t,-1,r)||MC(t):40==n?IC(t)||PC(t,1,r)||TC(t):r==(Ik.mac?"m":"c")&&(66==n||73==n||89==n||90==n))}function LC(t,e,n){var r=t.docView.parseRange(e,n),i=r.node,o=r.fromOffset,s=r.toOffset,a=r.from,c=r.to,u=t.root.getSelection(),l=null,d=u.anchorNode;if(d&&t.dom.contains(1==d.nodeType?d:d.parentNode)&&(l=[{node:d,offset:u.anchorOffset}],Qk(u)||l.push({node:u.focusNode,offset:u.focusOffset})),Ik.chrome&&8===t.lastKeyCode)for(var h=s;h>o;h--){var f=i.childNodes[h-1],p=f.pmViewDesc;if("BR"==f.nodeName&&!p){s=h;break}if(!p||p.size)break}var g=t.state.doc,m=t.someProp("domParser")||gS.fromSchema(t.state.schema),v=g.resolve(a),y=null,b=m.parse(i,{topNode:v.parent,topMatch:v.parent.contentMatchAt(v.index()),topOpen:!0,from:o,to:s,preserveWhitespace:"pre"!=v.parent.type.whitespace||"full",editableContent:!0,findPositions:l,ruleFromNode:$C,context:v});if(l&&null!=l[0].pos){var w=l[0].pos,E=l[1]&&l[1].pos;null==E&&(E=w),y={anchor:w+a,head:E+a}}return{doc:b,sel:y,from:a,to:c}}function $C(t){var e=t.pmViewDesc;if(e)return e.parseRule();if("BR"==t.nodeName&&t.parentNode){if(Ik.safari&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){var n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(t.parentNode.lastChild==t||Ik.safari&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if("IMG"==t.nodeName&&t.getAttribute("mark-placeholder"))return{ignore:!0}}function HC(t,e,n,r,i){if(e<0){var o=t.lastSelectionTime>Date.now()-50?t.lastSelectionOrigin:null,s=lC(t,o);if(s&&!t.state.selection.eq(s)){var a=t.state.tr.setSelection(s);"pointer"==o?a.setMeta("pointer",!0):"key"==o&&a.scrollIntoView(),t.dispatch(a)}}else{var c=t.state.doc.resolve(e),u=c.sharedDepth(n);e=c.before(u+1),n=t.state.doc.resolve(n).after(u+1);var l=t.state.selection,d=LC(t,e,n);if(Ik.chrome&&t.cursorWrapper&&d.sel&&d.sel.anchor==t.cursorWrapper.deco.from){var h=t.cursorWrapper.deco.type.toDOM.nextSibling,f=h&&h.nodeValue?h.nodeValue.length:1;d.sel={anchor:d.sel.anchor+f,head:d.sel.anchor+f}}var p,g,m=t.state.doc,v=m.slice(d.from,d.to);8===t.lastKeyCode&&Date.now()-100<t.lastKeyCodeTime?(p=t.state.selection.to,g="end"):(p=t.state.selection.from,g="start"),t.lastKeyCode=null;var y=GC(v.content,d.doc.content,d.from,p,g);if((Ik.ios&&t.lastIOSEnter>Date.now()-225||Ik.android)&&i.some((function(t){return"DIV"==t.nodeName||"P"==t.nodeName}))&&(!y||y.endA>=y.endB)&&t.someProp("handleKeyDown",(function(e){return e(t,tx(13,"Enter"))})))t.lastIOSEnter=0;else{if(!y){if(!(r&&l instanceof TD&&!l.empty&&l.$head.sameParent(l.$anchor))||t.composing||d.sel&&d.sel.anchor!=d.sel.head){if(d.sel){var b=VC(t,t.state.doc,d.sel);b&&!b.eq(t.state.selection)&&t.dispatch(t.state.tr.setSelection(b))}return}y={start:l.from,endA:l.to,endB:l.to}}t.domChangeCount++,t.state.selection.from<t.state.selection.to&&y.start==y.endB&&t.state.selection instanceof TD&&(y.start>t.state.selection.from&&y.start<=t.state.selection.from+2&&t.state.selection.from>=d.from?y.start=t.state.selection.from:y.endA<t.state.selection.to&&y.endA>=t.state.selection.to-2&&t.state.selection.to<=d.to&&(y.endB+=t.state.selection.to-y.endA,y.endA=t.state.selection.to)),Ik.ie&&Ik.ie_version<=11&&y.endB==y.start+1&&y.endA==y.start&&y.start>d.from&&"  "==d.doc.textBetween(y.start-d.from-1,y.start-d.from+1)&&(y.start--,y.endA--,y.endB--);var w,E=d.doc.resolveNoCache(y.start-d.from),S=d.doc.resolveNoCache(y.endB-d.from),D=E.sameParent(S)&&E.parent.inlineContent;if((Ik.ios&&t.lastIOSEnter>Date.now()-225&&(!D||i.some((function(t){return"DIV"==t.nodeName||"P"==t.nodeName})))||!D&&E.pos<d.doc.content.size&&(w=OD.findFrom(d.doc.resolve(E.pos+1),1,!0))&&w.head==S.pos)&&t.someProp("handleKeyDown",(function(e){return e(t,tx(13,"Enter"))})))t.lastIOSEnter=0;else if(t.state.selection.anchor>y.start&&UC(m,y.start,y.endA,E,S)&&t.someProp("handleKeyDown",(function(e){return e(t,tx(8,"Backspace"))})))Ik.android&&Ik.chrome&&t.domObserver.suppressSelectionUpdates();else{Ik.chrome&&Ik.android&&y.toB==y.from&&(t.lastAndroidDelete=Date.now()),Ik.android&&!D&&E.start()!=S.start()&&0==S.parentOffset&&E.depth==S.depth&&d.sel&&d.sel.anchor==d.sel.head&&d.sel.head==y.endA&&(y.endB-=2,S=d.doc.resolveNoCache(y.endB-d.from),setTimeout((function(){t.someProp("handleKeyDown",(function(e){return e(t,tx(13,"Enter"))}))}),20));var k,x,C,_,O=y.start,A=y.endA;if(D)if(E.pos==S.pos)Ik.ie&&Ik.ie_version<=11&&0==E.parentOffset&&(t.domObserver.suppressSelectionUpdates(),setTimeout((function(){return hC(t)}),20)),k=t.state.tr.delete(O,A),x=m.resolve(y.start).marksAcross(m.resolve(y.endA));else if(y.endA==y.endB&&(_=m.resolve(y.start))&&(C=WC(E.parent.content.cut(E.parentOffset,S.parentOffset),_.parent.content.cut(_.parentOffset,y.endA-_.start()))))k=t.state.tr,"add"==C.type?k.addMark(O,A,C.mark):k.removeMark(O,A,C.mark);else if(E.parent.child(E.index()).isText&&E.index()==S.index()-(S.textOffset?0:1)){var M=E.parent.textBetween(E.parentOffset,S.parentOffset);if(t.someProp("handleTextInput",(function(e){return e(t,O,A,M)})))return;k=t.state.tr.insertText(M,O,A)}if(k||(k=t.state.tr.replace(O,A,d.doc.slice(y.start-d.from,y.endB-d.from))),d.sel){var T=VC(t,k.doc,d.sel);T&&!(Ik.chrome&&Ik.android&&t.composing&&T.empty&&(y.start!=y.endB||t.lastAndroidDelete<Date.now()-100)&&(T.head==O||T.head==k.mapping.map(A)-1)||Ik.ie&&T.empty&&T.head==O)&&k.setSelection(T)}x&&k.ensureMarks(x),t.dispatch(k.scrollIntoView())}}}}function VC(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:EC(t,e.resolve(n.anchor),e.resolve(n.head))}function WC(t,e){for(var n,r,i,o=t.firstChild.marks,s=e.firstChild.marks,a=o,c=s,u=0;u<s.length;u++)a=s[u].removeFromSet(a);for(var l=0;l<o.length;l++)c=o[l].removeFromSet(c);if(1==a.length&&0==c.length)r=a[0],n="add",i=function(t){return t.mark(r.addToSet(t.marks))};else{if(0!=a.length||1!=c.length)return null;r=c[0],n="remove",i=function(t){return t.mark(r.removeFromSet(t.marks))}}for(var d=[],h=0;h<e.childCount;h++)d.push(i(e.child(h)));if(lE.from(d).eq(t))return{mark:r,type:n}}function UC(t,e,n,r,i){if(!r.parent.isTextblock||n-e<=i.pos-r.pos||qC(r,!0,!1)<i.pos)return!1;var o=t.resolve(e);if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;var s=t.resolve(qC(o,!0,!0));return!(!s.parent.isTextblock||s.pos>n||qC(s,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function qC(t,e,n){var r=t.depth,i=e?t.end():t.pos;while(r>0&&(e||t.indexAfter(r)==t.node(r).childCount))r--,i++,e=!1;if(n){var o=t.node(r).maybeChild(t.indexAfter(r));while(o&&!o.isLeaf)o=o.firstChild,i++}return i}function GC(t,e,n,r,i){var o=t.findDiffStart(e,n);if(null==o)return null;var s=t.findDiffEnd(e,n+t.size,n+e.size),a=s.a,c=s.b;if("end"==i){var u=Math.max(0,o-Math.min(a,c));r-=a+u-o}if(a<o&&t.size<e.size){var l=r<=o&&r>=a?o-r:0;o-=l,c=o+(c-a),a=o}else if(c<o){var d=r<=o&&r>=c?o-r:0;o-=d,a=o+(a-c),c=o}return{start:o,endA:a,endB:c}}function KC(t,e){var n=[],r=e.content,i=e.openStart,o=e.openEnd;while(i>1&&o>1&&1==r.childCount&&1==r.firstChild.childCount){i--,o--;var s=r.firstChild;n.push(s.type.name,s.attrs!=s.type.defaultAttrs?s.attrs:null),r=s.content}var a=t.someProp("clipboardSerializer")||RS.fromSchema(t.state.schema),c=o_(),u=c.createElement("div");u.appendChild(a.serializeFragment(r,{document:c}));var l,d=u.firstChild;while(d&&1==d.nodeType&&(l=r_[d.nodeName.toLowerCase()])){for(var h=l.length-1;h>=0;h--){var f=c.createElement(l[h]);while(u.firstChild)f.appendChild(u.firstChild);u.appendChild(f),"tbody"!=l[h]&&(i++,o++)}d=u.firstChild}d&&1==d.nodeType&&d.setAttribute("data-pm-slice",i+" "+o+" "+JSON.stringify(n));var p=t.someProp("clipboardTextSerializer",(function(t){return t(e)}))||e.content.textBetween(0,e.content.size,"\n\n");return{dom:u,text:p}}function YC(t,e,n,r,i){var o,s,a=i.parent.type.spec.code;if(!n&&!e)return null;var c=e&&(r||a||!n);if(c){if(t.someProp("transformPastedText",(function(t){e=t(e,a||r)})),a)return e?new vE(lE.from(t.state.schema.text(e.replace(/\r\n?/g,"\n"))),0,0):vE.empty;var u=t.someProp("clipboardTextParser",(function(t){return t(e,i,r)}));if(u)s=u;else{var l=i.marks(),d=t.state,h=d.schema,f=RS.fromSchema(h);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach((function(t){var e=o.appendChild(document.createElement("p"));t&&e.appendChild(f.serializeNode(h.text(t,l)))}))}}else t.someProp("transformPastedHTML",(function(t){n=t(n)})),o=s_(n),Ik.webkit&&a_(o);var p=o&&o.querySelector("[data-pm-slice]"),g=p&&/^(\d+) (\d+) (.*)/.exec(p.getAttribute("data-pm-slice"));if(!s){var m=t.someProp("clipboardParser")||t.someProp("domParser")||gS.fromSchema(t.state.schema);s=m.parseSlice(o,{preserveWhitespace:!(!c&&!g),context:i,ruleFromNode:function(t){if("BR"==t.nodeName&&!t.nextSibling&&t.parentNode&&!XC.test(t.parentNode.nodeName))return{ignore:!0}}})}if(g)s=c_(n_(s,+g[1],+g[2]),g[3]);else if(s=vE.maxOpen(JC(s.content,i),!0),s.openStart||s.openEnd){for(var v=0,y=0,b=s.content.firstChild;v<s.openStart&&!b.type.spec.isolating;v++,b=b.firstChild);for(var w=s.content.lastChild;y<s.openEnd&&!w.type.spec.isolating;y++,w=w.lastChild);s=n_(s,v,y)}return t.someProp("transformPasted",(function(t){s=t(s)})),s}var XC=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function JC(t,e){if(t.childCount<2)return t;for(var n=function(n){var r=e.node(n),i=r.contentMatchAt(e.index(n)),o=void 0,s=[];if(t.forEach((function(t){if(s){var e,n=i.findWrapping(t.type);if(!n)return s=null;if(e=s.length&&o.length&&QC(n,o,t,s[s.length-1],0))s[s.length-1]=e;else{s.length&&(s[s.length-1]=t_(s[s.length-1],o.length));var r=ZC(t,n);s.push(r),i=i.matchType(r.type,r.attrs),o=n}}})),s)return{v:lE.from(s)}},r=e.depth;r>=0;r--){var i=n(r);if(i)return i.v}return t}function ZC(t,e,n){void 0===n&&(n=0);for(var r=e.length-1;r>=n;r--)t=e[r].create(null,lE.from(t));return t}function QC(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){var o=QC(t,e,n,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));var s=r.contentMatchAt(r.childCount);if(s.matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(lE.from(ZC(n,t,i+1))))}}function t_(t,e){if(0==e)return t;var n=t.content.replaceChild(t.childCount-1,t_(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(lE.empty,!0);return t.copy(n.append(r))}function e_(t,e,n,r,i,o){var s=e<0?t.firstChild:t.lastChild,a=s.content;return i<r-1&&(a=e_(a,e,n,r,i+1,o)),i>=n&&(a=e<0?s.contentMatchAt(0).fillBefore(a,t.childCount>1||o<=i).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(lE.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(a))}function n_(t,e,n){return e<t.openStart&&(t=new vE(e_(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new vE(e_(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}var r_={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},i_=null;function o_(){return i_||(i_=document.implementation.createHTMLDocument("title"))}function s_(t){var e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));var n,r=o_().createElement("div"),i=/<([a-z][^>\s]+)/i.exec(t);if((n=i&&r_[i[1].toLowerCase()])&&(t=n.map((function(t){return"<"+t+">"})).join("")+t+n.map((function(t){return"</"+t+">"})).reverse().join("")),r.innerHTML=t,n)for(var o=0;o<n.length;o++)r=r.querySelector(n[o])||r;return r}function a_(t){for(var e=t.querySelectorAll(Ik.chrome?"span:not([class]):not([style])":"span.Apple-converted-space"),n=0;n<e.length;n++){var r=e[n];1==r.childNodes.length&&" "==r.textContent&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function c_(t,e){if(!t.size)return t;var n,r=t.content.firstChild.type.schema;try{n=JSON.parse(e)}catch(Xw){return t}for(var i=t.content,o=t.openStart,s=t.openEnd,a=n.length-2;a>=0;a-=2){var c=r.nodes[n[a]];if(!c||c.hasRequiredAttrs())break;i=lE.from(c.create(n[a+1],i)),o++,s++}return new vE(i,o,s)}var u_={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},l_=Ik.ie&&Ik.ie_version<=11,d_=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};d_.prototype.set=function(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset},d_.prototype.eq=function(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset};var h_=function(t,e){var n=this;this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver((function(t){for(var e=0;e<t.length;e++)n.queue.push(t[e]);Ik.ie&&Ik.ie_version<=11&&t.some((function(t){return"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length}))?n.flushSoon():n.flush()})),this.currentSelection=new d_,l_&&(this.onCharData=function(t){n.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};h_.prototype.flushSoon=function(){var t=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){t.flushingSoon=-1,t.flush()}),20))},h_.prototype.forceFlush=function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},h_.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,u_),l_&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},h_.prototype.stop=function(){var t=this;if(this.observer){var e=this.observer.takeRecords();if(e.length){for(var n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout((function(){return t.flush()}),20)}this.observer.disconnect()}l_&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},h_.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},h_.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},h_.prototype.suppressSelectionUpdates=function(){var t=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return t.suppressingSelectionUpdates=!1}),50)},h_.prototype.onSelectionChange=function(){if(SC(this.view)){if(this.suppressingSelectionUpdates)return hC(this.view);if(Ik.ie&&Ik.ie_version<=11&&!this.view.state.selection.empty){var t=this.view.root.getSelection();if(t.focusNode&&Gk(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}},h_.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},h_.prototype.ignoreSelectionChange=function(t){if(0==t.rangeCount)return!0;var e=t.getRangeAt(0).commonAncestorContainer,n=this.view.docView.nearestDesc(e);return n&&n.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0},h_.prototype.flush=function(){if(this.view.docView&&!(this.flushingSoon>-1)){var t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);var e=this.view.root.getSelection(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&SC(this.view)&&!this.ignoreSelectionChange(e),r=-1,i=-1,o=!1,s=[];if(this.view.editable)for(var a=0;a<t.length;a++){var c=this.registerMutation(t[a],s);c&&(r=r<0?c.from:Math.min(c.from,r),i=i<0?c.to:Math.max(c.to,i),c.typeOver&&(o=!0))}if(Ik.gecko&&s.length>1){var u=s.filter((function(t){return"BR"==t.nodeName}));if(2==u.length){var l=u[0],d=u[1];l.parentNode&&l.parentNode.parentNode==d.parentNode?d.remove():l.remove()}}(r>-1||n)&&(r>-1&&(this.view.docView.markDirty(r,i),p_(this.view)),this.handleDOMChange(r,i,o,s),this.view.docView&&this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(e)||hC(this.view),this.currentSelection.set(e))}},h_.prototype.registerMutation=function(t,e){if(e.indexOf(t.target)>-1)return null;var n=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(n==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(t))return null;if("childList"==t.type){for(var r=0;r<t.addedNodes.length;r++)e.push(t.addedNodes[r]);if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};var i=t.previousSibling,o=t.nextSibling;if(Ik.ie&&Ik.ie_version<=11&&t.addedNodes.length)for(var s=0;s<t.addedNodes.length;s++){var a=t.addedNodes[s],c=a.previousSibling,u=a.nextSibling;(!c||Array.prototype.indexOf.call(t.addedNodes,c)<0)&&(i=c),(!u||Array.prototype.indexOf.call(t.addedNodes,u)<0)&&(o=u)}var l=i&&i.parentNode==t.target?Vk(i)+1:0,d=n.localPosFromDOM(t.target,l,-1),h=o&&o.parentNode==t.target?Vk(o):t.target.childNodes.length,f=n.localPosFromDOM(t.target,h,1);return{from:d,to:f}}return"attributes"==t.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}};var f_=!1;function p_(t){f_||(f_=!0,"normal"==getComputedStyle(t.dom).whiteSpace&&console["warn"]("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."))}var g_={},m_={};function v_(t){t.shiftKey=!1,t.mouseDown=null,t.lastKeyCode=null,t.lastKeyCodeTime=0,t.lastClick={time:0,x:0,y:0,type:""},t.lastSelectionOrigin=null,t.lastSelectionTime=0,t.lastIOSEnter=0,t.lastIOSEnterFallbackTimeout=null,t.lastAndroidDelete=0,t.composing=!1,t.composingTimeout=null,t.compositionNodes=[],t.compositionEndedAt=-2e8,t.domObserver=new h_(t,(function(e,n,r,i){return HC(t,e,n,r,i)})),t.domObserver.start(),t.domChangeCount=0,t.eventHandlers=Object.create(null);var e=function(e){var n=g_[e];t.dom.addEventListener(e,t.eventHandlers[e]=function(e){!S_(t,e)||E_(t,e)||!t.editable&&e.type in m_||n(t,e)})};for(var n in g_)e(n);Ik.safari&&t.dom.addEventListener("input",(function(){return null})),w_(t)}function y_(t,e){t.lastSelectionOrigin=e,t.lastSelectionTime=Date.now()}function b_(t){for(var e in t.domObserver.stop(),t.eventHandlers)t.dom.removeEventListener(e,t.eventHandlers[e]);clearTimeout(t.composingTimeout),clearTimeout(t.lastIOSEnterFallbackTimeout)}function w_(t){t.someProp("handleDOMEvents",(function(e){for(var n in e)t.eventHandlers[n]||t.dom.addEventListener(n,t.eventHandlers[n]=function(e){return E_(t,e)})}))}function E_(t,e){return t.someProp("handleDOMEvents",(function(n){var r=n[e.type];return!!r&&(r(t,e)||e.defaultPrevented)}))}function S_(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(var n=e.target;n!=t.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function D_(t,e){E_(t,e)||!g_[e.type]||!t.editable&&e.type in m_||g_[e.type](t,e)}function k_(t){return{left:t.clientX,top:t.clientY}}function x_(t,e){var n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function C_(t,e,n,r,i){if(-1==r)return!1;for(var o=t.state.doc.resolve(r),s=function(r){if(t.someProp(e,(function(e){return r>o.depth?e(t,n,o.nodeAfter,o.before(r),i,!0):e(t,n,o.node(r),o.before(r),i,!1)})))return{v:!0}},a=o.depth+1;a>0;a--){var c=s(a);if(c)return c.v}return!1}function __(t,e,n){t.focused||t.focus();var r=t.state.tr.setSelection(e);"pointer"==n&&r.setMeta("pointer",!0),t.dispatch(r)}function O_(t,e){if(-1==e)return!1;var n=t.state.doc.resolve(e),r=n.nodeAfter;return!!(r&&r.isAtom&&ND.isSelectable(r))&&(__(t,new ND(n),"pointer"),!0)}function A_(t,e){if(-1==e)return!1;var n,r,i=t.state.selection;i instanceof ND&&(n=i.node);for(var o=t.state.doc.resolve(e),s=o.depth+1;s>0;s--){var a=s>o.depth?o.nodeAfter:o.node(s);if(ND.isSelectable(a)){r=n&&i.$from.depth>0&&s>=i.$from.depth&&o.before(i.$from.depth+1)==i.$from.pos?o.before(i.$from.depth):o.before(s);break}}return null!=r&&(__(t,ND.create(t.state.doc,r),"pointer"),!0)}function M_(t,e,n,r,i){return C_(t,"handleClickOn",e,n,r)||t.someProp("handleClick",(function(n){return n(t,e,r)}))||(i?A_(t,n):O_(t,n))}function T_(t,e,n,r){return C_(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",(function(n){return n(t,e,r)}))}function R_(t,e,n,r){return C_(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",(function(n){return n(t,e,r)}))||N_(t,n,r)}function N_(t,e,n){if(0!=n.button)return!1;var r=t.state.doc;if(-1==e)return!!r.inlineContent&&(__(t,TD.create(r,0,r.content.size),"pointer"),!0);for(var i=r.resolve(e),o=i.depth+1;o>0;o--){var s=o>i.depth?i.nodeAfter:i.node(o),a=i.before(o);if(s.inlineContent)__(t,TD.create(r,a+1,a+1+s.content.size),"pointer");else{if(!ND.isSelectable(s))continue;__(t,ND.create(r,a),"pointer")}return!0}}function P_(t){return H_(t)}m_.keydown=function(t,e){if(t.shiftKey=16==e.keyCode||e.shiftKey,!I_(t,e)&&(t.lastKeyCode=e.keyCode,t.lastKeyCodeTime=Date.now(),!Ik.android||!Ik.chrome||13!=e.keyCode))if(229!=e.keyCode&&t.domObserver.forceFlush(),!Ik.ios||13!=e.keyCode||e.ctrlKey||e.altKey||e.metaKey)t.someProp("handleKeyDown",(function(n){return n(t,e)}))||jC(t,e)?e.preventDefault():y_(t,"key");else{var n=Date.now();t.lastIOSEnter=n,t.lastIOSEnterFallbackTimeout=setTimeout((function(){t.lastIOSEnter==n&&(t.someProp("handleKeyDown",(function(e){return e(t,tx(13,"Enter"))})),t.lastIOSEnter=0)}),200)}},m_.keyup=function(t,e){16==e.keyCode&&(t.shiftKey=!1)},m_.keypress=function(t,e){if(!(I_(t,e)||!e.charCode||e.ctrlKey&&!e.altKey||Ik.mac&&e.metaKey))if(t.someProp("handleKeyPress",(function(n){return n(t,e)})))e.preventDefault();else{var n=t.state.selection;if(!(n instanceof TD)||!n.$from.sameParent(n.$to)){var r=String.fromCharCode(e.charCode);t.someProp("handleTextInput",(function(e){return e(t,n.$from.pos,n.$to.pos,r)}))||t.dispatch(t.state.tr.insertText(r).scrollIntoView()),e.preventDefault()}}};var B_=Ik.mac?"metaKey":"ctrlKey";g_.mousedown=function(t,e){t.shiftKey=e.shiftKey;var n=P_(t),r=Date.now(),i="singleClick";r-t.lastClick.time<500&&x_(e,t.lastClick)&&!e[B_]&&("singleClick"==t.lastClick.type?i="doubleClick":"doubleClick"==t.lastClick.type&&(i="tripleClick")),t.lastClick={time:r,x:e.clientX,y:e.clientY,type:i};var o=t.posAtCoords(k_(e));o&&("singleClick"==i?(t.mouseDown&&t.mouseDown.done(),t.mouseDown=new F_(t,o,e,n)):("doubleClick"==i?T_:R_)(t,o.pos,o.inside,e)?e.preventDefault():y_(t,"pointer"))};var F_=function(t,e,n,r){var i,o,s=this;if(this.view=t,this.startDoc=t.state.doc,this.pos=e,this.event=n,this.flushed=r,this.selectNode=n[B_],this.allowDefault=n.shiftKey,this.delayedSelectionSync=!1,e.inside>-1)i=t.state.doc.nodeAt(e.inside),o=e.inside;else{var a=t.state.doc.resolve(e.pos);i=a.parent,o=a.depth?a.before():0}this.mightDrag=null;var c=r?null:n.target,u=c?t.docView.nearestDesc(c,!0):null;this.target=u?u.dom:null;var l=t.state,d=l.selection;(0==n.button&&i.type.spec.draggable&&!1!==i.type.spec.selectable||d instanceof ND&&d.from<=o&&d.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&Ik.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){s.view.mouseDown==s&&s.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),y_(t,"pointer")};function I_(t,e){return!!t.composing||!!(Ik.safari&&Math.abs(e.timeStamp-t.compositionEndedAt)<500)&&(t.compositionEndedAt=-2e8,!0)}F_.prototype.done=function(){var t=this;this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout((function(){return hC(t.view)})),this.view.mouseDown=null},F_.prototype.up=function(t){if(this.done(),this.view.dom.contains(3==t.target.nodeType?t.target.parentNode:t.target)){var e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(k_(t))),this.allowDefault||!e?y_(this.view,"pointer"):M_(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||Ik.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||Ik.chrome&&!(this.view.state.selection instanceof TD)&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(__(this.view,OD.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):y_(this.view,"pointer")}},F_.prototype.move=function(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),y_(this.view,"pointer"),0==t.buttons&&this.done()},g_.touchdown=function(t){P_(t),y_(t,"pointer")},g_.contextmenu=function(t){return P_(t)};var z_=Ik.android?5e3:-1;function j_(t,e){clearTimeout(t.composingTimeout),e>-1&&(t.composingTimeout=setTimeout((function(){return H_(t)}),e))}function L_(t){t.composing&&(t.composing=!1,t.compositionEndedAt=$_());while(t.compositionNodes.length>0)t.compositionNodes.pop().markParentsDirty()}function $_(){var t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function H_(t,e){if(!(Ik.android&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),L_(t),e||t.docView&&t.docView.dirty){var n=lC(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):t.updateState(t.state),!0}return!1}}function V_(t,e){if(t.dom.parentNode){var n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";var r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout((function(){n.parentNode&&n.parentNode.removeChild(n),t.focus()}),50)}}m_.compositionstart=m_.compositionupdate=function(t){if(!t.composing){t.domObserver.flush();var e=t.state,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some((function(t){return!1===t.type.spec.inclusive}))))t.markCursor=t.state.storedMarks||n.marks(),H_(t,!0),t.markCursor=null;else if(H_(t),Ik.gecko&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=t.root.getSelection(),i=r.focusNode,o=r.focusOffset;i&&1==i.nodeType&&0!=o;){var s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(3==s.nodeType){r.collapse(s,s.nodeValue.length);break}i=s,o=-1}t.composing=!0}j_(t,z_)},m_.compositionend=function(t,e){t.composing&&(t.composing=!1,t.compositionEndedAt=e.timeStamp,j_(t,20))};var W_=Ik.ie&&Ik.ie_version<15||Ik.ios&&Ik.webkit_version<604;function U_(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}function q_(t,e){if(t.dom.parentNode){var n=t.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout((function(){t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?G_(t,r.value,null,e):G_(t,r.textContent,r.innerHTML,e)}),50)}}function G_(t,e,n,r){var i=YC(t,e,n,t.shiftKey,t.state.selection.$from);if(t.someProp("handlePaste",(function(e){return e(t,r,i||vE.empty)})))return!0;if(!i)return!1;var o=U_(i),s=o?t.state.tr.replaceSelectionWith(o,t.shiftKey):t.state.tr.replaceSelection(i);return t.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}g_.copy=m_.cut=function(t,e){var n=t.state.selection,r="cut"==e.type;if(!n.empty){var i=W_?null:e.clipboardData,o=n.content(),s=KC(t,o),a=s.dom,c=s.text;i?(e.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",c)):V_(t,a),r&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},m_.paste=function(t,e){if(!t.composing||Ik.android){var n=W_?null:e.clipboardData;n&&G_(t,n.getData("text/plain"),n.getData("text/html"),e)?e.preventDefault():q_(t,e)}};var K_=function(t,e){this.slice=t,this.move=e},Y_=Ik.mac?"altKey":"ctrlKey";for(var X_ in g_.dragstart=function(t,e){var n=t.mouseDown;if(n&&n.done(),e.dataTransfer){var r=t.state.selection,i=r.empty?null:t.posAtCoords(k_(e));if(i&&i.pos>=r.from&&i.pos<=(r instanceof ND?r.to-1:r.to));else if(n&&n.mightDrag)t.dispatch(t.state.tr.setSelection(ND.create(t.state.doc,n.mightDrag.pos)));else if(e.target&&1==e.target.nodeType){var o=t.docView.nearestDesc(e.target,!0);o&&o.node.type.spec.draggable&&o!=t.docView&&t.dispatch(t.state.tr.setSelection(ND.create(t.state.doc,o.posBefore)))}var s=t.state.selection.content(),a=KC(t,s),c=a.dom,u=a.text;e.dataTransfer.clearData(),e.dataTransfer.setData(W_?"Text":"text/html",c.innerHTML),e.dataTransfer.effectAllowed="copyMove",W_||e.dataTransfer.setData("text/plain",u),t.dragging=new K_(s,!e[Y_])}},g_.dragend=function(t){var e=t.dragging;window.setTimeout((function(){t.dragging==e&&(t.dragging=null)}),50)},m_.dragover=m_.dragenter=function(t,e){return e.preventDefault()},m_.drop=function(t,e){var n=t.dragging;if(t.dragging=null,e.dataTransfer){var r=t.posAtCoords(k_(e));if(r){var i=t.state.doc.resolve(r.pos);if(i){var o=n&&n.slice;o?t.someProp("transformPasted",(function(t){o=t(o)})):o=YC(t,e.dataTransfer.getData(W_?"Text":"text/plain"),W_?null:e.dataTransfer.getData("text/html"),!1,i);var s=n&&!e[Y_];if(t.someProp("handleDrop",(function(n){return n(t,e,o||vE.empty,s)})))e.preventDefault();else if(o){e.preventDefault();var a=o?lD(t.state.doc,i.pos,o):i.pos;null==a&&(a=i.pos);var c=t.state.tr;s&&c.deleteSelection();var u=c.mapping.map(a),l=0==o.openStart&&0==o.openEnd&&1==o.content.childCount,d=c.doc;if(l?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),!c.doc.eq(d)){var h=c.doc.resolve(u);if(l&&ND.isSelectable(o.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new ND(h));else{var f=c.mapping.map(a);c.mapping.maps[c.mapping.maps.length-1].forEach((function(t,e,n,r){return f=r})),c.setSelection(EC(t,h,c.doc.resolve(f)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))}}}}}},g_.focus=function(t){t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout((function(){t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.root.getSelection())&&hC(t)}),20))},g_.blur=function(t,e){t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),e.relatedTarget&&t.dom.contains(e.relatedTarget)&&t.domObserver.currentSelection.set({}),t.focused=!1)},g_.beforeinput=function(t,e){if(Ik.chrome&&Ik.android&&"deleteContentBackward"==e.inputType){t.domObserver.flushSoon();var n=t.domChangeCount;setTimeout((function(){if(t.domChangeCount==n&&(t.dom.blur(),t.focus(),!t.someProp("handleKeyDown",(function(e){return e(t,tx(8,"Backspace"))})))){var e=t.state.selection,r=e.$cursor;r&&r.pos>0&&t.dispatch(t.state.tr.delete(r.pos-1,r.pos).scrollIntoView())}}),50)}},m_)g_[X_]=m_[X_];function J_(t,e){if(t==e)return!0;for(var n in t)if(t[n]!==e[n])return!1;for(var r in e)if(!(r in t))return!1;return!0}var Z_=function(t,e){this.spec=e||iO,this.side=this.spec.side||0,this.toDOM=t};Z_.prototype.map=function(t,e,n,r){var i=t.mapResult(e.from+r,this.side<0?-1:1),o=i.pos,s=i.deleted;return s?null:new eO(o-n,o-n,this)},Z_.prototype.valid=function(){return!0},Z_.prototype.eq=function(t){return this==t||t instanceof Z_&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&J_(this.spec,t.spec))},Z_.prototype.destroy=function(t){this.spec.destroy&&this.spec.destroy(t)};var Q_=function(t,e){this.spec=e||iO,this.attrs=t};Q_.prototype.map=function(t,e,n,r){var i=t.map(e.from+r,this.spec.inclusiveStart?-1:1)-n,o=t.map(e.to+r,this.spec.inclusiveEnd?1:-1)-n;return i>=o?null:new eO(i,o,this)},Q_.prototype.valid=function(t,e){return e.from<e.to},Q_.prototype.eq=function(t){return this==t||t instanceof Q_&&J_(this.attrs,t.attrs)&&J_(this.spec,t.spec)},Q_.is=function(t){return t.type instanceof Q_};var tO=function(t,e){this.spec=e||iO,this.attrs=t};tO.prototype.map=function(t,e,n,r){var i=t.mapResult(e.from+r,1);if(i.deleted)return null;var o=t.mapResult(e.to+r,-1);return o.deleted||o.pos<=i.pos?null:new eO(i.pos-n,o.pos-n,this)},tO.prototype.valid=function(t,e){var n,r=t.content.findIndex(e.from),i=r.index,o=r.offset;return o==e.from&&!(n=t.child(i)).isText&&o+n.nodeSize==e.to},tO.prototype.eq=function(t){return this==t||t instanceof tO&&J_(this.attrs,t.attrs)&&J_(this.spec,t.spec)};var eO=function(t,e,n){this.from=t,this.to=e,this.type=n},nO={spec:{configurable:!0},inline:{configurable:!0}};eO.prototype.copy=function(t,e){return new eO(t,e,this.type)},eO.prototype.eq=function(t,e){return void 0===e&&(e=0),this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to},eO.prototype.map=function(t,e,n){return this.type.map(t,this,e,n)},eO.widget=function(t,e,n){return new eO(t,t,new Z_(e,n))},eO.inline=function(t,e,n,r){return new eO(t,e,new Q_(n,r))},eO.node=function(t,e,n,r){return new eO(t,e,new tO(n,r))},nO.spec.get=function(){return this.type.spec},nO.inline.get=function(){return this.type instanceof Q_},Object.defineProperties(eO.prototype,nO);var rO=[],iO={},oO=function(t,e){this.local=t&&t.length?t:rO,this.children=e&&e.length?e:rO};oO.create=function(t,e){return e.length?fO(e,t,0,iO):sO},oO.prototype.find=function(t,e,n){var r=[];return this.findInner(null==t?0:t,null==e?1e9:e,r,0,n),r},oO.prototype.findInner=function(t,e,n,r,i){for(var o=0;o<this.local.length;o++){var s=this.local[o];s.from<=e&&s.to>=t&&(!i||i(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(var a=0;a<this.children.length;a+=3)if(this.children[a]<e&&this.children[a+1]>t){var c=this.children[a]+1;this.children[a+2].findInner(t-c,e-c,n,r+c,i)}},oO.prototype.map=function(t,e,n){return this==sO||0==t.maps.length?this:this.mapInner(t,e,0,0,n||iO)},oO.prototype.mapInner=function(t,e,n,r,i){for(var o,s=0;s<this.local.length;s++){var a=this.local[s].map(t,n,r);a&&a.type.valid(e,a)?(o||(o=[])).push(a):i.onRemove&&i.onRemove(this.local[s].spec)}return this.children.length?cO(this.children,o,t,e,n,r,i):o?new oO(o.sort(pO)):sO},oO.prototype.add=function(t,e){return e.length?this==sO?oO.create(t,e):this.addInner(t,e,0):this},oO.prototype.addInner=function(t,e,n){var r,i=this,o=0;t.forEach((function(t,s){var a,c=s+n;if(a=dO(e,t,c)){r||(r=i.children.slice());while(o<r.length&&r[o]<s)o+=3;r[o]==s?r[o+2]=r[o+2].addInner(t,a,c+1):r.splice(o,0,s,s+t.nodeSize,fO(a,t,c+1,iO)),o+=3}}));for(var s=uO(o?hO(e):e,-n),a=0;a<s.length;a++)s[a].type.valid(t,s[a])||s.splice(a--,1);return new oO(s.length?this.local.concat(s).sort(pO):this.local,r||this.children)},oO.prototype.remove=function(t){return 0==t.length||this==sO?this:this.removeInner(t,0)},oO.prototype.removeInner=function(t,e){for(var n=this.children,r=this.local,i=0;i<n.length;i+=3){for(var o=void 0,s=n[i]+e,a=n[i+1]+e,c=0,u=void 0;c<t.length;c++)(u=t[c])&&u.from>s&&u.to<a&&(t[c]=null,(o||(o=[])).push(u));if(o){n==this.children&&(n=this.children.slice());var l=n[i+2].removeInner(o,s+1);l!=sO?n[i+2]=l:(n.splice(i,3),i-=3)}}if(r.length)for(var d=0,h=void 0;d<t.length;d++)if(h=t[d])for(var f=0;f<r.length;f++)r[f].eq(h,e)&&(r==this.local&&(r=this.local.slice()),r.splice(f--,1));return n==this.children&&r==this.local?this:r.length||n.length?new oO(r,n):sO},oO.prototype.forChild=function(t,e){if(this==sO)return this;if(e.isLeaf)return oO.empty;for(var n,r,i=0;i<this.children.length;i+=3)if(this.children[i]>=t){this.children[i]==t&&(n=this.children[i+2]);break}for(var o=t+1,s=o+e.content.size,a=0;a<this.local.length;a++){var c=this.local[a];if(c.from<s&&c.to>o&&c.type instanceof Q_){var u=Math.max(o,c.from)-o,l=Math.min(s,c.to)-o;u<l&&(r||(r=[])).push(c.copy(u,l))}}if(r){var d=new oO(r.sort(pO));return n?new aO([d,n]):d}return n||sO},oO.prototype.eq=function(t){if(this==t)return!0;if(!(t instanceof oO)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(var e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(var n=0;n<this.children.length;n+=3)if(this.children[n]!=t.children[n]||this.children[n+1]!=t.children[n+1]||!this.children[n+2].eq(t.children[n+2]))return!1;return!0},oO.prototype.locals=function(t){return gO(this.localsInner(t))},oO.prototype.localsInner=function(t){if(this==sO)return rO;if(t.inlineContent||!this.local.some(Q_.is))return this.local;for(var e=[],n=0;n<this.local.length;n++)this.local[n].type instanceof Q_||e.push(this.local[n]);return e};var sO=new oO;oO.empty=sO,oO.removeOverlap=gO;var aO=function(t){this.members=t};function cO(t,e,n,r,i,o,s){for(var a=t.slice(),c=function(t,e,n,r){for(var s=0;s<a.length;s+=3){var c=a[s+1],u=void 0;if(!(c<0||t>c+o)){var l=a[s]+o;e>=l?a[s+1]=t<=l?-2:-1:n>=i&&(u=r-n-(e-t))&&(a[s]+=u,a[s+1]+=u)}}},u=0;u<n.maps.length;u++)n.maps[u].forEach(c);for(var l=!1,d=0;d<a.length;d+=3)if(a[d+1]<0){if(-2==a[d+1]){l=!0,a[d+1]=-1;continue}var h=n.map(t[d]+o),f=h-i;if(f<0||f>=r.content.size){l=!0;continue}var p=n.map(t[d+1]+o,-1),g=p-i,m=r.content.findIndex(f),v=m.index,y=m.offset,b=r.maybeChild(v);if(b&&y==f&&y+b.nodeSize==g){var w=a[d+2].mapInner(n,b,h+1,t[d]+o+1,s);w!=sO?(a[d]=f,a[d+1]=g,a[d+2]=w):(a[d+1]=-2,l=!0)}else l=!0}if(l){var E=lO(a,t,e||[],n,i,o,s),S=fO(E,r,0,s);e=S.local;for(var D=0;D<a.length;D+=3)a[D+1]<0&&(a.splice(D,3),D-=3);for(var k=0,x=0;k<S.children.length;k+=3){var C=S.children[k];while(x<a.length&&a[x]<C)x+=3;a.splice(x,0,S.children[k],S.children[k+1],S.children[k+2])}}return new oO(e&&e.sort(pO),a)}function uO(t,e){if(!e||!t.length)return t;for(var n=[],r=0;r<t.length;r++){var i=t[r];n.push(new eO(i.from+e,i.to+e,i.type))}return n}function lO(t,e,n,r,i,o,s){function a(t,e){for(var o=0;o<t.local.length;o++){var c=t.local[o].map(r,i,e);c?n.push(c):s.onRemove&&s.onRemove(t.local[o].spec)}for(var u=0;u<t.children.length;u+=3)a(t.children[u+2],t.children[u]+e+1)}for(var c=0;c<t.length;c+=3)-1==t[c+1]&&a(t[c+2],e[c]+o+1);return n}function dO(t,e,n){if(e.isLeaf)return null;for(var r=n+e.nodeSize,i=null,o=0,s=void 0;o<t.length;o++)(s=t[o])&&s.from>n&&s.to<r&&((i||(i=[])).push(s),t[o]=null);return i}function hO(t){for(var e=[],n=0;n<t.length;n++)null!=t[n]&&e.push(t[n]);return e}function fO(t,e,n,r){var i=[],o=!1;e.forEach((function(e,s){var a=dO(t,e,s+n);if(a){o=!0;var c=fO(a,e,n+s+1,r);c!=sO&&i.push(s,s+e.nodeSize,c)}}));for(var s=uO(o?hO(t):t,-n).sort(pO),a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||i.length?new oO(s,i):sO}function pO(t,e){return t.from-e.from||t.to-e.to}function gO(t){for(var e=t,n=0;n<e.length-1;n++){var r=e[n];if(r.from!=r.to)for(var i=n+1;i<e.length;i++){var o=e[i];if(o.from!=r.from){o.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,o.from),mO(e,i,r.copy(o.from,r.to)));break}o.to!=r.to&&(e==t&&(e=t.slice()),e[i]=o.copy(o.from,r.to),mO(e,i+1,o.copy(r.to,o.to)))}}return e}function mO(t,e,n){while(e<t.length&&pO(n,t[e])>0)e++;t.splice(e,0,n)}function vO(t){var e=[];return t.someProp("decorations",(function(n){var r=n(t.state);r&&r!=sO&&e.push(r)})),t.cursorWrapper&&e.push(oO.create(t.state.doc,[t.cursorWrapper.deco])),aO.from(e)}aO.prototype.map=function(t,e){var n=this.members.map((function(n){return n.map(t,e,iO)}));return aO.from(n)},aO.prototype.forChild=function(t,e){if(e.isLeaf)return oO.empty;for(var n=[],r=0;r<this.members.length;r++){var i=this.members[r].forChild(t,e);i!=sO&&(i instanceof aO?n=n.concat(i.members):n.push(i))}return aO.from(n)},aO.prototype.eq=function(t){if(!(t instanceof aO)||t.members.length!=this.members.length)return!1;for(var e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0},aO.prototype.locals=function(t){for(var e,n=!0,r=0;r<this.members.length;r++){var i=this.members[r].localsInner(t);if(i.length)if(e){n&&(e=e.slice(),n=!1);for(var o=0;o<i.length;o++)e.push(i[o])}else e=i}return e?gO(n?e:e.sort(pO)):rO},aO.from=function(t){switch(t.length){case 0:return sO;case 1:return t[0];default:return new aO(t)}};var yO=function(t,e){this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(CO),this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.trackWrites=null,this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):t.apply?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=SO(this),this.markCursor=null,this.cursorWrapper=null,EO(this),this.nodeViews=kO(this),this.docView=Vx(this.state.doc,wO(this),vO(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,v_(this),this.prevDirectPlugins=[],this.pluginViews=[],this.updatePluginViews()},bO={props:{configurable:!0},root:{configurable:!0},isDestroyed:{configurable:!0}};function wO(t){var e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),e.translate="no",t.someProp("attributes",(function(n){if("function"==typeof n&&(n=n(t.state)),n)for(var r in n)"class"==r&&(e.class+=" "+n[r]),"style"==r?e.style=(e.style?e.style+";":"")+n[r]:e[r]||"contenteditable"==r||"nodeName"==r||(e[r]=String(n[r]))})),[eO.node(0,t.state.doc.content.size,e)]}function EO(t){if(t.markCursor){var e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:eO.widget(t.state.selection.head,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function SO(t){return!t.someProp("editable",(function(e){return!1===e(t.state)}))}function DO(t,e){var n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function kO(t){var e={};return t.someProp("nodeViews",(function(t){for(var n in t)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=t[n])})),e}function xO(t,e){var n=0,r=0;for(var i in t){if(t[i]!=e[i])return!0;n++}for(var o in e)r++;return n!=r}function CO(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}bO.props.get=function(){if(this._props.state!=this.state){var t=this._props;for(var e in this._props={},t)this._props[e]=t[e];this._props.state=this.state}return this._props},yO.prototype.update=function(t){t.handleDOMEvents!=this._props.handleDOMEvents&&w_(this),this._props=t,t.plugins&&(t.plugins.forEach(CO),this.directPlugins=t.plugins),this.updateStateInner(t.state,!0)},yO.prototype.setProps=function(t){var e={};for(var n in this._props)e[n]=this._props[n];for(var r in e.state=this.state,t)e[r]=t[r];this.update(e)},yO.prototype.updateState=function(t){this.updateStateInner(t,this.state.plugins!=t.plugins)},yO.prototype.updateStateInner=function(t,e){var n=this,r=this.state,i=!1,o=!1;if(t.storedMarks&&this.composing&&(L_(this),o=!0),this.state=t,e){var s=kO(this);xO(s,this.nodeViews)&&(this.nodeViews=s,i=!0),w_(this)}this.editable=SO(this),EO(this);var a=vO(this),c=wO(this),u=e?"reset":t.scrollToSelection>r.scrollToSelection?"to selection":"preserve",l=i||!this.docView.matchesNode(t.doc,c,a);!l&&t.selection.eq(r.selection)||(o=!0);var d="preserve"==u&&o&&null==this.dom.style.overflowAnchor&&ox(this);if(o){this.domObserver.stop();var h=l&&(Ik.ie||Ik.chrome)&&!this.composing&&!r.selection.empty&&!t.selection.empty&&DO(r.selection,t.selection);if(l){var f=Ik.chrome?this.trackWrites=this.root.getSelection().focusNode:null;!i&&this.docView.update(t.doc,c,a,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=Vx(t.doc,c,a,this.dom,this)),f&&!this.trackWrites&&(h=!0)}h||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&kC(this))?hC(this,h):(bC(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(r),"reset"==u)this.dom.scrollTop=0;else if("to selection"==u){var p=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(t){return t(n)}))||(t.selection instanceof ND?ix(this,this.docView.domAfterPos(t.selection.from).getBoundingClientRect(),p):ix(this,this.coordsAtPos(t.selection.head,1),p))}else d&&ax(d)},yO.prototype.destroyPluginViews=function(){var t;while(t=this.pluginViews.pop())t.destroy&&t.destroy()},yO.prototype.updatePluginViews=function(t){if(t&&t.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(var e=0;e<this.pluginViews.length;e++){var n=this.pluginViews[e];n.update&&n.update(this,t)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(var r=0;r<this.directPlugins.length;r++){var i=this.directPlugins[r];i.spec.view&&this.pluginViews.push(i.spec.view(this))}for(var o=0;o<this.state.plugins.length;o++){var s=this.state.plugins[o];s.spec.view&&this.pluginViews.push(s.spec.view(this))}}},yO.prototype.someProp=function(t,e){var n,r=this._props&&this._props[t];if(null!=r&&(n=e?e(r):r))return n;for(var i=0;i<this.directPlugins.length;i++){var o=this.directPlugins[i].props[t];if(null!=o&&(n=e?e(o):o))return n}var s=this.state.plugins;if(s)for(var a=0;a<s.length;a++){var c=s[a].props[t];if(null!=c&&(n=e?e(c):c))return n}},yO.prototype.hasFocus=function(){return this.root.activeElement==this.dom},yO.prototype.focus=function(){this.domObserver.stop(),this.editable&&lx(this.dom),hC(this),this.domObserver.start()},bO.root.get=function(){var t=this._root;if(null==t)for(var e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=function(){return document.getSelection()}),this._root=e;return t||document},yO.prototype.posAtCoords=function(t){return yx(this,t)},yO.prototype.coordsAtPos=function(t,e){return void 0===e&&(e=1),Ex(this,t,e)},yO.prototype.domAtPos=function(t,e){return void 0===e&&(e=0),this.docView.domFromPos(t,e)},yO.prototype.nodeDOM=function(t){var e=this.docView.descAt(t);return e?e.nodeDOM:null},yO.prototype.posAtDOM=function(t,e,n){void 0===n&&(n=-1);var r=this.docView.posFromDOM(t,e,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r},yO.prototype.endOfTextblock=function(t,e){return Tx(this,e||this.state,t)},yO.prototype.destroy=function(){this.docView&&(b_(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],vO(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},bO.isDestroyed.get=function(){return null==this.docView},yO.prototype.dispatchEvent=function(t){return D_(this,t)},yO.prototype.dispatch=function(t){var e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))},Object.defineProperties(yO.prototype,bO);for(var _O={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},OO={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},AO="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),MO="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),TO="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),RO="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),NO="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),PO=AO&&(RO||+AO[1]<57)||TO&&RO,BO=0;BO<10;BO++)_O[48+BO]=_O[96+BO]=String(BO);for(BO=1;BO<=24;BO++)_O[BO+111]="F"+BO;for(BO=65;BO<=90;BO++)_O[BO]=String.fromCharCode(BO+32),OO[BO]=String.fromCharCode(BO);for(var FO in _O)OO.hasOwnProperty(FO)||(OO[FO]=_O[FO]);function IO(t){var e=PO&&(t.ctrlKey||t.altKey||t.metaKey)||(MO||NO)&&t.shiftKey&&t.key&&1==t.key.length,n=!e&&t.key||(t.shiftKey?OO:_O)[t.keyCode]||t.key||"Unidentified";return"Esc"==n&&(n="Escape"),"Del"==n&&(n="Delete"),"Left"==n&&(n="ArrowLeft"),"Up"==n&&(n="ArrowUp"),"Right"==n&&(n="ArrowRight"),"Down"==n&&(n="ArrowDown"),n}var zO="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function jO(t){var e,n,r,i,o=t.split(/-(?!$)/),s=o[o.length-1];"Space"==s&&(s=" ");for(var a=0;a<o.length-1;a++){var c=o[a];if(/^(cmd|meta|m)$/i.test(c))i=!0;else if(/^a(lt)?$/i.test(c))e=!0;else if(/^(c|ctrl|control)$/i.test(c))n=!0;else if(/^s(hift)?$/i.test(c))r=!0;else{if(!/^mod$/i.test(c))throw new Error("Unrecognized modifier name: "+c);zO?i=!0:n=!0}}return e&&(s="Alt-"+s),n&&(s="Ctrl-"+s),i&&(s="Meta-"+s),r&&(s="Shift-"+s),s}function LO(t){var e=Object.create(null);for(var n in t)e[jO(n)]=t[n];return e}function $O(t,e,n){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),!1!==n&&e.shiftKey&&(t="Shift-"+t),t}function HO(t){return new JD({props:{handleKeyDown:VO(t)}})}function VO(t){var e=LO(t);return function(t,n){var r,i=IO(n),o=1==i.length&&" "!=i,s=e[$O(i,n,!o)];if(s&&s(t.state,t.dispatch,t))return!0;if(o&&(n.shiftKey||n.altKey||n.metaKey||i.charCodeAt(0)>127)&&(r=_O[n.keyCode])&&r!=i){var a=e[$O(r,n,!0)];if(a&&a(t.state,t.dispatch,t))return!0}else if(o&&n.shiftKey){var c=e[$O(i,n,!0)];if(c&&c(t.state,t.dispatch,t))return!0}return!1}}function WO(t){return Object.prototype.toString.call(t).slice(8,-1)}function UO(t){return"Object"===WO(t)&&(t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype)}function qO(t,e){const n={...t};return UO(t)&&UO(e)&&Object.keys(e).forEach((r=>{UO(e[r])?r in t?n[r]=qO(t[r],e[r]):Object.assign(n,{[r]:e[r]}):Object.assign(n,{[r]:e[r]})})),n}function GO(t){return"function"===typeof t}function KO(t,e,...n){return GO(t)?e?t.bind(e)(...n):t(...n):t}function YO(t,e,n){if(void 0===t.config[e]&&t.parent)return YO(t.parent,e,n);if("function"===typeof t.config[e]){const r=t.config[e].bind({...n,parent:t.parent?YO(t.parent,e,n):null});return r}return t.config[e]}class XO{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=KO(YO(this,"addOptions",{name:this.name}))),this.storage=KO(YO(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new XO(t)}configure(t={}){const e=this.extend();return e.options=qO(this.options,t),e.storage=KO(YO(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new XO(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=KO(YO(e,"addOptions",{name:e.name})),e.storage=KO(YO(e,"addStorage",{name:e.name,options:e.options})),e}}function JO(t,e,n){const{from:r,to:i}=e,{blockSeparator:o="\n\n",textSerializers:s={}}=n||{};let a="",c=!0;return t.nodesBetween(r,i,((t,e,n,u)=>{var l;const d=null===s||void 0===s?void 0:s[t.type.name];d?(t.isBlock&&!c&&(a+=o,c=!0),a+=d({node:t,pos:e,parent:n,index:u})):t.isText?(a+=null===(l=null===t||void 0===t?void 0:t.text)||void 0===l?void 0:l.slice(Math.max(r,e)-e,i-e),c=!1):t.isBlock&&!c&&(a+=o,c=!0)})),a}function ZO(t){return Object.fromEntries(Object.entries(t.nodes).filter((([,t])=>t.spec.toText)).map((([t,e])=>[t,e.spec.toText])))}const QO=XO.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new JD({key:new tk("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:i}=e,{ranges:o}=i,s=Math.min(...o.map((t=>t.$from.pos))),a=Math.max(...o.map((t=>t.$to.pos))),c=ZO(n),u={from:s,to:a};return JO(r,u,{textSerializers:c})}}})]}}),tA=()=>({editor:t,view:e})=>(requestAnimationFrame((()=>{var n;t.isDestroyed||(e.dom.blur(),null===(n=null===window||void 0===window?void 0:window.getSelection())||void 0===n||n.removeAllRanges())})),!0);var eA=Object.freeze({__proto__:null,blur:tA});const nA=(t=!1)=>({commands:e})=>e.setContent("",t);var rA=Object.freeze({__proto__:null,clearContent:nA});const iA=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:i}=r;return!n||(i.forEach((({$from:n,$to:r})=>{t.doc.nodesBetween(n.pos,r.pos,((t,n)=>{if(t.type.isText)return;const{doc:r,mapping:i}=e,o=r.resolve(i.map(n)),s=r.resolve(i.map(n+t.nodeSize)),a=o.blockRange(s);if(!a)return;const c=tD(a);if(t.type.isTextblock){const{defaultType:t}=o.parent.contentMatchAt(o.index());e.setNodeMarkup(a.start,t)}(c||0===c)&&e.lift(a,c)}))})),!0)};var oA=Object.freeze({__proto__:null,clearNodes:iA});const sA=t=>e=>t(e);var aA=Object.freeze({__proto__:null,command:sA});const cA=()=>({state:t,dispatch:e})=>fk(t,e);var uA=Object.freeze({__proto__:null,createParagraphNear:cA});function lA(t,e){if("string"===typeof t){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}const dA=t=>({tr:e,state:n,dispatch:r})=>{const i=lA(t,n.schema),o=e.selection.$anchor;for(let t=o.depth;t>0;t-=1){const n=o.node(t);if(n.type===i){if(r){const n=o.before(t),r=o.after(t);e.delete(n,r).scrollIntoView()}return!0}}return!1};var hA=Object.freeze({__proto__:null,deleteNode:dA});const fA=t=>({tr:e,dispatch:n})=>{const{from:r,to:i}=t;return n&&e.delete(r,i),!0};var pA=Object.freeze({__proto__:null,deleteRange:fA});const gA=()=>({state:t,dispatch:e})=>ek(t,e);var mA=Object.freeze({__proto__:null,deleteSelection:gA});const vA=()=>({commands:t})=>t.keyboardShortcut("Enter");var yA=Object.freeze({__proto__:null,enter:vA});const bA=()=>({state:t,dispatch:e})=>hk(t,e);var wA=Object.freeze({__proto__:null,exitCode:bA});function EA(t,e){if("string"===typeof t){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}function SA(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function DA(t,e,n={strict:!0}){const r=Object.keys(e);return!r.length||r.every((r=>n.strict?e[r]===t[r]:SA(e[r])?e[r].test(t[r]):e[r]===t[r]))}function kA(t,e,n={}){return t.find((t=>t.type===e&&DA(t.attrs,n)))}function xA(t,e,n={}){return!!kA(t,e,n)}function CA(t,e,n={}){if(!t||!e)return;const r=t.parent.childAfter(t.parentOffset);if(!r.node)return;const i=kA(r.node.marks,e,n);if(!i)return;let o=t.index(),s=t.start()+r.offset,a=o+1,c=s+r.node.nodeSize;kA(r.node.marks,e,n);while(o>0&&i.isInSet(t.parent.child(o-1).marks))o-=1,s-=t.parent.child(o).nodeSize;while(a<t.parent.childCount&&xA(t.parent.child(a).marks,e,n))c+=t.parent.child(a).nodeSize,a+=1;return{from:s,to:c}}const _A=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const o=EA(t,r.schema),{doc:s,selection:a}=n,{$from:c,from:u,to:l}=a;if(i){const t=CA(c,o,e);if(t&&t.from<=u&&t.to>=l){const e=TD.create(s,t.from,t.to);n.setSelection(e)}}return!0};var OA=Object.freeze({__proto__:null,extendMarkRange:_A});const AA=t=>e=>{const n="function"===typeof t?t(e):t;for(let t=0;t<n.length;t+=1)if(n[t](e))return!0;return!1};var MA=Object.freeze({__proto__:null,first:AA});function TA(t){var e;return"class"===(null===(e=t.constructor)||void 0===e?void 0:e.toString().substring(0,5))}function RA(t){return t&&"object"===typeof t&&!Array.isArray(t)&&!TA(t)}function NA(t){return RA(t)&&t instanceof TD}function PA(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function BA(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function FA(t,e=null){if(!e)return null;const n=OD.atStart(t),r=OD.atEnd(t);if("start"===e||!0===e)return n;if("end"===e)return r;const i=n.from,o=r.to;return"all"===e?TD.create(t,BA(0,i,o),BA(t.content.size,i,o)):TD.create(t,BA(e,i,o),BA(e,i,o))}const IA=(t=null,e)=>({editor:n,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const s=()=>{PA()&&r.dom.focus(),requestAnimationFrame((()=>{n.isDestroyed||(r.focus(),(null===e||void 0===e?void 0:e.scrollIntoView)&&n.commands.scrollIntoView())}))};if(r.hasFocus()&&null===t||!1===t)return!0;if(o&&null===t&&!NA(n.state.selection))return s(),!0;const a=FA(n.state.doc,t)||n.state.selection,c=n.state.selection.eq(a);return o&&(c||i.setSelection(a),c&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0};var zA=Object.freeze({__proto__:null,focus:IA});const jA=(t,e)=>n=>t.every(((t,r)=>e(t,{...n,index:r})));var LA=Object.freeze({__proto__:null,forEach:jA});const $A=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e);var HA=Object.freeze({__proto__:null,insertContent:$A});function VA(t){const e=`<body>${t}</body>`;return(new window.DOMParser).parseFromString(e,"text/html").body}function WA(t,e,n){if(n={slice:!0,parseOptions:{},...n},"object"===typeof t&&null!==t)try{return Array.isArray(t)?lE.fromArray(t.map((t=>e.nodeFromJSON(t)))):e.nodeFromJSON(t)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",r),WA("",e,n)}if("string"===typeof t){const r=gS.fromSchema(e);return n.slice?r.parseSlice(VA(t),n.parseOptions).content:r.parse(VA(t),n.parseOptions)}return WA("",e,n)}function UA(t,e,n){const r=t.steps.length-1;if(r<e)return;const i=t.steps[r];if(!(i instanceof XS||i instanceof JS))return;const o=t.mapping.maps[r];let s=0;o.forEach(((t,e,n,r)=>{0===s&&(s=r)})),t.setSelection(OD.near(t.doc.resolve(s),n))}const qA=t=>t.toString().startsWith("<"),GA=(t,e,n)=>({tr:r,dispatch:i,editor:o})=>{if(i){n={parseOptions:{},updateSelection:!0,...n};const i=WA(e,o.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions}});if("<>"===i.toString())return!0;let{from:s,to:a}="number"===typeof t?{from:t,to:t}:t,c=!0,u=!0;const l=qA(i)?i:[i];if(l.forEach((t=>{t.check(),c=!!c&&(t.isText&&0===t.marks.length),u=!!u&&t.isBlock})),s===a&&u){const{parent:t}=r.doc.resolve(s),e=t.isTextblock&&!t.type.spec.code&&!t.childCount;e&&(s-=1,a+=1)}c?r.insertText(e,s,a):r.replaceWith(s,a,i),n.updateSelection&&UA(r,r.steps.length-1,-1)}return!0};var KA=Object.freeze({__proto__:null,insertContentAt:GA});const YA=()=>({state:t,dispatch:e})=>nk(t,e);var XA=Object.freeze({__proto__:null,joinBackward:YA});const JA=()=>({state:t,dispatch:e})=>sk(t,e);var ZA=Object.freeze({__proto__:null,joinForward:JA});function QA(){return"undefined"!==typeof navigator&&/Mac/.test(navigator.platform)}function tM(t){const e=t.split(/-(?!$)/);let n,r,i,o,s=e[e.length-1];"Space"===s&&(s=" ");for(let a=0;a<e.length-1;a+=1){const t=e[a];if(/^(cmd|meta|m)$/i.test(t))o=!0;else if(/^a(lt)?$/i.test(t))n=!0;else if(/^(c|ctrl|control)$/i.test(t))r=!0;else if(/^s(hift)?$/i.test(t))i=!0;else{if(!/^mod$/i.test(t))throw new Error(`Unrecognized modifier name: ${t}`);PA()||QA()?o=!0:r=!0}}return n&&(s=`Alt-${s}`),r&&(s=`Ctrl-${s}`),o&&(s=`Meta-${s}`),i&&(s=`Shift-${s}`),s}const eM=t=>({editor:e,view:n,tr:r,dispatch:i})=>{const o=tM(t).split(/-(?!$)/),s=o.find((t=>!["Alt","Ctrl","Meta","Shift"].includes(t))),a=new KeyboardEvent("keydown",{key:"Space"===s?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),c=e.captureTransaction((()=>{n.someProp("handleKeyDown",(t=>t(n,a)))}));return null===c||void 0===c||c.steps.forEach((t=>{const e=t.map(r.mapping);e&&i&&r.maybeStep(e)})),!0};var nM=Object.freeze({__proto__:null,keyboardShortcut:eM});function rM(t,e,n={}){const{from:r,to:i,empty:o}=t.selection,s=e?lA(e,t.schema):null,a=[];t.doc.nodesBetween(r,i,((t,e)=>{if(t.isText)return;const n=Math.max(r,e),o=Math.min(i,e+t.nodeSize);a.push({node:t,from:n,to:o})}));const c=i-r,u=a.filter((t=>!s||s.name===t.node.type.name)).filter((t=>DA(t.node.attrs,n,{strict:!1})));if(o)return!!u.length;const l=u.reduce(((t,e)=>t+e.to-e.from),0);return l>=c}const iM=(t,e={})=>({state:n,dispatch:r})=>{const i=lA(t,n.schema),o=rM(n,i,e);return!!o&&uk(n,r)};var oM=Object.freeze({__proto__:null,lift:iM});const sM=()=>({state:t,dispatch:e})=>pk(t,e);var aM=Object.freeze({__proto__:null,liftEmptyBlock:sM});const cM=t=>({state:e,dispatch:n})=>{const r=lA(t,e.schema);return Nk(r)(e,n)};var uM=Object.freeze({__proto__:null,liftListItem:cM});const lM=()=>({state:t,dispatch:e})=>lk(t,e);var dM=Object.freeze({__proto__:null,newlineInCode:lM});function hM(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function fM(t,e){const n="string"===typeof e?[e]:e;return Object.keys(t).reduce(((e,r)=>(n.includes(r)||(e[r]=t[r]),e)),{})}const pM=(t,e)=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const a=hM("string"===typeof t?t:t.name,r.schema);return!!a&&("node"===a&&(o=lA(t,r.schema)),"mark"===a&&(s=EA(t,r.schema)),i&&n.selection.ranges.forEach((t=>{r.doc.nodesBetween(t.$from.pos,t.$to.pos,((t,r)=>{o&&o===t.type&&n.setNodeMarkup(r,void 0,fM(t.attrs,e)),s&&t.marks.length&&t.marks.forEach((i=>{s===i.type&&n.addMark(r,r+t.nodeSize,s.create(fM(i.attrs,e)))}))}))})),!0)};var gM=Object.freeze({__proto__:null,resetAttributes:pM});const mM=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0);var vM=Object.freeze({__proto__:null,scrollIntoView:mM});const yM=()=>({tr:t,commands:e})=>e.setTextSelection({from:0,to:t.doc.content.size});var bM=Object.freeze({__proto__:null,selectAll:yM});const wM=()=>({state:t,dispatch:e})=>ik(t,e);var EM=Object.freeze({__proto__:null,selectNodeBackward:wM});const SM=()=>({state:t,dispatch:e})=>ak(t,e);var DM=Object.freeze({__proto__:null,selectNodeForward:SM});const kM=()=>({state:t,dispatch:e})=>mk(t,e);var xM=Object.freeze({__proto__:null,selectParentNode:kM});const CM=()=>({state:t,dispatch:e})=>Sk(t,e);var _M=Object.freeze({__proto__:null,selectTextblockEnd:CM});const OM=()=>({state:t,dispatch:e})=>Ek(t,e);var AM=Object.freeze({__proto__:null,selectTextblockStart:OM});function MM(t,e,n={}){return WA(t,e,{slice:!1,parseOptions:n})}const TM=(t,e=!1,n={})=>({tr:r,editor:i,dispatch:o})=>{const{doc:s}=r,a=MM(t,i.schema,n),c=TD.create(s,0,s.content.size);return o&&r.setSelection(c).replaceSelectionWith(a,!1).setMeta("preventUpdate",!e),!0};var RM=Object.freeze({__proto__:null,setContent:TM});function NM(t,e){const n=EA(e,t.schema),{from:r,to:i,empty:o}=t.selection,s=[];o?(t.storedMarks&&s.push(...t.storedMarks),s.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,(t=>{s.push(...t.marks)}));const a=s.find((t=>t.type.name===n.name));return a?{...a.attrs}:{}}const PM=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const{selection:o}=n,{empty:s,ranges:a}=o,c=EA(t,r.schema);if(i)if(s){const t=NM(r,c);n.addStoredMark(c.create({...t,...e}))}else a.forEach((t=>{const i=t.$from.pos,o=t.$to.pos;r.doc.nodesBetween(i,o,((t,r)=>{const s=Math.max(r,i),a=Math.min(r+t.nodeSize,o),u=t.marks.find((t=>t.type===c));u?t.marks.forEach((t=>{c===t.type&&n.addMark(s,a,c.create({...t.attrs,...e}))})):n.addMark(s,a,c.create(e))}))}));return!0};var BM=Object.freeze({__proto__:null,setMark:PM});const FM=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0);var IM=Object.freeze({__proto__:null,setMeta:FM});const zM=(t,e={})=>({state:n,dispatch:r,chain:i})=>{const o=lA(t,n.schema);return o.isTextblock?i().command((({commands:t})=>{const r=kk(o,e)(n);return!!r||t.clearNodes()})).command((({state:t})=>kk(o,e)(t,r))).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)};var jM=Object.freeze({__proto__:null,setNode:zM});const LM=t=>({tr:e,dispatch:n})=>{if(n){const{doc:n}=e,r=OD.atStart(n).from,i=OD.atEnd(n).to,o=BA(t,r,i),s=ND.create(n,o);e.setSelection(s)}return!0};var $M=Object.freeze({__proto__:null,setNodeSelection:LM});const HM=t=>({tr:e,dispatch:n})=>{if(n){const{doc:n}=e,{from:r,to:i}="number"===typeof t?{from:t,to:t}:t,o=TD.atStart(n).from,s=TD.atEnd(n).to,a=BA(r,o,s),c=BA(i,o,s),u=TD.create(n,a,c);e.setSelection(u)}return!0};var VM=Object.freeze({__proto__:null,setTextSelection:HM});const WM=t=>({state:e,dispatch:n})=>{const r=lA(t,e.schema);return Fk(r)(e,n)};var UM=Object.freeze({__proto__:null,sinkListItem:WM});function qM(t,e,n){return Object.fromEntries(Object.entries(n).filter((([n])=>{const r=t.find((t=>t.type===e&&t.name===n));return!!r&&r.attribute.keepOnSplit})))}function GM(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function KM(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter((t=>null===e||void 0===e?void 0:e.includes(t.type.name)));t.tr.ensureMarks(r)}}const YM=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:i})=>{const{selection:o,doc:s}=e,{$from:a,$to:c}=o,u=i.extensionManager.attributes,l=qM(u,a.node().type.name,a.node().attrs);if(o instanceof ND&&o.node.isBlock)return!(!a.parentOffset||!sD(s,a.pos))&&(r&&(t&&KM(n,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(r){const r=c.parentOffset===c.parent.content.size;o instanceof TD&&e.deleteSelection();const s=0===a.depth?void 0:GM(a.node(-1).contentMatchAt(a.indexAfter(-1)));let u=r&&s?[{type:s,attrs:l}]:void 0,d=sD(e.doc,e.mapping.map(a.pos),1,u);if(u||d||!sD(e.doc,e.mapping.map(a.pos),1,s?[{type:s}]:void 0)||(d=!0,u=s?[{type:s,attrs:l}]:void 0),d&&(e.split(e.mapping.map(a.pos),1,u),s&&!r&&!a.parentOffset&&a.parent.type!==s)){const t=e.mapping.map(a.before()),n=e.doc.resolve(t);a.node(-1).canReplaceWith(n.index(),n.index()+1,s)&&e.setNodeMarkup(e.mapping.map(a.before()),s)}t&&KM(n,i.extensionManager.splittableMarks),e.scrollIntoView()}return!0};var XM=Object.freeze({__proto__:null,splitBlock:YM});const JM=t=>({tr:e,state:n,dispatch:r,editor:i})=>{var o;const s=lA(t,n.schema),{$from:a,$to:c}=n.selection,u=n.selection.node;if(u&&u.isBlock||a.depth<2||!a.sameParent(c))return!1;const l=a.node(-1);if(l.type!==s)return!1;const d=i.extensionManager.attributes;if(0===a.parent.content.size&&a.node(-1).childCount===a.indexAfter(-1)){if(2===a.depth||a.node(-3).type!==s||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let t=lE.empty;const n=a.index(-1)?1:a.index(-2)?2:3;for(let e=a.depth-n;e>=a.depth-3;e-=1)t=lE.from(a.node(e).copy(t));const r=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,i=qM(d,a.node().type.name,a.node().attrs),c=(null===(o=s.contentMatch.defaultType)||void 0===o?void 0:o.createAndFill(i))||void 0;t=t.append(lE.from(s.createAndFill(null,c)||void 0));const u=a.before(a.depth-(n-1));e.replace(u,a.after(-r),new vE(t,4-n,0));let l=-1;e.doc.nodesBetween(u,e.doc.content.size,((t,e)=>{if(l>-1)return!1;t.isTextblock&&0===t.content.size&&(l=e+1)})),l>-1&&e.setSelection(TD.near(e.doc.resolve(l))),e.scrollIntoView()}return!0}const h=c.pos===a.end()?l.contentMatchAt(0).defaultType:null,f=qM(d,l.type.name,l.attrs),p=qM(d,a.node().type.name,a.node().attrs);e.delete(a.pos,c.pos);const g=h?[{type:s,attrs:f},{type:h,attrs:p}]:[{type:s,attrs:f}];return!!sD(e.doc,a.pos,2)&&(r&&e.split(a.pos,2,g).scrollIntoView(),!0)};var ZM=Object.freeze({__proto__:null,splitListItem:JM});function QM(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function tT(t){return e=>QM(e.$from,t)}function eT(t){const e=t.filter((t=>"extension"===t.type)),n=t.filter((t=>"node"===t.type)),r=t.filter((t=>"mark"===t.type));return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function nT(t,e){const{nodeExtensions:n}=eT(e),r=n.find((e=>e.name===t));if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=KO(YO(r,"group",i));return"string"===typeof o&&o.split(" ").includes("list")}const rT=(t,e)=>{const n=tT((t=>t.type===e))(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;const i=t.doc.nodeAt(r),o=n.node.type===(null===i||void 0===i?void 0:i.type)&&aD(t.doc,n.pos);return!o||(t.join(n.pos),!0)},iT=(t,e)=>{const n=tT((t=>t.type===e))(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;const i=t.doc.nodeAt(r),o=n.node.type===(null===i||void 0===i?void 0:i.type)&&aD(t.doc,r);return!o||(t.join(r),!0)},oT=(t,e)=>({editor:n,tr:r,state:i,dispatch:o,chain:s,commands:a,can:c})=>{const{extensions:u}=n.extensionManager,l=lA(t,i.schema),d=lA(e,i.schema),{selection:h}=i,{$from:f,$to:p}=h,g=f.blockRange(p);if(!g)return!1;const m=tT((t=>nT(t.type.name,u)))(h);if(g.depth>=1&&m&&g.depth-m.depth<=1){if(m.node.type===l)return a.liftListItem(d);if(nT(m.node.type.name,u)&&l.validContent(m.node.content)&&o)return s().command((()=>(r.setNodeMarkup(m.pos,l),!0))).command((()=>rT(r,l))).command((()=>iT(r,l))).run()}return s().command((()=>{const t=c().wrapInList(l);return!!t||a.clearNodes()})).wrapInList(l).command((()=>rT(r,l))).command((()=>iT(r,l))).run()};var sT=Object.freeze({__proto__:null,toggleList:oT});function aT(t,e,n={}){const{empty:r,ranges:i}=t.selection,o=e?EA(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter((t=>!o||o.name===t.type.name)).find((t=>DA(t.attrs,n,{strict:!1})));let s=0;const a=[];if(i.forEach((({$from:e,$to:n})=>{const r=e.pos,i=n.pos;t.doc.nodesBetween(r,i,((t,e)=>{if(!t.isText&&!t.marks.length)return;const n=Math.max(r,e),o=Math.min(i,e+t.nodeSize),c=o-n;s+=c,a.push(...t.marks.map((t=>({mark:t,from:n,to:o}))))}))})),0===s)return!1;const c=a.filter((t=>!o||o.name===t.mark.type.name)).filter((t=>DA(t.mark.attrs,n,{strict:!1}))).reduce(((t,e)=>t+e.to-e.from),0),u=a.filter((t=>!o||t.mark.type!==o&&t.mark.type.excludes(o))).reduce(((t,e)=>t+e.to-e.from),0),l=c>0?c+u:c;return l>=s}const cT=(t,e={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=n,s=EA(t,r.schema),a=aT(r,s,e);return a?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,e)};var uT=Object.freeze({__proto__:null,toggleMark:cT});const lT=(t,e,n={})=>({state:r,commands:i})=>{const o=lA(t,r.schema),s=lA(e,r.schema),a=rM(r,o,n);return a?i.setNode(s):i.setNode(o,n)};var dT=Object.freeze({__proto__:null,toggleNode:lT});const hT=(t,e={})=>({state:n,commands:r})=>{const i=lA(t,n.schema),o=rM(n,i,e);return o?r.lift(i):r.wrapIn(i,e)};var fT=Object.freeze({__proto__:null,toggleWrap:hT});const pT=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let o;if(i.spec.isInputRules&&(o=i.getState(t))){if(e){const e=t.tr,n=o.transform;for(let t=n.steps.length-1;t>=0;t-=1)e.step(n.steps[t].invert(n.docs[t]));if(o.text){const n=e.doc.resolve(o.from).marks();e.replaceWith(o.from,o.to,t.schema.text(o.text,n))}else e.delete(o.from,o.to)}return!0}}return!1};var gT=Object.freeze({__proto__:null,undoInputRule:pT});const mT=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:i}=n;return r||e&&i.forEach((e=>{t.removeMark(e.$from.pos,e.$to.pos)})),!0};var vT=Object.freeze({__proto__:null,unsetAllMarks:mT});const yT=(t,e={})=>({tr:n,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=e,{selection:a}=n,c=EA(t,r.schema),{$from:u,empty:l,ranges:d}=a;if(!i)return!0;if(l&&s){let{from:t,to:e}=a;const r=null===(o=u.marks().find((t=>t.type===c)))||void 0===o?void 0:o.attrs,i=CA(u,c,r);i&&(t=i.from,e=i.to),n.removeMark(t,e,c)}else d.forEach((t=>{n.removeMark(t.$from.pos,t.$to.pos,c)}));return n.removeStoredMark(c),!0};var bT=Object.freeze({__proto__:null,unsetMark:yT});const wT=(t,e={})=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const a=hM("string"===typeof t?t:t.name,r.schema);return!!a&&("node"===a&&(o=lA(t,r.schema)),"mark"===a&&(s=EA(t,r.schema)),i&&n.selection.ranges.forEach((t=>{const i=t.$from.pos,a=t.$to.pos;r.doc.nodesBetween(i,a,((t,r)=>{o&&o===t.type&&n.setNodeMarkup(r,void 0,{...t.attrs,...e}),s&&t.marks.length&&t.marks.forEach((o=>{if(s===o.type){const c=Math.max(r,i),u=Math.min(r+t.nodeSize,a);n.addMark(c,u,s.create({...o.attrs,...e}))}}))}))})),!0)};var ET=Object.freeze({__proto__:null,updateAttributes:wT});const ST=(t,e={})=>({state:n,dispatch:r})=>{const i=lA(t,n.schema);return Dk(i,e)(n,r)};var DT=Object.freeze({__proto__:null,wrapIn:ST});const kT=(t,e={})=>({state:n,dispatch:r})=>{const i=lA(t,n.schema);return Tk(i,e)(n,r)};var xT=Object.freeze({__proto__:null,wrapInList:kT});const CT=XO.create({name:"commands",addCommands(){return{...eA,...rA,...oA,...aA,...uA,...hA,...pA,...mA,...yA,...wA,...OA,...MA,...zA,...LA,...HA,...KA,...XA,...ZA,...nM,...oM,...aM,...uM,...dM,...gM,...vM,...bM,...EM,...DM,...xM,..._M,...AM,...RM,...BM,...IM,...jM,...$M,...VM,...UM,...XM,...ZM,...sT,...uT,...dT,...fT,...gT,...vT,...bT,...ET,...DT,...xT}}}),_T=XO.create({name:"editable",addProseMirrorPlugins(){return[new JD({key:new tk("editable"),props:{editable:()=>this.editor.options.editable}})]}}),OT=XO.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new JD({key:new tk("focusEvents"),props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}});function AT(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:i}=n,{storedMarks:o}=n;return{...e,schema:e.schema,plugins:e.plugins,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,o=n.storedMarks,n}}}class MT{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:r}=e,{tr:i}=n,o=this.buildProps(i);return Object.fromEntries(Object.entries(t).map((([t,e])=>{const n=(...t)=>{const n=e(...t)(o);return i.getMeta("preventDispatch")||this.hasCustomState||r.dispatch(i),n};return[t,n]})))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:r,state:i}=this,{view:o}=r,s=[],a=!!t,c=t||i.tr,u=()=>(a||!e||c.getMeta("preventDispatch")||this.hasCustomState||o.dispatch(c),s.every((t=>!0===t))),l={...Object.fromEntries(Object.entries(n).map((([t,n])=>{const r=(...t)=>{const r=this.buildProps(c,e),i=n(...t)(r);return s.push(i),l};return[t,r]}))),run:u};return l}createCan(t){const{rawCommands:e,state:n}=this,r=void 0,i=t||n.tr,o=this.buildProps(i,r),s=Object.fromEntries(Object.entries(e).map((([t,e])=>[t,(...t)=>e(...t)({...o,dispatch:r})])));return{...s,chain:()=>this.createChain(i,r)}}buildProps(t,e=!0){const{rawCommands:n,editor:r,state:i}=this,{view:o}=r;i.storedMarks&&t.setStoredMarks(i.storedMarks);const s={tr:t,editor:r,view:o,state:AT({state:i,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map((([t,e])=>[t,(...t)=>e(...t)(s)])))}};return s}}const TT=XO.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first((({commands:t})=>[()=>t.undoInputRule(),()=>t.command((({tr:e})=>{const{selection:n,doc:r}=e,{empty:i,$anchor:o}=n,{pos:s,parent:a}=o,c=OD.atStart(r).from===s;return!(!(i&&c&&a.type.isTextblock)||a.textContent.length)&&t.clearNodes()})),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()])),e=()=>this.editor.commands.first((({commands:t})=>[()=>t.deleteSelection(),()=>t.joinForward(),()=>t.selectNodeForward()])),n=()=>this.editor.commands.first((({commands:t})=>[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()])),r={Enter:n,"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return PA()||QA()?o:i},addProseMirrorPlugins(){return[new JD({key:new tk("clearDocument"),appendTransaction:(t,e,n)=>{const r=t.some((t=>t.docChanged))&&!e.doc.eq(n.doc);if(!r)return;const{empty:i,from:o,to:s}=e.selection,a=OD.atStart(e.doc).from,c=OD.atEnd(e.doc).to,u=o===a&&s===c,l=0===n.doc.textBetween(0,n.doc.content.size," "," ").length;if(i||!u||!l)return;const d=n.tr,h=AT({state:n,transaction:d}),{commands:f}=new MT({editor:this.editor,state:h});return f.clearNodes(),d.steps.length?d:void 0}})]}}),RT=XO.create({name:"tabindex",addProseMirrorPlugins(){return[new JD({key:new tk("tabindex"),props:{attributes:()=>{if(this.editor.isEditable)return{tabindex:"0"}}}})]}});var NT=Object.freeze({__proto__:null,ClipboardTextSerializer:QO,Commands:CT,Editable:_T,FocusEvents:OT,Keymap:TT,Tabindex:RT});function PT(t,e){const n=lA(e,t.schema),{from:r,to:i}=t.selection,o=[];t.doc.nodesBetween(r,i,(t=>{o.push(t)}));const s=o.reverse().find((t=>t.type.name===n.name));return s?{...s.attrs}:{}}function BT(t,e){const n=hM("string"===typeof e?e:e.name,t.schema);return"node"===n?PT(t,e):"mark"===n?NM(t,e):{}}function FT(t,e,n={}){if(!e)return rM(t,null,n)||aT(t,null,n);const r=hM(e,t.schema);return"node"===r?rM(t,e,n):"mark"===r&&aT(t,e,n)}function IT(t,e){const n=RS.fromSchema(e).serializeFragment(t),r=document.implementation.createHTMLDocument(),i=r.createElement("div");return i.appendChild(n),i.innerHTML}function zT(t,e){const n={from:0,to:t.content.size};return JO(t,n,e)}function jT(t){var e;const n=null===(e=t.type.createAndFill())||void 0===e?void 0:e.toJSON(),r=t.toJSON();return JSON.stringify(n)===JSON.stringify(r)}function LT(t){const e=document.querySelector("style[data-tiptap-style]");if(null!==e)return e;const n=document.createElement("style");return n.setAttribute("data-tiptap-style",""),n.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(n),n}class $T{constructor(t){this.find=t.find,this.handler=t.handler}}const HT=(t,e)=>{if(SA(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[];return r.push(n.text),r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function VT(t){var e;const{editor:n,from:r,to:i,text:o,rules:s,plugin:a}=t,{view:c}=n;if(c.composing)return!1;const u=c.state.doc.resolve(r);if(u.parent.type.spec.code||(null===(e=u.nodeBefore||u.nodeAfter)||void 0===e?void 0:e.marks.find((t=>t.type.spec.code))))return!1;let l=!1;const d=500,h=u.parent.textBetween(Math.max(0,u.parentOffset-d),u.parentOffset,void 0," ")+o;return s.forEach((t=>{if(l)return;const e=HT(h,t.find);if(!e)return;const s=c.state.tr,u=AT({state:c.state,transaction:s}),d={from:r-(e[0].length-o.length),to:i},{commands:f,chain:p,can:g}=new MT({editor:n,state:u}),m=t.handler({state:u,range:d,match:e,commands:f,chain:p,can:g});null!==m&&s.steps.length&&(s.setMeta(a,{transform:s,from:r,to:i,text:o}),c.dispatch(s),l=!0)})),l}function WT(t){const{editor:e,rules:n}=t,r=new JD({state:{init(){return null},apply(t,e){const n=t.getMeta(this);return n||(t.selectionSet||t.docChanged?null:e)}},props:{handleTextInput(t,i,o,s){return VT({editor:e,from:i,to:o,text:s,rules:n,plugin:r})},handleDOMEvents:{compositionend:t=>(setTimeout((()=>{const{$cursor:i}=t.state.selection;i&&VT({editor:e,from:i.pos,to:i.pos,text:"",rules:n,plugin:r})})),!1)},handleKeyDown(t,i){if("Enter"!==i.key)return!1;const{$cursor:o}=t.state.selection;return!!o&&VT({editor:e,from:o.pos,to:o.pos,text:"\n",rules:n,plugin:r})}},isInputRules:!0});return r}function UT(t){return"number"===typeof t}class qT{constructor(t){this.find=t.find,this.handler=t.handler}}const GT=(t,e)=>{if(SA(e))return[...t.matchAll(e)];const n=e(t);return n?n.map((e=>{const n=[];return n.push(e.text),n.index=e.index,n.input=t,n.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(e.replaceWith)),n})):[]};function KT(t){const{editor:e,state:n,from:r,to:i,rule:o}=t,{commands:s,chain:a,can:c}=new MT({editor:e,state:n}),u=[];n.doc.nodesBetween(r,i,((t,e)=>{if(!t.isTextblock||t.type.spec.code)return;const l=Math.max(r,e),d=Math.min(i,e+t.content.size),h=t.textBetween(l-e,d-e,void 0,"￼"),f=GT(h,o.find);f.forEach((t=>{if(void 0===t.index)return;const e=l+t.index+1,r=e+t[0].length,i={from:n.tr.mapping.map(e),to:n.tr.mapping.map(r)},d=o.handler({state:n,range:i,match:t,commands:s,chain:a,can:c});u.push(d)}))}));const l=u.every((t=>null!==t));return l}function YT(t){const{editor:e,rules:n}=t;let r=null,i=!1,o=!1;const s=n.map((t=>new JD({view(t){const e=e=>{var n;r=(null===(n=t.dom.parentElement)||void 0===n?void 0:n.contains(e.target))?t.dom.parentElement:null};return window.addEventListener("dragstart",e),{destroy(){window.removeEventListener("dragstart",e)}}},props:{handleDOMEvents:{drop:t=>(o=r===t.dom.parentElement,!1),paste:(t,e)=>{var n;const r=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text/html");return i=!!(null===r||void 0===r?void 0:r.includes("data-pm-slice")),!1}}},appendTransaction:(n,r,s)=>{const a=n[0],c="paste"===a.getMeta("uiEvent")&&!i,u="drop"===a.getMeta("uiEvent")&&!o;if(!c&&!u)return;const l=r.doc.content.findDiffStart(s.doc.content),d=r.doc.content.findDiffEnd(s.doc.content);if(!UT(l)||!d||l===d.b)return;const h=s.tr,f=AT({state:s,transaction:h}),p=KT({editor:e,state:f,from:Math.max(l-1,0),to:d.b,rule:t});return p&&h.steps.length?h:void 0}})));return s}function XT(t){const e=[],{nodeExtensions:n,markExtensions:r}=eT(t),i=[...n,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0};return t.forEach((t=>{const n={name:t.name,options:t.options,storage:t.storage},r=YO(t,"addGlobalAttributes",n);if(!r)return;const i=r();i.forEach((t=>{t.types.forEach((n=>{Object.entries(t.attributes).forEach((([t,r])=>{e.push({type:n,name:t,attribute:{...o,...r}})}))}))}))})),i.forEach((t=>{const n={name:t.name,options:t.options,storage:t.storage},r=YO(t,"addAttributes",n);if(!r)return;const i=r();Object.entries(i).forEach((([n,r])=>{e.push({type:t.name,name:n,attribute:{...o,...r}})}))})),e}function JT(...t){return t.filter((t=>!!t)).reduce(((t,e)=>{const n={...t};return Object.entries(e).forEach((([t,e])=>{const r=n[t];n[t]=r?"class"===t?[n[t],e].join(" "):"style"===t?[n[t],e].join("; "):e:e})),n}),{})}function ZT(t,e){return e.filter((t=>t.attribute.rendered)).map((e=>e.attribute.renderHTML?e.attribute.renderHTML(t.attrs)||{}:{[e.name]:t.attrs[e.name]})).reduce(((t,e)=>JT(t,e)),{})}function QT(t={}){return 0===Object.keys(t).length&&t.constructor===Object}function tR(t){return"string"!==typeof t?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):"true"===t||"false"!==t&&t}function eR(t,e){return t.style?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(!1===r)return!1;const i=e.reduce(((t,e)=>{const r=e.attribute.parseHTML?e.attribute.parseHTML(n):tR(n.getAttribute(e.name));return null===r||void 0===r?t:{...t,[e.name]:r}}),{});return{...r,...i}}}}function nR(t){return Object.fromEntries(Object.entries(t).filter((([t,e])=>("attrs"!==t||!QT(e))&&(null!==e&&void 0!==e))))}function rR(t){var e;const n=XT(t),{nodeExtensions:r,markExtensions:i}=eT(t),o=null===(e=r.find((t=>YO(t,"topNode"))))||void 0===e?void 0:e.name,s=Object.fromEntries(r.map((e=>{const r=n.filter((t=>t.type===e.name)),i={name:e.name,options:e.options,storage:e.storage},o=t.reduce(((t,n)=>{const r=YO(n,"extendNodeSchema",i);return{...t,...r?r(e):{}}}),{}),s=nR({...o,content:KO(YO(e,"content",i)),marks:KO(YO(e,"marks",i)),group:KO(YO(e,"group",i)),inline:KO(YO(e,"inline",i)),atom:KO(YO(e,"atom",i)),selectable:KO(YO(e,"selectable",i)),draggable:KO(YO(e,"draggable",i)),code:KO(YO(e,"code",i)),defining:KO(YO(e,"defining",i)),isolating:KO(YO(e,"isolating",i)),attrs:Object.fromEntries(r.map((t=>{var e;return[t.name,{default:null===(e=null===t||void 0===t?void 0:t.attribute)||void 0===e?void 0:e.default}]})))}),a=KO(YO(e,"parseHTML",i));a&&(s.parseDOM=a.map((t=>eR(t,r))));const c=YO(e,"renderHTML",i);c&&(s.toDOM=t=>c({node:t,HTMLAttributes:ZT(t,r)}));const u=YO(e,"renderText",i);return u&&(s.toText=u),[e.name,s]}))),a=Object.fromEntries(i.map((e=>{const r=n.filter((t=>t.type===e.name)),i={name:e.name,options:e.options,storage:e.storage},o=t.reduce(((t,n)=>{const r=YO(n,"extendMarkSchema",i);return{...t,...r?r(e):{}}}),{}),s=nR({...o,inclusive:KO(YO(e,"inclusive",i)),excludes:KO(YO(e,"excludes",i)),group:KO(YO(e,"group",i)),spanning:KO(YO(e,"spanning",i)),code:KO(YO(e,"code",i)),attrs:Object.fromEntries(r.map((t=>{var e;return[t.name,{default:null===(e=null===t||void 0===t?void 0:t.attribute)||void 0===e?void 0:e.default}]})))}),a=KO(YO(e,"parseHTML",i));a&&(s.parseDOM=a.map((t=>eR(t,r))));const c=YO(e,"renderHTML",i);return c&&(s.toDOM=t=>c({mark:t,HTMLAttributes:ZT(t,r)})),[e.name,s]})));return new fS({topNode:o,nodes:s,marks:a})}function iR(t,e){return e.nodes[t]||e.marks[t]||null}function oR(t,e){return Array.isArray(e)?e.some((e=>{const n="string"===typeof e?e:e.name;return n===t.name})):e}function sR(t){const e=t.filter(((e,n)=>t.indexOf(e)!==n));return[...new Set(e)]}class aR{constructor(t,e){this.splittableMarks=[],this.editor=e,this.extensions=aR.resolve(t),this.schema=rR(this.extensions),this.extensions.forEach((t=>{var e;this.editor.extensionStorage[t.name]=t.storage;const n={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:iR(t.name,this.schema)};if("mark"===t.type){const r=null===(e=KO(YO(t,"keepOnSplit",n)))||void 0===e||e;r&&this.splittableMarks.push(t.name)}const r=YO(t,"onBeforeCreate",n);r&&this.editor.on("beforeCreate",r);const i=YO(t,"onCreate",n);i&&this.editor.on("create",i);const o=YO(t,"onUpdate",n);o&&this.editor.on("update",o);const s=YO(t,"onSelectionUpdate",n);s&&this.editor.on("selectionUpdate",s);const a=YO(t,"onTransaction",n);a&&this.editor.on("transaction",a);const c=YO(t,"onFocus",n);c&&this.editor.on("focus",c);const u=YO(t,"onBlur",n);u&&this.editor.on("blur",u);const l=YO(t,"onDestroy",n);l&&this.editor.on("destroy",l)}))}static resolve(t){const e=aR.sort(aR.flatten(t)),n=sR(e.map((t=>t.name)));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map((t=>`'${t}'`)).join(", ")}]. This can lead to issues.`),e}static flatten(t){return t.map((t=>{const e={name:t.name,options:t.options,storage:t.storage},n=YO(t,"addExtensions",e);return n?[t,...this.flatten(n())]:t})).flat(10)}static sort(t){const e=100;return t.sort(((t,n)=>{const r=YO(t,"priority")||e,i=YO(n,"priority")||e;return r>i?-1:r<i?1:0}))}get commands(){return this.extensions.reduce(((t,e)=>{const n={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:iR(e.name,this.schema)},r=YO(e,"addCommands",n);return r?{...t,...r()}:t}),{})}get plugins(){const{editor:t}=this,e=aR.sort([...this.extensions].reverse()),n=[],r=[],i=e.map((e=>{const i={name:e.name,options:e.options,storage:e.storage,editor:t,type:iR(e.name,this.schema)},o=[],s=YO(e,"addKeyboardShortcuts",i);if(s){const e=Object.fromEntries(Object.entries(s()).map((([e,n])=>[e,()=>n({editor:t})]))),n=HO(e);o.push(n)}const a=YO(e,"addInputRules",i);oR(e,t.options.enableInputRules)&&a&&n.push(...a());const c=YO(e,"addPasteRules",i);oR(e,t.options.enablePasteRules)&&c&&r.push(...c());const u=YO(e,"addProseMirrorPlugins",i);if(u){const t=u();o.push(...t)}return o})).flat();return[WT({editor:t,rules:n}),...YT({editor:t,rules:r}),...i]}get attributes(){return XT(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=eT(this.extensions);return Object.fromEntries(e.filter((t=>!!YO(t,"addNodeView"))).map((e=>{const n=this.attributes.filter((t=>t.type===e.name)),r={name:e.name,options:e.options,storage:e.storage,editor:t,type:lA(e.name,this.schema)},i=YO(e,"addNodeView",r);if(!i)return[];const o=(r,o,s,a)=>{const c=ZT(r,n);return i()({editor:t,node:r,getPos:s,decorations:a,HTMLAttributes:c,extension:e})};return[e.name,o]})))}}class cR{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach((t=>t.apply(this,e))),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter((t=>t!==e)):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}const uR='.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}';class lR extends cR{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout((()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))}),0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=LT(uR))}setOptions(t={}){this.options={...this.options,...t},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t){this.setOptions({editable:t})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,e){const n=GO(e)?e(t,this.state.plugins):[...this.state.plugins,t],r=this.state.reconfigure({plugins:n});this.view.updateState(r)}unregisterPlugin(t){if(this.isDestroyed)return;const e="string"===typeof t?`${t}$`:t.key,n=this.state.reconfigure({plugins:this.state.plugins.filter((t=>!t.key.startsWith(e)))});this.view.updateState(n)}createExtensionManager(){const t=this.options.enableCoreExtensions?Object.values(NT):[],e=[...t,...this.options.extensions].filter((t=>["extension","node","mark"].includes(null===t||void 0===t?void 0:t.type)));this.extensionManager=new aR(e,this)}createCommandManager(){this.commandManager=new MT({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const t=MM(this.options.content,this.schema,this.options.parseOptions),e=FA(t,this.options.autofocus);this.view=new yO(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:GD.create({doc:t,selection:e})});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.createNodeViews();const r=this.view.dom;r.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach((t=>{var e;return null===(e=this.capturedTransaction)||void 0===e?void 0:e.step(t)})):void(this.capturedTransaction=t);const e=this.state.apply(t),n=!this.state.selection.eq(e.selection);this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t}),n&&this.emit("selectionUpdate",{editor:this,transaction:t});const r=t.getMeta("focus"),i=t.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:t}),i&&this.emit("blur",{editor:this,event:i.event,transaction:t}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return BT(this.state,t)}isActive(t,e){const n="string"===typeof t?t:null,r="string"===typeof t?e:t;return FT(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return IT(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e="\n\n",textSerializers:n={}}=t||{};return zT(this.state.doc,{blockSeparator:e,textSerializers:{...n,...ZO(this.schema)}})}get isEmpty(){return jT(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(null===(t=this.view)||void 0===t?void 0:t.docView)}}class dR{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=KO(YO(this,"addOptions",{name:this.name}))),this.storage=KO(YO(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new dR(t)}configure(t={}){const e=this.extend();return e.options=qO(this.options,t),e.storage=KO(YO(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new dR(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=KO(YO(e,"addOptions",{name:e.name})),e.storage=KO(YO(e,"addStorage",{name:e.name,options:e.options})),e}}class hR{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=KO(YO(this,"addOptions",{name:this.name}))),this.storage=KO(YO(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new hR(t)}configure(t={}){const e=this.extend();return e.options=qO(this.options,t),e.storage=KO(YO(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new hR(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=KO(YO(e,"addOptions",{name:e.name})),e.storage=KO(YO(e,"addStorage",{name:e.name,options:e.options})),e}}function fR(t){return new $T({find:t.find,handler:({state:e,range:n,match:r})=>{const i=KO(t.getAttributes,void 0,r)||{},{tr:o}=e,s=n.from;let a=n.to;if(r[1]){const e=r[0].lastIndexOf(r[1]);let n=s+e;n>a?n=a:a=n+r[1].length;const c=r[0][r[0].length-1];o.insertText(c,s+r[0].length-1),o.replaceWith(n,a,t.type.create(i))}else r[0]&&o.replaceWith(s,a,t.type.create(i))}})}function pR(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach((e=>{const i=n.resolve(t-1),o=CA(i,e.type);o&&r.push({mark:e,...o})})):n.nodesBetween(t,e,((t,e)=>{r.push(...t.marks.map((n=>({from:e,to:e+t.nodeSize,mark:n}))))})),r}function gR(t){return new $T({find:t.find,handler:({state:e,range:n,match:r})=>{const i=KO(t.getAttributes,void 0,r);if(!1===i||null===i)return null;const{tr:o}=e,s=r[r.length-1],a=r[0];let c=n.to;if(s){const r=a.search(/\S/),u=n.from+a.indexOf(s),l=u+s.length,d=pR(n.from,n.to,e.doc).filter((e=>{const n=e.mark.type.excluded;return n.find((n=>n===t.type&&n!==e.mark.type))})).filter((t=>t.to>u));if(d.length)return null;l<n.to&&o.delete(l,n.to),u>n.from&&o.delete(n.from+r,u),c=n.from+r+s.length,o.addMark(n.from+r,c,t.type.create(i||{})),o.removeStoredMark(t.type)}}})}function mR(t){return new $T({find:t.find,handler:({state:e,range:n,match:r})=>{const i=e.doc.resolve(n.from),o=KO(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,o)}})}function vR(t){return new $T({find:t.find,handler:({state:e,range:n,match:r})=>{const i=KO(t.getAttributes,void 0,r)||{},o=e.tr.delete(n.from,n.to),s=o.doc.resolve(n.from),a=s.blockRange(),c=a&&eD(a,t.type,i);if(!c)return null;o.wrap(a,c);const u=o.doc.resolve(n.from-1).nodeBefore;u&&u.type===t.type&&aD(o.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,u))&&o.join(n.from-1)}})}function yR(t){return new qT({find:t.find,handler:({state:e,range:n,match:r})=>{const i=KO(t.getAttributes,void 0,r);if(!1===i||null===i)return null;const{tr:o}=e,s=r[r.length-1],a=r[0];let c=n.to;if(s){const r=a.search(/\S/),u=n.from+a.indexOf(s),l=u+s.length,d=pR(n.from,n.to,e.doc).filter((e=>{const n=e.mark.type.excluded;return n.find((n=>n===t.type&&n!==e.mark.type))})).filter((t=>t.to>u));if(d.length)return null;l<n.to&&o.delete(l,n.to),u>n.from&&o.delete(n.from+r,u),c=n.from+r+s.length,o.addMark(n.from+r,c,t.type.create(i||{})),o.removeStoredMark(t.type)}}})}function bR(t,e){const n=new WS(t);return e.forEach((t=>{t.steps.forEach((t=>{n.step(t)}))})),n}function wR(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,((t,e)=>{n(t)&&r.push({node:t,pos:e})})),r}function ER(t,e=JSON.stringify){const n={};return t.filter((t=>{const r=e(t);return!Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=!0)}))}function SR(t){const e=ER(t);return 1===e.length?e:e.filter(((t,n)=>{const r=e.filter(((t,e)=>e!==n));return!r.some((e=>t.oldRange.from>=e.oldRange.from&&t.oldRange.to<=e.oldRange.to&&t.newRange.from>=e.newRange.from&&t.newRange.to<=e.newRange.to))}))}function DR(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach(((t,i)=>{const o=[];if(t.ranges.length)t.forEach(((t,e)=>{o.push({from:t,to:e})}));else{const{from:t,to:e}=n[i];if(void 0===t||void 0===e)return;o.push({from:t,to:e})}o.forEach((({from:t,to:n})=>{const o=e.slice(i).map(t,-1),s=e.slice(i).map(n),a=e.invert().map(o,-1),c=e.invert().map(s);r.push({oldRange:{from:a,to:c},newRange:{from:o,to:s}})}))})),SR(r)}function kR(t){return RA(t)&&t instanceof ND}function xR(t,e,n){const r=0,i=t.state.doc.content.size,o=BA(e,r,i),s=BA(n,r,i),a=t.coordsAtPos(o),c=t.coordsAtPos(s,-1),u=Math.min(a.top,c.top),l=Math.max(a.bottom,c.bottom),d=Math.min(a.left,c.left),h=Math.max(a.right,c.right),f=h-d,p=l-u,g=d,m=u,v={top:u,bottom:l,left:d,right:h,width:f,height:p,x:g,y:m};return{...v,toJSON:()=>v}}var CR=n(2241),_R=n(3435),OR="tippy-box",AR="tippy-content",MR="tippy-backdrop",TR="tippy-arrow",RR="tippy-svg-arrow",NR={passive:!0,capture:!0},PR=function(){return document.body};function BR(t,e,n){if(Array.isArray(t)){var r=t[e];return null==r?Array.isArray(n)?n[e]:n:r}return t}function FR(t,e){var n={}.toString.call(t);return 0===n.indexOf("[object")&&n.indexOf(e+"]")>-1}function IR(t,e){return"function"===typeof t?t.apply(void 0,e):t}function zR(t,e){return 0===e?t:function(r){clearTimeout(n),n=setTimeout((function(){t(r)}),e)};var n}function jR(t){return t.split(/\s+/).filter(Boolean)}function LR(t){return[].concat(t)}function $R(t,e){-1===t.indexOf(e)&&t.push(e)}function HR(t){return t.filter((function(e,n){return t.indexOf(e)===n}))}function VR(t){return t.split("-")[0]}function WR(t){return[].slice.call(t)}function UR(t){return Object.keys(t).reduce((function(e,n){return void 0!==t[n]&&(e[n]=t[n]),e}),{})}function qR(){return document.createElement("div")}function GR(t){return["Element","Fragment"].some((function(e){return FR(t,e)}))}function KR(t){return FR(t,"NodeList")}function YR(t){return FR(t,"MouseEvent")}function XR(t){return!(!t||!t._tippy||t._tippy.reference!==t)}function JR(t){return GR(t)?[t]:KR(t)?WR(t):Array.isArray(t)?t:WR(document.querySelectorAll(t))}function ZR(t,e){t.forEach((function(t){t&&(t.style.transitionDuration=e+"ms")}))}function QR(t,e){t.forEach((function(t){t&&t.setAttribute("data-state",e)}))}function tN(t){var e,n=LR(t),r=n[0];return null!=r&&null!=(e=r.ownerDocument)&&e.body?r.ownerDocument:document}function eN(t,e){var n=e.clientX,r=e.clientY;return t.every((function(t){var e=t.popperRect,i=t.popperState,o=t.props,s=o.interactiveBorder,a=VR(i.placement),c=i.modifiersData.offset;if(!c)return!0;var u="bottom"===a?c.top.y:0,l="top"===a?c.bottom.y:0,d="right"===a?c.left.x:0,h="left"===a?c.right.x:0,f=e.top-r+u>s,p=r-e.bottom-l>s,g=e.left-n+d>s,m=n-e.right-h>s;return f||p||g||m}))}function nN(t,e,n){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(e){t[r](e,n)}))}function rN(t,e){var n=e;while(n){var r;if(t.contains(n))return!0;n=null==n.getRootNode||null==(r=n.getRootNode())?void 0:r.host}return!1}var iN={isTouch:!1},oN=0;function sN(){iN.isTouch||(iN.isTouch=!0,window.performance&&document.addEventListener("mousemove",aN))}function aN(){var t=performance.now();t-oN<20&&(iN.isTouch=!1,document.removeEventListener("mousemove",aN)),oN=t}function cN(){var t=document.activeElement;if(XR(t)){var e=t._tippy;t.blur&&!e.state.isVisible&&t.blur()}}function uN(){document.addEventListener("touchstart",sN,NR),window.addEventListener("blur",cN)}var lN="undefined"!==typeof window&&"undefined"!==typeof document,dN=!!lN&&!!window.msCrypto;var hN={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},fN={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},pN=Object.assign({appendTo:PR,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},hN,fN),gN=Object.keys(pN),mN=function(t){var e=Object.keys(t);e.forEach((function(e){pN[e]=t[e]}))};function vN(t){var e=t.plugins||[],n=e.reduce((function(e,n){var r,i=n.name,o=n.defaultValue;i&&(e[i]=void 0!==t[i]?t[i]:null!=(r=pN[i])?r:o);return e}),{});return Object.assign({},t,n)}function yN(t,e){var n=e?Object.keys(vN(Object.assign({},pN,{plugins:e}))):gN,r=n.reduce((function(e,n){var r=(t.getAttribute("data-tippy-"+n)||"").trim();if(!r)return e;if("content"===n)e[n]=r;else try{e[n]=JSON.parse(r)}catch(Xw){e[n]=r}return e}),{});return r}function bN(t,e){var n=Object.assign({},e,{content:IR(e.content,[t])},e.ignoreAttributes?{}:yN(t,e.plugins));return n.aria=Object.assign({},pN.aria,n.aria),n.aria={expanded:"auto"===n.aria.expanded?e.interactive:n.aria.expanded,content:"auto"===n.aria.content?e.interactive?null:"describedby":n.aria.content},n}var wN=function(){return"innerHTML"};function EN(t,e){t[wN()]=e}function SN(t){var e=qR();return!0===t?e.className=TR:(e.className=RR,GR(t)?e.appendChild(t):EN(e,t)),e}function DN(t,e){GR(e.content)?(EN(t,""),t.appendChild(e.content)):"function"!==typeof e.content&&(e.allowHTML?EN(t,e.content):t.textContent=e.content)}function kN(t){var e=t.firstElementChild,n=WR(e.children);return{box:e,content:n.find((function(t){return t.classList.contains(AR)})),arrow:n.find((function(t){return t.classList.contains(TR)||t.classList.contains(RR)})),backdrop:n.find((function(t){return t.classList.contains(MR)}))}}function xN(t){var e=qR(),n=qR();n.className=OR,n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=qR();function i(n,r){var i=kN(e),o=i.box,s=i.content,a=i.arrow;r.theme?o.setAttribute("data-theme",r.theme):o.removeAttribute("data-theme"),"string"===typeof r.animation?o.setAttribute("data-animation",r.animation):o.removeAttribute("data-animation"),r.inertia?o.setAttribute("data-inertia",""):o.removeAttribute("data-inertia"),o.style.maxWidth="number"===typeof r.maxWidth?r.maxWidth+"px":r.maxWidth,r.role?o.setAttribute("role",r.role):o.removeAttribute("role"),n.content===r.content&&n.allowHTML===r.allowHTML||DN(s,t.props),r.arrow?a?n.arrow!==r.arrow&&(o.removeChild(a),o.appendChild(SN(r.arrow))):o.appendChild(SN(r.arrow)):a&&o.removeChild(a)}return r.className=AR,r.setAttribute("data-state","hidden"),DN(r,t.props),e.appendChild(n),n.appendChild(r),i(t.props,t.props),{popper:e,onUpdate:i}}xN.$$tippy=!0;var CN=1,_N=[],ON=[];function AN(t,e){var n,r,i,o,s,a,c,u=bN(t,Object.assign({},pN,vN(UR(e)))),l=!1,d=!1,h=!1,f=!1,p=[],g=zR(X,u.interactiveDebounce),m=CN++,v=null,y=HR(u.plugins),b={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},w={id:m,reference:t,popper:qR(),popperInstance:v,props:u,state:b,plugins:y,clearDelayTimeouts:ct,setProps:ut,setContent:lt,show:dt,hide:ht,hideWithInteractivity:ft,enable:st,disable:at,unmount:pt,destroy:gt};if(!u.render)return w;var E=u.render(w),S=E.popper,D=E.onUpdate;S.setAttribute("data-tippy-root",""),S.id="tippy-"+w.id,w.popper=S,t._tippy=w,S._tippy=w;var k=y.map((function(t){return t.fn(w)})),x=t.hasAttribute("aria-expanded");return G(),F(),N(),P("onCreate",[w]),u.showOnCreate&&it(),S.addEventListener("mouseenter",(function(){w.props.interactive&&w.state.isVisible&&w.clearDelayTimeouts()})),S.addEventListener("mouseleave",(function(){w.props.interactive&&w.props.trigger.indexOf("mouseenter")>=0&&M().addEventListener("mousemove",g)})),w;function C(){var t=w.props.touch;return Array.isArray(t)?t:[t,0]}function _(){return"hold"===C()[0]}function O(){var t;return!(null==(t=w.props.render)||!t.$$tippy)}function A(){return c||t}function M(){var t=A().parentNode;return t?tN(t):document}function T(){return kN(S)}function R(t){return w.state.isMounted&&!w.state.isVisible||iN.isTouch||o&&"focus"===o.type?0:BR(w.props.delay,t?0:1,pN.delay)}function N(t){void 0===t&&(t=!1),S.style.pointerEvents=w.props.interactive&&!t?"":"none",S.style.zIndex=""+w.props.zIndex}function P(t,e,n){var r;(void 0===n&&(n=!0),k.forEach((function(n){n[t]&&n[t].apply(n,e)})),n)&&(r=w.props)[t].apply(r,e)}function B(){var e=w.props.aria;if(e.content){var n="aria-"+e.content,r=S.id,i=LR(w.props.triggerTarget||t);i.forEach((function(t){var e=t.getAttribute(n);if(w.state.isVisible)t.setAttribute(n,e?e+" "+r:r);else{var i=e&&e.replace(r,"").trim();i?t.setAttribute(n,i):t.removeAttribute(n)}}))}}function F(){if(!x&&w.props.aria.expanded){var e=LR(w.props.triggerTarget||t);e.forEach((function(t){w.props.interactive?t.setAttribute("aria-expanded",w.state.isVisible&&t===A()?"true":"false"):t.removeAttribute("aria-expanded")}))}}function I(){M().removeEventListener("mousemove",g),_N=_N.filter((function(t){return t!==g}))}function z(e){if(!iN.isTouch||!h&&"mousedown"!==e.type){var n=e.composedPath&&e.composedPath()[0]||e.target;if(!w.props.interactive||!rN(S,n)){if(LR(w.props.triggerTarget||t).some((function(t){return rN(t,n)}))){if(iN.isTouch)return;if(w.state.isVisible&&w.props.trigger.indexOf("click")>=0)return}else P("onClickOutside",[w,e]);!0===w.props.hideOnClick&&(w.clearDelayTimeouts(),w.hide(),d=!0,setTimeout((function(){d=!1})),w.state.isMounted||H())}}}function j(){h=!0}function L(){h=!1}function $(){var t=M();t.addEventListener("mousedown",z,!0),t.addEventListener("touchend",z,NR),t.addEventListener("touchstart",L,NR),t.addEventListener("touchmove",j,NR)}function H(){var t=M();t.removeEventListener("mousedown",z,!0),t.removeEventListener("touchend",z,NR),t.removeEventListener("touchstart",L,NR),t.removeEventListener("touchmove",j,NR)}function V(t,e){U(t,(function(){!w.state.isVisible&&S.parentNode&&S.parentNode.contains(S)&&e()}))}function W(t,e){U(t,e)}function U(t,e){var n=T().box;function r(t){t.target===n&&(nN(n,"remove",r),e())}if(0===t)return e();nN(n,"remove",s),nN(n,"add",r),s=r}function q(e,n,r){void 0===r&&(r=!1);var i=LR(w.props.triggerTarget||t);i.forEach((function(t){t.addEventListener(e,n,r),p.push({node:t,eventType:e,handler:n,options:r})}))}function G(){_()&&(q("touchstart",Y,{passive:!0}),q("touchend",J,{passive:!0})),jR(w.props.trigger).forEach((function(t){if("manual"!==t)switch(q(t,Y),t){case"mouseenter":q("mouseleave",J);break;case"focus":q(dN?"focusout":"blur",Z);break;case"focusin":q("focusout",Z);break}}))}function K(){p.forEach((function(t){var e=t.node,n=t.eventType,r=t.handler,i=t.options;e.removeEventListener(n,r,i)})),p=[]}function Y(t){var e,n=!1;if(w.state.isEnabled&&!Q(t)&&!d){var r="focus"===(null==(e=o)?void 0:e.type);o=t,c=t.currentTarget,F(),!w.state.isVisible&&YR(t)&&_N.forEach((function(e){return e(t)})),"click"===t.type&&(w.props.trigger.indexOf("mouseenter")<0||l)&&!1!==w.props.hideOnClick&&w.state.isVisible?n=!0:it(t),"click"===t.type&&(l=!n),n&&!r&&ot(t)}}function X(t){var e=t.target,n=A().contains(e)||S.contains(e);if("mousemove"!==t.type||!n){var r=rt().concat(S).map((function(t){var e,n=t._tippy,r=null==(e=n.popperInstance)?void 0:e.state;return r?{popperRect:t.getBoundingClientRect(),popperState:r,props:u}:null})).filter(Boolean);eN(r,t)&&(I(),ot(t))}}function J(t){var e=Q(t)||w.props.trigger.indexOf("click")>=0&&l;e||(w.props.interactive?w.hideWithInteractivity(t):ot(t))}function Z(t){w.props.trigger.indexOf("focusin")<0&&t.target!==A()||w.props.interactive&&t.relatedTarget&&S.contains(t.relatedTarget)||ot(t)}function Q(t){return!!iN.isTouch&&_()!==t.type.indexOf("touch")>=0}function tt(){et();var e=w.props,n=e.popperOptions,r=e.placement,i=e.offset,o=e.getReferenceClientRect,s=e.moveTransition,c=O()?kN(S).arrow:null,u=o?{getBoundingClientRect:o,contextElement:o.contextElement||A()}:t,l={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(t){var e=t.state;if(O()){var n=T(),r=n.box;["placement","reference-hidden","escaped"].forEach((function(t){"placement"===t?r.setAttribute("data-placement",e.placement):e.attributes.popper["data-popper-"+t]?r.setAttribute("data-"+t,""):r.removeAttribute("data-"+t)})),e.attributes.popper={}}}},d=[{name:"offset",options:{offset:i}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!s}},l];O()&&c&&d.push({name:"arrow",options:{element:c,padding:3}}),d.push.apply(d,(null==n?void 0:n.modifiers)||[]),w.popperInstance=(0,CR.fi)(u,S,Object.assign({},n,{placement:r,onFirstUpdate:a,modifiers:d}))}function et(){w.popperInstance&&(w.popperInstance.destroy(),w.popperInstance=null)}function nt(){var t,e=w.props.appendTo,n=A();t=w.props.interactive&&e===PR||"parent"===e?n.parentNode:IR(e,[n]),t.contains(S)||t.appendChild(S),w.state.isMounted=!0,tt()}function rt(){return WR(S.querySelectorAll("[data-tippy-root]"))}function it(t){w.clearDelayTimeouts(),t&&P("onTrigger",[w,t]),$();var e=R(!0),r=C(),i=r[0],o=r[1];iN.isTouch&&"hold"===i&&o&&(e=o),e?n=setTimeout((function(){w.show()}),e):w.show()}function ot(t){if(w.clearDelayTimeouts(),P("onUntrigger",[w,t]),w.state.isVisible){if(!(w.props.trigger.indexOf("mouseenter")>=0&&w.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(t.type)>=0&&l)){var e=R(!1);e?r=setTimeout((function(){w.state.isVisible&&w.hide()}),e):i=requestAnimationFrame((function(){w.hide()}))}}else H()}function st(){w.state.isEnabled=!0}function at(){w.hide(),w.state.isEnabled=!1}function ct(){clearTimeout(n),clearTimeout(r),cancelAnimationFrame(i)}function ut(e){if(!w.state.isDestroyed){P("onBeforeUpdate",[w,e]),K();var n=w.props,r=bN(t,Object.assign({},n,UR(e),{ignoreAttributes:!0}));w.props=r,G(),n.interactiveDebounce!==r.interactiveDebounce&&(I(),g=zR(X,r.interactiveDebounce)),n.triggerTarget&&!r.triggerTarget?LR(n.triggerTarget).forEach((function(t){t.removeAttribute("aria-expanded")})):r.triggerTarget&&t.removeAttribute("aria-expanded"),F(),N(),D&&D(n,r),w.popperInstance&&(tt(),rt().forEach((function(t){requestAnimationFrame(t._tippy.popperInstance.forceUpdate)}))),P("onAfterUpdate",[w,e])}}function lt(t){w.setProps({content:t})}function dt(){var t=w.state.isVisible,e=w.state.isDestroyed,n=!w.state.isEnabled,r=iN.isTouch&&!w.props.touch,i=BR(w.props.duration,0,pN.duration);if(!(t||e||n||r)&&!A().hasAttribute("disabled")&&(P("onShow",[w],!1),!1!==w.props.onShow(w))){if(w.state.isVisible=!0,O()&&(S.style.visibility="visible"),N(),$(),w.state.isMounted||(S.style.transition="none"),O()){var o=T(),s=o.box,c=o.content;ZR([s,c],0)}a=function(){var t;if(w.state.isVisible&&!f){if(f=!0,S.offsetHeight,S.style.transition=w.props.moveTransition,O()&&w.props.animation){var e=T(),n=e.box,r=e.content;ZR([n,r],i),QR([n,r],"visible")}B(),F(),$R(ON,w),null==(t=w.popperInstance)||t.forceUpdate(),P("onMount",[w]),w.props.animation&&O()&&W(i,(function(){w.state.isShown=!0,P("onShown",[w])}))}},nt()}}function ht(){var t=!w.state.isVisible,e=w.state.isDestroyed,n=!w.state.isEnabled,r=BR(w.props.duration,1,pN.duration);if(!(t||e||n)&&(P("onHide",[w],!1),!1!==w.props.onHide(w))){if(w.state.isVisible=!1,w.state.isShown=!1,f=!1,l=!1,O()&&(S.style.visibility="hidden"),I(),H(),N(!0),O()){var i=T(),o=i.box,s=i.content;w.props.animation&&(ZR([o,s],r),QR([o,s],"hidden"))}B(),F(),w.props.animation?O()&&V(r,w.unmount):w.unmount()}}function ft(t){M().addEventListener("mousemove",g),$R(_N,g),g(t)}function pt(){w.state.isVisible&&w.hide(),w.state.isMounted&&(et(),rt().forEach((function(t){t._tippy.unmount()})),S.parentNode&&S.parentNode.removeChild(S),ON=ON.filter((function(t){return t!==w})),w.state.isMounted=!1,P("onHidden",[w]))}function gt(){w.state.isDestroyed||(w.clearDelayTimeouts(),w.unmount(),K(),delete t._tippy,w.state.isDestroyed=!0,P("onDestroy",[w]))}}function MN(t,e){void 0===e&&(e={});var n=pN.plugins.concat(e.plugins||[]);uN();var r=Object.assign({},e,{plugins:n}),i=JR(t),o=i.reduce((function(t,e){var n=e&&AN(e,r);return n&&t.push(n),t}),[]);return GR(t)?o[0]:o}MN.defaultProps=pN,MN.setDefaultProps=mN,MN.currentInput=iN;Object.assign({},_R.Z,{effect:function(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow)}});MN.setDefaultProps({render:xN});var TN=MN;class RN{constructor({editor:t,element:e,view:n,tippyOptions:r={},shouldShow:i}){this.preventHide=!1,this.shouldShow=({view:t,state:e,from:n,to:r})=>{const{doc:i,selection:o}=e,{empty:s}=o,a=!i.textBetween(n,r).length&&NA(e.selection);return!(!t.hasFocus()||s||a)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout((()=>this.update(this.editor.view)))},this.blurHandler=({event:t})=>{var e;this.preventHide?this.preventHide=!1:(null===t||void 0===t?void 0:t.relatedTarget)&&(null===(e=this.element.parentNode)||void 0===e?void 0:e.contains(t.relatedTarget))||this.hide()},this.editor=t,this.element=e,this.view=n,i&&(this.shouldShow=i),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=r,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,e=!!t.parentElement;!this.tippy&&e&&(this.tippy=TN(t,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",(t=>{this.blurHandler({event:t})})))}update(t,e){var n,r,i;const{state:o,composing:s}=t,{doc:a,selection:c}=o,u=e&&e.doc.eq(a)&&e.selection.eq(c);if(s||u)return;this.createTooltip();const{ranges:l}=c,d=Math.min(...l.map((t=>t.$from.pos))),h=Math.max(...l.map((t=>t.$to.pos))),f=null===(n=this.shouldShow)||void 0===n?void 0:n.call(this,{editor:this.editor,view:t,state:o,oldState:e,from:d,to:h});f?(null===(r=this.tippy)||void 0===r||r.setProps({getReferenceClientRect:(null===(i=this.tippyOptions)||void 0===i?void 0:i.getReferenceClientRect)||(()=>{if(kR(o.selection)){const e=t.nodeDOM(d);if(e)return e.getBoundingClientRect()}return xR(t,d,h)})}),this.show()):this.hide()}show(){var t;null===(t=this.tippy)||void 0===t||t.show()}hide(){var t;null===(t=this.tippy)||void 0===t||t.hide()}destroy(){var t;null===(t=this.tippy)||void 0===t||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const NN=t=>new JD({key:"string"===typeof t.pluginKey?new tk(t.pluginKey):t.pluginKey,view:e=>new RN({view:e,...t})});XO.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[NN({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});class PN{constructor({editor:t,element:e,view:n,tippyOptions:r={},shouldShow:i}){this.preventHide=!1,this.shouldShow=({view:t,state:e})=>{const{selection:n}=e,{$anchor:r,empty:i}=n,o=1===r.depth,s=r.parent.isTextblock&&!r.parent.type.spec.code&&!r.parent.textContent;return!!(t.hasFocus()&&i&&o&&s)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout((()=>this.update(this.editor.view)))},this.blurHandler=({event:t})=>{var e;this.preventHide?this.preventHide=!1:(null===t||void 0===t?void 0:t.relatedTarget)&&(null===(e=this.element.parentNode)||void 0===e?void 0:e.contains(t.relatedTarget))||this.hide()},this.editor=t,this.element=e,this.view=n,i&&(this.shouldShow=i),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=r,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,e=!!t.parentElement;!this.tippy&&e&&(this.tippy=TN(t,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",(t=>{this.blurHandler({event:t})})))}update(t,e){var n,r,i;const{state:o}=t,{doc:s,selection:a}=o,{from:c,to:u}=a,l=e&&e.doc.eq(s)&&e.selection.eq(a);if(l)return;this.createTooltip();const d=null===(n=this.shouldShow)||void 0===n?void 0:n.call(this,{editor:this.editor,view:t,state:o,oldState:e});d?(null===(r=this.tippy)||void 0===r||r.setProps({getReferenceClientRect:(null===(i=this.tippyOptions)||void 0===i?void 0:i.getReferenceClientRect)||(()=>xR(t,c,u))}),this.show()):this.hide()}show(){var t;null===(t=this.tippy)||void 0===t||t.show()}hide(){var t;null===(t=this.tippy)||void 0===t||t.hide()}destroy(){var t;null===(t=this.tippy)||void 0===t||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const BN=t=>new JD({key:"string"===typeof t.pluginKey?new tk(t.pluginKey):t.pluginKey,view:e=>new PN({view:e,...t})});XO.create({name:"floatingMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[BN({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}}),(0,o.aZ)({name:"BubbleMenu",props:{pluginKey:{type:null,default:"bubbleMenu"},editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(t,{slots:e}){const n=(0,xd.iH)(null);return(0,o.bv)((()=>{const{pluginKey:e,editor:r,tippyOptions:i,shouldShow:o}=t;r.registerPlugin(NN({pluginKey:e,editor:r,element:n.value,tippyOptions:i,shouldShow:o}))})),(0,o.Jd)((()=>{const{pluginKey:e,editor:n}=t;n.unregisterPlugin(e)})),()=>{var t;return(0,o.h)("div",{ref:n},null===(t=e.default)||void 0===t?void 0:t.call(e))}}});function FN(t){return(0,xd.ZM)(((e,n)=>({get(){return e(),t},set(e){t=e,requestAnimationFrame((()=>{requestAnimationFrame((()=>{n()}))}))}})))}class IN extends lR{constructor(t={}){return super(t),this.vueRenderers=(0,xd.qj)(new Map),this.contentComponent=null,this.reactiveState=FN(this.view.state),this.reactiveExtensionStorage=FN(this.extensionStorage),this.on("transaction",(()=>{this.reactiveState.value=this.view.state,this.reactiveExtensionStorage.value=this.extensionStorage})),(0,xd.Xl)(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(t,e){super.registerPlugin(t,e),this.reactiveState.value=this.view.state}unregisterPlugin(t){super.unregisterPlugin(t),this.reactiveState.value=this.view.state}}const zN=(0,o.aZ)({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(t){const e=(0,xd.iH)(),n=(0,o.FN)();return(0,o.m0)((()=>{const r=t.editor;r&&r.options.element&&e.value&&(0,o.Y3)((()=>{if(!e.value||!r.options.element.firstChild)return;const t=(0,xd.SU)(e.value);e.value.append(...r.options.element.childNodes),r.contentComponent=n.ctx._,r.setOptions({element:t}),r.createNodeViews()}))})),(0,o.Jd)((()=>{const e=t.editor;if(!e)return;if(e.isDestroyed||e.view.setProps({nodeViews:{}}),e.contentComponent=null,!e.options.element.firstChild)return;const n=document.createElement("div");n.append(...e.options.element.childNodes),e.setOptions({element:n})})),{rootEl:e}},render(){const t=[];return this.editor&&this.editor.vueRenderers.forEach((e=>{const n=(0,o.h)(o.lR,{to:e.teleportElement,key:e.id},(0,o.h)(e.component,{ref:e.id,...e.props}));t.push(n)})),(0,o.h)("div",{ref:t=>{this.rootEl=t}},...t)}});(0,o.aZ)({name:"FloatingMenu",props:{pluginKey:{type:null,default:"floatingMenu"},editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(t,{slots:e}){const n=(0,xd.iH)(null);return(0,o.bv)((()=>{const{pluginKey:e,editor:r,tippyOptions:i,shouldShow:o}=t;r.registerPlugin(BN({pluginKey:e,editor:r,element:n.value,tippyOptions:i,shouldShow:o}))})),(0,o.Jd)((()=>{const{pluginKey:e,editor:n}=t;n.unregisterPlugin(e)})),()=>{var t;return(0,o.h)("div",{ref:n},null===(t=e.default)||void 0===t?void 0:t.call(e))}}});Boolean;(0,o.aZ)({props:{as:{type:String,default:"div"}},inject:["onDragStart","decorationClasses"],render(){var t,e;return(0,o.h)(this.as,{class:this.decorationClasses.value,style:{whiteSpace:"normal"},"data-node-view-wrapper":"",onDragstart:this.onDragStart},null===(e=(t=this.$slots).default)||void 0===e?void 0:e.call(t))}}),(0,o.aZ)({props:{as:{type:String,default:"div"}},render(){return(0,o.h)(this.as,{style:{whiteSpace:"pre-wrap"},"data-node-view-content":""})}});const jN=/^\s*>\s$/,LN=dR.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",JT(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[vR({find:jN,type:this.type})]}}),$N=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,HN=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,VN=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,WN=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,UN=hR.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>"normal"!==t.style.fontWeight&&null},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",JT(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[gR({find:$N,type:this.type}),gR({find:VN,type:this.type})]},addPasteRules(){return[yR({find:HN,type:this.type}),yR({find:WN,type:this.type})]}}),qN=/^\s*([-+*])\s$/,GN=dR.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",JT(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[vR({find:qN,type:this.type})]}}),KN=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,YN=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,XN=hR.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",JT(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[gR({find:KN,type:this.type})]},addPasteRules(){return[yR({find:YN,type:this.type})]}}),JN=/^```([a-z]+)?[\s\n]$/,ZN=/^~~~([a-z]+)?[\s\n]$/,QN=dR.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,r=[...(null===(e=t.firstElementChild)||void 0===e?void 0:e.classList)||[]],i=r.filter((t=>t.startsWith(n))).map((t=>t.replace(n,""))),o=i[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",JT(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=1===e.pos;return!(!t||e.parent.type.name!==this.name)&&(!(!n&&e.parent.textContent.length)&&this.editor.commands.clearNodes())},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith("\n\n");return!(!o||!s)&&t.chain().command((({tr:t})=>(t.delete(r.pos-2,r.pos),!0))).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:i,empty:o}=n;if(!o||i.parent.type!==this.type)return!1;const s=i.parentOffset===i.parent.nodeSize-2;if(!s)return!1;const a=i.after();if(void 0===a)return!1;const c=r.nodeAt(a);return!c&&t.commands.exitCode()}}},addInputRules(){return[mR({find:JN,type:this.type,getAttributes:t=>({language:t[1]})}),mR({find:ZN,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new JD({key:new tk("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=null===i||void 0===i?void 0:i.mode;if(!n||!o)return!1;const{tr:s}=t.state;return s.replaceSelectionWith(this.type.create({language:o})),s.setSelection(TD.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.insertText(n.replace(/\r\n?/g,"\n")),s.setMeta("paste",!0),t.dispatch(s),!0}}})]}}),tP=dR.create({name:"doc",topNode:!0,content:"block+"});function eP(t){return void 0===t&&(t={}),new JD({view:function(e){return new nP(e,t)}})}var nP=function(t,e){var n=this;this.editorView=t,this.width=e.width||1,this.color=e.color||"black",this.class=e.class,this.cursorPos=null,this.element=null,this.timeout=null,this.handlers=["dragover","dragend","drop","dragleave"].map((function(e){var r=function(t){return n[e](t)};return t.dom.addEventListener(e,r),{name:e,handler:r}}))};nP.prototype.destroy=function(){var t=this;this.handlers.forEach((function(e){var n=e.name,r=e.handler;return t.editorView.dom.removeEventListener(n,r)}))},nP.prototype.update=function(t,e){null!=this.cursorPos&&e.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())},nP.prototype.setCursor=function(t){t!=this.cursorPos&&(this.cursorPos=t,null==t?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())},nP.prototype.updateOverlay=function(){var t,e=this.editorView.state.doc.resolve(this.cursorPos);if(!e.parent.inlineContent){var n=e.nodeBefore,r=e.nodeAfter;if(n||r){var i=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0)).getBoundingClientRect(),o=n?i.bottom:i.top;n&&r&&(o=(o+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),t={left:i.left,right:i.right,top:o-this.width/2,bottom:o+this.width/2}}}if(!t){var s=this.editorView.coordsAtPos(this.cursorPos);t={left:s.left-this.width/2,right:s.left+this.width/2,top:s.top,bottom:s.bottom}}var a,c,u=this.editorView.dom.offsetParent;if(this.element||(this.element=u.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),!u||u==document.body&&"static"==getComputedStyle(u).position)a=-pageXOffset,c=-pageYOffset;else{var l=u.getBoundingClientRect();a=l.left-u.scrollLeft,c=l.top-u.scrollTop}this.element.style.left=t.left-a+"px",this.element.style.top=t.top-c+"px",this.element.style.width=t.right-t.left+"px",this.element.style.height=t.bottom-t.top+"px"},nP.prototype.scheduleRemoval=function(t){var e=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){return e.setCursor(null)}),t)},nP.prototype.dragover=function(t){if(this.editorView.editable){var e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),n=e&&e.inside>=0&&this.editorView.state.doc.nodeAt(e.inside),r=n&&n.type.spec.disableDropCursor,i="function"==typeof r?r(this.editorView,e):r;if(e&&!i){var o=e.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&(o=lD(this.editorView.state.doc,o,this.editorView.dragging.slice),null==o))return this.setCursor(null);this.setCursor(o),this.scheduleRemoval(5e3)}}},nP.prototype.dragend=function(){this.scheduleRemoval(20)},nP.prototype.drop=function(){this.scheduleRemoval(20)},nP.prototype.dragleave=function(t){t.target!=this.editorView.dom&&this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)};const rP=XO.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:null}},addProseMirrorPlugins(){return[eP(this.options)]}});var iP=function(t){function e(e){t.call(this,e,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var i=n.resolve(r.map(this.head));return e.valid(i)?new e(i):t.near(i)},e.prototype.content=function(){return vE.empty},e.prototype.eq=function(t){return t instanceof e&&t.head==this.head},e.prototype.toJSON=function(){return{type:"gapcursor",pos:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new e(t.resolve(n.pos))},e.prototype.getBookmark=function(){return new oP(this.anchor)},e.valid=function(t){var e=t.parent;if(e.isTextblock||!sP(t)||!aP(t))return!1;var n=e.type.spec.allowGapCursor;if(null!=n)return n;var r=e.contentMatchAt(t.index()).defaultType;return r&&r.isTextblock},e.findFrom=function(t,n,r){t:for(;;){if(!r&&e.valid(t))return t;for(var i=t.pos,o=null,s=t.depth;;s--){var a=t.node(s);if(n>0?t.indexAfter(s)<a.childCount:t.index(s)>0){o=a.child(n>0?t.indexAfter(s):t.index(s)-1);break}if(0==s)return null;i+=n;var c=t.doc.resolve(i);if(e.valid(c))return c}for(;;){var u=n>0?o.firstChild:o.lastChild;if(!u){if(o.isAtom&&!o.isText&&!ND.isSelectable(o)){t=t.doc.resolve(i+o.nodeSize*n),r=!1;continue t}break}o=u,i+=n;var l=t.doc.resolve(i);if(e.valid(l))return l}return null}},e}(OD);iP.prototype.visible=!1,OD.jsonID("gapcursor",iP);var oP=function(t){this.pos=t};function sP(t){for(var e=t.depth;e>=0;e--){var n=t.index(e),r=t.node(e);if(0!=n)for(var i=r.child(n-1);;i=i.lastChild){if(0==i.childCount&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}function aP(t){for(var e=t.depth;e>=0;e--){var n=t.indexAfter(e),r=t.node(e);if(n!=r.childCount)for(var i=r.child(n);;i=i.firstChild){if(0==i.childCount&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}oP.prototype.map=function(t){return new oP(t.map(this.pos))},oP.prototype.resolve=function(t){var e=t.resolve(this.pos);return iP.valid(e)?new iP(e):OD.near(e)};var cP=function(){return new JD({props:{decorations:fP,createSelectionBetween:function(t,e,n){if(e.pos==n.pos&&iP.valid(n))return new iP(n)},handleClick:dP,handleKeyDown:uP,handleDOMEvents:{beforeinput:hP}}})},uP=VO({ArrowLeft:lP("horiz",-1),ArrowRight:lP("horiz",1),ArrowUp:lP("vert",-1),ArrowDown:lP("vert",1)});function lP(t,e){var n="vert"==t?e>0?"down":"up":e>0?"right":"left";return function(t,r,i){var o=t.selection,s=e>0?o.$to:o.$from,a=o.empty;if(o instanceof TD){if(!i.endOfTextblock(n)||0==s.depth)return!1;a=!1,s=t.doc.resolve(e>0?s.after():s.before())}var c=iP.findFrom(s,e,a);return!!c&&(r&&r(t.tr.setSelection(new iP(c))),!0)}}function dP(t,e,n){if(!t.editable)return!1;var r=t.state.doc.resolve(e);if(!iP.valid(r))return!1;var i=t.posAtCoords({left:n.clientX,top:n.clientY}),o=i.inside;return!(o>-1&&ND.isSelectable(t.state.doc.nodeAt(o)))&&(t.dispatch(t.state.tr.setSelection(new iP(r))),!0)}function hP(t,e){if("insertCompositionText"!=e.inputType||!(t.state.selection instanceof iP))return!1;var n=t.state.selection,r=n.$from,i=r.parent.contentMatchAt(r.index()).findWrapping(t.state.schema.nodes.text);if(!i)return!1;for(var o=lE.empty,s=i.length-1;s>=0;s--)o=lE.from(i[s].createAndFill(null,o));var a=t.state.tr.replace(r.pos,r.pos,new vE(o,0,0));return a.setSelection(TD.near(a.doc.resolve(r.pos+1))),t.dispatch(a),!1}function fP(t){if(!(t.selection instanceof iP))return null;var e=document.createElement("div");return e.className="ProseMirror-gapcursor",oO.create(t.doc,[eO.widget(t.selection.head,e,{key:"gapcursor"})])}const pP=XO.create({name:"gapCursor",addProseMirrorPlugins(){return[cP()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:null!==(e=KO(YO(t,"allowGapCursor",n)))&&void 0!==e?e:null}}}),gP=dR.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",JT(this.options.HTMLAttributes,t)]},renderText(){return"\n"},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command((()=>{const{selection:t,storedMarks:i}=n;if(t.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:s}=r.extensionManager,a=i||t.$to.parentOffset&&t.$from.marks();return e().insertContent({type:this.name}).command((({tr:t,dispatch:e})=>{if(e&&a&&o){const e=a.filter((t=>s.includes(t.type.name)));t.ensureMarks(e)}return!0})).run()}))])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),mP=dR.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map((t=>({tag:`h${t}`,attrs:{level:t}})))},renderHTML({node:t,HTMLAttributes:e}){const n=this.options.levels.includes(t.attrs.level),r=n?t.attrs.level:this.options.levels[0];return[`h${r}`,JT(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>!!this.options.levels.includes(t.level)&&e.setNode(this.name,t),toggleHeading:t=>({commands:e})=>!!this.options.levels.includes(t.level)&&e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return this.options.levels.reduce(((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})})),{})},addInputRules(){return this.options.levels.map((t=>mR({find:new RegExp(`^(#{1,${t}})\\s$`),type:this.type,getAttributes:{level:t}})))}});var vP=200,yP=function(){};yP.prototype.append=function(t){return t.length?(t=yP.from(t),!this.length&&t||t.length<vP&&this.leafAppend(t)||this.length<vP&&t.leafPrepend(this)||this.appendInner(t)):this},yP.prototype.prepend=function(t){return t.length?yP.from(t).append(this):this},yP.prototype.appendInner=function(t){return new wP(this,t)},yP.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.length),t>=e?yP.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))},yP.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)},yP.prototype.forEach=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length),e<=n?this.forEachInner(t,e,n,0):this.forEachInvertedInner(t,e,n,0)},yP.prototype.map=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length);var r=[];return this.forEach((function(e,n){return r.push(t(e,n))}),e,n),r},yP.from=function(t){return t instanceof yP?t:t&&t.length?new bP(t):yP.empty};var bP=function(t){function e(e){t.call(this),this.values=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(t,n){return 0==t&&n==this.length?this:new e(this.values.slice(t,n))},e.prototype.getInner=function(t){return this.values[t]},e.prototype.forEachInner=function(t,e,n,r){for(var i=e;i<n;i++)if(!1===t(this.values[i],r+i))return!1},e.prototype.forEachInvertedInner=function(t,e,n,r){for(var i=e-1;i>=n;i--)if(!1===t(this.values[i],r+i))return!1},e.prototype.leafAppend=function(t){if(this.length+t.length<=vP)return new e(this.values.concat(t.flatten()))},e.prototype.leafPrepend=function(t){if(this.length+t.length<=vP)return new e(t.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(yP);yP.empty=new bP([]);var wP=function(t){function e(e,n){t.call(this),this.left=e,this.right=n,this.length=e.length+n.length,this.depth=Math.max(e.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(t){return t<this.left.length?this.left.get(t):this.right.get(t-this.left.length)},e.prototype.forEachInner=function(t,e,n,r){var i=this.left.length;return!(e<i&&!1===this.left.forEachInner(t,e,Math.min(n,i),r))&&(!(n>i&&!1===this.right.forEachInner(t,Math.max(e-i,0),Math.min(this.length,n)-i,r+i))&&void 0)},e.prototype.forEachInvertedInner=function(t,e,n,r){var i=this.left.length;return!(e>i&&!1===this.right.forEachInvertedInner(t,e-i,Math.max(n,i)-i,r+i))&&(!(n<i&&!1===this.left.forEachInvertedInner(t,Math.min(e,i),n,r))&&void 0)},e.prototype.sliceInner=function(t,e){if(0==t&&e==this.length)return this;var n=this.left.length;return e<=n?this.left.slice(t,e):t>=n?this.right.slice(t-n,e-n):this.left.slice(t,n).append(this.right.slice(0,e-n))},e.prototype.leafAppend=function(t){var n=this.right.leafAppend(t);if(n)return new e(this.left,n)},e.prototype.leafPrepend=function(t){var n=this.left.leafPrepend(t);if(n)return new e(n,this.right)},e.prototype.appendInner=function(t){return this.left.depth>=Math.max(this.right.depth,t.depth)+1?new e(this.left,new e(this.right,t)):new e(this,t)},e}(yP),EP=yP,SP=EP,DP=500,kP=function(t,e){this.items=t,this.eventCount=e};function xP(t,e){var n;return t.forEach((function(t,r){if(t.selection&&0==e--)return n=r,!1})),t.slice(n)}kP.prototype.popEvent=function(t,e){var n=this;if(0==this.eventCount)return null;for(var r,i,o=this.items.length;;o--){var s=this.items.get(o-1);if(s.selection){--o;break}}e&&(r=this.remapping(o,this.items.length),i=r.maps.length);var a,c,u=t.tr,l=[],d=[];return this.items.forEach((function(t,e){if(!t.step)return r||(r=n.remapping(o,e+1),i=r.maps.length),i--,void d.push(t);if(r){d.push(new CP(t.map));var s,h=t.step.map(r.slice(i));h&&u.maybeStep(h).doc&&(s=u.mapping.maps[u.mapping.maps.length-1],l.push(new CP(s,null,null,l.length+d.length))),i--,s&&r.appendMap(s,i)}else u.maybeStep(t.step);return t.selection?(a=r?t.selection.map(r.slice(i)):t.selection,c=new kP(n.items.slice(0,o).append(d.reverse().concat(l)),n.eventCount-1),!1):void 0}),this.items.length,0),{remaining:c,transform:u,selection:a}},kP.prototype.addTransform=function(t,e,n,r){for(var i=[],o=this.eventCount,s=this.items,a=!r&&s.length?s.get(s.length-1):null,c=0;c<t.steps.length;c++){var u=t.steps[c].invert(t.docs[c]),l=new CP(t.mapping.maps[c],u,e),d=void 0;(d=a&&a.merge(l))&&(l=d,c?i.pop():s=s.slice(0,s.length-1)),i.push(l),e&&(o++,e=null),r||(a=l)}var h=o-n.depth;return h>OP&&(s=xP(s,h),o-=h),new kP(s.append(i),o)},kP.prototype.remapping=function(t,e){var n=new HS;return this.items.forEach((function(e,r){var i=null!=e.mirrorOffset&&r-e.mirrorOffset>=t?n.maps.length-e.mirrorOffset:null;n.appendMap(e.map,i)}),t,e),n},kP.prototype.addMaps=function(t){return 0==this.eventCount?this:new kP(this.items.append(t.map((function(t){return new CP(t)}))),this.eventCount)},kP.prototype.rebased=function(t,e){if(!this.eventCount)return this;var n=[],r=Math.max(0,this.items.length-e),i=t.mapping,o=t.steps.length,s=this.eventCount;this.items.forEach((function(t){t.selection&&s--}),r);var a=e;this.items.forEach((function(e){var r=i.getMirror(--a);if(null!=r){o=Math.min(o,r);var c=i.maps[r];if(e.step){var u=t.steps[r].invert(t.docs[r]),l=e.selection&&e.selection.map(i.slice(a+1,r));l&&s++,n.push(new CP(c,u,l))}else n.push(new CP(c))}}),r);for(var c=[],u=e;u<o;u++)c.push(new CP(i.maps[u]));var l=this.items.slice(0,r).append(c).append(n),d=new kP(l,s);return d.emptyItemCount()>DP&&(d=d.compress(this.items.length-n.length)),d},kP.prototype.emptyItemCount=function(){var t=0;return this.items.forEach((function(e){e.step||t++})),t},kP.prototype.compress=function(t){void 0===t&&(t=this.items.length);var e=this.remapping(0,t),n=e.maps.length,r=[],i=0;return this.items.forEach((function(o,s){if(s>=t)r.push(o),o.selection&&i++;else if(o.step){var a=o.step.map(e.slice(n)),c=a&&a.getMap();if(n--,c&&e.appendMap(c,n),a){var u=o.selection&&o.selection.map(e.slice(n));u&&i++;var l,d=new CP(c.invert(),a,u),h=r.length-1;(l=r.length&&r[h].merge(d))?r[h]=l:r.push(d)}}else o.map&&n--}),this.items.length,0),new kP(SP.from(r.reverse()),i)},kP.empty=new kP(SP.empty,0);var CP=function(t,e,n,r){this.map=t,this.step=e,this.selection=n,this.mirrorOffset=r};CP.prototype.merge=function(t){if(this.step&&t.step&&!t.selection){var e=t.step.merge(this.step);if(e)return new CP(e.getMap().invert(),e,this.selection)}};var _P=function(t,e,n,r){this.done=t,this.undone=e,this.prevRanges=n,this.prevTime=r},OP=20;function AP(t,e,n,r){var i,o=n.getMeta(IP);if(o)return o.historyState;n.getMeta(zP)&&(t=new _P(t.done,t.undone,null,0));var s=n.getMeta("appendedTransaction");if(0==n.steps.length)return t;if(s&&s.getMeta(IP))return s.getMeta(IP).redo?new _P(t.done.addTransform(n,null,r,FP(e)),t.undone,TP(n.mapping.maps[n.steps.length-1]),t.prevTime):new _P(t.done,t.undone.addTransform(n,null,r,FP(e)),null,t.prevTime);if(!1===n.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))return(i=n.getMeta("rebased"))?new _P(t.done.rebased(n,i),t.undone.rebased(n,i),RP(t.prevRanges,n.mapping),t.prevTime):new _P(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),RP(t.prevRanges,n.mapping),t.prevTime);var a=0==t.prevTime||!s&&(t.prevTime<(n.time||0)-r.newGroupDelay||!MP(n,t.prevRanges)),c=s?RP(t.prevRanges,n.mapping):TP(n.mapping.maps[n.steps.length-1]);return new _P(t.done.addTransform(n,a?e.selection.getBookmark():null,r,FP(e)),kP.empty,c,n.time)}function MP(t,e){if(!e)return!1;if(!t.docChanged)return!0;var n=!1;return t.mapping.maps[0].forEach((function(t,r){for(var i=0;i<e.length;i+=2)t<=e[i+1]&&r>=e[i]&&(n=!0)})),n}function TP(t){var e=[];return t.forEach((function(t,n,r,i){return e.push(r,i)})),e}function RP(t,e){if(!t)return null;for(var n=[],r=0;r<t.length;r+=2){var i=e.map(t[r],1),o=e.map(t[r+1],-1);i<=o&&n.push(i,o)}return n}function NP(t,e,n,r){var i=FP(e),o=IP.get(e).spec.config,s=(r?t.undone:t.done).popEvent(e,i);if(s){var a=s.selection.resolve(s.transform.doc),c=(r?t.done:t.undone).addTransform(s.transform,e.selection.getBookmark(),o,i),u=new _P(r?c:s.remaining,r?s.remaining:c,null,0);n(s.transform.setSelection(a).setMeta(IP,{redo:r,historyState:u}).scrollIntoView())}}var PP=!1,BP=null;function FP(t){var e=t.plugins;if(BP!=e){PP=!1,BP=e;for(var n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){PP=!0;break}}return PP}var IP=new tk("history"),zP=new tk("closeHistory");function jP(t){return t={depth:t&&t.depth||100,newGroupDelay:t&&t.newGroupDelay||500},new JD({key:IP,state:{init:function(){return new _P(kP.empty,kP.empty,null,0)},apply:function(e,n,r){return AP(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput:function(t,e){var n="historyUndo"==e.inputType?LP(t.state,t.dispatch):"historyRedo"==e.inputType&&$P(t.state,t.dispatch);return n&&e.preventDefault(),n}}}})}function LP(t,e){var n=IP.getState(t);return!(!n||0==n.done.eventCount)&&(e&&NP(n,t,e,!1),!0)}function $P(t,e){var n=IP.getState(t);return!(!n||0==n.undone.eventCount)&&(e&&NP(n,t,e,!0),!0)}const HP=XO.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>LP(t,e),redo:()=>({state:t,dispatch:e})=>$P(t,e)}},addProseMirrorPlugins(){return[jP(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),VP=dR.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",JT(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t})=>t().insertContent({type:this.name}).command((({tr:t,dispatch:e})=>{var n;if(e){const{$to:e}=t.selection,r=e.end();if(e.nodeAfter)t.setSelection(TD.create(t.doc,e.pos));else{const i=null===(n=e.parent.type.contentMatch.defaultType)||void 0===n?void 0:n.create();i&&(t.insert(r,i),t.setSelection(TD.create(t.doc,r)))}t.scrollIntoView()}return!0})).run()}},addInputRules(){return[fR({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),WP=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,UP=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,qP=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,GP=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,KP=hR.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>"normal"!==t.style.fontStyle&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",JT(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[gR({find:WP,type:this.type}),gR({find:qP,type:this.type})]},addPasteRules(){return[yR({find:UP,type:this.type}),yR({find:GP,type:this.type})]}}),YP=dR.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",JT(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),XP=/^(\d+)\.\s$/,JP=dR.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return 1===e?["ol",JT(this.options.HTMLAttributes,n),0]:["ol",JT(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[vR({find:XP,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1]})]}}),ZP=dR.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",JT(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),QP=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,tB=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,eB=hR.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>!!t.includes("line-through")&&{}}]},renderHTML({HTMLAttributes:t}){return["s",JT(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[gR({find:QP,type:this.type})]},addPasteRules(){return[yR({find:tB,type:this.type})]}}),nB=dR.create({name:"text",group:"inline"}),rB=XO.create({name:"starterKit",addExtensions(){var t,e,n,r,i,o,s,a,c,u,l,d,h,f,p,g,m,v;const y=[];return!1!==this.options.blockquote&&y.push(LN.configure(null===(t=this.options)||void 0===t?void 0:t.blockquote)),!1!==this.options.bold&&y.push(UN.configure(null===(e=this.options)||void 0===e?void 0:e.bold)),!1!==this.options.bulletList&&y.push(GN.configure(null===(n=this.options)||void 0===n?void 0:n.bulletList)),!1!==this.options.code&&y.push(XN.configure(null===(r=this.options)||void 0===r?void 0:r.code)),!1!==this.options.codeBlock&&y.push(QN.configure(null===(i=this.options)||void 0===i?void 0:i.codeBlock)),!1!==this.options.document&&y.push(tP.configure(null===(o=this.options)||void 0===o?void 0:o.document)),!1!==this.options.dropcursor&&y.push(rP.configure(null===(s=this.options)||void 0===s?void 0:s.dropcursor)),!1!==this.options.gapcursor&&y.push(pP.configure(null===(a=this.options)||void 0===a?void 0:a.gapcursor)),!1!==this.options.hardBreak&&y.push(gP.configure(null===(c=this.options)||void 0===c?void 0:c.hardBreak)),!1!==this.options.heading&&y.push(mP.configure(null===(u=this.options)||void 0===u?void 0:u.heading)),!1!==this.options.history&&y.push(HP.configure(null===(l=this.options)||void 0===l?void 0:l.history)),!1!==this.options.horizontalRule&&y.push(VP.configure(null===(d=this.options)||void 0===d?void 0:d.horizontalRule)),!1!==this.options.italic&&y.push(KP.configure(null===(h=this.options)||void 0===h?void 0:h.italic)),!1!==this.options.listItem&&y.push(YP.configure(null===(f=this.options)||void 0===f?void 0:f.listItem)),!1!==this.options.orderedList&&y.push(JP.configure(null===(p=this.options)||void 0===p?void 0:p.orderedList)),!1!==this.options.paragraph&&y.push(ZP.configure(null===(g=this.options)||void 0===g?void 0:g.paragraph)),!1!==this.options.strike&&y.push(eB.configure(null===(m=this.options)||void 0===m?void 0:m.strike)),!1!==this.options.text&&y.push(nB.configure(null===(v=this.options)||void 0===v?void 0:v.text)),y}}),iB=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))$/,oB=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))/g,sB=hR.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:t=>t.getAttribute("data-color")||t.style.backgroundColor,renderHTML:t=>t.color?{"data-color":t.color,style:`background-color: ${t.color}`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:t}){return["mark",JT(this.options.HTMLAttributes,t),0]},addCommands(){return{setHighlight:t=>({commands:e})=>e.setMark(this.name,t),toggleHighlight:t=>({commands:e})=>e.toggleMark(this.name,t),unsetHighlight:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[gR({find:iB,type:this.type})]},addPasteRules(){return[yR({find:oB,type:this.type})]}});function aB(t){this.j={},this.jr=[],this.jd=null,this.t=t}aB.prototype={accepts:function(){return!!this.t},tt:function(t,e){if(e&&e.j)return this.j[t]=e,e;var n=e,r=this.j[t];if(r)return n&&(r.t=n),r;r=cB();var i=hB(this,t);return i?(Object.assign(r.j,i.j),r.jr.append(i.jr),r.jr=i.jd,r.t=n||i.t):r.t=n,this.j[t]=r,r}};var cB=function(){return new aB},uB=function(t){return new aB(t)},lB=function(t,e,n){t.j[e]||(t.j[e]=n)},dB=function(t,e,n){t.jr.push([e,n])},hB=function(t,e){var n=t.j[e];if(n)return n;for(var r=0;r<t.jr.length;r++){var i=t.jr[r][0],o=t.jr[r][1];if(i.test(e))return o}return t.jd},fB=function(t,e,n){for(var r=0;r<e.length;r++)lB(t,e[r],n)},pB=function(t,e){for(var n=0;n<e.length;n++){var r=e[n][0],i=e[n][1];lB(t,r,i)}},gB=function(t,e,n,r){var i,o=0,s=e.length;while(o<s&&(i=t.j[e[o]]))t=i,o++;if(o>=s)return[];while(o<s-1)i=r(),lB(t,e[o],i),t=i,o++;lB(t,e[s-1],n)},mB="DOMAIN",vB="LOCALHOST",yB="TLD",bB="NUM",wB="PROTOCOL",EB="MAILTO",SB="WS",DB="NL",kB="OPENBRACE",xB="OPENBRACKET",CB="OPENANGLEBRACKET",_B="OPENPAREN",OB="CLOSEBRACE",AB="CLOSEBRACKET",MB="CLOSEANGLEBRACKET",TB="CLOSEPAREN",RB="AMPERSAND",NB="APOSTROPHE",PB="ASTERISK",BB="AT",FB="BACKSLASH",IB="BACKTICK",zB="CARET",jB="COLON",LB="COMMA",$B="DOLLAR",HB="DOT",VB="EQUALS",WB="EXCLAMATION",UB="HYPHEN",qB="PERCENT",GB="PIPE",KB="PLUS",YB="POUND",XB="QUERY",JB="QUOTE",ZB="SEMI",QB="SLASH",tF="TILDE",eF="UNDERSCORE",nF="SYM",rF=Object.freeze({__proto__:null,DOMAIN:mB,LOCALHOST:vB,TLD:yB,NUM:bB,PROTOCOL:wB,MAILTO:EB,WS:SB,NL:DB,OPENBRACE:kB,OPENBRACKET:xB,OPENANGLEBRACKET:CB,OPENPAREN:_B,CLOSEBRACE:OB,CLOSEBRACKET:AB,CLOSEANGLEBRACKET:MB,CLOSEPAREN:TB,AMPERSAND:RB,APOSTROPHE:NB,ASTERISK:PB,AT:BB,BACKSLASH:FB,BACKTICK:IB,CARET:zB,COLON:jB,COMMA:LB,DOLLAR:$B,DOT:HB,EQUALS:VB,EXCLAMATION:WB,HYPHEN:UB,PERCENT:qB,PIPE:GB,PLUS:KB,POUND:YB,QUERY:XB,QUOTE:JB,SEMI:ZB,SLASH:QB,TILDE:tF,UNDERSCORE:eF,SYM:nF}),iF="aaa aarp abarth abb abbott abbvie abc able abogado abudhabi ac academy accenture accountant accountants aco actor ad adac ads adult ae aeg aero aetna af afamilycompany afl africa ag agakhan agency ai aig airbus airforce airtel akdn al alfaromeo alibaba alipay allfinanz allstate ally alsace alstom am amazon americanexpress americanfamily amex amfam amica amsterdam analytics android anquan anz ao aol apartments app apple aq aquarelle ar arab aramco archi army arpa art arte as asda asia associates at athleta attorney au auction audi audible audio auspost author auto autos avianca aw aws ax axa az azure ba baby baidu banamex bananarepublic band bank bar barcelona barclaycard barclays barefoot bargains baseball basketball bauhaus bayern bb bbc bbt bbva bcg bcn bd be beats beauty beer bentley berlin best bestbuy bet bf bg bh bharti bi bible bid bike bing bingo bio biz bj black blackfriday blockbuster blog bloomberg blue bm bms bmw bn bnpparibas bo boats boehringer bofa bom bond boo book booking bosch bostik boston bot boutique box br bradesco bridgestone broadway broker brother brussels bs bt budapest bugatti build builders business buy buzz bv bw by bz bzh ca cab cafe cal call calvinklein cam camera camp cancerresearch canon capetown capital capitalone car caravan cards care career careers cars casa case cash casino cat catering catholic cba cbn cbre cbs cc cd center ceo cern cf cfa cfd cg ch chanel channel charity chase chat cheap chintai christmas chrome church ci cipriani circle cisco citadel citi citic city cityeats ck cl claims cleaning click clinic clinique clothing cloud club clubmed cm cn co coach codes coffee college cologne com comcast commbank community company compare computer comsec condos construction consulting contact contractors cooking cookingchannel cool coop corsica country coupon coupons courses cpa cr credit creditcard creditunion cricket crown crs cruise cruises csc cu cuisinella cv cw cx cy cymru cyou cz dabur dad dance data date dating datsun day dclk dds de deal dealer deals degree delivery dell deloitte delta democrat dental dentist desi design dev dhl diamonds diet digital direct directory discount discover dish diy dj dk dm dnp do docs doctor dog domains dot download drive dtv dubai duck dunlop dupont durban dvag dvr dz earth eat ec eco edeka edu education ee eg email emerck energy engineer engineering enterprises epson equipment er ericsson erni es esq estate et etisalat eu eurovision eus events exchange expert exposed express extraspace fage fail fairwinds faith family fan fans farm farmers fashion fast fedex feedback ferrari ferrero fi fiat fidelity fido film final finance financial fire firestone firmdale fish fishing fit fitness fj fk flickr flights flir florist flowers fly fm fo foo food foodnetwork football ford forex forsale forum foundation fox fr free fresenius frl frogans frontdoor frontier ftr fujitsu fujixerox fun fund furniture futbol fyi ga gal gallery gallo gallup game games gap garden gay gb gbiz gd gdn ge gea gent genting george gf gg ggee gh gi gift gifts gives giving gl glade glass gle global globo gm gmail gmbh gmo gmx gn godaddy gold goldpoint golf goo goodyear goog google gop got gov gp gq gr grainger graphics gratis green gripe grocery group gs gt gu guardian gucci guge guide guitars guru gw gy hair hamburg hangout haus hbo hdfc hdfcbank health healthcare help helsinki here hermes hgtv hiphop hisamitsu hitachi hiv hk hkt hm hn hockey holdings holiday homedepot homegoods homes homesense honda horse hospital host hosting hot hoteles hotels hotmail house how hr hsbc ht hu hughes hyatt hyundai ibm icbc ice icu id ie ieee ifm ikano il im imamat imdb immo immobilien in inc industries infiniti info ing ink institute insurance insure int international intuit investments io ipiranga iq ir irish is ismaili ist istanbul it itau itv iveco jaguar java jcb je jeep jetzt jewelry jio jll jm jmp jnj jo jobs joburg jot joy jp jpmorgan jprs juegos juniper kaufen kddi ke kerryhotels kerrylogistics kerryproperties kfh kg kh ki kia kim kinder kindle kitchen kiwi km kn koeln komatsu kosher kp kpmg kpn kr krd kred kuokgroup kw ky kyoto kz la lacaixa lamborghini lamer lancaster lancia land landrover lanxess lasalle lat latino latrobe law lawyer lb lc lds lease leclerc lefrak legal lego lexus lgbt li lidl life lifeinsurance lifestyle lighting like lilly limited limo lincoln linde link lipsy live living lixil lk llc llp loan loans locker locus loft lol london lotte lotto love lpl lplfinancial lr ls lt ltd ltda lu lundbeck luxe luxury lv ly ma macys madrid maif maison makeup man management mango map market marketing markets marriott marshalls maserati mattel mba mc mckinsey md me med media meet melbourne meme memorial men menu merckmsd mg mh miami microsoft mil mini mint mit mitsubishi mk ml mlb mls mm mma mn mo mobi mobile moda moe moi mom monash money monster mormon mortgage moscow moto motorcycles mov movie mp mq mr ms msd mt mtn mtr mu museum mutual mv mw mx my mz na nab nagoya name nationwide natura navy nba nc ne nec net netbank netflix network neustar new news next nextdirect nexus nf nfl ng ngo nhk ni nico nike nikon ninja nissan nissay nl no nokia northwesternmutual norton now nowruz nowtv np nr nra nrw ntt nu nyc nz obi observer off office okinawa olayan olayangroup oldnavy ollo om omega one ong onl online onyourside ooo open oracle orange org organic origins osaka otsuka ott ovh pa page panasonic paris pars partners parts party passagens pay pccw pe pet pf pfizer pg ph pharmacy phd philips phone photo photography photos physio pics pictet pictures pid pin ping pink pioneer pizza pk pl place play playstation plumbing plus pm pn pnc pohl poker politie porn post pr pramerica praxi press prime pro prod productions prof progressive promo properties property protection pru prudential ps pt pub pw pwc py qa qpon quebec quest qvc racing radio raid re read realestate realtor realty recipes red redstone redumbrella rehab reise reisen reit reliance ren rent rentals repair report republican rest restaurant review reviews rexroth rich richardli ricoh ril rio rip rmit ro rocher rocks rodeo rogers room rs rsvp ru rugby ruhr run rw rwe ryukyu sa saarland safe safety sakura sale salon samsclub samsung sandvik sandvikcoromant sanofi sap sarl sas save saxo sb sbi sbs sc sca scb schaeffler schmidt scholarships school schule schwarz science scjohnson scot sd se search seat secure security seek select sener services ses seven sew sex sexy sfr sg sh shangrila sharp shaw shell shia shiksha shoes shop shopping shouji show showtime si silk sina singles site sj sk ski skin sky skype sl sling sm smart smile sn sncf so soccer social softbank software sohu solar solutions song sony soy spa space sport spot spreadbetting sr srl ss st stada staples star statebank statefarm stc stcgroup stockholm storage store stream studio study style su sucks supplies supply support surf surgery suzuki sv swatch swiftcover swiss sx sy sydney systems sz tab taipei talk taobao target tatamotors tatar tattoo tax taxi tc tci td tdk team tech technology tel temasek tennis teva tf tg th thd theater theatre tiaa tickets tienda tiffany tips tires tirol tj tjmaxx tjx tk tkmaxx tl tm tmall tn to today tokyo tools top toray toshiba total tours town toyota toys tr trade trading training travel travelchannel travelers travelersinsurance trust trv tt tube tui tunes tushu tv tvs tw tz ua ubank ubs ug uk unicom university uno uol ups us uy uz va vacations vana vanguard vc ve vegas ventures verisign versicherung vet vg vi viajes video vig viking villas vin vip virgin visa vision viva vivo vlaanderen vn vodka volkswagen volvo vote voting voto voyage vu vuelos wales walmart walter wang wanggou watch watches weather weatherchannel webcam weber website wed wedding weibo weir wf whoswho wien wiki williamhill win windows wine winners wme wolterskluwer woodside work works world wow ws wtc wtf xbox xerox xfinity xihuan xin xxx xyz yachts yahoo yamaxun yandex ye yodobashi yoga yokohama you youtube yt yun za zappos zara zero zip zm zone zuerich zw vermögensberater-ctb vermögensberatung-pwb ελ ευ бг бел дети ею католик ком қаз мкд мон москва онлайн орг рус рф сайт срб укр გე հայ ישראל קום ابوظبي اتصالات ارامكو الاردن البحرين الجزائر السعودية العليان المغرب امارات ایران بارت بازار بھارت بيتك پاکستان ڀارت تونس سودان سورية شبكة عراق عرب عمان فلسطين قطر كاثوليك كوم مصر مليسيا موريتانيا موقع همراه कॉम नेट भारत भारतम् भारोत संगठन বাংলা ভারত ভাৰত ਭਾਰਤ ભારત ଭାରତ இந்தியா இலங்கை சிங்கப்பூர் భారత్ ಭಾರತ ഭാരതം ලංකා คอม ไทย ລາວ 닷넷 닷컴 삼성 한국 アマゾン グーグル クラウド コム ストア セール ファッション ポイント みんな 世界 中信 中国 中國 中文网 亚马逊 企业 佛山 信息 健康 八卦 公司 公益 台湾 台灣 商城 商店 商标 嘉里 嘉里大酒店 在线 大众汽车 大拿 天主教 娱乐 家電 广东 微博 慈善 我爱你 手机 招聘 政务 政府 新加坡 新闻 时尚 書籍 机构 淡马锡 游戏 澳門 点看 移动 组织机构 网址 网店 网站 网络 联通 诺基亚 谷歌 购物 通販 集团 電訊盈科 飞利浦 食品 餐厅 香格里拉 香港".split(" "),oF=/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/,sF=/(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEDD-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE74\uDE78-\uDE7C\uDE80-\uDE86\uDE90-\uDEAC\uDEB0-\uDEBA\uDEC0-\uDEC5\uDED0-\uDED9\uDEE0-\uDEE7\uDEF0-\uDEF6])/,aF=/\uFE0F/,cF=/\d/,uF=/\s/;function lF(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=cB(),n=uB(bB),r=uB(mB),i=cB(),o=uB(SB),s=[[cF,r],[oF,r],[sF,r],[aF,r]],a=function(){var t=uB(mB);return t.j={"-":i},t.jr=[].concat(s),t},c=function(t){var e=a();return e.t=t,e};pB(e,[["'",uB(NB)],["{",uB(kB)],["[",uB(xB)],["<",uB(CB)],["(",uB(_B)],["}",uB(OB)],["]",uB(AB)],[">",uB(MB)],[")",uB(TB)],["&",uB(RB)],["*",uB(PB)],["@",uB(BB)],["`",uB(IB)],["^",uB(zB)],[":",uB(jB)],[",",uB(LB)],["$",uB($B)],[".",uB(HB)],["=",uB(VB)],["!",uB(WB)],["-",uB(UB)],["%",uB(qB)],["|",uB(GB)],["+",uB(KB)],["#",uB(YB)],["?",uB(XB)],['"',uB(JB)],["/",uB(QB)],[";",uB(ZB)],["~",uB(tF)],["_",uB(eF)],["\\",uB(FB)]]),lB(e,"\n",uB(DB)),dB(e,uF,o),lB(o,"\n",cB()),dB(o,uF,o);for(var u=0;u<iF.length;u++)gB(e,iF[u],c(yB),a);var l=a(),d=a(),h=a(),f=a();gB(e,"file",l,a),gB(e,"ftp",d,a),gB(e,"http",h,a),gB(e,"mailto",f,a);var p=a(),g=uB(wB),m=uB(EB);lB(d,"s",p),lB(d,":",g),lB(h,"s",p),lB(h,":",g),lB(l,":",g),lB(p,":",g),lB(f,":",m);for(var v=a(),y=0;y<t.length;y++)gB(e,t[y],v,a);return lB(v,":",g),gB(e,"localhost",c(vB),a),dB(e,cF,n),dB(e,oF,r),dB(e,sF,r),dB(e,aF,r),dB(n,cF,n),dB(n,oF,r),dB(n,sF,r),dB(n,aF,r),lB(n,"-",i),lB(r,"-",i),lB(i,"-",i),dB(r,cF,r),dB(r,oF,r),dB(r,sF,r),dB(r,aF,r),dB(i,cF,r),dB(i,oF,r),dB(i,sF,r),dB(i,aF,r),e.jd=uB(nF),e}function dF(t,e){var n=hF(e.replace(/[A-Z]/g,(function(t){return t.toLowerCase()}))),r=n.length,i=[],o=0,s=0;while(s<r){var a=t,c=null,u=0,l=null,d=-1,h=-1;while(s<r&&(c=hB(a,n[s])))a=c,a.accepts()?(d=0,h=0,l=a):d>=0&&(d+=n[s].length,h++),u+=n[s].length,o+=n[s].length,s++;o-=d,s-=h,u-=d,i.push({t:l.t,v:e.substr(o-u,u),s:o-u,e:o})}return i}function hF(t){var e=[],n=t.length,r=0;while(r<n){var i=t.charCodeAt(r),o=void 0,s=i<55296||i>56319||r+1===n||(o=t.charCodeAt(r+1))<56320||o>57343?t[r]:t.slice(r,r+2);e.push(s),r+=s.length}return e}function fF(t){return fF="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fF(t)}var pF={defaultProtocol:"http",events:null,format:mF,formatHref:mF,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:0,className:null,attributes:null,ignoreTags:[]};function gF(t){t=t||{},this.defaultProtocol="defaultProtocol"in t?t.defaultProtocol:pF.defaultProtocol,this.events="events"in t?t.events:pF.events,this.format="format"in t?t.format:pF.format,this.formatHref="formatHref"in t?t.formatHref:pF.formatHref,this.nl2br="nl2br"in t?t.nl2br:pF.nl2br,this.tagName="tagName"in t?t.tagName:pF.tagName,this.target="target"in t?t.target:pF.target,this.rel="rel"in t?t.rel:pF.rel,this.validate="validate"in t?t.validate:pF.validate,this.truncate="truncate"in t?t.truncate:pF.truncate,this.className="className"in t?t.className:pF.className,this.attributes=t.attributes||pF.attributes,this.ignoreTags=[];for(var e=("ignoreTags"in t?t.ignoreTags:pF.ignoreTags),n=0;n<e.length;n++)this.ignoreTags.push(e[n].toUpperCase())}function mF(t){return t}gF.prototype={resolve:function(t){var e=t.toHref(this.defaultProtocol);return{formatted:this.get("format",t.toString(),t),formattedHref:this.get("formatHref",e,t),tagName:this.get("tagName",e,t),className:this.get("className",e,t),target:this.get("target",e,t),rel:this.get("rel",e,t),events:this.getObject("events",e,t),attributes:this.getObject("attributes",e,t),truncate:this.get("truncate",e,t)}},check:function(t){return this.get("validate",t.toString(),t)},get:function(t,e,n){var r,i=this[t];if(!i)return i;switch(fF(i)){case"function":return i(e,n.t);case"object":return r=n.t in i?i[n.t]:pF[t],"function"===typeof r?r(e,n.t):r}return i},getObject:function(t,e,n){var r=this[t];return"function"===typeof r?r(e,n.t):r}};function vF(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.create(t.prototype);for(var i in n)r[i]=n[i];return r.constructor=e,e.prototype=r,e}function yF(){}function bF(t,e){function n(e,n){this.t=t,this.v=e,this.tk=n}return vF(yF,n,e),n}yF.prototype={t:"token",isLink:!1,toString:function(){return this.v},toHref:function(){return this.toString()},startIndex:function(){return this.tk[0].s},endIndex:function(){return this.tk[this.tk.length-1].e},toObject:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pF.defaultProtocol;return{type:this.t,value:this.v,isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}}};var wF=bF("email",{isLink:!0}),EF=bF("email",{isLink:!0,toHref:function(){return"mailto:"+this.toString()}}),SF=bF("text"),DF=bF("nl"),kF=bF("url",{isLink:!0,toHref:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pF.defaultProtocol,e=this.tk,n=!1,r=!1,i=[],o=0;while(e[o].t===wB)n=!0,i.push(e[o].v),o++;while(e[o].t===QB)r=!0,i.push(e[o].v),o++;for(;o<e.length;o++)i.push(e[o].v);return i=i.join(""),n||r||(i="".concat(t,"://").concat(i)),i},hasProtocol:function(){return this.tk[0].t===wB}}),xF=Object.freeze({__proto__:null,MultiToken:yF,Base:yF,createTokenClass:bF,MailtoEmail:wF,Email:EF,Text:SF,Nl:DF,Url:kF});function CF(){var t=cB(),e=cB(),n=cB(),r=cB(),i=cB(),o=cB(),s=cB(),a=uB(kF),c=cB(),u=uB(kF),l=uB(kF),d=cB(),h=cB(),f=cB(),p=cB(),g=cB(),m=uB(kF),v=uB(kF),y=uB(kF),b=uB(kF),w=cB(),E=cB(),S=cB(),D=cB(),k=cB(),x=cB(),C=uB(EF),_=cB(),O=uB(EF),A=uB(wF),M=cB(),T=cB(),R=cB(),N=cB(),P=uB(DF);lB(t,DB,P),lB(t,wB,e),lB(t,EB,n),lB(e,QB,r),lB(r,QB,i),lB(t,yB,o),lB(t,mB,o),lB(t,vB,a),lB(t,bB,o),lB(i,yB,l),lB(i,mB,l),lB(i,bB,l),lB(i,vB,l),lB(o,HB,s),lB(k,HB,x),lB(s,yB,a),lB(s,mB,o),lB(s,bB,o),lB(s,vB,o),lB(x,yB,C),lB(x,mB,k),lB(x,bB,k),lB(x,vB,k),lB(a,HB,s),lB(C,HB,x),lB(a,jB,c),lB(a,QB,l),lB(c,bB,u),lB(u,QB,l),lB(C,jB,_),lB(_,bB,O);var B=[RB,PB,BB,FB,IB,zB,$B,mB,VB,UB,vB,bB,qB,GB,KB,YB,wB,QB,nF,tF,yB,eF],F=[NB,MB,OB,AB,TB,jB,LB,HB,WB,CB,kB,xB,_B,XB,JB,ZB];lB(l,kB,h),lB(l,xB,f),lB(l,CB,p),lB(l,_B,g),lB(d,kB,h),lB(d,xB,f),lB(d,CB,p),lB(d,_B,g),lB(h,OB,l),lB(f,AB,l),lB(p,MB,l),lB(g,TB,l),lB(m,OB,l),lB(v,AB,l),lB(y,MB,l),lB(b,TB,l),lB(w,OB,l),lB(E,AB,l),lB(S,MB,l),lB(D,TB,l),fB(h,B,m),fB(f,B,v),fB(p,B,y),fB(g,B,b),fB(h,F,w),fB(f,F,E),fB(p,F,S),fB(g,F,D),fB(m,B,m),fB(v,B,v),fB(y,B,y),fB(b,B,b),fB(m,F,m),fB(v,F,v),fB(y,F,y),fB(b,F,b),fB(w,B,m),fB(E,B,v),fB(S,B,y),fB(D,B,b),fB(w,F,w),fB(E,F,E),fB(S,F,S),fB(D,F,D),fB(l,B,l),fB(d,B,l),fB(l,F,d),fB(d,F,d),lB(n,yB,A),lB(n,mB,A),lB(n,bB,A),lB(n,vB,A),fB(A,B,A),fB(A,F,M),fB(M,B,A),fB(M,F,M);var I=[RB,NB,PB,FB,IB,zB,OB,$B,mB,VB,UB,bB,kB,qB,GB,KB,YB,XB,QB,nF,tF,yB,eF];return fB(o,I,T),lB(o,BB,R),fB(a,I,T),lB(a,BB,R),fB(s,I,T),fB(T,I,T),lB(T,BB,R),lB(T,HB,N),fB(N,I,T),lB(R,yB,k),lB(R,mB,k),lB(R,bB,k),lB(R,vB,C),t}function _F(t,e,n){var r=n.length,i=0,o=[],s=[];while(i<r){var a=t,c=null,u=null,l=0,d=null,h=-1;while(i<r&&!(c=hB(a,n[i].t)))s.push(n[i++]);while(i<r&&(u=c||hB(a,n[i].t)))c=null,a=u,a.accepts()?(h=0,d=a):h>=0&&h++,i++,l++;if(h<0)for(var f=i-l;f<i;f++)s.push(n[f]);else{s.length>0&&(o.push(OF(SF,e,s)),s=[]),i-=h,l-=h;var p=d.t,g=n.slice(i-l,i);o.push(OF(p,e,g))}}return s.length>0&&o.push(OF(SF,e,s)),o}function OF(t,e,n){var r=n[0].s,i=n[n.length-1].e,o=e.substr(r,i-r);return new t(o,n)}"undefined"!==typeof console&&console&&console.warn;var AF={scanner:null,parser:null,pluginQueue:[],customProtocols:[],initialized:!1};function MF(){AF.scanner={start:lF(AF.customProtocols),tokens:rF},AF.parser={start:CF(),tokens:xF};for(var t={createTokenClass:bF},e=0;e<AF.pluginQueue.length;e++)AF.pluginQueue[e][1]({scanner:AF.scanner,parser:AF.parser,utils:t});AF.initialized=!0}function TF(t){return AF.initialized||MF(),_F(AF.parser.start,t,dF(AF.scanner.start,t))}function RF(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=TF(t),r=[],i=0;i<n.length;i++){var o=n[i];!o.isLink||e&&o.t!==e||r.push(o.toObject())}return r}function NF(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=TF(t);return 1===n.length&&n[0].isLink&&(!e||n[0].t===e)}function PF(t){return new JD({key:new tk("autolink"),appendTransaction:(e,n,r)=>{const i=e.some((t=>t.docChanged))&&!n.doc.eq(r.doc),o=e.some((t=>t.getMeta("preventAutolink")));if(!i||o)return;const{tr:s}=r,a=bR(n.doc,e),{mapping:c}=a,u=DR(a);return u.forEach((({oldRange:e,newRange:i})=>{pR(e.from,e.to,n.doc).filter((e=>e.mark.type===t.type)).forEach((e=>{const i=c.map(e.from),o=c.map(e.to),a=pR(i,o,r.doc).filter((e=>e.mark.type===t.type));if(!a.length)return;const u=a[0],l=n.doc.textBetween(e.from,e.to,void 0," "),d=r.doc.textBetween(u.from,u.to,void 0," "),h=NF(l),f=NF(d);h&&!f&&s.removeMark(u.from,u.to,t.type)})),wR(r.doc,i,(t=>t.isTextblock)).forEach((e=>{const n=r.doc.textBetween(e.pos,e.pos+e.node.nodeSize,void 0," ");RF(n).filter((t=>t.isLink)).map((t=>({...t,from:e.pos+t.start+1,to:e.pos+t.end+1}))).filter((t=>{const e=i.from>=t.from&&i.from<=t.to,n=i.to>=t.from&&i.to<=t.to;return e||n})).forEach((e=>{s.addMark(e.from,e.to,t.type.create({href:e.href}))}))}))})),s.steps.length?s:void 0}})}function BF(t){return new JD({key:new tk("handleClickLink"),props:{handleClick:(e,n,r)=>{var i;const o=BT(e.state,t.type.name),s=null===(i=r.target)||void 0===i?void 0:i.closest("a");return!(!s||!o.href)&&(window.open(o.href,o.target),!0)}}})}function FF(t){return new JD({key:new tk("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{state:i}=e,{selection:o}=i,{empty:s}=o;if(s)return!1;let a="";r.content.forEach((t=>{a+=t.textContent}));const c=RF(a).find((t=>t.isLink&&t.value===a));return!(!a||!c)&&(t.editor.commands.setMark(t.type,{href:c.href}),!0)}}})}const IF=hR.create({name:"link",priority:1e3,keepOnSplit:!1,inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow"}}},addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target}}},parseHTML(){return[{tag:'a[href]:not([href *= "javascript:" i])'}]},renderHTML({HTMLAttributes:t}){return["a",JT(this.options.HTMLAttributes,t),0]},addCommands(){return{setLink:t=>({chain:e})=>e().setMark(this.name,t).setMeta("preventAutolink",!0).run(),toggleLink:t=>({chain:e})=>e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[yR({find:t=>RF(t).filter((t=>t.isLink)).map((t=>({text:t.value,index:t.start,data:t}))),type:this.type,getAttributes:t=>{var e;return{href:null===(e=t.data)||void 0===e?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[];return this.options.autolink&&t.push(PF({type:this.type})),this.options.openOnClick&&t.push(BF({type:this.type})),this.options.linkOnPaste&&t.push(FF({editor:this.editor,type:this.type})),t}}),zF=XO.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new JD({props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,i=[];if(n)return t.descendants(((t,e)=>{const n=r>=e&&r<=e+t.nodeSize,o=!t.isLeaf&&!t.childCount;if((n||!this.options.showOnlyCurrent)&&o){const r=[this.options.emptyNodeClass];this.editor.isEmpty&&r.push(this.options.emptyEditorClass);const o=eO.node(e,e+t.nodeSize,{class:r.join(" "),"data-placeholder":"function"===typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:t,pos:e,hasAnchor:n}):this.options.placeholder});i.push(o)}return this.options.includeChildren})),oO.create(t,i)}}})]}});var jF=(0,o.aZ)({name:"IntrigueNoteEditor",inject:["document","store","state","send"],components:{EditorContent:zN},props:{id:String,content:String,editing:Boolean},data(){return{editor:null}},mounted(){this.editor=new IN({content:this.content,extensions:[rB,sB,IF,zF.configure({placeholder:"What are your thoughts?"})],autofocus:this.editing,editable:this.editing}),this.editor.on("blur",this.onEditorBlur)},beforeUnmount(){this.editor.destroy()},methods:{onEditorBlur(){this.send("editor blur"),"<p></p>"===this.editor.getHTML()?this.document.deleteNode(this.id):(this.document.commit("updateNode",{id:this.id,set:{content:this.editor.getHTML()}}),this.$emit("change",this.editor.getText()))}},watch:{content(){this.editor.commands.setContent(this.content)},editing(){this.editor.setEditable(this.editing),this.editing?(console.log("Editing: ",this.editing,this.id),this.editor.commands.focus("end")):this.editor.commands.blur()}}}),LF=n(89);const $F=(0,LF.Z)(jF,[["render",iE]]);var HF=$F,VF=n(7994);const WF="text/plain",UF="us-ascii",qF=(t,e)=>e.some((e=>e instanceof RegExp?e.test(t):e===t)),GF=(t,{stripHash:e})=>{const n=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(t);if(!n)throw new Error(`Invalid URL: ${t}`);let{type:r,data:i,hash:o}=n.groups;const s=r.split(";");o=e?"":o;let a=!1;"base64"===s[s.length-1]&&(s.pop(),a=!0);const c=(s.shift()||"").toLowerCase(),u=s.map((t=>{let[e,n=""]=t.split("=").map((t=>t.trim()));return"charset"===e&&(n=n.toLowerCase(),n===UF)?"":`${e}${n?`=${n}`:""}`})).filter(Boolean),l=[...u];return a&&l.push("base64"),(l.length>0||c&&c!==WF)&&l.unshift(c),`data:${l.join(";")},${a?i.trim():i}${o?`#${o}`:""}`};function KF(t,e){if(e={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...e},t=t.trim(),/^data:/i.test(t))return GF(t,e);if(/^view-source:/i.test(t))throw new Error("`view-source:` is not supported as it is a non-standard protocol");const n=t.startsWith("//"),r=!n&&/^\.*\//.test(t);r||(t=t.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,e.defaultProtocol));const i=new URL(t);if(e.forceHttp&&e.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(e.forceHttp&&"https:"===i.protocol&&(i.protocol="http:"),e.forceHttps&&"http:"===i.protocol&&(i.protocol="https:"),e.stripAuthentication&&(i.username="",i.password=""),e.stripHash?i.hash="":e.stripTextFragment&&(i.hash=i.hash.replace(/#?:~:text.*?$/i,"")),i.pathname){const t=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g;let e=0,n="";for(;;){const r=t.exec(i.pathname);if(!r)break;const o=r[0],s=r.index,a=i.pathname.slice(e,s);n+=a.replace(/\/{2,}/g,"/"),n+=o,e=s+o.length}const r=i.pathname.slice(e,i.pathname.length);n+=r.replace(/\/{2,}/g,"/"),i.pathname=n}if(i.pathname)try{i.pathname=decodeURI(i.pathname)}catch{}if(!0===e.removeDirectoryIndex&&(e.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(e.removeDirectoryIndex)&&e.removeDirectoryIndex.length>0){let t=i.pathname.split("/");const n=t[t.length-1];qF(n,e.removeDirectoryIndex)&&(t=t.slice(0,-1),i.pathname=t.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),e.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(e.removeQueryParameters))for(const s of[...i.searchParams.keys()])qF(s,e.removeQueryParameters)&&i.searchParams.delete(s);if(!0===e.removeQueryParameters&&(i.search=""),e.sortQueryParameters){i.searchParams.sort();try{i.search=decodeURIComponent(i.search)}catch{}}e.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,""));const o=t;return t=i.toString(),e.removeSingleSlash||"/"!==i.pathname||o.endsWith("/")||""!==i.hash||(t=t.replace(/\/$/,"")),(e.removeTrailingSlash||"/"===i.pathname)&&""===i.hash&&e.removeSingleSlash&&(t=t.replace(/\/$/,"")),n&&!e.normalizeProtocol&&(t=t.replace(/^http:\/\//,"//")),e.stripProtocol&&(t=t.replace(/^(?:https?:)?\/\//,"")),t}const YF=t=>{const e=new Set,{searchParams:n}=new URL(t.replace(/^(?:\/\/|(?:www\.))/i,"http://$2"));for(const[,r]of n)VF({exact:!0}).test(r)&&e.add(r);return e};function XF(t,e={}){if("string"!==typeof t)throw new TypeError("The `text` argument should be a string, got "+typeof t);if("undefined"!==typeof e.exclude&&!Array.isArray(e.exclude))throw new TypeError("The `exclude` option must be an array");const n=new Set,r=t=>{try{n.add(KF(t.trim().replace(/\.+$/,""),e))}catch{}},i=t.match(VF(void 0===e.requireSchemeOrWww?void 0:{strict:e.requireSchemeOrWww,parens:!0}))||[];for(const o of i)if(r(o),e.extractFromQueryString){const t=YF(o);for(const e of t)r(e)}for(const o of e.exclude||[])for(const t of n){const e=new RegExp(o);e.test(t)&&n.delete(t)}return n}const JF=n(9841);function ZF(t){const e=QF(t);if(e)return{type:"isbn",identifier:e};const n=JF.extract(t);if(n.length>0)return{type:"doi",identifier:n[0]};const r=XF(t);return r.size>0?{type:"url",identifier:r.values().next().value}:void 0}function QF(t){let e=/^(?:ISBN(?:-1[03])?:? )?(?=[0-9X]{10}$|(?=(?:[0-9]+[- ]){3})[- 0-9X]{13}$|97[89][0-9]{10}$|(?=(?:[0-9]+[- ]){4})[- 0-9]{17}$)(?:97[89][- ]?)?[0-9]{1,5}[- ]?[0-9]+[- ]?[0-9]+[- ]?[0-9X]$/;if(e.test(t)){var n,r,i=t.replace(/[- ]|^ISBN(?:-1[03])?:?/g,"").split(""),o=i.pop(),s=0;if(9==i.length){for(i.reverse(),r=0;r<i.length;r++)s+=(r+2)*parseInt(i[r],10);n=11-s%11,10==n?n="X":11==n&&(n="0")}else{for(r=0;r<i.length;r++)s+=(r%2*2+1)*parseInt(i[r],10);n=10-s%10,10==n&&(n="0")}if(n==o){let n=t.match(e)[0];return n}}}var tI=(0,o.aZ)({name:"IntrigueNode",inject:["document","store","state","send","editing","dragging","dropping","selection"],components:{VaCard:nE.ZP,VaCardContent:nE.dV,NoteEditor:HF},props:{node:{type:Object,required:!0},selected:{type:Boolean,default:!1}},data(){return{x:this.node.x,y:this.node.y,w:this.node.w,h:this.node.h,parent:null}},methods:{onMouseEnter(){this.send({type:"drop enter",node:this.node.id})},onMouseLeave(){this.send({type:"drop leave",node:this.node.id})},observeParent(){this.parentWatchers=[this.$watch("parent.currentX",this.updateDimensionsFromParent),this.$watch("parent.currentY",this.updateDimensionsFromParent),this.$watch("parent.currentWidth",this.updateDimensionsFromParent),this.$watch("parent.currentHeight",this.updateDimensionsFromParent)]},updateDimensions(){if(console.log("Dimensions changed"),!this.$refs.node)return;let t=this.$refs.node.$el.clientHeight;this.document.updateNode({id:this.node.id,set:{currentHeight:t}})},updateDimensionsFromParent(){this.document.updateNode({id:this.node.id,set:{x:this.parent.currentX,y:this.parent.currentY+this.parent.currentHeight,w:this.parent.currentWidth,currentX:this.parent.currentX,currentY:this.parent.currentY+this.parent.currentHeight,currentWidth:this.parent.currentWidth,currentHeight:this.$refs.node.$el.clientHeight}})},parseNoteContent(t){const e=ZF(t);e&&(console.log(e,Kw.Literature),this.document.commit("updateNode",{id:this.node.id,set:{type:Kw.Reference,identifier:e.identifier}}))}},mounted(){this.observer=new ResizeObserver(this.updateDimensions),this.observer.observe(this.$refs.node.$el),this.document.updateNode({id:this.node.id,set:{currentX:this.node.x,currentY:this.node.y,currentHeight:this.node.h?this.node.h:this.$refs.node.$el.clientHeight}}),this.node.parent&&(this.parent=this.store.value.nodes[this.node.parent],this.observeParent(),this.updateDimensionsFromParent())},breforeUnmount(){console.log("Unmounting",this.node.id),this.observer.disconnect();for(let t of this.parentWatchers)t()},deactivated(){console.log("Unmounting",this.node.id),this.observer.disconnect();for(let t of this.parentWatchers)t()},computed:{styles(){return{"--bg-color":"rgb(250, 248, 229)","--border-color":"rgb(233, 183, 109)",width:`${this.w}px`,transform:`translate(${this.x}px, ${this.y}px)`,"z-index":this.index}},selectedByRemoteUsers(){for(let[t,e]of Object.entries(this.document.users))if(t!==this.document.userId&&e.selection.includes(this.node.id))return!0;return!1},isNote(){return this.node.type===Kw.Note},isReference(){return this.node.type===Kw.Reference},index(){let t=0,e=this.node;while(e.parent)t++,e=this.store.value.nodes[e.parent];return this.selection.value.includes(this.node.id)?t+2:t}},watch:{"node.currentX":function(){this.x=this.node.currentX},"node.currentY":function(){this.y=this.node.currentY},"node.currentWidth":function(){this.w=this.node.currentWidth},"node.x":function(){this.document.updateNode({id:this.node.id,set:{currentX:this.node.x}})},"node.y":function(){this.document.updateNode({id:this.node.id,set:{currentY:this.node.y}})},"node.w":function(){this.document.updateNode({id:this.node.id,set:{currentWidth:this.node.w}})},"node.parent":function(){if(this.node.parent)this.parent=this.store.value.nodes[this.node.parent],this.observeParent(),this.updateDimensionsFromParent();else{this.parent=null;for(let t of this.parentWatchers)t();this.parentWatchers=[]}}}});const eI=(0,LF.Z)(tI,[["render",eE]]);var nI=eI;const rI=t=>((0,o.dD)("data-v-496375aa"),t=t(),(0,o.Cn)(),t),iI=rI((()=>(0,o._)("div",{class:"arrow"},null,-1)));function oI(t,e,n,r,i,a){const c=(0,o.up)("Avatar");return(0,o.wg)(),(0,o.iD)("div",{class:"cursor",style:(0,s.j5)({transform:`translate(${t.x}px, ${t.y}px)`})},[iI,(0,o.Wm)(c,{class:"avatar",variant:"beam",name:t.name,size:20},null,8,["name"])],4)}var sI=(0,o.aZ)({name:"IntrigueCursor",components:{Avatar:z.Z},props:{id:String,name:String,x:Number,y:Number}});const aI=(0,LF.Z)(sI,[["render",oI],["__scopeId","data-v-496375aa"]]);var cI=aI,uI=(0,o.aZ)({name:"IntrigueCanvas",inject:["document","store","state","send","editing","dragging","dropping","detaching"],components:{VueInfiniteViewer:bn,Moveable:Dl,VueSelecto:wd,Node:nI,Cursor:cI},data(){return{x:0,y:0,zoom:1,selection:[],keyboard:new tE}},methods:{newNode(t){const e=this.mapMousePosition(t.clientX,t.clientY),n=(0,Dd.x0)();this.document.commit("createNode",{id:n,type:Kw.Note,content:void 0,x:e.x-14,y:e.y-14,w:200,h:15}),this.send({type:"create node",node:n})},editNode(t){this.send({type:"dblclick node",node:t.id}),console.log(this.state.value,this.editing.value)},deleteNodes(t){if(this.editing.value)return;const e=this.selection.map((t=>t.id));this.selection=[],this.document.commit("deleteNodes",e),t.preventDefault()},undo(t){console.log("undo"),null===this.editing.value&&(this.document.undo(),t.preventDefault())},redo(t){console.log("redo"),null===this.editing.value&&(this.document.redo(),t.preventDefault())},panCanvas(t){this.x=t.scrollLeft,this.y=t.scrollTop,this.document.updateAwareness("x",this.x),this.document.updateAwareness("y",this.y)},zoomCanvas(t){this.zoom=t.zoom,this.$refs.canvas.setZoom(t.zoom)},cancelSelectionWhenClickEmpty(t){this.$refs.selecto.clickTarget(t.inputEvent,t.inputTarget)},sendDragStartMessage(t){if(!t.events&&t.target)this.send({type:"start dragging",node:t.target.id});else if(t.targets){t.target.classList.add("clickthrough");for(let e of t.targets){let n=e.getBoundingClientRect();if(n.left<=t.clientX&&n.right>=t.clientX&&n.top<=t.clientY&&n.bottom>=t.clientY){this.send({type:"start dragging",node:e.id});break}}}},dragNodes(t){let e;this.sendDragStartMessage(t),!t.events&&t.target?e=[t]:t.events&&(e=t.events);const n=e.map((t=>this.store.value.nodes[t.target.id])),r=[];for(let i of n)i.parent&&r.push({source:i.parent,target:i.id});if(r.length>0){this.send({type:"start detaching",detaching:r});const e=Math.sqrt(t.dist[0]*t.dist[0]+t.dist[1]*t.dist[1]);if(!(e>30))return;this.send("detached");for(let t of r)this.document.commit("unsnapNode",t)}e.forEach((t=>{this.document.updateNode({id:t.target.id,set:{currentX:t.translate[0],currentY:t.translate[1]}})}))},commitNodePositions(t){if(this.dropping.value&&(console.log("Dropping",this.dragging.value,"on",this.dropping.value),this.document.commit("snapNode",{source:this.dropping.value,target:this.dragging.value}),this.send("stop dragging")),this.detaching.value.length>0)return console.log("Detaching ended halfway."),void this.send("stop detaching");t.lastEvent&&this.document.commit("updateNodes",{id:this.selection.map((t=>t.id)),by:{x:t.lastEvent.dist[0],y:t.lastEvent.dist[1]}}),this.send("stop dragging")},preventSelectionWhenDragging(t){const e=t.inputEvent.target;(this.$refs.moveable.isMoveableElement(e)||this.selection.some((t=>t===e||t.contains(e)))||e.matches(".moveable-area")||e.matches(".moveable-control"))&&t.stop()},selectNode(t){this.send({type:"update selection",selection:t.selected.map((t=>t.id))})},commitSelections(t){t.isDragStart&&(t.inputEvent.preventDefault(),setTimeout((()=>{this.$refs.moveable.dragStart(t.inputEvent)}))),this.selection=t.selected;const e=t.selected.map((t=>t.id));this.document.updateAwareness("selection",e),this.send({type:"done selecting",selection:e})},resizeNode(t){t.target.style.width=`${t.width}px`,this.document.updateNode({id:t.target.id,set:{currentWidth:t.width}})},commitNodeSize(t){t.lastEvent&&this.document.commit("updateNode",{id:t.target.id,set:{w:t.lastEvent.width,h:t.target.offsetHeight}})},mapMousePosition(t,e){let n=t/this.zoom+this.x,r=e/this.zoom+this.y;return{x:n,y:r}},gatherDescendants(t,e){const n=e?new Set([t.id]):new Set;for(let r of t.children){const t=this.store.value.nodes[r],e=this.gatherDescendants(t,!0);for(let r of e)n.add(r)}return[...n]},updateCursorPosition(t){const e=this.mapMousePosition(t.clientX,t.clientY);this.document.updateAwareness("cursorX",e.x),this.document.updateAwareness("cursorY",e.y)},startPanning(t){console.log("Space pressed",t),this.send("space pressed"),this.editing||t.preventDefault()},stopPanning(t){console.log("Space released",t),this.send("space released"),this.editing||t.preventDefault()}},mounted(){this.document.on("synced",(()=>{this.document.updateAwareness("selection",[]),window.addEventListener("mousemove",this.updateCursorPosition),this.keyboard.on("keydown","Space",this.startPanning),this.keyboard.on("keyup","Space",this.stopPanning),this.keyboard.on("keydown","Backspace",this.deleteNodes),this.keyboard.on("keydown","$mod+Z",this.undo),this.keyboard.on("keydown","$mod+Shift+Z",this.redo)}))},beforeUnmount(){window.removeEventListener("mousemove",this.updateCursorPosition),this.keyboard.removeListeners()}});const lI=(0,LF.Z)(uI,[["render",H],["__scopeId","data-v-ff4a14a6"]]);var dI,hI,fI=lI,pI=function(){return pI=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},pI.apply(this,arguments)};function gI(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function mI(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function vI(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return s}function yI(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}(function(t){t["Start"]="xstate.start",t["Stop"]="xstate.stop",t["Raise"]="xstate.raise",t["Send"]="xstate.send",t["Cancel"]="xstate.cancel",t["NullEvent"]="",t["Assign"]="xstate.assign",t["After"]="xstate.after",t["DoneState"]="done.state",t["DoneInvoke"]="done.invoke",t["Log"]="xstate.log",t["Init"]="xstate.init",t["Invoke"]="xstate.invoke",t["ErrorExecution"]="error.execution",t["ErrorCommunication"]="error.communication",t["ErrorPlatform"]="error.platform",t["ErrorCustom"]="xstate.error",t["Update"]="xstate.update",t["Pure"]="xstate.pure",t["Choose"]="xstate.choose"})(dI||(dI={})),function(t){t["Parent"]="#_parent",t["Internal"]="#_internal"}(hI||(hI={}));var bI,wI=dI.Start,EI=dI.Stop,SI=dI.Raise,DI=dI.Send,kI=dI.Cancel,xI=dI.NullEvent,CI=dI.Assign,_I=(dI.After,dI.DoneState,dI.Log),OI=dI.Init,AI=dI.Invoke,MI=(dI.ErrorExecution,dI.ErrorPlatform),TI=dI.ErrorCustom,RI=dI.Update,NI=dI.Choose,PI=dI.Pure,BI=".",FI={},II="xstate.guard",zI="",jI=!0;function LI(t,e,n){void 0===n&&(n=BI);var r=WI(t,n),i=WI(e,n);return dz(i)?!!dz(r)&&i===r:dz(r)?r in i:Object.keys(r).every((function(t){return t in i&&LI(r[t],i[t])}))}function $I(t){try{return dz(t)||"number"===typeof t?"".concat(t):t.type}catch(Xw){throw new Error("Events must be strings or objects with a string event.type property.")}}function HI(t,e){try{return uz(t)?t:t.toString().split(e)}catch(Xw){throw new Error("'".concat(t,"' is not a valid state path."))}}function VI(t){return"object"===typeof t&&"value"in t&&"context"in t&&"event"in t&&"_event"in t}function WI(t,e){if(VI(t))return t.value;if(uz(t))return UI(t);if("string"!==typeof t)return t;var n=HI(t,e);return UI(n)}function UI(t){if(1===t.length)return t[0];for(var e={},n=e,r=0;r<t.length-1;r++)r===t.length-2?n[t[r]]=t[r+1]:(n[t[r]]={},n=n[t[r]]);return e}function qI(t,e){for(var n={},r=Object.keys(t),i=0;i<r.length;i++){var o=r[i];n[o]=e(t[o],o,t,i)}return n}function GI(t,e,n){var r,i,o={};try{for(var s=mI(Object.keys(t)),a=s.next();!a.done;a=s.next()){var c=a.value,u=t[c];n(u)&&(o[c]=e(u,c,t))}}catch(l){r={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o}var KI=function(t){return function(e){var n,r,i=e;try{for(var o=mI(t),s=o.next();!s.done;s=o.next()){var a=s.value;i=i[a]}}catch(c){n={error:c}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}};function YI(t,e){return function(n){var r,i,o=n;try{for(var s=mI(t),a=s.next();!a.done;a=s.next()){var c=a.value;o=o[e][c]}}catch(u){r={error:u}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o}}function XI(t){if(!t)return[[]];if(dz(t))return[[t]];var e=JI(Object.keys(t).map((function(e){var n=t[e];return"string"===typeof n||n&&Object.keys(n).length?XI(t[e]).map((function(t){return[e].concat(t)})):[[e]]})));return e}function JI(t){var e;return(e=[]).concat.apply(e,yI([],vI(t),!1))}function ZI(t){return uz(t)?t:[t]}function QI(t){return void 0===t?[]:ZI(t)}function tz(t,e,n){var r,i;if(lz(t))return t(e,n.data);var o={};try{for(var s=mI(Object.keys(t)),a=s.next();!a.done;a=s.next()){var c=a.value,u=t[c];lz(u)?o[c]=u(e,n.data):o[c]=u}}catch(l){r={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o}function ez(t){return/^(done|error)\./.test(t)}function nz(t){return t instanceof Promise||!(null===t||!lz(t)&&"object"!==typeof t||!lz(t.then))}function rz(t){return null!==t&&"object"===typeof t&&"transition"in t&&"function"===typeof t.transition}function iz(t,e){var n,r,i=vI([[],[]],2),o=i[0],s=i[1];try{for(var a=mI(t),c=a.next();!c.done;c=a.next()){var u=c.value;e(u)?o.push(u):s.push(u)}}catch(l){n={error:l}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return[o,s]}function oz(t,e){return qI(t.states,(function(t,n){if(t){var r=(dz(e)?void 0:e[n])||(t?t.current:void 0);if(r)return{current:r,states:oz(t,r)}}}))}function sz(t,e){return{current:e,states:oz(t,e)}}function az(t,e,n,r){jI||cz(!!t,"Attempting to update undefined context");var i=t?n.reduce((function(t,n){var i,o,s=n.assignment,a={state:r,action:n,_event:e},c={};if(lz(s))c=s(t,e.data,a);else try{for(var u=mI(Object.keys(s)),l=u.next();!l.done;l=u.next()){var d=l.value,h=s[d];c[d]=lz(h)?h(t,e.data,a):h}}catch(f){i={error:f}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}return Object.assign({},t,c)}),t):t;return i}var cz=function(){};function uz(t){return Array.isArray(t)}function lz(t){return"function"===typeof t}function dz(t){return"string"===typeof t}function hz(t,e){if(t)return dz(t)?{type:II,name:t,predicate:e?e[t]:void 0}:lz(t)?{type:II,name:t.name,predicate:t}:t}function fz(t){try{return"subscribe"in t&&lz(t.subscribe)}catch(Xw){return!1}}jI||(cz=function(t,e){var n=t instanceof Error?t:void 0;if((n||!t)&&void 0!==console){var r=["Warning: ".concat(e)];n&&r.push(n),console.warn.apply(console,r)}});var pz=function(){return"function"===typeof Symbol&&Symbol.observable||"@@observable"}();bI={},bI[pz]=function(){return this},bI[Symbol.observable]=function(){return this};function gz(t){return!!t&&"__xstatenode"in t}function mz(t){return!!t&&"function"===typeof t.send}function vz(t,e){return dz(t)||"number"===typeof t?pI({type:t},e):t}function yz(t,e){if(!dz(t)&&"$$type"in t&&"scxml"===t.$$type)return t;var n=vz(t);return pI({name:n.type,data:n,$$type:"scxml",type:"external"},e)}function bz(t,e){var n=ZI(e).map((function(e){return"undefined"===typeof e||"string"===typeof e||gz(e)?{target:e,event:t}:pI(pI({},e),{event:t})}));return n}function wz(t){if(void 0!==t&&t!==zI)return QI(t)}function Ez(t,e,n){if(!jI){var r=t.stack?" Stacktrace was '".concat(t.stack,"'"):"";if(t===e)console.error("Missing onError handler for invocation '".concat(n,"', error was '").concat(t,"'.").concat(r));else{var i=e.stack?" Stacktrace was '".concat(e.stack,"'"):"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '".concat(n,"'. ")+"Original error: '".concat(t,"'. ").concat(r," Current error is '").concat(e,"'.").concat(i))}}}function Sz(t,e,n,r,i){var o=t.options.guards,s={state:i,cond:e,_event:r};if(e.type===II)return((null===o||void 0===o?void 0:o[e.name])||e.predicate)(n,r.data,s);var a=null===o||void 0===o?void 0:o[e.type];if(!a)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(t.id,"'."));return a(n,r.data,s)}function Dz(t){return"string"===typeof t?{type:t}:t}function kz(t,e,n){if("object"===typeof t)return t;var r=function(){};return{next:t,error:e||r,complete:n||r}}function xz(t,e){return"".concat(t,":invocation[").concat(e,"]")}var Cz=yz({type:OI});function _z(t,e){return e&&e[t]||void 0}function Oz(t,e){var n;if(dz(t)||"number"===typeof t){var r=_z(t,e);n=lz(r)?{type:t,exec:r}:r||{type:t,exec:void 0}}else if(lz(t))n={type:t.name||t.toString(),exec:t};else{r=_z(t.type,e);if(lz(r))n=pI(pI({},t),{exec:r});else if(r){var i=r.type||t.type;n=pI(pI(pI({},r),t),{type:i})}else n=t}return n}var Az=function(t,e){if(!t)return[];var n=uz(t)?t:[t];return n.map((function(t){return Oz(t,e)}))};function Mz(t){var e=Oz(t);return pI(pI({id:dz(t)?t:e.id},e),{type:e.type})}function Tz(t){return dz(t)?{type:SI,event:t}:Nz(t,{to:hI.Internal})}function Rz(t){return{type:SI,_event:yz(t.event)}}function Nz(t,e){return{to:e?e.to:void 0,type:DI,event:lz(t)?t:vz(t),delay:e?e.delay:void 0,id:e&&void 0!==e.id?e.id:lz(t)?t.name:$I(t)}}function Pz(t,e,n,r){var i,o={_event:n},s=yz(lz(t.event)?t.event(e,n.data,o):t.event);if(dz(t.delay)){var a=r&&r[t.delay];i=lz(a)?a(e,n.data,o):a}else i=lz(t.delay)?t.delay(e,n.data,o):t.delay;var c=lz(t.to)?t.to(e,n.data,o):t.to;return pI(pI({},t),{to:c,_event:s,event:s.data,delay:i})}var Bz=function(t,e,n){return pI(pI({},t),{value:dz(t.expr)?t.expr:t.expr(e,n.data,{_event:n})})},Fz=function(t){return{type:kI,sendId:t}};function Iz(t){var e=Mz(t);return{type:dI.Start,activity:e,exec:void 0}}function zz(t){var e=lz(t)?t:Mz(t);return{type:dI.Stop,activity:e,exec:void 0}}function jz(t,e,n){var r=lz(t.activity)?t.activity(e,n.data):t.activity,i="string"===typeof r?{id:r}:r,o={type:dI.Stop,activity:i};return o}var Lz=function(t){return{type:CI,assignment:t}};function $z(t,e){var n=e?"#".concat(e):"";return"".concat(dI.After,"(").concat(t,")").concat(n)}function Hz(t,e){var n="".concat(dI.DoneState,".").concat(t),r={type:n,data:e,toString:function(){return n}};return r}function Vz(t,e){var n="".concat(dI.DoneInvoke,".").concat(t),r={type:n,data:e,toString:function(){return n}};return r}function Wz(t,e){var n="".concat(dI.ErrorPlatform,".").concat(t),r={type:n,data:e,toString:function(){return n}};return r}function Uz(t,e,n,r,i,o){void 0===o&&(o=!1);var s=vI(o?[[],i]:iz(i,(function(t){return t.type===CI})),2),a=s[0],c=s[1],u=a.length?az(n,r,a,e):n,l=o?[n]:void 0,d=JI(c.map((function(n){var i;switch(n.type){case SI:return Rz(n);case DI:var s=Pz(n,u,r,t.options.delays);return jI||cz(!dz(n.delay)||"number"===typeof s.delay,"No delay reference for delay expression '".concat(n.delay,"' was found on machine '").concat(t.id,"'")),s;case _I:return Bz(n,u,r);case NI:var a=n,c=null===(i=a.conds.find((function(n){var i=hz(n.cond,t.options.guards);return!i||Sz(t,i,u,r,e)})))||void 0===i?void 0:i.actions;if(!c)return[];var d=vI(Uz(t,e,u,r,Az(QI(c),t.options.actions),o),2),h=d[0],f=d[1];return u=f,null===l||void 0===l||l.push(u),h;case PI:c=n.get(u,r.data);if(!c)return[];var p=vI(Uz(t,e,u,r,Az(QI(c),t.options.actions),o),2),g=p[0],m=p[1];return u=m,null===l||void 0===l||l.push(u),g;case EI:return jz(n,u,r);case CI:u=az(u,r,[n],e),null===l||void 0===l||l.push(u);break;default:var v=Oz(n,t.options.actions),y=v.exec;if(y&&l){var b=l.length-1;v=pI(pI({},v),{exec:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];y.apply(void 0,yI([l[b]],vI(e),!1))}})}return v}})).filter((function(t){return!!t})));return[d,u]}var qz=Lz,Gz=function(t){return"atomic"===t.type||"final"===t.type};function Kz(t){return Object.keys(t.states).map((function(e){return t.states[e]})).filter((function(t){return"history"!==t.type}))}function Yz(t){var e=[t];return Gz(t)?e:e.concat(JI(Kz(t).map(Yz)))}function Xz(t,e){var n,r,i,o,s,a,c,u,l=new Set(t),d=Zz(l),h=new Set(e);try{for(var f=mI(h),p=f.next();!p.done;p=f.next()){var g=p.value,m=g.parent;while(m&&!h.has(m))h.add(m),m=m.parent}}catch(x){n={error:x}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}var v=Zz(h);try{for(var y=mI(h),b=y.next();!b.done;b=y.next()){g=b.value;if("compound"!==g.type||v.get(g)&&v.get(g).length){if("parallel"===g.type)try{for(var w=(s=void 0,mI(Kz(g))),E=w.next();!E.done;E=w.next()){var S=E.value;h.has(S)||(h.add(S),d.get(S)?d.get(S).forEach((function(t){return h.add(t)})):S.initialStateNodes.forEach((function(t){return h.add(t)})))}}catch(C){s={error:C}}finally{try{E&&!E.done&&(a=w.return)&&a.call(w)}finally{if(s)throw s.error}}}else d.get(g)?d.get(g).forEach((function(t){return h.add(t)})):g.initialStateNodes.forEach((function(t){return h.add(t)}))}}catch(_){i={error:_}}finally{try{b&&!b.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}try{for(var D=mI(h),k=D.next();!k.done;k=D.next()){g=k.value,m=g.parent;while(m&&!h.has(m))h.add(m),m=m.parent}}catch(O){c={error:O}}finally{try{k&&!k.done&&(u=D.return)&&u.call(D)}finally{if(c)throw c.error}}return h}function Jz(t,e){var n=e.get(t);if(!n)return{};if("compound"===t.type){var r=n[0];if(!r)return{};if(Gz(r))return r.key}var i={};return n.forEach((function(t){i[t.key]=Jz(t,e)})),i}function Zz(t){var e,n,r=new Map;try{for(var i=mI(t),o=i.next();!o.done;o=i.next()){var s=o.value;r.has(s)||r.set(s,[]),s.parent&&(r.has(s.parent)||r.set(s.parent,[]),r.get(s.parent).push(s))}}catch(a){e={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Qz(t,e){var n=Xz([t],e);return Jz(t,Zz(n))}function tj(t,e){return Array.isArray(t)?t.some((function(t){return t===e})):t instanceof Set&&t.has(e)}function ej(t){return yI([],vI(new Set(JI(yI([],vI(t.map((function(t){return t.ownEvents}))),!1)))),!1)}function nj(t,e){return"compound"===e.type?Kz(e).some((function(e){return"final"===e.type&&tj(t,e)})):"parallel"===e.type&&Kz(e).every((function(e){return nj(t,e)}))}function rj(t){return void 0===t&&(t=[]),t.reduce((function(t,e){return void 0!==e.meta&&(t[e.id]=e.meta),t}),{})}function ij(t){return new Set(JI(t.map((function(t){return t.tags}))))}function oj(t,e){if(t===e)return!0;if(void 0===t||void 0===e)return!1;if(dz(t)||dz(e))return t===e;var n=Object.keys(t),r=Object.keys(e);return n.length===r.length&&n.every((function(n){return oj(t[n],e[n])}))}function sj(t){return"object"===typeof t&&null!==t&&("value"in t&&"_event"in t)}function aj(t,e){var n=t.exec,r=pI(pI({},t),{exec:void 0!==n?function(){return n(e.context,e.event,{action:t,state:e,_event:e._event})}:void 0});return r}var cj=function(){function t(t){var e,n=this;this.actions=[],this.activities=FI,this.meta={},this.events=[],this.value=t.value,this.context=t.context,this._event=t._event,this._sessionid=t._sessionid,this.event=this._event.data,this.historyValue=t.historyValue,this.history=t.history,this.actions=t.actions||[],this.activities=t.activities||FI,this.meta=rj(t.configuration),this.events=t.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=t.configuration,this.transitions=t.transitions,this.children=t.children,this.done=!!t.done,this.tags=null!==(e=Array.isArray(t.tags)?new Set(t.tags):t.tags)&&void 0!==e?e:new Set,this.machine=t.machine,Object.defineProperty(this,"nextEvents",{get:function(){return ej(n.configuration)}})}return t.from=function(e,n){if(e instanceof t)return e.context!==n?new t({value:e.value,context:n,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e;var r=Cz;return new t({value:e,context:n,_event:r,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},t.create=function(e){return new t(e)},t.inert=function(e,n){if(e instanceof t){if(!e.actions.length)return e;var r=Cz;return new t({value:e.value,context:n,_event:r,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return t.from(e,n)},t.prototype.toStrings=function(t,e){var n=this;if(void 0===t&&(t=this.value),void 0===e&&(e="."),dz(t))return[t];var r=Object.keys(t);return r.concat.apply(r,yI([],vI(r.map((function(r){return n.toStrings(t[r],e).map((function(t){return r+e+t}))}))),!1))},t.prototype.toJSON=function(){var t=this;t.configuration,t.transitions;var e=t.tags;t.machine;var n=gI(t,["configuration","transitions","tags","machine"]);return pI(pI({},n),{tags:Array.from(e)})},t.prototype.matches=function(t){return LI(t,this.value)},t.prototype.hasTag=function(t){return this.tags.has(t)},t.prototype.can=function(t){var e;jI&&cz(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var n=null===(e=this.machine)||void 0===e?void 0:e.getTransitionData(this,t);return!!(null===n||void 0===n?void 0:n.transitions.length)&&n.transitions.some((function(t){return void 0!==t.target||t.actions.length}))},t}(),uj=[],lj=function(t,e){uj.push(t);var n=e(t);return uj.pop(),n};function dj(t){var e;return e={id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:t}}},e[pz]=function(){return this},e}function hj(t,e,n,r){var i,o=Dz(t.src),s=null===(i=null===e||void 0===e?void 0:e.options.services)||void 0===i?void 0:i[o.type],a=t.data?tz(t.data,n,r):void 0,c=s?fj(s,t.id,a):dj(t.id);return c.meta=t,c}function fj(t,e,n){var r=dj(e);if(r.deferred=!0,gz(t)){var i=r.state=lj(void 0,(function(){return(n?t.withContext(n):t).initialState}));r.getSnapshot=function(){return i}}return r}function pj(t){try{return"function"===typeof t.send}catch(Xw){return!1}}function gj(t){return pj(t)&&"id"in t}function mj(t){var e;return pI((e={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},e[pz]=function(){return this},e),t)}function vj(t){if("string"===typeof t){var e={type:t,toString:function(){return t}};return e}return t}function yj(t){return pI(pI({type:AI},t),{toJSON:function(){t.onDone,t.onError;var e=gI(t,["onDone","onError"]);return pI(pI({},e),{type:AI,src:vj(t.src)})}})}var bj="",wj="#",Ej="*",Sj={},Dj=function(t){return t[0]===wj},kj=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},xj=function(t,e,n){var r=n.slice(0,-1).some((function(t){return!("cond"in t)&&!("in"in t)&&(dz(t.target)||gz(t.target))})),i=e===bj?"the transient event":"event '".concat(e,"'");cz(!r,"One or more transitions for ".concat(i," on state '").concat(t.id,"' are unreachable. ")+"Make sure that the default transition is the last one defined.")},Cj=function(){function t(e,n,r,i){var o,s=this;void 0===r&&(r="context"in e?e.context:void 0),this.config=e,this._context=r,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(kj(),n),this.parent=null===i||void 0===i?void 0:i.parent,this.key=this.config.key||(null===i||void 0===i?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:BI),this.id=this.config.id||yI([this.machine.key],vI(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!==(o=this.config.schema)&&void 0!==o?o:{},this.description=this.config.description,jI||cz(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '.concat(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '".concat(this.type,"'`")," in the config for state node '").concat(this.id,"' instead.")),this.initial=this.config.initial,this.states=this.config.states?qI(this.config.states,(function(e,n){var r,i=new t(e,{},void 0,{parent:s,key:n});return Object.assign(s.idMap,pI((r={},r[i.id]=i,r),i.idMap)),i})):Sj;var a=0;function c(t){var e,n;t.order=a++;try{for(var r=mI(Kz(t)),i=r.next();!i.done;i=r.next()){var o=i.value;c(o)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}c(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(Array.isArray(this.config.on)?this.config.on.some((function(t){var e=t.event;return e===bj})):bj in this.config.on),this.strict=!!this.config.strict,this.onEntry=QI(this.config.entry||this.config.onEntry).map((function(t){return Oz(t)})),this.onExit=QI(this.config.exit||this.config.onExit).map((function(t){return Oz(t)})),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=QI(this.config.invoke).map((function(t,e){var n,r;if(gz(t)){var i=xz(s.id,e);return s.machine.options.services=pI((n={},n[i]=t,n),s.machine.options.services),yj({src:i,id:i})}if(dz(t.src)){i=t.id||xz(s.id,e);return yj(pI(pI({},t),{id:i,src:t.src}))}if(gz(t.src)||lz(t.src)){i=t.id||xz(s.id,e);return s.machine.options.services=pI((r={},r[i]=t.src,r),s.machine.options.services),yj(pI(pI({id:i},t),{src:i}))}var o=t.src;return yj(pI(pI({id:xz(s.id,e)},t),{src:o}))})),this.activities=QI(this.config.activities).concat(this.invoke).map((function(t){return Mz(t)})),this.transition=this.transition.bind(this),this.tags=QI(this.config.tags)}return t.prototype._init=function(){this.__cache.transitions||Yz(this).forEach((function(t){return t.on}))},t.prototype.withConfig=function(e,n){var r=this.options,i=r.actions,o=r.activities,s=r.guards,a=r.services,c=r.delays;return new t(this.config,{actions:pI(pI({},i),e.actions),activities:pI(pI({},o),e.activities),guards:pI(pI({},s),e.guards),services:pI(pI({},a),e.services),delays:pI(pI({},c),e.delays)},null!==n&&void 0!==n?n:this.context)},t.prototype.withContext=function(e){return new t(this.config,this.options,e)},Object.defineProperty(t.prototype,"context",{get:function(){return lz(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:qI(this.states,(function(t){return t.definition})),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return this.definition},Object.defineProperty(t.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var t=this.transitions;return this.__cache.on=t.reduce((function(t,e){return t[e.eventType]=t[e.eventType]||[],t[e.eventType].push(e),t}),{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),t.prototype.getCandidates=function(t){if(this.__cache.candidates[t])return this.__cache.candidates[t];var e=t===bj,n=this.transitions.filter((function(n){var r=n.eventType===t;return e?r:r||n.eventType===Ej}));return this.__cache.candidates[t]=n,n},t.prototype.getDelayedTransitions=function(){var t=this,e=this.config.after;if(!e)return[];var n=function(e,n){var r=lz(e)?"".concat(t.id,":delay[").concat(n,"]"):e,i=$z(r,t.id);return t.onEntry.push(Nz(i,{delay:e})),t.onExit.push(Fz(i)),i},r=uz(e)?e.map((function(t,e){var r=n(t.delay,e);return pI(pI({},t),{event:r})})):JI(Object.keys(e).map((function(t,r){var i=e[t],o=dz(i)?{target:i}:i,s=isNaN(+t)?t:+t,a=n(s,r);return QI(o).map((function(t){return pI(pI({},t),{event:a,delay:s})}))})));return r.map((function(e){var n=e.delay;return pI(pI({},t.formatTransition(e)),{delay:n})}))},t.prototype.getStateNodes=function(t){var e,n=this;if(!t)return[];var r=t instanceof cj?t.value:WI(t,this.delimiter);if(dz(r)){var i=this.getStateNode(r).initial;return void 0!==i?this.getStateNodes((e={},e[r]=i,e)):[this,this.states[r]]}var o=Object.keys(r),s=[this];return s.push.apply(s,yI([],vI(JI(o.map((function(t){return n.getStateNode(t).getStateNodes(r[t])})))),!1)),s},t.prototype.handles=function(t){var e=$I(t);return this.events.includes(e)},t.prototype.resolveState=function(t){var e=t instanceof cj?t:cj.create(t),n=Array.from(Xz([],this.getStateNodes(e.value)));return new cj(pI(pI({},e),{value:this.resolve(e.value),configuration:n,done:nj(n,this),tags:ij(n),machine:this.machine}))},t.prototype.transitionLeafNode=function(t,e,n){var r=this.getStateNode(t),i=r.next(e,n);return i&&i.transitions.length?i:this.next(e,n)},t.prototype.transitionCompoundNode=function(t,e,n){var r=Object.keys(t),i=this.getStateNode(r[0]),o=i._transition(t[r[0]],e,n);return o&&o.transitions.length?o:this.next(e,n)},t.prototype.transitionParallelNode=function(t,e,n){var r,i,o={};try{for(var s=mI(Object.keys(t)),a=s.next();!a.done;a=s.next()){var c=a.value,u=t[c];if(u){var l=this.getStateNode(c),d=l._transition(u,e,n);d&&(o[c]=d)}}}catch(v){r={error:v}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}var h=Object.keys(o).map((function(t){return o[t]})),f=JI(h.map((function(t){return t.transitions}))),p=h.some((function(t){return t.transitions.length>0}));if(!p)return this.next(e,n);var g=JI(h.map((function(t){return t.entrySet}))),m=JI(Object.keys(o).map((function(t){return o[t].configuration})));return{transitions:f,entrySet:g,exitSet:JI(h.map((function(t){return t.exitSet}))),configuration:m,source:e,actions:JI(Object.keys(o).map((function(t){return o[t].actions})))}},t.prototype._transition=function(t,e,n){return dz(t)?this.transitionLeafNode(t,e,n):1===Object.keys(t).length?this.transitionCompoundNode(t,e,n):this.transitionParallelNode(t,e,n)},t.prototype.getTransitionData=function(t,e){return this._transition(t.value,t,yz(e))},t.prototype.next=function(t,e){var n,r,i,o=this,s=e.name,a=[],c=[];try{for(var u=mI(this.getCandidates(s)),l=u.next();!l.done;l=u.next()){var d=l.value,h=d.cond,f=d.in,p=t.context,g=!f||(dz(f)&&Dj(f)?t.matches(WI(this.getStateNodeById(f).path,this.delimiter)):LI(WI(f,this.delimiter),KI(this.path.slice(0,-2))(t.value))),m=!1;try{m=!h||Sz(this.machine,h,p,e,t)}catch(w){throw new Error("Unable to evaluate guard '".concat(h.name||h.type,"' in transition for event '").concat(s,"' in state node '").concat(this.id,"':\n").concat(w.message))}if(m&&g){void 0!==d.target&&(c=d.target),a.push.apply(a,yI([],vI(d.actions),!1)),i=d;break}}}catch(E){n={error:E}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}if(i){if(!c.length)return{transitions:[i],entrySet:[],exitSet:[],configuration:t.value?[this]:[],source:t,actions:a};var v=JI(c.map((function(e){return o.getRelativeStateNodes(e,t.historyValue)}))),y=!!i.internal,b=y?[]:JI(v.map((function(t){return o.nodesFromChild(t)})));return{transitions:[i],entrySet:b,exitSet:y?[]:[this],configuration:v,source:t,actions:a}}},t.prototype.nodesFromChild=function(t){if(t.escapes(this))return[];var e=[],n=t;while(n&&n!==this)e.push(n),n=n.parent;return e.push(this),e},t.prototype.escapes=function(t){if(this===t)return!1;var e=this.parent;while(e){if(e===t)return!1;e=e.parent}return!0},t.prototype.getActions=function(t,e,n,r){var i,o,s,a,c=Xz([],r?this.getStateNodes(r.value):[this]),u=t.configuration.length?Xz(c,t.configuration):c;try{for(var l=mI(u),d=l.next();!d.done;d=l.next()){var h=d.value;tj(c,h)||t.entrySet.push(h)}}catch(S){i={error:S}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}try{for(var f=mI(c),p=f.next();!p.done;p=f.next()){h=p.value;tj(u,h)&&!tj(t.exitSet,h.parent)||t.exitSet.push(h)}}catch(D){s={error:D}}finally{try{p&&!p.done&&(a=f.return)&&a.call(f)}finally{if(s)throw s.error}}var g=JI(t.entrySet.map((function(r){var i=[];if("final"!==r.type)return i;var o=r.parent;if(!o.parent)return i;i.push(Hz(r.id,r.doneData),Hz(o.id,r.doneData?tz(r.doneData,e,n):void 0));var s=o.parent;return"parallel"===s.type&&Kz(s).every((function(e){return nj(t.configuration,e)}))&&i.push(Hz(s.id)),i})));t.exitSet.sort((function(t,e){return e.order-t.order})),t.entrySet.sort((function(t,e){return t.order-e.order}));var m=new Set(t.entrySet),v=new Set(t.exitSet),y=vI([JI(Array.from(m).map((function(t){return yI(yI([],vI(t.activities.map((function(t){return Iz(t)}))),!1),vI(t.onEntry),!1)}))).concat(g.map(Tz)),JI(Array.from(v).map((function(t){return yI(yI([],vI(t.onExit),!1),vI(t.activities.map((function(t){return zz(t)}))),!1)})))],2),b=y[0],w=y[1],E=Az(w.concat(t.actions).concat(b),this.machine.options.actions);return E},t.prototype.transition=function(t,e,n){void 0===t&&(t=this.initialState);var r,i=yz(e);if(t instanceof cj)r=void 0===n?t:this.resolveState(cj.from(t,n));else{var o=dz(t)?this.resolve(UI(this.getResolvedPath(t))):this.resolve(t),s=null!==n&&void 0!==n?n:this.machine.context;r=this.resolveState(cj.from(o,s))}if(!jI&&i.name===Ej)throw new Error("An event cannot have the wildcard type ('".concat(Ej,"')"));if(this.strict&&!this.events.includes(i.name)&&!ez(i.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(i.name,"'"));var a=this._transition(r.value,r,i)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:r,actions:[]},c=Xz([],this.getStateNodes(r.value)),u=a.configuration.length?Xz(c,a.configuration):c;return a.configuration=yI([],vI(u),!1),this.resolveTransition(a,r,r.context,i)},t.prototype.resolveRaisedTransition=function(t,e,n){var r,i=t.actions;return t=this.transition(t,e),t._event=n,t.event=n.data,(r=t.actions).unshift.apply(r,yI([],vI(i),!1)),t},t.prototype.resolveTransition=function(t,e,n,r){var i,o,s=this;void 0===r&&(r=Cz);var a=t.configuration,c=!e||t.transitions.length>0,u=c?Qz(this.machine,a):void 0,l=e?e.historyValue?e.historyValue:t.source?this.machine.historyValue(e.value):void 0:void 0,d=this.getActions(t,n,r,e),h=e?pI({},e.activities):{};try{for(var f=mI(d),p=f.next();!p.done;p=f.next()){var g=p.value;g.type===wI?h[g.activity.id||g.activity.type]=g:g.type===EI&&(h[g.activity.id||g.activity.type]=!1)}}catch(N){i={error:N}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}var m=vI(Uz(this,e,n,r,d,this.machine.config.preserveActionOrder),2),v=m[0],y=m[1],b=vI(iz(v,(function(t){return t.type===SI||t.type===DI&&t.to===hI.Internal})),2),w=b[0],E=b[1],S=v.filter((function(t){var e;return t.type===wI&&(null===(e=t.activity)||void 0===e?void 0:e.type)===AI})),D=S.reduce((function(t,e){return t[e.activity.id]=hj(e.activity,s.machine,y,r),t}),e?pI({},e.children):{}),k=c?t.configuration:e?e.configuration:[],x=nj(k,this),C=new cj({value:u||e.value,context:y,_event:r,_sessionid:e?e._sessionid:null,historyValue:u?l?sz(l,u):void 0:e?e.historyValue:void 0,history:!u||t.source?e:void 0,actions:u?E:[],activities:u?h:e?e.activities:{},events:[],configuration:k,transitions:t.transitions,children:D,done:x,tags:ij(k),machine:this}),_=n!==y;C.changed=r.name===RI||_;var O=C.history;O&&delete O.history;var A=!x&&(this._transient||a.some((function(t){return t._transient})));if(!c&&(!A||r.name===bj))return C;var M=C;if(!x){A&&(M=this.resolveRaisedTransition(M,{type:xI},r));while(w.length){var T=w.shift();M=this.resolveRaisedTransition(M,T._event,r)}}var R=M.changed||(O?!!M.actions.length||_||typeof O.value!==typeof M.value||!oj(M.value,O.value):void 0);return M.changed=R,M.history=O,M},t.prototype.getStateNode=function(t){if(Dj(t))return this.machine.getStateNodeById(t);if(!this.states)throw new Error("Unable to retrieve child state '".concat(t,"' from '").concat(this.id,"'; no child states exist."));var e=this.states[t];if(!e)throw new Error("Child state '".concat(t,"' does not exist on '").concat(this.id,"'"));return e},t.prototype.getStateNodeById=function(t){var e=Dj(t)?t.slice(wj.length):t;if(e===this.id)return this;var n=this.machine.idMap[e];if(!n)throw new Error("Child state node '#".concat(e,"' does not exist on machine '").concat(this.id,"'"));return n},t.prototype.getStateNodeByPath=function(t){if("string"===typeof t&&Dj(t))try{return this.getStateNodeById(t.slice(1))}catch(Xw){}var e=HI(t,this.delimiter).slice(),n=this;while(e.length){var r=e.shift();if(!r.length)break;n=n.getStateNode(r)}return n},t.prototype.resolve=function(t){var e,n=this;if(!t)return this.initialStateValue||Sj;switch(this.type){case"parallel":return qI(this.initialStateValue,(function(e,r){return e?n.getStateNode(r).resolve(t[r]||e):Sj}));case"compound":if(dz(t)){var r=this.getStateNode(t);return"parallel"===r.type||"compound"===r.type?(e={},e[t]=r.initialStateValue,e):t}return Object.keys(t).length?qI(t,(function(t,e){return t?n.getStateNode(e).resolve(t):Sj})):this.initialStateValue||{};default:return t||Sj}},t.prototype.getResolvedPath=function(t){if(Dj(t)){var e=this.machine.idMap[t.slice(wj.length)];if(!e)throw new Error("Unable to find state node '".concat(t,"'"));return e.path}return HI(t,this.delimiter)},Object.defineProperty(t.prototype,"initialStateValue",{get:function(){var t,e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)e=GI(this.states,(function(t){return t.initialStateValue||Sj}),(function(t){return!("history"===t.type)}));else if(void 0!==this.initial){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));e=Gz(this.states[this.initial])?this.initial:(t={},t[this.initial]=this.states[this.initial].initialStateValue,t)}else e={};return this.__cache.initialStateValue=e,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),t.prototype.getInitialState=function(t,e){this._init();var n=this.getStateNodes(t);return this.resolveTransition({configuration:n,entrySet:n,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,null!==e&&void 0!==e?e:this.machine.context,void 0)},Object.defineProperty(t.prototype,"initialState",{get:function(){var t=this.initialStateValue;if(!t)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){var t;if("history"===this.type){var e=this.config;t=dz(e.target)&&Dj(e.target)?UI(this.machine.getStateNodeById(e.target).path.slice(this.path.length-1)):e.target}return t},enumerable:!1,configurable:!0}),t.prototype.getRelativeStateNodes=function(t,e,n){return void 0===n&&(n=!0),n?"history"===t.type?t.resolveHistory(e):t.initialStateNodes:[t]},Object.defineProperty(t.prototype,"initialStateNodes",{get:function(){var t=this;if(Gz(this))return[this];if("compound"===this.type&&!this.initial)return jI||cz(!1,"Compound state node '".concat(this.id,"' has no initial state.")),[this];var e=XI(this.initialStateValue);return JI(e.map((function(e){return t.getFromRelativePath(e)})))},enumerable:!1,configurable:!0}),t.prototype.getFromRelativePath=function(t){if(!t.length)return[this];var e=vI(t),n=e[0],r=e.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(n,"' from node with no states"));var i=this.getStateNode(n);if("history"===i.type)return i.resolveHistory();if(!this.states[n])throw new Error("Child state '".concat(n,"' does not exist on '").concat(this.id,"'"));return this.states[n].getFromRelativePath(r)},t.prototype.historyValue=function(t){if(Object.keys(this.states).length)return{current:t||this.initialStateValue,states:GI(this.states,(function(e,n){if(!t)return e.historyValue();var r=dz(t)?void 0:t[n];return e.historyValue(r||e.initialStateValue)}),(function(t){return!t.history}))}},t.prototype.resolveHistory=function(t){var e=this;if("history"!==this.type)return[this];var n=this.parent;if(!t){var r=this.target;return r?JI(XI(r).map((function(t){return n.getFromRelativePath(t)}))):n.initialStateNodes}var i=YI(n.path,"states")(t).current;return dz(i)?[n.getStateNode(i)]:JI(XI(i).map((function(t){return"deep"===e.history?n.getFromRelativePath(t):[n.states[t[0]]]})))},Object.defineProperty(t.prototype,"stateIds",{get:function(){var t=this,e=JI(Object.keys(this.states).map((function(e){return t.states[e].stateIds})));return[this.id].concat(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){var t,e,n,r;if(this.__cache.events)return this.__cache.events;var i=this.states,o=new Set(this.ownEvents);if(i)try{for(var s=mI(Object.keys(i)),a=s.next();!a.done;a=s.next()){var c=a.value,u=i[c];if(u.states)try{for(var l=(n=void 0,mI(u.events)),d=l.next();!d.done;d=l.next()){var h=d.value;o.add("".concat(h))}}catch(f){n={error:f}}finally{try{d&&!d.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}}catch(p){t={error:p}}finally{try{a&&!a.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ownEvents",{get:function(){var t=new Set(this.transitions.filter((function(t){return!(!t.target&&!t.actions.length&&t.internal)})).map((function(t){return t.eventType})));return Array.from(t)},enumerable:!1,configurable:!0}),t.prototype.resolveTarget=function(t){var e=this;if(void 0!==t)return t.map((function(t){if(!dz(t))return t;var n=t[0]===e.delimiter;if(n&&!e.parent)return e.getStateNodeByPath(t.slice(1));var r=n?e.key+t:t;if(!e.parent)return e.getStateNodeByPath(r);try{var i=e.parent.getStateNodeByPath(r);return i}catch(o){throw new Error("Invalid transition definition for state node '".concat(e.id,"':\n").concat(o.message))}}))},t.prototype.formatTransition=function(t){var e=this,n=wz(t.target),r="internal"in t?t.internal:!n||n.some((function(t){return dz(t)&&t[0]===e.delimiter})),i=this.machine.options.guards,o=this.resolveTarget(n),s=pI(pI({},t),{actions:Az(QI(t.actions)),cond:hz(t.cond,i),target:o,source:this,internal:r,eventType:t.event,toJSON:function(){return pI(pI({},s),{target:s.target?s.target.map((function(t){return"#".concat(t.id)})):void 0,source:"#".concat(e.id)})}});return s},t.prototype.formatTransitions=function(){var t,e,n,r=this;if(this.config.on)if(Array.isArray(this.config.on))n=this.config.on;else{var i=this.config.on,o=Ej,s=i[o],a=void 0===s?[]:s,c=gI(i,["symbol"===typeof o?o:o+""]);n=JI(Object.keys(c).map((function(t){jI||t!==bj||cz(!1,"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. "+'Please check the `on` configuration for "#'.concat(r.id,'".'));var e=bz(t,c[t]);return jI||xj(r,t,e),e})).concat(bz(Ej,a)))}else n=[];var u=this.config.always?bz("",this.config.always):[],l=this.config.onDone?bz(String(Hz(this.id)),this.config.onDone):[];jI||cz(!(this.config.onDone&&!this.parent),'Root nodes cannot have an ".onDone" transition. Please check the config of "'.concat(this.id,'".'));var d=JI(this.invoke.map((function(t){var e=[];return t.onDone&&e.push.apply(e,yI([],vI(bz(String(Vz(t.id)),t.onDone)),!1)),t.onError&&e.push.apply(e,yI([],vI(bz(String(Wz(t.id)),t.onError)),!1)),e}))),h=this.after,f=JI(yI(yI(yI(yI([],vI(l),!1),vI(d),!1),vI(n),!1),vI(u),!1).map((function(t){return QI(t).map((function(t){return r.formatTransition(t)}))})));try{for(var p=mI(h),g=p.next();!g.done;g=p.next()){var m=g.value;f.push(m)}}catch(v){t={error:v}}finally{try{g&&!g.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}return f},t}();function _j(t,e){return new Cj(t,e)}const Oj={initial:"Idle",states:{Idle:{on:{"editing title":"TitleEditing","space pressed":{target:"Panning",actions:"setPanning"},"start dragging":{target:"Dragging",actions:"setDragging"},"update selection":{target:"Selecting",actions:"setSelection"},"create node":{target:"#Intrigue.Editing",actions:"setEditing"},"dblclick node":{target:"#Intrigue.Editing",actions:"setEditing"}}},TitleEditing:{on:{"stop editing title":"Idle"}},Panning:{on:{"space released":{target:"Idle",actions:"clearPanning"}}},Selecting:{on:{"update selection":{target:"Selecting",actions:"setSelection"},"done selecting":{target:"Idle"}}},Dragging:{on:{"drop enter":{target:"Dropping",actions:"setDropping"},"stop dragging":{target:"Idle",actions:["clearDragging","clearDetaching"]},"start detaching":{target:"Detaching",actions:"setDetaching"}}},Dropping:{on:{"drop leave":{target:"Dragging",actions:"clearDropping"},"stop dragging":{target:"Idle",actions:["clearDragging","clearDropping"]}}},Detaching:{on:{detached:{target:"Dragging",actions:"clearDetaching"},"stop detaching":{target:"Idle",actions:"clearDetaching"}}}}},Aj={initial:"Editing",states:{Editing:{on:{"editor blur":{target:"#Intrigue.Viewing",actions:"clearEditing"},"update selection":{target:"#Intrigue.Viewing",actions:["clearEditing","setSelection"]}}}}},Mj={initial:"Selected",states:{Selected:{on:{"click on empty canvas":"#Intrigue.Viewing","drag node handle":"Resizing"}},Resizing:{on:{"drag end":"Selected"}}}},Tj=_j({id:"Intrigue",initial:"Viewing",states:{Viewing:{...Oj},Arranging:{...Mj},Editing:{...Aj}},context:{editing:null,panning:!1,dragging:null,dropping:null,selection:[],detaching:[]}},{actions:{setEditing:qz({editing:(t,e)=>t.editing=e.node}),clearEditing:qz({editing:t=>t.editing=null}),setPanning:qz({panning:t=>t.panning=!0}),clearPanning:qz({panning:t=>t.panning=!1}),setDragging:qz({dragging:(t,e)=>t.dragging=e.node}),clearDragging:qz({dragging:t=>t.dragging=null}),setDropping:qz({dropping:(t,e)=>t.dropping=e.node}),clearDropping:qz({dropping:t=>t.dropping=null}),setDetaching:qz({detaching:(t,e)=>t.detaching=e.detaching}),clearDetaching:qz({detaching:t=>t.detaching=[]}),setSelection:qz({selection:(t,e)=>t.selection=e.selection})}});var Rj={deferEvents:!1},Nj=function(){function t(t){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=pI(pI({},Rj),t)}return t.prototype.initialize=function(t){if(this.initialized=!0,t){if(!this.options.deferEvents)return void this.schedule(t);this.process(t)}this.flushEvents()},t.prototype.schedule=function(t){if(this.initialized&&!this.processingEvent){if(0!==this.queue.length)throw new Error("Event queue should be empty when it is not processing events");this.process(t),this.flushEvents()}else this.queue.push(t)},t.prototype.clear=function(){this.queue=[]},t.prototype.flushEvents=function(){var t=this.queue.shift();while(t)this.process(t),t=this.queue.shift()},t.prototype.process=function(t){this.processingEvent=!0;try{t()}catch(Xw){throw this.clear(),Xw}finally{this.processingEvent=!1}},t}(),Pj=new Map,Bj=0,Fj={bookId:function(){return"x:".concat(Bj++)},register:function(t,e){return Pj.set(t,e),t},get:function(t){return Pj.get(t)},free:function(t){Pj.delete(t)}};function Ij(){return"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:void(jI||console.warn("XState could not find a global object in this environment. Please let the maintainers know and raise an issue here: https://github.com/statelyai/xstate/issues"))}function zj(){var t=Ij();if(t&&"__xstate__"in t)return t.__xstate__}function jj(t){if(Ij()){var e=zj();e&&e.register(t)}}function Lj(t,e){void 0===e&&(e={});var n=t.initialState,r=new Set,i=[],o=!1,s=function(){if(!o){o=!0;while(i.length>0){var e=i.shift();n=t.transition(n,e,c),r.forEach((function(t){return t.next(n)}))}o=!1}},a=mj({id:e.id,send:function(t){i.push(t),s()},getSnapshot:function(){return n},subscribe:function(t,e,i){var o=kz(t,e,i);return r.add(o),o.next(n),{unsubscribe:function(){r.delete(o)}}}}),c={parent:e.parent,self:a,id:e.id||"anonymous",observers:r};return n=t.start?t.start(c):n,a}var $j,Hj={sync:!1,autoForward:!1};(function(t){t[t["NotStarted"]=0]="NotStarted",t[t["Running"]=1]="Running",t[t["Stopped"]=2]="Stopped"})($j||($j={}));var Vj=function(){function t(e,n){var r=this;void 0===n&&(n=t.defaultOptions),this.machine=e,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=$j.NotStarted,this.children=new Map,this.forwardTo=new Set,this.init=this.start,this.send=function(t,e){if(uz(t))return r.batch(t),r.state;var n=yz(vz(t,e));if(r.status===$j.Stopped)return jI||cz(!1,'Event "'.concat(n.name,'" was sent to stopped service "').concat(r.machine.id,'". This service has already reached its final state, and will not transition.\nEvent: ').concat(JSON.stringify(n.data))),r.state;if(r.status!==$j.Running&&!r.options.deferEvents)throw new Error('Event "'.concat(n.name,'" was sent to uninitialized service "').concat(r.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: ').concat(JSON.stringify(n.data)));return r.scheduler.schedule((function(){r.forward(n);var t=r.nextState(n);r.update(t,n)})),r._state},this.sendTo=function(t,e){var n=r.parent&&(e===hI.Parent||r.parent.id===e),i=n?r.parent:dz(e)?r.children.get(e)||Fj.get(e):mz(e)?e:void 0;if(i)"machine"in i?i.send(pI(pI({},t),{name:t.name===TI?"".concat(Wz(r.id)):t.name,origin:r.sessionId})):i.send(t.data);else{if(!n)throw new Error("Unable to send event to child '".concat(e,"' from service '").concat(r.id,"'."));jI||cz(!1,"Service '".concat(r.id,"' has no parent: unable to send event ").concat(t.type))}};var i=pI(pI({},t.defaultOptions),n),o=i.clock,s=i.logger,a=i.parent,c=i.id,u=void 0!==c?c:e.id;this.id=u,this.logger=s,this.clock=o,this.parent=a,this.options=i,this.scheduler=new Nj({deferEvents:this.options.deferEvents}),this.sessionId=Fj.bookId()}return Object.defineProperty(t.prototype,"initialState",{get:function(){var t=this;return this._initialState?this._initialState:lj(this,(function(){return t._initialState=t.machine.initialState,t._initialState}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return jI||cz(this.status!==$j.NotStarted,"Attempted to read state from uninitialized service '".concat(this.id,"'. Make sure the service is started first.")),this._state},enumerable:!1,configurable:!0}),t.prototype.execute=function(t,e){var n,r;try{for(var i=mI(t.actions),o=i.next();!o.done;o=i.next()){var s=o.value;this.exec(s,t,e)}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.update=function(t,e){var n,r,i,o,s,a,c,u,l=this;if(t._sessionid=this.sessionId,this._state=t,this.options.execute&&this.execute(this.state),this.children.forEach((function(t){l.state.children[t.id]=t})),this.devTools&&this.devTools.send(e.data,t),t.event)try{for(var d=mI(this.eventListeners),h=d.next();!h.done;h=d.next()){var f=h.value;f(t.event)}}catch(k){n={error:k}}finally{try{h&&!h.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}try{for(var p=mI(this.listeners),g=p.next();!g.done;g=p.next()){f=g.value;f(t,t.event)}}catch(x){i={error:x}}finally{try{g&&!g.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}try{for(var m=mI(this.contextListeners),v=m.next();!v.done;v=m.next()){var y=v.value;y(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(C){s={error:C}}finally{try{v&&!v.done&&(a=m.return)&&a.call(m)}finally{if(s)throw s.error}}var b=nj(t.configuration||[],this.machine);if(this.state.configuration&&b){var w=t.configuration.find((function(t){return"final"===t.type&&t.parent===l.machine})),E=w&&w.doneData?tz(w.doneData,t.context,e):void 0;try{for(var S=mI(this.doneListeners),D=S.next();!D.done;D=S.next()){f=D.value;f(Vz(this.id,E))}}catch(_){c={error:_}}finally{try{D&&!D.done&&(u=S.return)&&u.call(S)}finally{if(c)throw c.error}}this.stop()}},t.prototype.onTransition=function(t){return this.listeners.add(t),this.status===$j.Running&&t(this.state,this.state.event),this},t.prototype.subscribe=function(t,e,n){var r,i=this;if(!t)return{unsubscribe:function(){}};var o=n;return"function"===typeof t?r=t:(r=t.next.bind(t),o=t.complete.bind(t)),this.listeners.add(r),this.status!==$j.NotStarted&&r(this.state),o&&(this.status===$j.Stopped?o():this.onDone(o)),{unsubscribe:function(){r&&i.listeners.delete(r),o&&i.doneListeners.delete(o)}}},t.prototype.onEvent=function(t){return this.eventListeners.add(t),this},t.prototype.onSend=function(t){return this.sendListeners.add(t),this},t.prototype.onChange=function(t){return this.contextListeners.add(t),this},t.prototype.onStop=function(t){return this.stopListeners.add(t),this},t.prototype.onDone=function(t){return this.doneListeners.add(t),this},t.prototype.off=function(t){return this.listeners.delete(t),this.eventListeners.delete(t),this.sendListeners.delete(t),this.stopListeners.delete(t),this.doneListeners.delete(t),this.contextListeners.delete(t),this},t.prototype.start=function(t){var e=this;if(this.status===$j.Running)return this;this.machine._init(),Fj.register(this.sessionId,this),this.initialized=!0,this.status=$j.Running;var n=void 0===t?this.initialState:lj(this,(function(){return sj(t)?e.machine.resolveState(t):e.machine.resolveState(cj.from(t,e.machine.context))}));return this.options.devTools&&this.attachDev(),this.scheduler.initialize((function(){e.update(n,Cz)})),this},t.prototype.stop=function(){var t,e,n,r,i,o,s,a,c,u,l=this;try{for(var d=mI(this.listeners),h=d.next();!h.done;h=d.next()){var f=h.value;this.listeners.delete(f)}}catch(D){t={error:D}}finally{try{h&&!h.done&&(e=d.return)&&e.call(d)}finally{if(t)throw t.error}}try{for(var p=mI(this.stopListeners),g=p.next();!g.done;g=p.next()){f=g.value;f(),this.stopListeners.delete(f)}}catch(k){n={error:k}}finally{try{g&&!g.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}try{for(var m=mI(this.contextListeners),v=m.next();!v.done;v=m.next()){f=v.value;this.contextListeners.delete(f)}}catch(x){i={error:x}}finally{try{v&&!v.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}try{for(var y=mI(this.doneListeners),b=y.next();!b.done;b=y.next()){f=b.value;this.doneListeners.delete(f)}}catch(C){s={error:C}}finally{try{b&&!b.done&&(a=y.return)&&a.call(y)}finally{if(s)throw s.error}}if(!this.initialized)return this;yI([],vI(this.state.configuration),!1).sort((function(t,e){return e.order-t.order})).forEach((function(t){var e,n;try{for(var r=mI(t.definition.exit),i=r.next();!i.done;i=r.next()){var o=i.value;l.exec(o,l.state)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}})),this.children.forEach((function(t){lz(t.stop)&&t.stop()})),this.children.clear();try{for(var w=mI(Object.keys(this.delayedEventsMap)),E=w.next();!E.done;E=w.next()){var S=E.value;this.clock.clearTimeout(this.delayedEventsMap[S])}}catch(_){c={error:_}}finally{try{E&&!E.done&&(u=w.return)&&u.call(w)}finally{if(c)throw c.error}}return this.scheduler.clear(),this.scheduler=new Nj({deferEvents:this.options.deferEvents}),this.initialized=!1,this.status=$j.Stopped,this._initialState=void 0,Fj.free(this.sessionId),this},t.prototype.batch=function(t){var e=this;if(this.status===$j.NotStarted&&this.options.deferEvents)jI||cz(!1,"".concat(t.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'" and are deferred. Make sure .start() is called for this service.\nEvent: ').concat(JSON.stringify(event)));else if(this.status!==$j.Running)throw new Error("".concat(t.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));this.scheduler.schedule((function(){var n,r,i=e.state,o=!1,s=[],a=function(t){var n=yz(t);e.forward(n),i=lj(e,(function(){return e.machine.transition(i,n)})),s.push.apply(s,yI([],vI(i.actions.map((function(t){return aj(t,i)}))),!1)),o=o||!!i.changed};try{for(var c=mI(t),u=c.next();!u.done;u=c.next()){var l=u.value;a(l)}}catch(d){n={error:d}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}i.changed=o,i.actions=s,e.update(i,yz(t[t.length-1]))}))},t.prototype.sender=function(t){return this.send.bind(this,t)},t.prototype.nextState=function(t){var e=this,n=yz(t);if(0===n.name.indexOf(MI)&&!this.state.nextEvents.some((function(t){return 0===t.indexOf(MI)})))throw n.data.data;var r=lj(this,(function(){return e.machine.transition(e.state,n)}));return r},t.prototype.forward=function(t){var e,n;try{for(var r=mI(this.forwardTo),i=r.next();!i.done;i=r.next()){var o=i.value,s=this.children.get(o);if(!s)throw new Error("Unable to forward event '".concat(t,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));s.send(t)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.defer=function(t){var e=this;this.delayedEventsMap[t.id]=this.clock.setTimeout((function(){t.to?e.sendTo(t._event,t.to):e.send(t._event)}),t.delay)},t.prototype.cancel=function(t){this.clock.clearTimeout(this.delayedEventsMap[t]),delete this.delayedEventsMap[t]},t.prototype.exec=function(t,e,n){void 0===n&&(n=this.machine.options.actions);var r=e.context,i=e._event,o=t.exec||_z(t.type,n),s=lz(o)?o:o?o.exec:t.exec;if(s)try{return s(r,i.data,{action:t,state:this.state,_event:i})}catch(b){throw this.parent&&this.parent.send({type:"xstate.error",data:b}),b}switch(t.type){case DI:var a=t;if("number"===typeof a.delay)return void this.defer(a);a.to?this.sendTo(a._event,a.to):this.send(a._event);break;case kI:this.cancel(t.sendId);break;case wI:if(this.status!==$j.Running)return;var c=t.activity;if(!this.state.activities[c.id||c.type])break;if(c.type===dI.Invoke){var u=Dz(c.src),l=this.machine.options.services?this.machine.options.services[u.type]:void 0,d=c.id,h=c.data;jI||cz(!("forward"in c),"`forward` property is deprecated (found in invocation of '".concat(c.src,"' in in machine '").concat(this.machine.id,"'). ")+"Please use `autoForward` instead.");var f="autoForward"in c?c.autoForward:!!c.forward;if(!l)return void(jI||cz(!1,"No service found for invocation '".concat(c.src,"' in machine '").concat(this.machine.id,"'.")));var p=h?tz(h,r,i):void 0;if("string"===typeof l)return;var g=lz(l)?l(r,i.data,{data:p,src:u,meta:c.meta}):l;if(!g)return;var m=void 0;gz(g)&&(g=p?g.withContext(p):g,m={autoForward:f}),this.spawn(g,d,m)}else this.spawnActivity(c);break;case EI:this.stopChild(t.activity.id);break;case _I:var v=t.label,y=t.value;v?this.logger(v,y):this.logger(y);break;default:jI||cz(!1,"No implementation found for action type '".concat(t.type,"'"));break}},t.prototype.removeChild=function(t){var e;this.children.delete(t),this.forwardTo.delete(t),null===(e=this.state)||void 0===e||delete e.children[t]},t.prototype.stopChild=function(t){var e=this.children.get(t);e&&(this.removeChild(t),lz(e.stop)&&e.stop())},t.prototype.spawn=function(t,e,n){if(nz(t))return this.spawnPromise(Promise.resolve(t),e);if(lz(t))return this.spawnCallback(t,e);if(gj(t))return this.spawnActor(t,e);if(fz(t))return this.spawnObservable(t,e);if(gz(t))return this.spawnMachine(t,pI(pI({},n),{id:e}));if(rz(t))return this.spawnBehavior(t,e);throw new Error('Unable to spawn entity "'.concat(e,'" of type "').concat(typeof t,'".'))},t.prototype.spawnMachine=function(e,n){var r=this;void 0===n&&(n={});var i=new t(e,pI(pI({},this.options),{parent:this,id:n.id||e.id})),o=pI(pI({},Hj),n);o.sync&&i.onTransition((function(t){r.send(RI,{state:t,id:i.id})}));var s=i;return this.children.set(i.id,s),o.autoForward&&this.forwardTo.add(i.id),i.onDone((function(t){r.removeChild(i.id),r.send(yz(t,{origin:i.id}))})).start(),s},t.prototype.spawnBehavior=function(t,e){var n=Lj(t,{id:e,parent:this});return this.children.set(e,n),n},t.prototype.spawnPromise=function(t,e){var n,r,i=this,o=!1;t.then((function(t){o||(r=t,i.removeChild(e),i.send(yz(Vz(e,t),{origin:e})))}),(function(t){if(!o){i.removeChild(e);var n=Wz(e,t);try{i.send(yz(n,{origin:e}))}catch(r){Ez(t,r,e),i.devTools&&i.devTools.send(n,i.state),i.machine.strict&&i.stop()}}}));var s=(n={id:e,send:function(){},subscribe:function(e,n,r){var i=kz(e,n,r),o=!1;return t.then((function(t){o||(i.next(t),o||i.complete())}),(function(t){o||i.error(t)})),{unsubscribe:function(){return o=!0}}},stop:function(){o=!0},toJSON:function(){return{id:e}},getSnapshot:function(){return r}},n[pz]=function(){return this},n);return this.children.set(e,s),s},t.prototype.spawnCallback=function(t,e){var n,r,i,o=this,s=!1,a=new Set,c=new Set,u=function(t){r=t,c.forEach((function(e){return e(t)})),s||o.send(yz(t,{origin:e}))};try{i=t(u,(function(t){a.add(t)}))}catch(d){this.send(Wz(e,d))}if(nz(i))return this.spawnPromise(i,e);var l=(n={id:e,send:function(t){return a.forEach((function(e){return e(t)}))},subscribe:function(t){var e=kz(t);return c.add(e.next),{unsubscribe:function(){c.delete(e.next)}}},stop:function(){s=!0,lz(i)&&i()},toJSON:function(){return{id:e}},getSnapshot:function(){return r}},n[pz]=function(){return this},n);return this.children.set(e,l),l},t.prototype.spawnObservable=function(t,e){var n,r,i=this,o=t.subscribe((function(t){r=t,i.send(yz(t,{origin:e}))}),(function(t){i.removeChild(e),i.send(yz(Wz(e,t),{origin:e}))}),(function(){i.removeChild(e),i.send(yz(Vz(e),{origin:e}))})),s=(n={id:e,send:function(){},subscribe:function(e,n,r){return t.subscribe(e,n,r)},stop:function(){return o.unsubscribe()},getSnapshot:function(){return r},toJSON:function(){return{id:e}}},n[pz]=function(){return this},n);return this.children.set(e,s),s},t.prototype.spawnActor=function(t,e){return this.children.set(e,t),t},t.prototype.spawnActivity=function(t){var e=this.machine.options&&this.machine.options.activities?this.machine.options.activities[t.type]:void 0;if(e){var n=e(this.state.context,t);this.spawnEffect(t.id,n)}else jI||cz(!1,"No implementation found for activity '".concat(t.type,"'"))},t.prototype.spawnEffect=function(t,e){var n;this.children.set(t,(n={id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:e||void 0,getSnapshot:function(){},toJSON:function(){return{id:t}}},n[pz]=function(){return this},n))},t.prototype.attachDev=function(){var t=Ij();if(this.options.devTools&&t){if(t.__REDUX_DEVTOOLS_EXTENSION__){var e="object"===typeof this.options.devTools?this.options.devTools:void 0;this.devTools=t.__REDUX_DEVTOOLS_EXTENSION__.connect(pI(pI({name:this.id,autoPause:!0,stateSanitizer:function(t){return{value:t.value,context:t.context,actions:t.actions}}},e),{features:pI({jump:!1,skip:!1},e?e.features:void 0)}),this.machine),this.devTools.init(this.state)}jj(this)}},t.prototype.toJSON=function(){return{id:this.id}},t.prototype[pz]=function(){return this},t.prototype.getSnapshot=function(){return this.status===$j.NotStarted?this.initialState:this._state},t.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(t,e){return setTimeout(t,e)},clearTimeout:function(t){return clearTimeout(t)}},logger:console.log.bind(console),devTools:!1},t.interpret=Wj,t}();function Wj(t,e){var n=new Vj(t,e);return n}var Uj=function(){return Uj=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Uj.apply(this,arguments)},qj=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},Gj=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return s};function Kj(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=Gj(e,2),s=i[0],a=void 0===s?{}:s,c=i[1],u="function"===typeof t?t():t,l=a.context,d=a.guards,h=a.actions,f=a.activities,p=a.services,g=a.delays,m=a.state,v=qj(a,["context","guards","actions","activities","services","delays","state"]),y={context:l,guards:d,actions:h,activities:f,services:p,delays:g},b=u.withConfig(y,(function(){return Uj(Uj({},u.context),l)})),w=Wj(b,v).start(m?cj.create(m):void 0);return(0,o.bv)((function(){c&&(r=w.subscribe(kz(c)))})),(0,o.Jd)((function(){w.stop(),null===r||void 0===r||r.unsubscribe()})),w}var Yj=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return s};function Xj(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=Yj(e,1),i=r[0],o=void 0===i?{}:i;function s(t){var e=void 0===t.changed&&Object.keys(t.children).length;(t.changed||e)&&(u.value=t)}var a=Kj(t,o,s),c=a.machine.initialState,u=(0,xd.XI)(o.state?cj.create(o.state):c);return{state:u,send:a.send,service:a}}var Jj=(0,o.aZ)({name:"DocumentView",components:{VaNavbar:p.Z,VaNavbarItem:p.n,VaButton:g.Z,VaAvatar:m.Z,VaPopover:v.Z,VaModal:I,VaIcon:k.Z,Avatar:z.Z,Canvas:fI},data(){let t;return t=Array.isArray(this.$route.params.key)?new Gw(this.$route.params.key[0]):new Gw(this.$route.params.key),{document:t,store:t.store,users:[],loading:!0,title:""}},provide(){const t={document:this.document,store:(0,o.Fl)((()=>this.document.store)),state:(0,o.Fl)((()=>this.state)),send:this.send};for(let e of Object.keys(this.state.context))t[e]=(0,o.Fl)((()=>this.state.context[e]));return t},setup(){const{state:t,send:e}=Xj(Tj);return{state:t,send:e}},methods:{broadcastUsername(){const t=L()("en",{maxWords:1});this.document.updateAwareness("name",`Anonymous ${t}`)},onPinch(t){console.log(t.zoom)}},mounted(){this.document.on("synced",(()=>{this.broadcastUsername(),this.loading=!1,this.$route.params.title?(this.store.metadata.name=this.$route.params.title,this.title=this.$route.params.title):this.title=this.store.metadata.name}))},beforeUnmount(){console.log("Closing document..."),this.document.close(),console.log("Document closed.")},watch:{"document.users":{deep:!0,handler(){const t=[];for(let e of Object.keys(this.document.users))t.push(this.document.users[e]);this.users=t}},"document.metadata.name":{deep:!0,handler(){this.title=this.document.metadata.name}}}});const Zj=(0,LF.Z)(Jj,[["render",f],["__scopeId","data-v-e82862a8"]]);var Qj=Zj},1538:function(){},5708:function(t){"use strict";t.exports=JSON.parse('{"fruits":["Ananas","Angrešt","Avokádo","Banán","Bluma","Borůvka","Broskev","Brusinka","Bílý rybíz","Citron","Fík","Granátové jablko","Hrozen","Hruška","Jablko","Jahoda","Kaki","Kiwi","Liči","Malina","Mandarinka","Mango","Meruňka","Mirabelka","Ostružina","Pomelo","Pomeranč","Slíva","Trnka","Třešeň","Višeň","Černý rybíz","Červený rybíz","Švestka"]}')},4324:function(t){"use strict";t.exports=JSON.parse('{"fruits":["Ölpalme","Allackerbeere","Amanatsu","Ananaserdbeere","Anden-Brombeere","Anden-Heidelbeere","Apfel","Apfelbeere","Aprikose","Armenische Brombeere","Atherton-Himbeere","Australische-Limette","Büffelbeeren","Berberitze","Berg-Heidelbeere","Bergamotte","Birnen","Bitterorange","Bollweiler Birne","Boysenbeere","Brasilianische Himbeere","Briançon-Aprikose","Brombeere","Burrawang","Buschmango","Calamondinorange","Chinesische Pflaume","Chinesische Zierquitte","Clementine","Echte Bärentraube","Echte Sauerkirsche","Edel-Pflaume","Elsbeere","Erdbeeren","Europäische Birne","Felsenbirne","Felsenkirsche","Gartenerdbeere","Gewöhnliche Moosbeere","Gewöhnliche Traubenkirsche","Gold-Johannisbeere","Grapefruit","Große Kolumbianische Brombeere","Großfrüchtige Moosbeere","Hagebutte","Heidelbeere","Herzkirsche","Himalaya-Birne","Himalaya-Kirsche","Himbeere","Hunds-Rose","Hyūganatsu","Japanische Aprikose","Japanische Weinbeere","Japanische Zierquitte","Jochelbeere","Kaffir-Limette","Kalifornische Brombeere","Karamelbeere","Kartoffel-Rose","Kirschpflaume","Knorpelkirsche","Korea-Kirsche","Kornelkirsche","Kratzbeere","Kultur-Pflaume","Limequats","Loganbeere","Maibeere","Malus","Mandarine","Marionbeere","Mauritius-Himbeere","Mirabelle","Mispel","Mittelamerikanische Brombeere","Mittelmeer-Brombeere","Moltebeere","Molukkische Brombeere","Moschus-Erdbeere","Nashi-Birne","Nektarine","Nutka-Himbeere","Olive","Oregon-Himbeere","Oregon-Stachelbeere","Pampelmuse","Pappelpflaume","Pfirsich","Pomelo","Pomeranze","Ponkan","Pracht-Himbeere","Preiselbeere","Quitte","Rauschbeere","Rote Heidelbeeren","Rote Johannisbeere","Rote Maulbeere","Ruby Roman Traube","Süße Limette","Süßkirschen","Sand-Kirsche","Sauerkirschen","Schattenmorelle","Schlehbeere","Schwarze Heidelbeere","Schwarze Johannisbeere","Schwarze Krähenbeere","Schwarze Maulbeere","Schwarzer Nachtschatten","Sembikiya Queen Erdbeere","Shallon-Scheinbeere","Stachelbeere","Steinbeere","Strand-Pflaume","Sumach","Tangelo","Tangerine","Tasmanische Scheinbeere","Taybeere","Ugli","Virginische Traubenkirsche","Vogelbeere","Wacholderbeeren","Walderdbeere","Weißdorne","Weiße Johannisbeere","Weiße Maulbeere","Weintraube","Wilde Brombeere","Yuzu","Zimt-Himbeere","Zitrone"]}')},6035:function(t){"use strict";t.exports=JSON.parse('{"fruits":["Apple","Apricot","Avocado","Banana","Boysenberrie","Blueberrie","Bing Cherry","Cherrie","Cantaloupe","Crab apple","Clementine","Cucumber","Damson plum","Dinosaur Eggs","Date","Dewberrie","Dragon Fruit","Elderberry","Eggfruit","Evergreen Huckleberry","Entawak","Fig","Farkleberry","Finger Lime","Grapefruit","Grape","Gooseberrie","Guava","Honeydew melon","Hackberry","Honeycrisp Apple","Indian Prune","Indonesian Lime","Imbe","Indian Fig","Jackfruit","Java Apple","Jambolan","Kiwi","Kaffir Lime","Kumquat","Lime","Longan","Lychee","Loquat","Mango","Mandarin Orange","Mulberry","Melon","Nectarine","Navel Orange","Nashi Pear","Olive","Orange","Ogeechee Lime","Oval Kumquat","Papaya","Persimmon","Paw Paw","Prickly Pear","Peach","Pomegranate","Pineapple","Quince","Queen Anne Cherry","Quararibea cordata","Rambutan","Raspberrie","Rose Hip","Star Fruit","Strawberrie","Sugar Baby Watermelon","Tomato","Tangerine","Tamarind","Tart Cherrie","Ugli Fruit","Uniq Fruit","Ugni","Vanilla Bean","Velvet Pink Banana","Voavanga","Watermelon","Wolfberry","White Mulberry","Xigua","Ximenia caffra fruit","Xango Mangosteen Fruit Juice","Yellow Passion Fruit","Yunnan Hackberry","Yangmei","Zig Zag Vine fruit","Zinfandel Grape","Zucchini"]}')},8447:function(t){"use strict";t.exports=JSON.parse('{"fruits":["Manzana","Mango","Pera","Uva","Kiwi","Melon","Sandia","Durazno","Chabacano","Limon","Fresa","Papaya","Cereza","Guanabana","Zarzamora","Anana","Mandarina","Naranja","Banana","Mora","Arandano","Coco","Nectarina","Granada","Tomate","Aguacate","Pepino","Toronja","Litchi","Ciruela","Higo","Cacahuate","Pistache","Nuez","Avellana","Almendra","Frambuesa","Maracuya","Membrillo"]}')},34:function(t){"use strict";t.exports=JSON.parse('{"fruits":["Abricot","Airelle","Alkékenge","Amélanche","Amande","Ananas","Arbouse","Asimine","Avocat","Banane","Barbadine","Bergamote","Bleuet","Cacao","Camu-camu","Canneberge","Cantaloup","Carambole","Cassis","Cerise de Cayenne","Cerise","Châtaigne","Chayotte","Citron","Clémentine","Coing","Cynorrhodon","Datte","Durian","Épine-vinette","Fe\'i","Feijoa","Figue de barbarie","Figue","Fraise","Framboise","Fruit de la passion","Fruit-à-pain","Girembelle","Goyave","Grenade","Griotte","Groseille","Icaque","Jacque","Jamalac","Jambose rouge","Jujube","Kaki","Kiwaï","Kiwano","Kiwi","Les passiflores","Lime","Litchi","Longane","Mûre","Mandarine","Mangoustan","Mangue","Marron","Melon","Mombin","Myrobolan","Myrte","Myrtille","Nèfle du Japon","Nèfle","Olive","Orange","Pain de singe","Pamplemousse","Papaye","Pastèque","Pêche","Pepino","Pistache","Pitaya","Poire","Pomélos","Pomme de cajou","Pomme de lait","Pomme","Prune de Cythère","Prunes","Quenette","Raisin","Ramboutan","Salak","Sapote","Sapotille","Tamarillo","Tamarin d\'Inde","Tamarin","Taxo","Tomate","Yuzu"]}')},3213:function(t){"use strict";t.exports=JSON.parse('{"fruits":["りんご","アプリコット","アボカド","バナナ","ボイセンベリー","ブルーベリー","アメリカンチェリー","サクランボ","カンタロープ","クラブアップル","クレメンタイン","きゅうり","ダムソン","プルオット","デーツ","デューベリー","ドラゴンフルーツ","エルダーベリー","カニステル","エバーグリーン・ハックルベリー","エンタワク","イチジク","ブラックベリー","フィンガーライム","グレープフルーツ","ぶどう","グースベリー","グアバ","ハネデューメロン","ハックベリー","ハニークリスプ","インディアンプルーン","インドネシアンライム","インベ","インディアン・フィグ","ジャックフルーツ","れんぶ","ジャンボラン","キウイフルーツ","コブミカン","キンカン","ライム","リュウガン","ライチ","びわ","マンゴー","マンダリンオレンジ","クワの実","メロン","ネクタリン","ネーブルオレンジ","ヤマナシ","オリーブ","オレンジ","オゲチーライム","ナガミキンカン","パパイア","柿","ポーポー","ウチワサボテン","桃","ザクロ","パイナップル","マルメロ","クイーン・アン・チェリー","チュパチュパ","ランブータン","ラズベリー","ローズヒップ","スターフルーツ","いちご","シュガーベイビー(スイカ)","トマト","タンジェリン","タマリンド","タートチェリー","アグリフルーツ","ユニ","バニラ","ムサ・ウェルティナ","ボアカンガ","スイカ","クコの実","クワ","キシメニア・カフラ・フルーツ","マンゴスチンジュース","グラナディラ","ヤマモモ","ジグザグつる","ジンファンデル","ズッキーニ"]}')},4667:function(t){"use strict";t.exports=JSON.parse('{"fruits":["Aalbes","Aardbei","Abrikoos","Acerola","Ambarella","Ananas","Appel","Appelbanaan","Avocado","Azarole","Banaan","Bes","Bergamot","Blauwe Bes","Boomtomaat","Bosbes","Bloedsinaasappel","Braam","Broodvrucht","Cactusvijg","Cantaloupe","Cashewappel","Cherimoya","Chinese Kumquat","Citroen","Clementine","Cranberry","Curuba","Custardappel","Dadel","Djamboe Semarang","Druif","Framboos","Goudbes","Granaatappel","Grapefruit","Guave","Honingmeloen","Jackfruit","Japanse Wijnbes","Java-appel","Kei-appel","Kers","Kiwi","Kokosnoot","Komkommer","Kruisbes","Kumquat","Kweepeer","Lijsterbes","Lemmetje","Lotusvrucht","Lychee","Mandarijntje","Mango","Meloen","Mispel","Moerbei","Nance","Nectarine","Olifantsappel","Olijf","Ossenhart","Papaja","Passievrucht","Peer","Persimoen","Perzik","Pomelo","Pompelmoes","Prachtframboos","Pruim","Ramboetan","Rijsbes","Rode Bes","Rozenappel","Rozenbottel","Schroefpalm","Sinaasappel","Stervrucht","Stranddruif","Surinaamse Kers","Tomaat","Tomatillo","Ugli","Vanilleboon","Veenbes","vijg","Vlierbes","Wampi","Waspeer","Witte Bes","Witte Moerbij","Watermeloen","Yang Mei","Zoete Kers","Zoet Zak","Zure Kers","Zuurzak","Zucchini","Zwarte Bes","Zwarte Moerbei","Zwarte Zapote"]}')},2470:function(t){"use strict";t.exports=JSON.parse('{"fruits":["Damasco","Maçã","Abacate","Banana","Mirtilo","Cantalupo","Coco","Nao Maçã","Cereja","Datas","Fig","Groselha","Uvas","Goiaba","Jaca","JambuFruit","kiwi","Limão","Lima","Manga","Mulberry","Muskmelon","Laranja","Mamão","Pera","Abacaxi","Romã","Sapoti","Ameixa","Cal doce","Melancia","Tomate"]}')},248:function(t){"use strict";t.exports=JSON.parse('["aaa","aarp","abarth","abb","abbott","abbvie","abc","able","abogado","abudhabi","ac","academy","accenture","accountant","accountants","aco","actor","ad","adac","ads","adult","ae","aeg","aero","aetna","af","afl","africa","ag","agakhan","agency","ai","aig","airbus","airforce","airtel","akdn","al","alfaromeo","alibaba","alipay","allfinanz","allstate","ally","alsace","alstom","am","amazon","americanexpress","americanfamily","amex","amfam","amica","amsterdam","analytics","android","anquan","anz","ao","aol","apartments","app","apple","aq","aquarelle","ar","arab","aramco","archi","army","arpa","art","arte","as","asda","asia","associates","at","athleta","attorney","au","auction","audi","audible","audio","auspost","author","auto","autos","avianca","aw","aws","ax","axa","az","azure","ba","baby","baidu","banamex","bananarepublic","band","bank","bar","barcelona","barclaycard","barclays","barefoot","bargains","baseball","basketball","bauhaus","bayern","bb","bbc","bbt","bbva","bcg","bcn","bd","be","beats","beauty","beer","bentley","berlin","best","bestbuy","bet","bf","bg","bh","bharti","bi","bible","bid","bike","bing","bingo","bio","biz","bj","black","blackfriday","blockbuster","blog","bloomberg","blue","bm","bms","bmw","bn","bnpparibas","bo","boats","boehringer","bofa","bom","bond","boo","book","booking","bosch","bostik","boston","bot","boutique","box","br","bradesco","bridgestone","broadway","broker","brother","brussels","bs","bt","bugatti","build","builders","business","buy","buzz","bv","bw","by","bz","bzh","ca","cab","cafe","cal","call","calvinklein","cam","camera","camp","cancerresearch","canon","capetown","capital","capitalone","car","caravan","cards","care","career","careers","cars","casa","case","cash","casino","cat","catering","catholic","cba","cbn","cbre","cbs","cc","cd","center","ceo","cern","cf","cfa","cfd","cg","ch","chanel","channel","charity","chase","chat","cheap","chintai","christmas","chrome","church","ci","cipriani","circle","cisco","citadel","citi","citic","city","cityeats","ck","cl","claims","cleaning","click","clinic","clinique","clothing","cloud","club","clubmed","cm","cn","co","coach","codes","coffee","college","cologne","com","comcast","commbank","community","company","compare","computer","comsec","condos","construction","consulting","contact","contractors","cooking","cookingchannel","cool","coop","corsica","country","coupon","coupons","courses","cpa","cr","credit","creditcard","creditunion","cricket","crown","crs","cruise","cruises","cu","cuisinella","cv","cw","cx","cy","cymru","cyou","cz","dabur","dad","dance","data","date","dating","datsun","day","dclk","dds","de","deal","dealer","deals","degree","delivery","dell","deloitte","delta","democrat","dental","dentist","desi","design","dev","dhl","diamonds","diet","digital","direct","directory","discount","discover","dish","diy","dj","dk","dm","dnp","do","docs","doctor","dog","domains","dot","download","drive","dtv","dubai","dunlop","dupont","durban","dvag","dvr","dz","earth","eat","ec","eco","edeka","edu","education","ee","eg","email","emerck","energy","engineer","engineering","enterprises","epson","equipment","er","ericsson","erni","es","esq","estate","et","etisalat","eu","eurovision","eus","events","exchange","expert","exposed","express","extraspace","fage","fail","fairwinds","faith","family","fan","fans","farm","farmers","fashion","fast","fedex","feedback","ferrari","ferrero","fi","fiat","fidelity","fido","film","final","finance","financial","fire","firestone","firmdale","fish","fishing","fit","fitness","fj","fk","flickr","flights","flir","florist","flowers","fly","fm","fo","foo","food","foodnetwork","football","ford","forex","forsale","forum","foundation","fox","fr","free","fresenius","frl","frogans","frontdoor","frontier","ftr","fujitsu","fun","fund","furniture","futbol","fyi","ga","gal","gallery","gallo","gallup","game","games","gap","garden","gay","gb","gbiz","gd","gdn","ge","gea","gent","genting","george","gf","gg","ggee","gh","gi","gift","gifts","gives","giving","gl","glass","gle","global","globo","gm","gmail","gmbh","gmo","gmx","gn","godaddy","gold","goldpoint","golf","goo","goodyear","goog","google","gop","got","gov","gp","gq","gr","grainger","graphics","gratis","green","gripe","grocery","group","gs","gt","gu","guardian","gucci","guge","guide","guitars","guru","gw","gy","hair","hamburg","hangout","haus","hbo","hdfc","hdfcbank","health","healthcare","help","helsinki","here","hermes","hgtv","hiphop","hisamitsu","hitachi","hiv","hk","hkt","hm","hn","hockey","holdings","holiday","homedepot","homegoods","homes","homesense","honda","horse","hospital","host","hosting","hot","hoteles","hotels","hotmail","house","how","hr","hsbc","ht","hu","hughes","hyatt","hyundai","ibm","icbc","ice","icu","id","ie","ieee","ifm","ikano","il","im","imamat","imdb","immo","immobilien","in","inc","industries","infiniti","info","ing","ink","institute","insurance","insure","int","international","intuit","investments","io","ipiranga","iq","ir","irish","is","ismaili","ist","istanbul","it","itau","itv","jaguar","java","jcb","je","jeep","jetzt","jewelry","jio","jll","jm","jmp","jnj","jo","jobs","joburg","jot","joy","jp","jpmorgan","jprs","juegos","juniper","kaufen","kddi","ke","kerryhotels","kerrylogistics","kerryproperties","kfh","kg","kh","ki","kia","kids","kim","kinder","kindle","kitchen","kiwi","km","kn","koeln","komatsu","kosher","kp","kpmg","kpn","kr","krd","kred","kuokgroup","kw","ky","kyoto","kz","la","lacaixa","lamborghini","lamer","lancaster","lancia","land","landrover","lanxess","lasalle","lat","latino","latrobe","law","lawyer","lb","lc","lds","lease","leclerc","lefrak","legal","lego","lexus","lgbt","li","lidl","life","lifeinsurance","lifestyle","lighting","like","lilly","limited","limo","lincoln","linde","link","lipsy","live","living","lk","llc","llp","loan","loans","locker","locus","loft","lol","london","lotte","lotto","love","lpl","lplfinancial","lr","ls","lt","ltd","ltda","lu","lundbeck","luxe","luxury","lv","ly","ma","macys","madrid","maif","maison","makeup","man","management","mango","map","market","marketing","markets","marriott","marshalls","maserati","mattel","mba","mc","mckinsey","md","me","med","media","meet","melbourne","meme","memorial","men","menu","merckmsd","mg","mh","miami","microsoft","mil","mini","mint","mit","mitsubishi","mk","ml","mlb","mls","mm","mma","mn","mo","mobi","mobile","moda","moe","moi","mom","monash","money","monster","mormon","mortgage","moscow","moto","motorcycles","mov","movie","mp","mq","mr","ms","msd","mt","mtn","mtr","mu","museum","music","mutual","mv","mw","mx","my","mz","na","nab","nagoya","name","natura","navy","nba","nc","ne","nec","net","netbank","netflix","network","neustar","new","news","next","nextdirect","nexus","nf","nfl","ng","ngo","nhk","ni","nico","nike","nikon","ninja","nissan","nissay","nl","no","nokia","northwesternmutual","norton","now","nowruz","nowtv","np","nr","nra","nrw","ntt","nu","nyc","nz","obi","observer","office","okinawa","olayan","olayangroup","oldnavy","ollo","om","omega","one","ong","onl","online","ooo","open","oracle","orange","org","organic","origins","osaka","otsuka","ott","ovh","pa","page","panasonic","paris","pars","partners","parts","party","passagens","pay","pccw","pe","pet","pf","pfizer","pg","ph","pharmacy","phd","philips","phone","photo","photography","photos","physio","pics","pictet","pictures","pid","pin","ping","pink","pioneer","pizza","pk","pl","place","play","playstation","plumbing","plus","pm","pn","pnc","pohl","poker","politie","porn","post","pr","pramerica","praxi","press","prime","pro","prod","productions","prof","progressive","promo","properties","property","protection","pru","prudential","ps","pt","pub","pw","pwc","py","qa","qpon","quebec","quest","racing","radio","re","read","realestate","realtor","realty","recipes","red","redstone","redumbrella","rehab","reise","reisen","reit","reliance","ren","rent","rentals","repair","report","republican","rest","restaurant","review","reviews","rexroth","rich","richardli","ricoh","ril","rio","rip","ro","rocher","rocks","rodeo","rogers","room","rs","rsvp","ru","rugby","ruhr","run","rw","rwe","ryukyu","sa","saarland","safe","safety","sakura","sale","salon","samsclub","samsung","sandvik","sandvikcoromant","sanofi","sap","sarl","sas","save","saxo","sb","sbi","sbs","sc","sca","scb","schaeffler","schmidt","scholarships","school","schule","schwarz","science","scot","sd","se","search","seat","secure","security","seek","select","sener","services","ses","seven","sew","sex","sexy","sfr","sg","sh","shangrila","sharp","shaw","shell","shia","shiksha","shoes","shop","shopping","shouji","show","showtime","si","silk","sina","singles","site","sj","sk","ski","skin","sky","skype","sl","sling","sm","smart","smile","sn","sncf","so","soccer","social","softbank","software","sohu","solar","solutions","song","sony","soy","spa","space","sport","spot","sr","srl","ss","st","stada","staples","star","statebank","statefarm","stc","stcgroup","stockholm","storage","store","stream","studio","study","style","su","sucks","supplies","supply","support","surf","surgery","suzuki","sv","swatch","swiss","sx","sy","sydney","systems","sz","tab","taipei","talk","taobao","target","tatamotors","tatar","tattoo","tax","taxi","tc","tci","td","tdk","team","tech","technology","tel","temasek","tennis","teva","tf","tg","th","thd","theater","theatre","tiaa","tickets","tienda","tiffany","tips","tires","tirol","tj","tjmaxx","tjx","tk","tkmaxx","tl","tm","tmall","tn","to","today","tokyo","tools","top","toray","toshiba","total","tours","town","toyota","toys","tr","trade","trading","training","travel","travelchannel","travelers","travelersinsurance","trust","trv","tt","tube","tui","tunes","tushu","tv","tvs","tw","tz","ua","ubank","ubs","ug","uk","unicom","university","uno","uol","ups","us","uy","uz","va","vacations","vana","vanguard","vc","ve","vegas","ventures","verisign","vermögensberater","vermögensberatung","versicherung","vet","vg","vi","viajes","video","vig","viking","villas","vin","vip","virgin","visa","vision","viva","vivo","vlaanderen","vn","vodka","volkswagen","volvo","vote","voting","voto","voyage","vu","vuelos","wales","walmart","walter","wang","wanggou","watch","watches","weather","weatherchannel","webcam","weber","website","wed","wedding","weibo","weir","wf","whoswho","wien","wiki","williamhill","win","windows","wine","winners","wme","wolterskluwer","woodside","work","works","world","wow","ws","wtc","wtf","xbox","xerox","xfinity","xihuan","xin","xxx","xyz","yachts","yahoo","yamaxun","yandex","ye","yodobashi","yoga","yokohama","you","youtube","yt","yun","za","zappos","zara","zero","zip","zm","zone","zuerich","zw","ελ","ευ","бг","бел","дети","ею","католик","ком","мкд","мон","москва","онлайн","орг","рус","рф","сайт","срб","укр","қаз","հայ","ישראל","קום","ابوظبي","اتصالات","ارامكو","الاردن","البحرين","الجزائر","السعودية","العليان","المغرب","امارات","ایران","بارت","بازار","بيتك","بھارت","تونس","سودان","سورية","شبكة","عراق","عرب","عمان","فلسطين","قطر","كاثوليك","كوم","مصر","مليسيا","موريتانيا","موقع","همراه","پاکستان","ڀارت","कॉम","नेट","भारत","भारतम्","भारोत","संगठन","বাংলা","ভারত","ভাৰত","ਭਾਰਤ","ભારત","ଭାରତ","இந்தியா","இலங்கை","சிங்கப்பூர்","భారత్","ಭಾರತ","ഭാരതം","ලංකා","คอม","ไทย","ລາວ","გე","みんな","アマゾン","クラウド","グーグル","コム","ストア","セール","ファッション","ポイント","世界","中信","中国","中國","中文网","亚马逊","企业","佛山","信息","健康","八卦","公司","公益","台湾","台灣","商城","商店","商标","嘉里","嘉里大酒店","在线","大拿","天主教","娱乐","家電","广东","微博","慈善","我爱你","手机","招聘","政务","政府","新加坡","新闻","时尚","書籍","机构","淡马锡","游戏","澳門","点看","移动","组织机构","网址","网店","网站","网络","联通","诺基亚","谷歌","购物","通販","集团","電訊盈科","飞利浦","食品","餐厅","香格里拉","香港","닷넷","닷컴","삼성","한국"]')}}]);
//# sourceMappingURL=document.723b9b8f.js.map