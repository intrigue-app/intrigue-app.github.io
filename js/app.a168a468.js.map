{"version":3,"file":"js/app.a168a468.js","mappings":"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","sources":["webpack://intrigue/./src/App.vue","webpack://intrigue/./src/utils/prop.js","webpack://intrigue/./src/utils/event.js","webpack://intrigue/./src/store/persist.js","webpack://intrigue/./src/store/sync.js","webpack://intrigue/./src/store/undo.js","webpack://intrigue/./src/store/types.js","webpack://intrigue/./src/store/document.js","webpack://intrigue/./src/state/index.js","webpack://intrigue/./src/components/window/TitleBar.vue","webpack://intrigue/./src/components/window/CopyButton.vue","webpack://intrigue/./src/components/window/CopyButton.vue?5bce","webpack://intrigue/./src/components/window/TitleBar.vue?1db7","webpack://intrigue/./src/components/canvas/Canvas.vue","webpack://intrigue/./src/keyboard/index.js","webpack://intrigue/./src/components/canvas/Node.vue","webpack://intrigue/./src/components/canvas/node/Note.vue","webpack://intrigue/./src/components/canvas/node/Note.vue?0e4b","webpack://intrigue/./src/components/canvas/node/Reference.vue","webpack://intrigue/./src/components/canvas/node/Reference.vue?0a06","webpack://intrigue/./src/literature/index.js","webpack://intrigue/./src/components/canvas/Node.vue?ed95","webpack://intrigue/./src/components/canvas/Link.vue","webpack://intrigue/./src/components/canvas/Link.vue?5143","webpack://intrigue/./src/components/canvas/Canvas.vue?de33","webpack://intrigue/./src/components/canvas/PointerTracker.vue","webpack://intrigue/./src/components/canvas/PointerTracker.vue?2721","webpack://intrigue/./src/App.vue?7ccd","webpack://intrigue/./src/main.js","webpack://intrigue/webpack/bootstrap","webpack://intrigue/webpack/runtime/chunk loaded","webpack://intrigue/webpack/runtime/compat get default export","webpack://intrigue/webpack/runtime/create fake namespace object","webpack://intrigue/webpack/runtime/define property getters","webpack://intrigue/webpack/runtime/ensure chunk","webpack://intrigue/webpack/runtime/get javascript chunk filename","webpack://intrigue/webpack/runtime/get mini-css chunk filename","webpack://intrigue/webpack/runtime/global","webpack://intrigue/webpack/runtime/hasOwnProperty shorthand","webpack://intrigue/webpack/runtime/load script","webpack://intrigue/webpack/runtime/make namespace object","webpack://intrigue/webpack/runtime/node module decorator","webpack://intrigue/webpack/runtime/publicPath","webpack://intrigue/webpack/runtime/jsonp chunk loading","webpack://intrigue/webpack/startup"],"sourcesContent":["<template>\n    <TitleBar />\n    <DocumentCanvas />\n    <PointerTracker />\n    <!-- <Debug /> -->\n</template>\n\n<script>\nimport { computed } from 'vue';\nimport isElectron from 'is-electron';\n\n// import Avatar from 'vue-boring-avatars';\n\nimport getRandomFruitsName from 'random-fruits-name';\n\nimport { IntrigueDocument } from '@/store';\nimport intrigueMachine from '@/state';\nimport { useMachine } from '@xstate/vue';\n\nimport TitleBar from '@/components/window/TitleBar.vue';\nimport DocumentCanvas from '@/components/canvas/Canvas.vue';\nimport PointerTracker from '@/components/canvas/PointerTracker.vue';\n// import Debug from '@/components/utils/Debug.vue';\n\nexport default {\n    name: 'App',\n    components: {\n        TitleBar,\n        DocumentCanvas,\n        PointerTracker,\n        // Debug,\n    },\n\n    data() {\n        const document = new IntrigueDocument();\n\n        return {\n            document,\n            store: document.store,\n            users: [],\n            loading: true,\n            title: '',\n            docId: undefined,\n            filePath: undefined,\n        };\n    },\n\n    provide() {\n        // use function syntax so that we can access `this`\n        const injections = {\n            document: this.document,\n            store: computed(() => this.document.store),\n            state: computed(() => this.state),\n            send: this.send,\n            filePath: computed(() => this.filePath),\n        };\n\n        Object.keys(this.state.context).forEach((key) => {\n            injections[key] = computed(() => this.state.context[key]);\n        });\n\n        return injections;\n    },\n\n    setup() {\n        if (isElectron()) {\n            import('electron-log').then((log) => {\n                Object.assign(console, log.functions);\n                log.catchErrors();\n            });\n        }\n\n        const { state, send } = useMachine(intrigueMachine);\n        return { state, send };\n    },\n\n    methods: {\n        broadcastUsername() {\n            const fruit = getRandomFruitsName('en', { maxWords: 1 });\n            this.document.updateAwareness('name', `Anonymous ${fruit}`);\n        },\n    },\n\n    mounted() {\n        this.document.on('synced', () => {\n            this.broadcastUsername();\n            this.loading = false;\n        });\n\n        this.document.on('commit', () => {\n            if (isElectron()) {\n                // eslint-disable-next-line import/no-extraneous-dependencies, global-require\n                import('electron').then(({ ipcRenderer }) => {\n                    ipcRenderer.send('set-edited', true);\n                });\n            }\n        });\n\n        this.document.on('saved', () => {\n            if (isElectron()) {\n                // eslint-disable-next-line import/no-extraneous-dependencies, global-require\n                import('electron').then(({ ipcRenderer }) => {\n                    ipcRenderer.send('set-edited', false);\n                });\n            }\n        });\n\n        // Prevent space from causing scrolling down behavior.\n        window.addEventListener('keydown', (event) => {\n            if (event.code === 'Space' && event.target === document.body) {\n                event.preventDefault();\n            }\n        });\n\n        if (isElectron()) {\n            // eslint-disable-next-line import/no-extraneous-dependencies, global-require\n            import('electron').then(({ ipcRenderer }) => {\n                ipcRenderer.on('new-file', () => {\n                    console.log('[App][ipcRenderer@set-filepath] This is a new empty file.');\n                    this.document.initSync();\n                });\n\n                ipcRenderer.on('set-filepath', (_, filePath) => {\n                    console.log(`[App][ipcRenderer@set-filepath] filePath is ${filePath}.`);\n                    this.filePath = filePath;\n                    this.document.initPersistence(filePath);\n                });\n            });\n        } else {\n            const queryString = window.location.search;\n            const urlParams = new URLSearchParams(queryString);\n            console.log(`[App][mounted] urlParams.document is ${urlParams.get('document')}`);\n            this.document.initSync(urlParams.get('document'));\n            this.document.initPersistence(urlParams.get('document'));\n        }\n    },\n\n    beforeUnmount() {\n        console.log('[App][beforeUnmount] Closing document...');\n        this.document.close();\n        console.log('[App][beforeUnmount] Document closed.');\n    },\n\n    watch: {\n        'document.users': {\n            deep: true,\n            handler() {\n                const users = [];\n                Object.keys(this.document.users).forEach((userId) => {\n                    users.push(this.document.users[userId]);\n                });\n                this.users = users;\n            },\n        },\n        'document.metadata.name': {\n            deep: true,\n            handler() {\n                this.title = this.document.metadata.name;\n            },\n        },\n    },\n};\n</script>\n\n<style lang=\"scss\">\nhtml,\nbody,\n#app {\n    --background: #F8F9F9;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n    background: var(--background);\n}\n\n.noselect {\n    -webkit-touch-callout: none; /* iOS Safari */\n    -webkit-user-select: none; /* Safari */\n    -khtml-user-select: none; /* Konqueror HTML */\n    -moz-user-select: none; /* Old versions of Firefox */\n    -ms-user-select: none; /* Internet Explorer/Edge */\n    user-select: none; /* Non-prefixed version, currently\n                                  supported by Chrome, Edge, Opera and Firefox */\n}\n</style>\n","/* eslint-disable no-plusplus */\n/* eslint-disable no-param-reassign */\nexport default function propByPath(object, path, value) {\n    const parts = path.split('.');\n    const limit = parts.length - 1;\n    for (let i = 0; i < limit; ++i) {\n        const key = parts[i];\n        object = object[key] ?? (object[key] = {});\n    }\n    const key = parts[limit];\n    if (value !== undefined) {\n        object[key] = value;\n    }\n    return object[key];\n}\n","export default class EventEmitter {\n    constructor() {\n        this.events = {};\n        // this.emitter = createNanoEvents();\n    }\n\n    // eslint-disable-next-line\n    on(event, callback) {\n        // return this.emitter.on(event, callback);\n        if (!this.events[event]) this.events[event] = [];\n        this.events[event].push(callback);\n        return () => {\n            this.events[event] = this.events[event]?.filter((i) => callback !== i);\n        };\n    }\n\n    emit(event, ...args) {\n        // this.emitter.emit(event, data);\n        const callbacks = this.events[event] || [];\n        callbacks.forEach((callback) => callback(...args));\n        // for (let i = 0, { length } = callbacks; i < length; i += 1) {\n        //     callbacks[i](...args);\n        // }\n    }\n}\n","import isElectron from 'is-electron';\nimport { encodeStateAsUpdate, applyUpdate } from 'yjs';\n// import * as mutex from 'lib0/mutex';\nimport EventEmitter from '@/utils/event';\n\nexport default class LocalFilePersistence extends EventEmitter {\n    constructor(filePath, doc, fs, debounce) {\n        super();\n        this.doc = doc;\n        this.filePath = filePath;\n        this.timeout = null;\n        this.debounce = debounce || 1000;\n\n        if (isElectron()) {\n            // eslint-disable-next-line global-require\n            const { readFile, writeFile, access } = require('fs/promises');\n            this.readFile = readFile;\n            this.writeFile = writeFile;\n            this.access = access;\n        } else if (fs) {\n            const { readFile, writeFile, access } = fs;\n            this.readFile = readFile;\n            this.writeFile = writeFile;\n            this.access = access;\n        } else {\n            throw new Error('LocalFilePersistence is designed to be used in Electron. Either make sure you are calling this class in an Electron environment, or provide your own async fs implementation.');\n        }\n\n        if (!this.filePath) {\n            this.emit('synced');\n        } else {\n            this.access(this.filePath).then(() => {\n                this.readFile(filePath).then((data) => {\n                    applyUpdate(this.doc, Uint8Array.from(data));\n                    this.emit('synced');\n                });\n            }).catch(() => {\n                this.storeUpdate(null, () => {\n                    this.emit('synced');\n                });\n            });\n        }\n        this.doc.on('update', this.storeUpdate.bind(this));\n    }\n\n    storeUpdate() {\n        if (this.timeout) {\n            clearTimeout(this.timeout);\n            this.timeout = null;\n        }\n        this.timeout = setTimeout(() => {\n            if (!this.filePath) return;\n\n            console.log('[LocalFilePersistence][storeUpdate] Saving to disk.');\n            console.log(encodeStateAsUpdate(this.doc));\n            this.writeFile(this.filePath, encodeStateAsUpdate(this.doc)).then(() => {\n                // if (callback) callback();\n                this.emit('saved');\n            });\n        }, this.debounce);\n    }\n}\n","import { nanoid } from 'nanoid';\nimport * as Vue from 'vue';\nimport { reactive } from 'vue';\nimport isElectron from 'is-electron';\nimport { enableVueBindings, syncedStore, getYjsValue } from '@syncedstore/core';\n\nimport { WebrtcProvider } from 'y-webrtc';\nimport { IndexeddbPersistence } from 'y-indexeddb';\nimport EventEmitter from '@/utils/event';\nimport LocalFilePersistence from './persist';\n\n// import * as T from \"./types\"\n// import { DocTypeDescription } from '@syncedstore/core/types/doc';\n\nenableVueBindings(Vue);\n\nexport default class SyncedDocument extends EventEmitter {\n    constructor(storeStructure) {\n        super();\n        this.syncInitialized = false;\n        this.store = syncedStore(storeStructure);\n        console.warn = () => null; // Supress the numerous warnings generated by SyncedStore.\n    }\n\n    initSync(documentId) {\n        this.users = reactive({});\n        this.store.metadata.id = documentId || nanoid();\n\n        const doc = getYjsValue(this.store);\n        this.syncProvider = new WebrtcProvider(this.store.metadata.id, doc);\n        this.syncProvider.awareness.on('change', this.handleChanges.bind(this));\n\n        // Generate a random user id, then update the awareness.\n        this.userId = nanoid();\n        this.syncProvider.awareness.setLocalStateField('id', this.userId);\n        // if (!this.store.metadata.name) this.store.metadata.name = 'Untitled';\n\n        this.localUser = reactive(this.users[this.userId]);\n\n        this.syncInitialized = true;\n    }\n\n    initPersistence(filePath) {\n        const doc = getYjsValue(this.store);\n        this.saveProvider = isElectron()\n            ? new LocalFilePersistence(filePath, doc)\n            : new IndexeddbPersistence(filePath, doc);\n\n        this.saveProvider.on('synced', () => {\n            console.log('[Sync][saveProvider@synced] Save provider synced.', this.store.metadata.id);\n            if (!this.syncInitialized) this.initSync(this.store.metadata.id);\n            this.emit('synced');\n        });\n\n        this.saveProvider.on('saved', () => {\n            console.log('[Sync][saveProvider@synced] Save provider saved.');\n            this.emit('saved');\n        });\n    }\n\n    close() {\n        this.syncProvider.destroy();\n    }\n\n    // eslint-disable-next-line\n    updateAwareness(key, value) {\n        if (!this.syncInitialized) return;\n        this.syncProvider.awareness.setLocalStateField(key, value);\n    }\n\n    registerAwarenessCallback(key, callback) {\n        this.syncProvider.awareness.on(key, callback);\n    }\n\n    handleChanges() {\n        const awarenessInfo = [...this.syncProvider.awareness.getStates().values()];\n        const onlineUsers = new Set();\n        const offlineUsers = new Set(Object.keys(this.users));\n\n        awarenessInfo.forEach((user) => {\n            onlineUsers.add(user.id);\n            offlineUsers.delete(user.id);\n\n            if (!this.users[user.id]) this.users[user.id] = {};\n            Object.entries(user).forEach(([key, value]) => {\n                this.users[user.id][key] = value;\n            });\n        });\n\n        offlineUsers.forEach((userId) => delete this.users[userId]);\n    }\n\n    stringify() {\n        return JSON.stringify(this.store);\n    }\n}\n","import SyncedDocument from './sync';\n\nexport default class ReversibleDocument extends SyncedDocument {\n    constructor(storeStructure) {\n        super(storeStructure);\n\n        this.inverses = {};\n        this.undoStack = [];\n        this.redoStack = [];\n\n        this.previousTime = -1;\n        this.captureTimeout = 50;\n    }\n\n    registerInverses(actionA, actionB) {\n        this.inverses[actionA] = actionB;\n        this.inverses[actionB] = actionA;\n    }\n\n    commit(action, params) {\n        let inverseParams = null;\n\n        // eslint-disable-next-line\n        const actionFunction = this[action].bind(this);\n\n        if (actionFunction !== undefined) {\n            inverseParams = actionFunction(params);\n        } else {\n            console.error(`[Undo][Commit] There is no method called ${action}() on this object:`, this);\n            return;\n        }\n\n        if (!inverseParams) return;\n\n        const currentTime = Date.now();\n        if (Math.abs(currentTime - this.previousTime) < this.captureTimeout) {\n            console.log('[Undo][Commit] Capturing.');\n            // If the previous item is not in an array, then put it inside one.\n            if (!Array.isArray(this.undoStack[this.undoStack.length - 1])) {\n                this.undoStack[this.undoStack.length - 1] = [\n                    this.undoStack[this.undoStack.length - 1],\n                ];\n            }\n            this.undoStack[this.undoStack.length - 1].push({ action, inverseParams });\n        } else {\n            this.undoStack.push({ action, inverseParams });\n        }\n        this.previousTime = currentTime;\n        // console.log(`[Undo][Commit] ${JSON.stringify(this.undoStack, null, 2)}`);\n\n        this.redoStack = [];\n        this.emit('commit');\n    }\n\n    popStackItem(fromStack, toStack) {\n        if (fromStack.length <= 0) return;\n        let lastRecord = fromStack.pop();\n        if (!lastRecord) return;\n\n        if (!Array.isArray(lastRecord)) lastRecord = [lastRecord];\n\n        const toStackRecord = [];\n        lastRecord.reverse().forEach((item) => {\n            const inverseAction = this.inverses[item.action];\n            if (!inverseAction) {\n                console.error(`There is no registered inverse for ${item.action}().`);\n                return;\n            }\n\n            let inverseParams;\n\n            // eslint-disable-next-line\n            const actionFunction = this[inverseAction].bind(this);\n\n            if (actionFunction !== undefined) {\n                inverseParams = actionFunction(item.inverseParams);\n            } else {\n                console.error(`There is no method called ${inverseAction}() on this object:`, this);\n            }\n\n            toStackRecord.push({\n                action: inverseAction,\n                inverseParams,\n            });\n        });\n\n        toStack.push(toStackRecord.length === 1 ? toStackRecord[0] : toStackRecord);\n    }\n\n    undo() {\n        this.popStackItem(this.undoStack, this.redoStack);\n    }\n\n    redo() {\n        this.popStackItem(this.redoStack, this.undoStack);\n    }\n\n    canUndo() {\n        return this.undoStack.length > 0;\n    }\n\n    canRedo() {\n        return this.redoStack.length > 0;\n    }\n}\n","export default class NodeTypes {\n    static Note = 'note';\n\n    static Reference = 'reference';\n\n    static Area = 'area';\n}\n","/* eslint-disable no-param-reassign */\nimport { reactive } from 'vue';\nimport { nanoid } from 'nanoid';\n\nimport propByPath from '@/utils/prop';\n\nimport ReversibleDocument from './undo';\nimport NodeTypes from './types';\n\nexport default class IntrigueDocument extends ReversibleDocument {\n    constructor() {\n        super({\n            metadata: {},\n            nodes: {},\n            links: {},\n\n            fragment: 'xml',\n        });\n\n        this.remoteSelection = reactive(new Set());\n\n        this.registerInverses('createNode', 'deleteNode');\n        this.registerInverses('createNodes', 'deleteNodes');\n        this.registerInverses('updateNode', 'updateNode');\n        this.registerInverses('updateNodes', 'updateNodes');\n        this.registerInverses('snapNode', 'unsnapNode');\n        this.registerInverses('createLink', 'removeLink');\n    }\n\n    // Note: each function below should return its inverse parameters\n    createNode(nodeItem) {\n        const nodeId = nodeItem.id ? nodeItem.id : nanoid();\n        const node = {\n            id: nodeId,\n            type: nodeItem.type,\n            content: nodeItem.content,\n            links: [],\n            parent: null,\n            children: [],\n            identifier: null,\n            literature: null,\n            x: nodeItem.x ? nodeItem.x : 0,\n            y: nodeItem.y ? nodeItem.y : 0,\n            w: nodeItem.w ? nodeItem.w : 200,\n            currentX: nodeItem.x ? nodeItem.x : 0,\n            currentY: nodeItem.y ? nodeItem.y : 0,\n            currentWidth: nodeItem.w ? nodeItem.w : 200,\n        };\n        if (nodeItem.links) {\n            nodeItem.links.forEach((link) => this.createLink(link));\n        }\n        if (nodeItem.children) {\n            nodeItem.children.forEach((child) => this.snapNode(child));\n        }\n        this.store.nodes[nodeId] = node;\n        return nodeId;\n    }\n\n    createNodes(nodeItems) {\n        const nodeIds = [];\n        const newLinks = [];\n        const newChildren = [];\n        nodeItems.forEach((item) => {\n            // Extract all links to be created.\n            // This is to delay link creation until all nodes are first created.\n            if (item.links) {\n                item.links.forEach((link) => newLinks.push(link));\n                delete item.links;\n            }\n            // Extract all children to be snapped.\n            // Same as above.\n            if (item.children) {\n                item.children.forEach((child) => newChildren.push(child));\n                delete item.children;\n            }\n\n            const nodeId = this.createNode(item);\n            nodeIds.push(nodeId);\n        });\n\n        newLinks.forEach((link) => this.createLink(link));\n\n        newChildren.forEach((pairInfo) => this.snapNode(pairInfo));\n\n        return nodeIds;\n    }\n\n    deleteNode(nodeId) {\n        const node = { ...this.store.nodes[nodeId] };\n        const removedLinks = [];\n        const unsnappedChildren = [];\n        node.links.forEach((linkId) => {\n            removedLinks.push(this.removeLink(linkId));\n        });\n        node.children.forEach((childId) => {\n            unsnappedChildren.push(\n                this.unsnapNode({\n                    source: node.id,\n                    target: childId,\n                }),\n            );\n        });\n        node.links = removedLinks;\n        node.children = unsnappedChildren;\n        delete this.store.nodes[nodeId];\n        return node;\n    }\n\n    deleteNodes(nodeIds) {\n        const nodes = [];\n        nodeIds.forEach((nodeId) => {\n            const node = this.deleteNode(nodeId);\n            nodes.push(node);\n        });\n        return nodes;\n    }\n\n    updateNode(update) {\n        const node = this.store.nodes[update.id];\n        const inverseParams = {\n            id: update.id,\n        };\n        // Update parameters by a number\n        if (update.by) {\n            inverseParams.by = {};\n            Object.entries(update.by).forEach(([path, value]) => {\n                const originalValue = propByPath(node, path);\n                if (typeof originalValue !== 'number') {\n                    console.error('Only number properties can be updated by a number!');\n                    return;\n                }\n                propByPath(node, path, originalValue + value);\n                inverseParams.by[path] = -originalValue;\n            });\n        }\n        // Set parameters to values\n        if (update.set) {\n            inverseParams.set = {};\n            Object.entries(update.set).forEach(([path, value]) => {\n                const originalValue = propByPath(node, path);\n                propByPath(node, path, value);\n                inverseParams.set[path] = originalValue;\n            });\n        }\n        return inverseParams;\n    }\n\n    updateNodes(update) {\n        const inverseParams = {\n            id: [...update.id],\n        };\n\n        if (update.by) {\n            inverseParams.by = {};\n            Object.entries(update.by).forEach(([path, value]) => {\n                inverseParams.by[path] = -value;\n            });\n            update.id.forEach((nodeId) => {\n                this.updateNode({\n                    id: nodeId,\n                    by: update.by,\n                });\n            });\n        }\n\n        if (update.set) {\n            inverseParams.set = {};\n            update.id.forEach((nodeId) => {\n                inverseParams.set[nodeId] = {};\n                const node = this.store.nodes[nodeId];\n                Object.keys(update.set[nodeId]).forEach((path) => {\n                    inverseParams.set[nodeId][path] = propByPath(node, path);\n                });\n                this.updateNode({\n                    id: nodeId,\n                    set: update.set[nodeId],\n                });\n            });\n        }\n\n        return inverseParams;\n    }\n\n    snapNode(nodes) {\n        const inverseParams = {};\n        if (!nodes.source || !nodes.target) return false;\n        const parent = this.store.nodes[nodes.source];\n        const child = this.store.nodes[nodes.target];\n\n        // Areas can have multiple children\n        if (parent.type === NodeTypes.Area) {\n            parent.children.push(nodes.target);\n            // Remove potential duplicates\n            parent.children.filter((item, i) => parent.children.indexOf(item) === i);\n            child.parent = parent.id;\n\n            inverseParams.source = nodes.source;\n            inverseParams.target = nodes.target;\n\n            // Other nodes may only have one child.\n        } else if (parent.children.length === 0) {\n            parent.children.push(nodes.target);\n            // Remove potential duplicates\n            parent.children.filter((item, i) => parent.children.indexOf(item) === i);\n            child.parent = parent.id;\n\n            inverseParams.source = nodes.source;\n            inverseParams.target = nodes.target;\n        }\n        return inverseParams.source ? inverseParams : false;\n    }\n\n    unsnapNode(nodes) {\n        const inverseParams = {};\n        if (!nodes.source || !nodes.target) return false;\n        const parent = this.store.nodes[nodes.source];\n        const child = this.store.nodes[nodes.target];\n\n        const childIndex = parent.children.indexOf(nodes.target);\n        if (childIndex > -1) {\n            parent.children.splice(childIndex, 1);\n            child.parent = null;\n            inverseParams.source = nodes.source;\n            inverseParams.target = nodes.target;\n        }\n\n        return inverseParams.source ? inverseParams : false;\n    }\n\n    createLink(params) {\n        const source = this.store.nodes[params.source];\n        const target = this.store.nodes[params.target];\n\n        const linkId = params.id ? params.id : nanoid();\n        const link = {\n            id: linkId,\n            source: params.source,\n            target: params.target,\n        };\n        this.store.links[linkId] = link;\n\n        source.links.push(linkId);\n        source.links.filter((item, i) => source.links.indexOf(item) === i);\n        target.links.push(linkId);\n        target.links.filter((item, i) => target.links.indexOf(item) === i);\n\n        return linkId;\n    }\n\n    removeLink(linkId) {\n        const link = { ...this.store.links[linkId] };\n        const source = this.store.nodes[link.source];\n        const target = this.store.nodes[link.target];\n\n        source.links.splice(source.links.indexOf(linkId), 1);\n        target.links.splice(target.links.indexOf(linkId), 1);\n\n        delete this.store.links[linkId];\n        return link;\n    }\n\n    findLinkByNodeIds(sourceId, targetId) {\n        console.log(sourceId, targetId);\n        const finds = Object.keys(this.store.links).filter((linkId) => {\n            const link = this.store.links[linkId];\n            return link.source === sourceId && link.target === targetId;\n        });\n        return finds.length > 0 ? finds[0] : false;\n    }\n}\n","/* eslint-disable no-param-reassign */\n/* eslint-disable no-return-assign */\n\nimport { createMachine, assign } from 'xstate';\n\nconst ViewingState = {\n    initial: 'Idle',\n    states: {\n        Idle: {\n            on: {\n                'editing title': 'TitleEditing',\n                'space pressed': { target: 'Panning', actions: 'setPanning' },\n                'start dragging': { target: 'Dragging', actions: 'setDragging' },\n                'start linking': { target: 'Linking', actions: 'setLinking' },\n                'update selection': { target: 'Selecting', actions: 'setSelection' },\n                'create node': { target: '#Intrigue.Editing', actions: 'setEditing' },\n                'delete node': { target: 'Idle', actions: 'clearSelection' },\n                'dblclick node': { target: '#Intrigue.Editing', actions: 'setEditing' },\n            },\n        },\n\n        TitleEditing: {\n            on: { 'stop editing title': 'Idle' },\n        },\n\n        Panning: {\n            on: {\n                'space released': { target: 'Idle', actions: 'clearPanning' },\n            },\n        },\n\n        Selecting: {\n            on: {\n                'update selection': { target: 'Selecting', actions: 'setSelection' },\n                'done selecting': { target: 'Idle' },\n            },\n        },\n\n        Dragging: {\n            on: {\n                'drop enter': { target: 'Dropping', actions: 'setDropping' },\n                'stop dragging': { target: 'Idle', actions: ['clearDragging', 'clearDetaching'] },\n                'start detaching': { target: 'Detaching', actions: 'setDetaching' },\n            },\n        },\n\n        Dropping: {\n            on: {\n                'drop leave': { target: 'Dragging', actions: 'clearDropping' },\n                'stop dragging': { target: 'Idle', actions: ['clearDragging', 'clearDropping'] },\n            },\n        },\n\n        Detaching: {\n            on: {\n                detached: { target: 'Dragging', actions: 'clearDetaching' },\n                'stop detaching': { target: 'Idle', actions: 'clearDetaching' },\n            },\n        },\n\n        Linking: {\n            on: {\n                'update selection': { target: 'Idle', actions: ['clearLinking', 'setSelection'] },\n                'click on empty canvas': { target: 'Idle', actions: 'clearLinking' },\n                'create node': { target: '#Intrigue.Editing', actions: ['clearLinking', 'setEditing'] },\n            },\n        },\n    },\n};\n\nconst EditingState = {\n    initial: 'Editing',\n    states: {\n        Editing: {\n            on: {\n                'editor blur': {\n                    target: '#Intrigue.Viewing',\n                    actions: 'clearEditing',\n                },\n                'update selection': {\n                    target: '#Intrigue.Viewing',\n                    actions: ['clearEditing', 'setSelection'],\n                },\n            },\n        },\n    },\n};\n\nconst ArrangingState = {\n    initial: 'Selected',\n    states: {\n        Selected: {\n            on: {\n                'click on empty canvas': '#Intrigue.Viewing',\n                'drag node handle': 'Resizing',\n            },\n        },\n\n        Resizing: {\n            on: {\n                'drag end': 'Selected',\n            },\n        },\n    },\n};\n\nconst intrigueMachine = createMachine(\n    {\n        id: 'Intrigue',\n        initial: 'Viewing',\n        states: {\n            Viewing: { ...ViewingState },\n            Arranging: { ...ArrangingState },\n            Editing: { ...EditingState },\n        },\n        context: {\n            editing: null,\n            panning: false,\n            dragging: null,\n            dropping: null,\n            selection: [],\n            detaching: [],\n            linking: null,\n        },\n    },\n    {\n        actions: {\n            setEditing: assign({\n                editing: (context, event) => (context.editing = event.node),\n            }),\n\n            clearEditing: assign({\n                editing: (context) => (context.editing = null),\n            }),\n\n            setPanning: assign({\n                panning: (context) => (context.panning = true),\n            }),\n\n            clearPanning: assign({\n                panning: (context) => (context.panning = false),\n            }),\n\n            setDragging: assign({\n                dragging: (context, event) => (context.dragging = event.node),\n            }),\n\n            clearDragging: assign({\n                dragging: (context) => (context.dragging = null),\n            }),\n\n            setDropping: assign({\n                dropping: (context, event) => (context.dropping = event.node),\n            }),\n\n            clearDropping: assign({\n                dropping: (context) => (context.dropping = null),\n            }),\n\n            setDetaching: assign({\n                detaching: (context, event) => (context.detaching = event.detaching),\n            }),\n\n            clearDetaching: assign({\n                detaching: (context) => (context.detaching = []),\n            }),\n\n            setSelection: assign({\n                selection: (context, event) => (context.selection = event.selection),\n            }),\n\n            clearSelection: assign({\n                selection: (context) => (context.selection = []),\n            }),\n\n            setLinking: assign({\n                linking: (context, event) => (context.linking = event.node),\n            }),\n\n            clearLinking: assign({\n                linking: (context) => (context.linking = null),\n            }),\n        },\n    },\n);\n\nexport default intrigueMachine;\n// export const state = interpret(intrigueMachine).start();\n","<template>\n    <div class=\"titlebar-container\">\n        <a-row v-if=\"electron\" class=\"window noselect\" justify=\"center\" align=\"center\">\n            <a-col :span=\"8\">\n                <a-button-group style=\"margin-left: 5rem;\">\n                    <a-button type=\"text\" size=\"mini\"\n                        :disabled=\"!document.canUndo()\"\n                        @click=\"document.undo()\"\n                    >\n                        <template #icon><icon-undo /></template>\n                    </a-button>\n\n                    <a-button type=\"text\" size=\"mini\"\n                        :disabled=\"!document.canRedo()\"\n                        @click=\"document.redo()\"\n                    >\n                        <template #icon><icon-redo /></template>\n                    </a-button>\n                </a-button-group>\n            </a-col>\n            <a-col :span=\"8\" align=\"center\">\n                <b>{{fileName}}</b>\n            </a-col>\n            <a-col :span=\"8\" align=\"right\" style=\"padding-right: 0.5rem\">\n                <CopyButton size=\"mini\" :text=\"shareLink\">Share</CopyButton>\n            </a-col>\n        </a-row>\n\n        <a-row v-else class=\"browser noselect\" justify=\"center\" align=\"center\">\n            <a-col :span=\"8\">\n                <a-button-group style=\"margin-left: 1rem;\">\n                    <a-button type=\"text\" size=\"small\"\n                        :disabled=\"!document.canUndo()\"\n                        @click=\"document.undo()\"\n                    >\n                        <template #icon><icon-undo /></template>\n                    </a-button>\n\n                    <a-button type=\"text\" size=\"small\"\n                        :disabled=\"!document.canRedo()\"\n                        @click=\"document.redo()\"\n                    >\n                        <template #icon><icon-redo /></template>\n                    </a-button>\n                </a-button-group>\n            </a-col>\n            <a-col :span=\"8\" align=\"center\">\n            </a-col>\n            <a-col :span=\"8\" align=\"right\" style=\"padding-right: 0.5rem\">\n                <CopyButton size=\"small\" :text=\"shareLink\">Share</CopyButton>\n            </a-col>\n        </a-row>\n    </div>\n</template>\n\n<script>\nimport isElectron from 'is-electron';\nimport CopyButton from './CopyButton.vue';\n\nexport default {\n    name: 'TitleBar',\n    inject: ['store', 'document', 'selection', 'filePath'],\n\n    components: {\n        CopyButton,\n    },\n\n    data() {\n        return {\n            electron: isElectron(),\n        };\n    },\n\n    computed: {\n        fileName() {\n            // eslint-disable-next-line global-require\n            const { basename } = require('path');\n            return this.filePath.value ? basename(this.filePath.value) : 'Untitled';\n        },\n\n        shareLink() {\n            return `https://intrigue-app.github.io/?document=${this.store.value.metadata.id}`;\n        },\n    },\n};\n</script>\n\n<style scoped>\n.window {\n    position: fixed;\n    width: 100%;\n    height: 2rem;\n    -webkit-app-region: drag;\n    z-index: 10000;\n    background: linear-gradient(var(--background) 10%, transparent 100%)\n}\n\n.browser {\n    position: fixed;\n    width: 100%;\n    height: 2rem;\n    z-index: 10000;\n}\n</style>\n","<template>\n    <a-button\n        :type=\"type\"\n        :shape=\"shape\"\n        :size=\"size\"\n        :status=\"status\"\n        :disabled=\"copied\"\n        @click=\"copy\"\n    >\n        <slot v-if=\"!copied\"/>\n        <span v-else>Copied!</span>\n    </a-button>\n</template>\n\n<script>\nimport ultralightCopy from 'copy-to-clipboard-ultralight';\n\nexport default {\n    name: 'CopyButton',\n    props: {\n        size: String,\n        shape: String,\n        type: String,\n        status: String,\n        text: String,\n    },\n\n    data() {\n        return {\n            copied: false,\n            timer: null,\n        };\n    },\n\n    methods: {\n        copy() {\n            if (ultralightCopy(this.text)) {\n                this.copied = true;\n                if (this.timer) clearTimeout(this.timer);\n                this.timer = setTimeout(() => {\n                    this.copied = false;\n                }, 1000);\n            } else {\n                this.$message.error('Error copying to clipboard!');\n            }\n        },\n    },\n};\n</script>\n","import { render } from \"./CopyButton.vue?vue&type=template&id=11d5bf2b\"\nimport script from \"./CopyButton.vue?vue&type=script&lang=js\"\nexport * from \"./CopyButton.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/shauna/Development/intrigue-dev/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./TitleBar.vue?vue&type=template&id=5ce49f0c&scoped=true\"\nimport script from \"./TitleBar.vue?vue&type=script&lang=js\"\nexport * from \"./TitleBar.vue?vue&type=script&lang=js\"\n\nimport \"./TitleBar.vue?vue&type=style&index=0&id=5ce49f0c&scoped=true&lang=css\"\n\nimport exportComponent from \"/Users/shauna/Development/intrigue-dev/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-5ce49f0c\"]])\n\nexport default __exports__","<template>\n    <div style=\"width: 100%; height: 100%;\">\n        <vue-infinite-viewer\n            class=\"canvas\"\n            ref=\"canvas\"\n            :style=\"{\n                'background-position': `${-x * zoom}px ${-y * zoom}px`,\n                'background-size': `${13 * zoom}px ${13 * zoom}px`,\n                '--resize-handle-height': `${activeNodeHeight}px`,\n            }\"\n            :maxPinchWheel=\"10\"\n            @scroll=\"panCanvas\"\n            @pinch=\"zoomCanvas\"\n            @dblclick=\"newNode\"\n        >\n            <div class=\"viewport\">\n                <IntrigueLink\n                    v-for=\"link in store.value.links\"\n                    :key=\"link.id\"\n                    :ref=\"link.id\"\n                    :source=\"link.source\"\n                    :target=\"link.target\"\n                />\n\n                <IntrigueLink\n                    v-if=\"linking.value\"\n                    :source=\"linking.value\"\n                    target=\"pointer-location\"\n                />\n\n                <IntrigueNode\n                    v-for=\"node in store.value.nodes\"\n                    :key=\"node.id\"\n                    :ref=\"node.id\"\n                    :node=\"node\"\n                    :selected=\"selection.some((t) => t.id === node.id)\"\n                    @click=\"tryLinking(node.id)\"\n                    @dblclick.stop=\"doubleClickNode(node)\"\n                    @update-dimensions=\"$refs.moveable.updateRect\"\n                />\n\n                <!-- <div v-for=\"user in document.users\" :key=\"user.id\">\n                    <Cursor\n                        v-if=\"document.localUser.id !== user.id\"\n                        :id=\"user.id\"\n                        :name=\"user.name\"\n                        :x=\"user.cursorX\"\n                        :y=\"user.cursorY\"\n                    />\n                </div> -->\n\n                <Moveable\n                    ref=\"moveable\"\n                    className=\"moveable\"\n                    :target=\"selection\"\n                    :draggable=\"true\"\n                    :resizable=\"shouldResize\"\n                    :renderDirections=\"['e']\"\n                    @clickGroup=\"cancelSelectionWhenClickEmpty\"\n                    @drag=\"dragNodes\"\n                    @dragGroup=\"dragNodes\"\n                    @dragEnd=\"commitNodePositions\"\n                    @dragGroupEnd=\"commitNodePositions\"\n                    @resize=\"resizeNode\"\n                    @resizeEnd=\"commitNodeSize\"\n                />\n            </div>\n        </vue-infinite-viewer>\n        <VueSelecto\n            ref=\"selecto\"\n            dragContainer=\".canvas\"\n            :selectableTargets=\"['.node.selectable']\"\n            :selectByClick=\"true\"\n            :selectFromInside=\"false\"\n            :toggleContinueSelect=\"['shift']\"\n            :keyContainer=\"window\"\n            :hitRate=\"0\"\n            :ratio=\"0\"\n            @dragStart=\"preventSelectionWhenDragging\"\n            @select=\"selectNode\"\n            @selectEnd=\"commitSelections\"\n        />\n        <svg class=\"links\" id=\"links\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n        />\n    </div>\n</template>\n\n<script>\nimport { defineComponent, computed } from 'vue';\n\nimport { VueInfiniteViewer } from 'vue3-infinite-viewer';\nimport Moveable from 'vue3-moveable';\nimport { VueSelecto } from 'vue3-selecto';\n\nimport { nanoid } from 'nanoid';\n\nimport { NodeTypes } from '@/store';\nimport Keyboard from '@/keyboard';\n\nimport IntrigueNode from '@/components/canvas/Node.vue';\nimport IntrigueLink from '@/components/canvas/Link.vue';\n// import Cursor from '@/components/canvas/Cursor.vue';\n\nexport default defineComponent({\n    name: 'IntrigueCanvas',\n    inject: ['document', 'store', 'state', 'send', 'editing', 'dragging', 'dropping', 'detaching', 'linking'],\n    components: {\n        VueInfiniteViewer,\n        Moveable,\n        VueSelecto,\n        IntrigueNode,\n        IntrigueLink,\n        // Cursor,\n    },\n\n    provide() {\n        return {\n            x: computed(() => this.x),\n            y: computed(() => this.y),\n            zoom: computed(() => this.zoom),\n        };\n    },\n\n    data() {\n        return {\n            x: 0,\n            y: 0,\n            zoom: 1,\n            selection: [],\n            keyboard: new Keyboard(),\n        };\n    },\n\n    methods: {\n        // Data editing methods\n\n        newNode(event) {\n            const mapped = this.mapMousePosition(event.clientX, event.clientY);\n            const nodeId = nanoid();\n            this.document.commit('createNode', {\n                id: nodeId,\n                type: NodeTypes.Note,\n                content: '',\n                x: mapped.x - 14,\n                y: mapped.y - 10,\n                w: 200,\n                h: 15,\n            });\n            this.send({\n                type: 'create node',\n                node: nodeId,\n            });\n            // if (Object.keys(this.store.value.nodes).length === 2) {\n            //     const [source, target] = Object.keys(this.store.value.nodes);\n            //     this.document.commit('createLink', { source, target });\n            //     // arrowLine(`[id=\"${nodeIds[0]}\"]`, `[id=\"${nodeIds[1]}\"]`);\n            // }\n        },\n\n        doubleClickNode(node) {\n            this.send({\n                type: 'dblclick node',\n                node: node.id,\n            });\n            // console.log(this.state.value, this.editing.value);\n        },\n\n        deleteNodes(event) {\n            if (this.editing.value) return;\n            const selectedIds = this.selection.map((el) => el.id);\n            console.log(`[Canvas][deleteNodes] ${selectedIds}`);\n            this.selection = [];\n            this.send('delete node');\n            this.document.commit('deleteNodes', selectedIds);\n            // console.log(selectedIds);\n            event.preventDefault();\n        },\n\n        undo(event) {\n            if (this.editing.value === null) {\n                this.document.undo();\n                event.preventDefault();\n            }\n        },\n\n        redo(event) {\n            if (this.editing.value === null) {\n                this.document.redo();\n                event.preventDefault();\n            }\n        },\n\n        // Node wrangling methods (dragging, resizing, selecting, etc)\n        panCanvas(event) {\n            this.x = event.scrollLeft;\n            this.y = event.scrollTop;\n            this.document.updateAwareness('x', this.x);\n            this.document.updateAwareness('y', this.y);\n        },\n\n        zoomCanvas(event) {\n            this.zoom = event.zoom;\n            this.$refs.canvas.setZoom(event.zoom);\n        },\n\n        cancelSelectionWhenClickEmpty(e) {\n            this.$refs.selecto.clickTarget(e.inputEvent, e.inputTarget);\n        },\n\n        sendDragStartMessage(event) {\n            if (!event.events && event.target) {\n                this.send({\n                    type: 'start dragging',\n                    node: event.target.id,\n                });\n            } else if (event.targets) {\n                event.target.classList.add('clickthrough');\n                // console.log(event.target);\n                event.targets.some((target) => {\n                    const rect = target.getBoundingClientRect();\n                    if (\n                        rect.left <= event.clientX\n                        && rect.right >= event.clientX\n                        && rect.top <= event.clientY\n                        && rect.bottom >= event.clientY\n                    ) {\n                        this.send({\n                            type: 'start dragging',\n                            node: target.id,\n                        });\n                        return false;\n                    }\n                    return true;\n                });\n            }\n        },\n\n        dragNodes(event) {\n            this.sendDragStartMessage(event);\n\n            let events;\n            if (!event.events && event.target) {\n                // Dragging only one node\n                events = [event];\n            } else if (event.events) {\n                // Dragging multiple nodes\n                events = event.events;\n            }\n\n            // See if any nodes in the current selection will be detached from parent if moved.\n            const nodes = events.map((e) => this.store.value.nodes[e.target.id]);\n            const nodeIds = events.map((e) => e.target.id);\n            const toDetach = [];\n            nodes.forEach((node) => {\n                if (node.parent && !nodeIds.includes(node.parent)) {\n                    toDetach.push({\n                        source: node.parent,\n                        target: node.id,\n                    });\n                }\n            });\n            if (toDetach.length > 0) {\n                this.send({ type: 'start detaching', detaching: toDetach });\n                const distance = Math.sqrt(\n                    event.dist[0] * event.dist[0] + event.dist[1] * event.dist[1],\n                );\n                // console.log(distance);\n\n                if (distance > 30) {\n                    // Detach these nodes\n                    this.send('detached');\n                    toDetach.forEach((pair) => {\n                        this.document.commit('unsnapNode', pair);\n                    });\n                } else {\n                    return;\n                }\n            }\n\n            // We don't commit here because we don't want to\n            // leave undo history for rapid-firing events.\n            events.forEach((e) => {\n                const node = this.store.value.nodes[e.target.id];\n                if (node.parent) return;\n                this.document.updateNode({\n                    id: e.target.id,\n                    set: {\n                        currentX: e.translate[0],\n                        currentY: e.translate[1],\n                    },\n                });\n            });\n        },\n\n        commitNodePositions(event) {\n            // If dropping has value, then handle that first.\n            // Note that in this case, the action to be commited is snapNode,\n            // not updateNodes\n            if (this.dropping.value) {\n                console.log('[Canvas][commitNodePositions] Dropping', this.dragging.value, 'on', this.dropping.value);\n                this.document.commit('snapNode', {\n                    source: this.dropping.value,\n                    target: this.dragging.value,\n                });\n                this.send('stop dragging');\n            }\n\n            // If we're detaching half-way, then don't commit any position update and just return.\n            if (this.detaching.value.length > 0) {\n                console.log('[Canvas][commitNodePositions] Detaching ended halfway.');\n                this.send('stop detaching');\n                return;\n            }\n\n            // If event.lastEvent exists, then it means that the node moved a little.\n            // Basically, not a \"in-place click\".\n            if (event.lastEvent) {\n                if (event.lastEvent.target) {\n                    event.lastEvent.target.classList.remove('clickthrough');\n                }\n                // Only update the parents, and the descendants will follow.\n                const toUpdate = [];\n                this.selection.forEach((e) => {\n                    const node = this.store.value.nodes[e.id];\n                    if (!node.parent) toUpdate.push(e.id);\n                });\n                this.document.commit('updateNodes', {\n                    id: toUpdate,\n                    by: {\n                        x: event.lastEvent.dist[0],\n                        y: event.lastEvent.dist[1],\n                    },\n                });\n            }\n            this.send('stop dragging');\n        },\n\n        preventSelectionWhenDragging(e) {\n            const { target } = e.inputEvent;\n            if (\n                this.$refs.moveable.isMoveableElement(target)\n                || this.selection.some((t) => t === target || t.contains(target))\n                // || target.matches('.moveable-area')\n                // || target.matches('.moveable-control')\n            ) {\n                e.stop();\n            }\n        },\n\n        tryLinking(nodeId) {\n            if (this.linking.value) {\n                if (nodeId !== this.linking.value) {\n                    console.log(`[Canvas][selectNode] Linking ${this.linking.value} to ${nodeId}`);\n\n                    const linkId = this.document.findLinkByNodeIds(\n                        this.linking.value,\n                        nodeId,\n                    );\n                    if (linkId) {\n                        this.document.commit('removeLink', linkId);\n                    } else {\n                        this.document.commit('createLink', {\n                            source: this.linking.value,\n                            target: nodeId,\n                        });\n                    }\n                }\n            }\n        },\n\n        selectNode(e) {\n            if (this.linking.value && e.selected.length > 0) return;\n            this.send({\n                type: 'update selection',\n                selection: e.selected.map((el) => el.id),\n            });\n        },\n\n        commitSelections(e) {\n            if (e.isDragStart) {\n                e.inputEvent.preventDefault();\n                setTimeout(() => {\n                    this.$refs.moveable.dragStart(e.inputEvent);\n                });\n            }\n            this.selection = e.selected;\n            const selectedIds = e.selected.map((el) => el.id);\n            this.document.updateAwareness('selection', selectedIds);\n            this.send({\n                type: 'done selecting',\n                selection: selectedIds,\n            });\n        },\n\n        resizeNode(event) {\n            // We still need to change the width here, otherwise the resizing is very unresponsive.\n            // TODO: See if we can get around this.\n            const { target } = event;\n            target.style.width = `${event.width}px`;\n            this.document.updateNode({\n                id: event.target.id,\n                set: {\n                    currentWidth: event.width,\n                },\n            });\n        },\n\n        commitNodeSize(event) {\n            if (!event.lastEvent) return;\n            this.document.commit('updateNode', {\n                id: event.target.id,\n                set: {\n                    w: event.lastEvent.width,\n                    h: event.target.offsetHeight,\n                },\n            });\n        },\n\n        // Utility functions\n        mapMousePosition(x, y) {\n            const mappedX = x / this.zoom + this.x;\n            const mappedY = y / this.zoom + this.y;\n            return { x: mappedX, y: mappedY };\n        },\n\n        gatherDescendants(root, includeRoot) {\n            const descendants = includeRoot ? new Set([root.id]) : new Set();\n            root.children.forEach((childId) => {\n                const child = this.store.value.nodes[childId];\n                const childDescendants = this.gatherDescendants(child, true);\n                childDescendants.forEach((descendantId) => {\n                    descendants.add(descendantId);\n                });\n            });\n            return [...descendants];\n        },\n\n        // Event handlers\n        updateCursorPosition(event) {\n            const mapped = this.mapMousePosition(event.clientX, event.clientY);\n            this.document.updateAwareness('cursorX', mapped.x);\n            this.document.updateAwareness('cursorY', mapped.y);\n        },\n\n        startPanning(event) {\n            if (!this.editing) {\n                console.log('[Canvas][startPanning] Space pressed.', event);\n                this.send('space pressed');\n                event.preventDefault();\n                event.stopPropagation();\n            }\n        },\n\n        stopPanning(event) {\n            if (!this.editing) {\n                console.log('[Canvas][startPanning] Space released.', event);\n                this.send('space released');\n                event.preventDefault();\n            }\n        },\n    },\n\n    computed: {\n        activeNodeHeight() {\n            if (this.selection.length > 0) {\n                const node = this.store.value.nodes[this.selection[0].id];\n                if (!node) return 0;\n                if (!node.currentHeight) return this.selection[0].clientHeight;\n                if (node.currentHeight <= 20) {\n                    return node.currentHeight - 8;\n                }\n                return node.currentHeight - 12;\n            }\n            return 0;\n        },\n\n        shouldResize() {\n            if (this.selection.length !== 1) return false;\n            if (!this.store.value.nodes[this.selection[0].id]) return false;\n            if (this.store.value.nodes[this.selection[0].id].parent) return false;\n            return true;\n        },\n    },\n\n    mounted() {\n        // Create handler to update cursor position to remote users.\n        // Don't forget to unregister upon leaving this page!\n        window.addEventListener('mousemove', this.updateCursorPosition);\n        // Register keyboard shortcuts. Need to unregister as well.\n        this.keyboard.on('keydown', 'Space', this.startPanning);\n        this.keyboard.on('keyup', 'Space', this.stopPanning);\n        this.keyboard.on('keydown', 'Backspace', this.deleteNodes);\n        this.keyboard.on('keydown', '$mod+Z', this.undo);\n        this.keyboard.on('keydown', '$mod+Shift+Z', this.redo);\n\n        this.document.on('synced', () => {\n            // Clear selections.\n            this.document.updateAwareness('selection', []);\n        });\n    },\n\n    beforeUnmount() {\n        window.removeEventListener('mousemove', this.updateCursorPosition);\n        this.keyboard.removeListeners();\n    },\n});\n</script>\n\n<style>\n.canvas {\n    position: fixed;\n    width: 100vw;\n    height: 100vh;\n    background: transparent;\n    background-image: radial-gradient(var(--color-neutral-3) 10%, transparent 10%);\n    /* background-size: 15px 15px; */\n    /* background-position: center; */\n}\n\nsvg.links {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    pointer-events: none;\n    /* background: red; */\n}\n</style>\n","import { createKeybindingsHandler } from 'tinykeys';\n\nexport default class Keyboard {\n    constructor() {\n        this.handlers = [];\n    }\n\n    on(event, key, handler) {\n        const options = {};\n        options[key] = handler;\n        const keyBindingHandler = createKeybindingsHandler(options);\n        window.addEventListener(event, keyBindingHandler);\n        this.handlers.push({\n            event,\n            handler: keyBindingHandler,\n        });\n    }\n\n    removeListeners() {\n        this.handlers.forEach((handler) => {\n            window.removeEventListener(handler.event, handler.handler);\n        });\n    }\n}\n","<template>\n    <div\n        class=\"node\"\n        ref=\"node\"\n        :id=\"node.id\"\n        :class=\"{\n            selected: selection.value.includes(node.id),\n            dropping: dropping.value === node.id,\n            noselect: editing.value !== node.id,\n            clickthrough: dragging.value && selection.value.includes(node.id),\n            selectable: !selectedByRemoteUsers,\n            'remote-selected': selectedByRemoteUsers,\n            'snap-top': !node.parent && node.children.length > 0,\n            'snap-middle': node.parent && node.children.length > 0,\n            'snap-bottom': node.parent && node.children.length === 0,\n            reference: isReference,\n        }\"\n        :style=\"styles\"\n        :color=\"isReference ? 'primary' : 'white'\"\n        :gradient=\"isReference\"\n        @mouseenter=\"onMouseEnter\"\n        @focusin=\"onMouseEnter\"\n        @mouseleave=\"onMouseLeave\"\n        @focusout=\"onMouseLeave\"\n    >\n        <note\n            v-if=\"isNote\"\n            :id=\"node.id\"\n            :content=\"node.content\"\n            :editing=\"editing.value === node.id\"\n            @change=\"parseNoteContent\"\n        />\n\n        <reference\n            v-if=\"isReference\"\n            :id=\"node.id\"\n            :type=\"node.referenceType\"\n            :identifier=\"node.identifier\"\n            :title=\"node.title\"\n            :author=\"node.author\"\n        />\n\n        <button class=\"link-button\" v-if=\"showLinkButton\"\n            @mousedown.stop\n            @mouseup.stop\n            @dblclick.stop\n            @click.stop=\"onLinkButtonClick\"\n        >\n            <icon-link/>\n        </button>\n    </div>\n</template>\n\n<script>\nimport { defineComponent } from 'vue';\nimport { NodeTypes } from '@/store';\n\nimport Note from '@/components/canvas/node/Note.vue';\nimport Reference from '@/components/canvas/node/Reference.vue';\nimport { extractIdentifier, fetchLiteratureInfo } from '@/literature';\n\nexport default defineComponent({\n    name: 'IntrigueNode',\n    inject: ['document', 'store', 'state', 'send', 'editing', 'dragging', 'dropping', 'selection'],\n    components: {\n        Note,\n        Reference,\n    },\n    props: {\n        node: {\n            type: Object,\n            required: true,\n        },\n        selected: {\n            type: Boolean,\n            default: false,\n        },\n    },\n\n    data() {\n        return {\n            x: this.node.x,\n            y: this.node.y,\n            w: this.node.w,\n            h: this.node.h,\n            parent: null,\n            // content: this.node.content,\n        };\n    },\n\n    methods: {\n        onMouseEnter() {\n            this.send({\n                type: 'drop enter',\n                node: this.node.id,\n            });\n        },\n\n        onMouseLeave() {\n            this.send({\n                type: 'drop leave',\n                node: this.node.id,\n            });\n        },\n\n        onLinkButtonClick() {\n            this.send('start linking', { node: this.node.id });\n        },\n\n        observeParent() {\n            this.parentWatchers = [\n                this.$watch('parent.currentX', this.updateDimensionsFromParent),\n                this.$watch('parent.currentY', this.updateDimensionsFromParent),\n                this.$watch('parent.currentWidth', this.updateDimensionsFromParent),\n                this.$watch('parent.currentHeight', this.updateDimensionsFromParent),\n            ];\n        },\n\n        updateDimensions() {\n            if (!this.$refs.node) return;\n            const height = this.$refs.node.clientHeight;\n            this.document.updateNode({\n                id: this.node.id,\n                set: {\n                    currentHeight: height,\n                },\n            });\n            this.$emit('update-dimensions');\n        },\n\n        updateDimensionsFromParent() {\n            // console.log('Updating dimensions from parent', this.node.id);\n            this.document.updateNode({\n                id: this.node.id,\n                set: {\n                    x: this.parent.currentX,\n                    y: this.parent.currentY + this.parent.currentHeight + 5,\n                    w: this.parent.currentWidth,\n                    currentX: this.parent.currentX,\n                    currentY: this.parent.currentY + this.parent.currentHeight + 5,\n                    currentWidth: this.parent.currentWidth,\n                    currentHeight: this.$refs.node.clientHeight,\n                },\n            });\n        },\n\n        parseNoteContent(content) {\n            const identifier = extractIdentifier(content);\n            if (identifier) {\n                console.log(`[Node][parseNoteContent@extractIdentifier] ${JSON.stringify(identifier)}`);\n                this.document.commit('updateNode', {\n                    id: this.node.id,\n                    set: {\n                        type: NodeTypes.Reference,\n                        identifier: identifier.identifier,\n                        referenceType: identifier.type,\n                    },\n                });\n\n                if (identifier.type === 'zotero') {\n                    this.document.commit('updateNode', {\n                        id: this.node.id,\n                        set: {\n                            title: identifier.title,\n                            author: identifier.author,\n                            identifier: identifier.identifier,\n                            record: identifier,\n                        },\n                    });\n                } else if (identifier.type === 'zotero-link') {\n                    this.document.commit('updateNode', {\n                        id: this.node.id,\n                        set: {\n                            title: undefined,\n                            author: undefined,\n                            identifier: identifier.identifier,\n                            record: identifier,\n                        },\n                    });\n                } else {\n                    fetchLiteratureInfo(identifier.type, identifier.identifier).then((info) => {\n                        console.log(`[Node][parseNoteContent@fetchLiteratureInfo] ${info}`);\n                        this.document.commit('updateNode', {\n                            id: this.node.id,\n                            set: {\n                                title: info.title,\n                                author: info.author,\n                                identifier: info.identifier\n                                    ? info.identifier : identifier.identifier,\n                                record: info,\n                            },\n                        });\n                    });\n                }\n            }\n        },\n    },\n\n    mounted() {\n        // console.log('Mounted', this.node.id);\n        this.observer = new ResizeObserver(this.updateDimensions);\n        this.observer.observe(this.$refs.node);\n\n        this.document.updateNode({\n            id: this.node.id,\n            set: {\n                currentX: this.node.x,\n                currentY: this.node.y,\n                currentHeight: this.node.h ? this.node.h : this.$refs.node.clientHeight,\n            },\n        });\n\n        if (this.node.parent) {\n            this.parent = this.store.value.nodes[this.node.parent];\n            this.observeParent();\n            this.updateDimensionsFromParent();\n        }\n    },\n\n    breforeUnmount() {\n        console.log('[Node][breforeUnmount] Unmounting', this.node.id);\n        this.observer.disconnect();\n        this.parentWatchers.forEach((removeParentWatcher) => removeParentWatcher());\n    },\n\n    deactivated() {\n        console.log('[Node][deactivated] Deactivated', this.node.id);\n        this.observer.disconnect();\n        this.parentWatchers.forEach((removeParentWatcher) => removeParentWatcher());\n    },\n\n    computed: {\n        styles() {\n            return {\n                width: `${this.w}px`,\n                transform: `translate(${this.x}px, ${this.y}px)`,\n                '--bg-color': 'rgb(250, 248, 229)',\n                '--border-color': 'rgb(233, 183, 109)',\n                'z-index': this.index,\n            };\n        },\n\n        selectedByRemoteUsers() {\n            // console.log(this.document.users);\n            let selected = false;\n            Object.entries(this.document.users).some(([userId, userData]) => {\n                if (userId === this.document.userId) return false;\n                if (userData.selection.includes(this.node.id)) {\n                    selected = true;\n                    return true;\n                }\n                return false;\n            });\n            return selected;\n        },\n\n        isNote() {\n            return this.node.type === NodeTypes.Note;\n        },\n\n        isReference() {\n            return this.node.type === NodeTypes.Reference;\n        },\n\n        index() {\n            let index = 0;\n            let current = this.node;\n            while (current.parent) {\n                index += 1;\n                current = this.store.value.nodes[current.parent];\n            }\n            if (this.selection.value.includes(this.node.id)) {\n                return index + 2;\n            }\n            return index;\n        },\n\n        showLinkButton() {\n            if (this.selection.value.length !== 1) return false;\n            if (!this.selection.value.includes(this.node.id)) return false;\n            return true;\n        },\n    },\n\n    watch: {\n        // eslint-disable-next-line func-names\n        'node.currentX': function () {\n            // console.log('node.currentX changed', this.node.id);\n            this.x = this.node.currentX;\n        },\n        // eslint-disable-next-line func-names\n        'node.currentY': function () {\n            this.y = this.node.currentY;\n        },\n        // eslint-disable-next-line func-names\n        'node.currentWidth': function () {\n            this.w = this.node.currentWidth;\n        },\n        // eslint-disable-next-line func-names\n        'node.x': function () {\n            // console.log('node.x changed', this.node.id);\n            this.document.updateNode({\n                id: this.node.id,\n                set: { currentX: this.node.x },\n            });\n        },\n        // eslint-disable-next-line func-names\n        'node.y': function () {\n            this.document.updateNode({\n                id: this.node.id,\n                set: { currentY: this.node.y },\n            });\n        },\n        // eslint-disable-next-line func-names\n        'node.w': function () {\n            this.document.updateNode({\n                id: this.node.id,\n                set: { currentWidth: this.node.w },\n            });\n        },\n        // eslint-disable-next-line func-names\n        'node.parent': function () {\n            if (this.node.parent) {\n                this.parent = this.store.value.nodes[this.node.parent];\n                this.observeParent();\n                this.updateDimensionsFromParent();\n            } else {\n                this.parent = null;\n                this.parentWatchers.forEach((removeParentWatcher) => removeParentWatcher());\n                this.parentWatchers = [];\n            }\n        },\n    },\n});\n</script>\n\n<style>\n.node {\n    --node-corner: 0.7rem;\n    position: absolute;\n    top: 0;\n    left: 0;\n\n    font-size: 12px;\n\n    border-radius: var(--node-corner);\n    padding: 0.2rem 0.5rem;\n    margin: -1px;\n    background: rgb(250, 248, 229);\n    border: 1px solid rgb(233, 183, 109);\n\n    word-wrap: break-word;\n    /* background: var(--bg-color); */\n    cursor: text;\n    z-index: 1;\n}\n\n.link-button {\n    position: absolute;\n    /* top: calc(50% - 0.5rem); */\n    top: -0.9rem;\n    left: calc(100% - 0.1rem);\n    padding: 0.1rem;\n    padding-left: 0.2rem;\n    padding-right: 0.2rem;\n    border-radius: var(--node-corner);\n    border: 0px transparent;\n    background: rgb(255, 112, 143);\n    color: white;\n    cursor: pointer;\n    z-index: 100 !important;\n}\n\n.link-button:hover {\n    background: rgb(255, 137, 163);\n}\n\n.link-button:active {\n    background: rgb(255, 112, 143);\n}\n\n.reference {\n    background: rgb(203, 227, 250);\n    border: 1px solid rgb(91, 169, 247);\n}\n\n.selected {\n    margin: -2px;\n    border: 2px solid;\n    border-color: rgb(255, 112, 143) !important;\n}\n\n.snap-top {\n    border-radius: var(--node-corner) var(--node-corner) 0 0;\n}\n\n.snap-middle {\n    border-radius: 0;\n}\n\n.snap-bottom {\n    border-radius: 0 0 var(--node-corner) var(--node-corner);\n}\n\n.noselect {\n    -webkit-touch-callout: none; /* iOS Safari */\n    -webkit-user-select: none; /* Safari */\n    -khtml-user-select: none; /* Konqueror HTML */\n    -moz-user-select: none; /* Old versions of Firefox */\n    -ms-user-select: none; /* Internet Explorer/Edge */\n    user-select: none; /* Non-prefixed version, currently\n                                  supported by Chrome, Edge, Opera and Firefox */\n}\n\n.node.noselect {\n    cursor: pointer;\n}\n\n.content {\n    padding: 0.4rem;\n    padding-right: 1rem;\n}\n\n.dropping {\n    margin: -2px;\n    border-width: 2px;\n    z-index: 0;\n}\n\n.remote-selected {\n    margin: -2px;\n    border: 2px solid;\n    border-color: gray !important;\n    pointer-events: none;\n}\n\n.moveable-line {\n    background: transparent !important;\n}\n\n.moveable-control.moveable-origin {\n    border-color: transparent !important;\n    background: transparent !important;\n}\n\n.moveable-control {\n    width: 3.5px !important;\n    height: var(--resize-handle-height) !important;\n    background: transparent !important;\n    margin-top: calc(var(--resize-handle-height) / -2) !important;\n    margin-left: -9px !important;\n    border-radius: 0px !important;\n    border-left: 1px solid rgba(0, 0, 0, 0.15) !important;\n    border-right: 1px solid rgba(0, 0, 0, 0.15) !important;\n    border-top: 0px solid transparent !important;\n    border-bottom: 0px solid transparent !important;\n}\n\n.clickthrough {\n    pointer-events: none;\n}\n</style>\n","<template>\n    <div class=\"note\" ref=\"note\">\n        <editor-content :editor=\"editor\" />\n    </div>\n</template>\n\n<script>\nimport { defineComponent } from 'vue';\nimport { Editor, EditorContent } from '@tiptap/vue-3';\nimport StarterKit from '@tiptap/starter-kit';\nimport Highlight from '@tiptap/extension-highlight';\nimport Link from '@tiptap/extension-link';\n\nexport default defineComponent({\n    name: 'IntrigueNote',\n    inject: ['document', 'store', 'state', 'send'],\n    components: {\n        EditorContent,\n    },\n    props: {\n        id: String,\n        content: String,\n        editing: Boolean,\n    },\n\n    data() {\n        return {\n            editor: null,\n        };\n    },\n\n    mounted() {\n        this.editor = new Editor({\n            content: this.content,\n            extensions: [\n                StarterKit,\n                Highlight,\n                Link.configure({\n                    protocols: ['zotero'],\n                }),\n            ],\n            autofocus: this.editing,\n            editable: this.editing,\n        });\n\n        this.editor.on('blur', this.onEditorBlur);\n    },\n\n    beforeUnmount() {\n        this.editor.destroy();\n    },\n\n    methods: {\n        onEditorBlur() {\n            this.send('editor blur');\n            if (this.editor.getHTML() === '<p></p>') {\n                this.document.deleteNode(this.id);\n            } else {\n                this.document.commit('updateNode', {\n                    id: this.id,\n                    set: {\n                        content: this.editor.getHTML(),\n                    },\n                });\n                this.$emit('change', this.editor.getText());\n            }\n        },\n    },\n\n    watch: {\n        content() {\n            this.editor.commands.setContent(this.content);\n        },\n\n        editing() {\n            this.editor.setEditable(this.editing);\n            if (this.editing) {\n                console.log(`[Note][watch@editing] Editing: ${this.editing}, ${this.id}`);\n                this.editor.commands.focus('end');\n            } else {\n                this.editor.commands.blur();\n            }\n        },\n    },\n});\n</script>\n\n<style>\n.ProseMirror {\n    outline: none;\n    outline-style: none;\n    box-shadow: none;\n    border-color: transparent;\n}\n\n.ProseMirror * {\n    margin-block-start: 0.2rem;\n    margin-block-end: 0.2rem;\n    margin: 0px;\n}\n\n.ProseMirror h1,\nh2,\nh3 {\n    margin-block-start: 0.5rem;\n    margin: 0px;\n}\n\n.ProseMirror ul {\n    padding-inline-start: 1.2rem;\n}\n\n.ProseMirror p.is-editor-empty:first-child::before {\n    content: attr(data-placeholder);\n    float: left;\n    /* color: #adb5bd; */\n    color: var(--va-gray);\n    pointer-events: none;\n    height: 0;\n}\n</style>\n","import { render } from \"./Note.vue?vue&type=template&id=59589eac\"\nimport script from \"./Note.vue?vue&type=script&lang=js\"\nexport * from \"./Note.vue?vue&type=script&lang=js\"\n\nimport \"./Note.vue?vue&type=style&index=0&id=59589eac&lang=css\"\n\nimport exportComponent from \"/Users/shauna/Development/intrigue-dev/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n    <div class=\"reference-content\" ref=\"reference\" @dblclick.stop.prevent=\"showFullText\">\n        <span class=\"title\"> {{ title ? title : 'Fetching title...' }} </span> <br />\n        <span class=\"authors\">\n            {{ author ? formatAuthors(author) : 'Fetching authors...' }}\n        </span>  <br />\n        <span class=\"identifier\"> {{ identifier ? identifier : '' }} </span>\n    </div>\n</template>\n\n<script>\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n    name: 'IntrigueReference',\n    inject: ['document', 'store', 'state', 'send'],\n    components: {},\n    props: {\n        id: String,\n        type: String,\n        title: String,\n        author: String,\n        identifier: String,\n    },\n\n    methods: {\n        formatAuthors(authors) {\n            let authorsString = '';\n            authors.forEach((author, i) => {\n                authorsString += author.family;\n                if (i === authors.length - 2) {\n                    authorsString += authors.length === 2 ? ' and ' : ', and ';\n                } else if (i < authors.length - 2) {\n                    authorsString += ', ';\n                }\n            });\n            return authorsString;\n        },\n\n        showFullText() {\n            if (this.type === 'zotero' || this.type === 'zotero-link') {\n                window.open(this.identifier);\n            } else if (this.type === 'doi') {\n                window.open(`https://sci-hub.se/${this.data.identifier}`);\n            } else if (this.type === 'isbn') {\n                window.open(`http://libgen.rs/search.php?req=${this.data.identifier}`);\n            } else if (this.type === 'url') {\n                window.open(this.identifier);\n            }\n        },\n    },\n});\n</script>\n\n<style scoped>\n.title {\n    font-weight: bold;\n}\n\n.authors {\n    font-weight: normal;\n}\n\n.identifier {\n    font-weight: normal;\n    font-style: italic;\n}\n</style>\n","import { render } from \"./Reference.vue?vue&type=template&id=8d4a73d4&scoped=true\"\nimport script from \"./Reference.vue?vue&type=script&lang=js\"\nexport * from \"./Reference.vue?vue&type=script&lang=js\"\n\nimport \"./Reference.vue?vue&type=style&index=0&id=8d4a73d4&scoped=true&lang=css\"\n\nimport exportComponent from \"/Users/shauna/Development/intrigue-dev/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-8d4a73d4\"]])\n\nexport default __exports__","import * as linkify from 'linkifyjs';\n\nimport doi from 'identifiers-doi';\nimport Cite from 'citation-js';\nimport axios from 'axios';\n\nexport function extractIsbn(subject) {\n    // Checks for ISBN-10 or ISBN-13 format\n    // eslint-disable-next-line operator-linebreak\n    const regex =\n        /^(?:ISBN(?:-1[03])?:? )?(?=[0-9X]{10}$|(?=(?:[0-9]+[- ]){3})[- 0-9X]{13}$|97[89][0-9]{10}$|(?=(?:[0-9]+[- ]){4})[- 0-9]{17}$)(?:97[89][- ]?)?[0-9]{1,5}[- ]?[0-9]+[- ]?[0-9]+[- ]?[0-9X]$/;\n\n    if (regex.test(subject)) {\n        // Remove non ISBN digits, then split into an array\n        const chars = subject.replace(/[- ]|^ISBN(?:-1[03])?:?/g, '').split('');\n        // Remove the final ISBN digit from `chars`, and assign it to `last`\n        const last = chars.pop();\n        let sum = 0;\n        let check;\n        let i;\n\n        if (chars.length === 9) {\n            // Compute the ISBN-10 check digit\n            chars.reverse();\n            for (i = 0; i < chars.length; i += 1) {\n                sum += (i + 2) * parseInt(chars[i], 10);\n            }\n            check = 11 - (sum % 11);\n            if (check === 10) {\n                check = 'X';\n            } else if (check === 11) {\n                check = '0';\n            }\n        } else {\n            // Compute the ISBN-13 check digit\n            for (i = 0; i < chars.length; i += 1) {\n                sum += ((i % 2) * 2 + 1) * parseInt(chars[i], 10);\n            }\n            check = 10 - (sum % 10);\n            if (check === 10) {\n                check = '0';\n            }\n        }\n\n        if (check === last) {\n            const final = subject.match(regex)[0];\n            return final;\n        }\n    }\n    return false;\n}\n\nexport function extractIdentifier(content) {\n    // Check ISBN\n    const isbnString = extractIsbn(content);\n    if (isbnString && isbnString === content.trim()) {\n        return {\n            type: 'isbn',\n            identifier: isbnString,\n        };\n    }\n    // Check DOI\n    const doiStrings = doi.extract(content);\n    if (doiStrings.length > 0 && doiStrings[0] === content.trim()) {\n        return {\n            type: 'doi',\n            identifier: doiStrings[0],\n        };\n    }\n\n    // Check Zotero Paste\n    try {\n        const data = JSON.parse(content);\n        if (data.source === 'zotero') {\n            return {\n                type: 'zotero',\n                identifier: data.url,\n                ...data,\n            };\n        }\n    } catch (e) {\n        // Do nothing here.\n    }\n\n    // Check Zotero URL\n    const zotero = linkify.find(content, 'url').filter(\n        (item) => item.value.startsWith('zotero://'),\n    );\n    if (zotero.length === 1 && zotero[0].value === content.trim()) {\n        return {\n            type: 'zotero-link',\n            identifier: zotero[0].href,\n        };\n    }\n\n    // Check URL\n    const urls = linkify.find(content, 'url');\n    if (urls.length === 1 && urls[0].value === content.trim()) {\n        return {\n            type: 'url',\n            identifier: urls[0].href,\n        };\n    }\n    return false;\n}\n\nexport function fetchLiteratureInfo(type, identifier) {\n    console.log(`[Literature][fetchLiteratureInfo] type: ${type}, identifier: ${identifier}`);\n    return new Promise((resolve, reject) => {\n        if (type === 'url') {\n            axios.get(identifier).then((data) => {\n                // console.log(data.request);\n                const matches = data.data.match(/<title>(.*?)<\\/title>/);\n                resolve({\n                    title: matches[1],\n                    author: [{ family: 'Web link' }],\n                    identifier: data.request.responseURL,\n                });\n            }).catch((err) => {\n                reject(err);\n            });\n        } else {\n            // Handles both BibTex and DOIs.\n            // eslint-disable-next-line no-new, new-cap\n            new Cite.async(identifier, (data) => {\n                const info = data.data[0];\n                // eslint-disable-next-line no-underscore-dangle\n                delete info._graph;\n                resolve(\n                    JSON.parse(JSON.stringify(info)),\n                );\n            });\n        }\n    });\n}\n","import { render } from \"./Node.vue?vue&type=template&id=1a5a19c9\"\nimport script from \"./Node.vue?vue&type=script&lang=js\"\nexport * from \"./Node.vue?vue&type=script&lang=js\"\n\nimport \"./Node.vue?vue&type=style&index=0&id=1a5a19c9&lang=css\"\n\nimport exportComponent from \"/Users/shauna/Development/intrigue-dev/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n    <teleport to=\"#links\">\n        <g ref=\"arrow\" style=\"pointer-events: auto\">\n            <path\n                style=\"cursor: pointer\"\n                :d=\"`M ${sx} ${sy} C ${c1x} ${c1y}, ${c2x} ${c2y}, ${ex} ${ey}`\"\n                :stroke=\"color\"\n                :stroke-width=\"arrowHeadSize / 3 * zoom.value\"\n                fill=\"none\"\n            />\n            <polygon\n                :points=\"`0,${-arrowHeadSize * zoom.value} ${arrowHeadSize *\n                2 * zoom.value},0, 0,${arrowHeadSize * zoom.value}`\"\n                :transform=\"`translate(${ex}, ${ey}) rotate(${ae})`\"\n                :fill=\"color\"\n            />\n        </g>\n    </teleport>\n</template>\n\n<script>\n// import { nextTick } from 'vue';\nimport { getBoxToBoxArrow } from 'curved-arrows';\n\nexport default {\n    name: 'IntrigueLink',\n    inject: ['store', 'x', 'y', 'zoom'],\n\n    props: {\n        source: {\n            type: String,\n            required: true,\n        },\n        target: {\n            type: String,\n            required: true,\n        },\n        text: {\n            type: String,\n            default: '',\n        },\n        color: {\n            type: String,\n            default: '#9A9A9B',\n        },\n        arrowHeadSize: {\n            type: Number,\n            default: 4,\n        },\n    },\n\n    data() {\n        const sourceNode = this.store.value.nodes[this.source];\n        const targetNode = this.store.value.nodes[this.target];\n        if (!targetNode) {\n            window.addEventListener('mousemove', this.updateLine);\n        }\n\n        return {\n            sourceNode,\n            targetNode,\n            sx: 0,\n            sy: 0,\n            c1x: 0,\n            c1y: 0,\n            c2x: 0,\n            c2y: 0,\n            ex: 0,\n            ey: 0,\n            ae: 0,\n            as: 0,\n        };\n    },\n\n    mounted() {\n        this.$refs.arrow.addEventListener('click', this.onClick);\n        this.updateLine();\n    },\n\n    beforeUnmount() {\n        window.removeEventListener('mousemove', this.updateLine);\n    },\n\n    methods: {\n        onClick() {\n            console.log('click');\n        },\n\n        updateLine() {\n            const sourceElement = document.querySelector(`[id=\"${this.source}\"]`);\n            const targetElement = document.querySelector(`[id=\"${this.target}\"]`);\n            const sourceBox = this.getBoundingBox(sourceElement, this.sourceNode);\n            const targetBox = this.getBoundingBox(targetElement, this.targetNode);\n\n            const [sx, sy, c1x, c1y, c2x, c2y, ex, ey, ae] = getBoxToBoxArrow(\n                sourceBox.x,\n                sourceBox.y,\n                sourceBox.w,\n                sourceBox.h,\n                targetBox.x,\n                targetBox.y,\n                targetBox.w,\n                targetBox.h,\n                { padEnd: this.arrowHeadSize },\n            );\n\n            this.sx = this.mapX(sx);\n            this.sy = this.mapY(sy);\n            this.c1x = this.mapX(c1x);\n            this.c1y = this.mapY(c1y);\n            this.c2x = this.mapX(c2x);\n            this.c2y = this.mapY(c2y);\n            this.ex = this.mapX(ex);\n            this.ey = this.mapY(ey);\n            this.ae = ae;\n        },\n\n        mapX(value) {\n            return (value - this.x.value) * this.zoom.value;\n        },\n\n        mapY(value) {\n            return (value - this.y.value) * this.zoom.value;\n        },\n\n        getBoundingBox(element, data) {\n            const rect = element.getBoundingClientRect();\n            const cs = getComputedStyle(element);\n            const paddingX = parseFloat(cs.paddingLeft) + parseFloat(cs.paddingRight);\n            // const paddingY = parseFloat(cs.paddingTop) + parseFloat(cs.paddingBottom);\n\n            // const borderX = parseFloat(cs.borderLeftWidth) + parseFloat(cs.borderRightWidth);\n            // const borderY = parseFloat(cs.borderTopWidth) + parseFloat(cs.borderBottomWidth);\n\n            // const elementWidth = element.offsetWidth - paddingX - borderX;\n            // const elementHeight = element.offsetHeight - paddingY - borderY;\n\n            // const centerX = element.offsetLeft + element.offsetWidth / 2;\n            // const centerY = element.offsetTop + element.offsetHeight / 2;\n\n            return {\n                x: data ? data.currentX : rect.x / this.zoom.value + this.x.value,\n                y: data ? data.currentY : rect.y / this.zoom.value + this.y.value,\n                w: data ? data.currentWidth + paddingX : rect.width / this.zoom.value,\n                h: element.offsetHeight - 2,\n            };\n        },\n    },\n\n    watch: {\n        sourceNode: {\n            deep: true,\n            handler() {\n                this.updateLine();\n            },\n        },\n\n        targetNode: {\n            deep: true,\n            handler() {\n                this.updateLine();\n            },\n        },\n\n        x: {\n            deep: true,\n            handler() {\n                this.updateLine();\n            },\n        },\n\n        y: {\n            deep: true,\n            handler() {\n                this.updateLine();\n            },\n        },\n\n        zoom: {\n            deep: true,\n            handler() {\n                this.updateLine(true);\n            },\n        },\n    },\n};\n</script>\n","import { render } from \"./Link.vue?vue&type=template&id=018bda29\"\nimport script from \"./Link.vue?vue&type=script&lang=js\"\nexport * from \"./Link.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/shauna/Development/intrigue-dev/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./Canvas.vue?vue&type=template&id=13523c6b\"\nimport script from \"./Canvas.vue?vue&type=script&lang=js\"\nexport * from \"./Canvas.vue?vue&type=script&lang=js\"\n\nimport \"./Canvas.vue?vue&type=style&index=0&id=13523c6b&lang=css\"\n\nimport exportComponent from \"/Users/shauna/Development/intrigue-dev/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n    <div id=\"pointer-location\" :style=\"{left: `${x}px`, top: `${y}px`}\"/>\n</template>\n\n<script>\nexport default {\n    name: 'PointerTracker',\n\n    data() {\n        return {\n            x: 0,\n            y: 0,\n        };\n    },\n\n    mounted() {\n        window.addEventListener('mousemove', (event) => {\n            this.x = event.clientX + 2;\n            this.y = event.clientY + 2;\n        });\n    },\n};\n</script>\n\n<style scoped>\n#pointer-location {\n    position: fixed;\n    width: 2px;\n    height: 2px;\n    /* background-color: red; */\n    pointer-events: none;\n}\n</style>\n","import { render } from \"./PointerTracker.vue?vue&type=template&id=0fb01106&scoped=true\"\nimport script from \"./PointerTracker.vue?vue&type=script&lang=js\"\nexport * from \"./PointerTracker.vue?vue&type=script&lang=js\"\n\nimport \"./PointerTracker.vue?vue&type=style&index=0&id=0fb01106&scoped=true&lang=css\"\n\nimport exportComponent from \"/Users/shauna/Development/intrigue-dev/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0fb01106\"]])\n\nexport default __exports__","import { render } from \"./App.vue?vue&type=template&id=58725b44\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=58725b44&lang=scss\"\n\nimport exportComponent from \"/Users/shauna/Development/intrigue-dev/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { createApp } from 'vue';\nimport ArcoVue from '@arco-design/web-vue';\nimport ArcoVueIcon from '@arco-design/web-vue/es/icon';\nimport '@arco-design/web-vue/dist/arco.css';\n\nimport App from './App.vue';\n\nconst app = createApp(App);\napp.use(ArcoVue);\napp.use(ArcoVueIcon);\napp.mount('#app');\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// expose the module cache\n__webpack_require__.c = __webpack_module_cache__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","var getProto = Object.getPrototypeOf ? function(obj) { return Object.getPrototypeOf(obj); } : function(obj) { return obj.__proto__; };\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach(function(key) { def[key] = function() { return value[key]; }; });\n\t}\n\tdef['default'] = function() { return value; };\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"js/\" + chunkId + \".\" + {\"798\":\"bb0d12ed\",\"916\":\"fe57ca0f\"}[chunkId] + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var inProgress = {};\nvar dataWebpackPrefix = \"intrigue:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\t;\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkintrigue\"] = self[\"webpackChunkintrigue\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// module cache are used so entry inlining is disabled\n// startup\n// Load entry module and return exports\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(__webpack_require__.s = 528); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["_createVNode","_component_TitleBar","_component_DocumentCanvas","_component_PointerTracker","propByPath","object","path","value","parts","split","limit","length","i","key","undefined","EventEmitter","constructor","this","events","on","event","callback","push","filter","emit","args","callbacks","forEach","LocalFilePersistence","filePath","doc","fs","debounce","super","timeout","isElectron","readFile","writeFile","access","require","Error","then","data","applyUpdate","Uint8Array","from","catch","storeUpdate","bind","clearTimeout","setTimeout","console","log","encodeStateAsUpdate","enableVueBindings","Vue","SyncedDocument","storeStructure","syncInitialized","store","syncedStore","warn","initSync","documentId","users","reactive","metadata","id","nanoid","getYjsValue","syncProvider","WebrtcProvider","awareness","handleChanges","userId","setLocalStateField","localUser","initPersistence","saveProvider","IndexeddbPersistence","close","destroy","updateAwareness","registerAwarenessCallback","awarenessInfo","getStates","values","onlineUsers","Set","offlineUsers","Object","keys","user","add","delete","entries","stringify","JSON","ReversibleDocument","inverses","undoStack","redoStack","previousTime","captureTimeout","registerInverses","actionA","actionB","commit","action","params","inverseParams","actionFunction","error","currentTime","Date","now","Math","abs","Array","isArray","popStackItem","fromStack","toStack","lastRecord","pop","toStackRecord","reverse","item","inverseAction","undo","redo","canUndo","canRedo","NodeTypes","IntrigueDocument","nodes","links","fragment","remoteSelection","createNode","nodeItem","nodeId","node","type","content","parent","children","identifier","literature","x","y","w","currentX","currentY","currentWidth","link","createLink","child","snapNode","createNodes","nodeItems","nodeIds","newLinks","newChildren","pairInfo","deleteNode","removedLinks","unsnappedChildren","linkId","removeLink","childId","unsnapNode","source","target","deleteNodes","updateNode","update","by","originalValue","set","updateNodes","Area","indexOf","childIndex","splice","findLinkByNodeIds","sourceId","targetId","finds","ViewingState","initial","states","Idle","actions","TitleEditing","Panning","Selecting","Dragging","Dropping","Detaching","detached","Linking","EditingState","Editing","ArrangingState","Selected","Resizing","intrigueMachine","createMachine","Viewing","Arranging","context","editing","panning","dragging","dropping","selection","detaching","linking","setEditing","assign","clearEditing","setPanning","clearPanning","setDragging","clearDragging","setDropping","clearDropping","setDetaching","clearDetaching","setSelection","clearSelection","setLinking","clearLinking","class","_createElementBlock","$data","_createBlock","_component_a_row","justify","align","_component_a_col","span","_component_a_button_group","style","_component_a_button","size","disabled","$options","onClick","icon","_component_icon_undo","_component_icon_redo","_createElementVNode","_toDisplayString","_component_CopyButton","text","$props","shape","status","_hoisted_1","_renderSlot","_ctx","name","props","String","copied","timer","methods","copy","ultralightCopy","$message","__exports__","inject","components","CopyButton","electron","computed","fileName","basename","shareLink","xmlns","_component_vue_infinite_viewer","ref","maxPinchWheel","onScroll","onPinch","onDblclick","_Fragment","_renderList","_component_IntrigueLink","_component_IntrigueNode","selected","some","t","onUpdateDimensions","moveable","updateRect","_component_Moveable","className","draggable","resizable","renderDirections","onClickGroup","onDrag","onDragGroup","onDragEnd","onDragGroupEnd","onResize","onResizeEnd","_component_VueSelecto","dragContainer","selectableTargets","selectByClick","selectFromInside","toggleContinueSelect","keyContainer","hitRate","ratio","onDragStart","onSelect","onSelectEnd","_hoisted_3","Keyboard","handlers","handler","options","keyBindingHandler","createKeybindingsHandler","window","addEventListener","removeListeners","removeEventListener","includes","color","gradient","onMouseenter","onFocusin","onMouseleave","onFocusout","_component_note","onChange","_component_reference","referenceType","title","author","onMousedown","onMouseup","_component_icon_link","_component_editor_content","editor","defineComponent","EditorContent","Boolean","mounted","Editor","extensions","StarterKit","Highlight","Link","protocols","autofocus","editable","onEditorBlur","beforeUnmount","send","getHTML","document","$emit","getText","watch","commands","setContent","setEditable","focus","blur","_hoisted_6","formatAuthors","authors","authorsString","family","showFullText","open","extractIsbn","subject","regex","test","chars","replace","last","check","sum","parseInt","final","match","extractIdentifier","isbnString","trim","doiStrings","doi","extract","parse","url","e","zotero","linkify","startsWith","href","urls","fetchLiteratureInfo","Promise","resolve","reject","axios","matches","request","responseURL","err","Cite","info","_graph","Note","Reference","required","default","h","onMouseEnter","onMouseLeave","onLinkButtonClick","observeParent","parentWatchers","$watch","updateDimensionsFromParent","updateDimensions","$refs","height","clientHeight","currentHeight","parseNoteContent","record","observer","ResizeObserver","observe","breforeUnmount","disconnect","removeParentWatcher","deactivated","styles","width","transform","index","selectedByRemoteUsers","userData","isNote","isReference","current","showLinkButton","_Teleport","to","d","stroke","fill","points","arrowHeadSize","Number","sourceNode","targetNode","updateLine","sx","sy","c1x","c1y","c2x","c2y","ex","ey","ae","as","arrow","sourceElement","querySelector","targetElement","sourceBox","getBoundingBox","targetBox","getBoxToBoxArrow","padEnd","mapX","mapY","zoom","element","rect","getBoundingClientRect","cs","getComputedStyle","paddingX","parseFloat","paddingLeft","paddingRight","offsetHeight","deep","VueInfiniteViewer","Moveable","VueSelecto","IntrigueNode","IntrigueLink","provide","keyboard","newNode","mapped","mapMousePosition","clientX","clientY","doubleClickNode","selectedIds","map","el","preventDefault","panCanvas","scrollLeft","scrollTop","zoomCanvas","canvas","setZoom","cancelSelectionWhenClickEmpty","selecto","clickTarget","inputEvent","inputTarget","sendDragStartMessage","targets","classList","left","right","top","bottom","dragNodes","toDetach","distance","sqrt","dist","pair","translate","commitNodePositions","lastEvent","remove","toUpdate","preventSelectionWhenDragging","isMoveableElement","contains","stop","tryLinking","selectNode","commitSelections","isDragStart","dragStart","resizeNode","commitNodeSize","mappedX","mappedY","gatherDescendants","root","includeRoot","descendants","childDescendants","descendantId","updateCursorPosition","startPanning","stopPropagation","stopPanning","activeNodeHeight","shouldResize","TitleBar","DocumentCanvas","PointerTracker","loading","docId","injections","state","setup","functions","catchErrors","useMachine","broadcastUsername","fruit","getRandomFruitsName","maxWords","ipcRenderer","code","body","_","queryString","location","search","urlParams","URLSearchParams","get","render","app","createApp","App","use","ArcoVue","ArcoVueIcon","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","loaded","__webpack_modules__","call","m","c","deferred","O","result","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","every","r","n","getter","__esModule","a","leafPrototypes","getProto","getPrototypeOf","obj","__proto__","mode","ns","create","def","getOwnPropertyNames","definition","o","defineProperty","enumerable","f","chunkId","all","reduce","promises","u","miniCssF","g","globalThis","Function","prop","prototype","hasOwnProperty","inProgress","dataWebpackPrefix","l","done","script","needAttach","scripts","getElementsByTagName","s","getAttribute","createElement","charset","nc","setAttribute","src","onScriptComplete","prev","onerror","onload","doneFns","parentNode","removeChild","head","appendChild","Symbol","toStringTag","nmd","paths","p","installedChunks","installedChunkData","promise","loadingEnded","errorType","realSrc","message","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}